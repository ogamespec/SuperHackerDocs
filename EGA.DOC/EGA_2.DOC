                               I B M

           
          Р А С Ш И Р Е Н Н Ы Й       Г Р А Ф И Ч Е С К И Й

                           А Д А П Т Е Р

                               - 2 -
       
                        С О Д Е Р Ж А Н И Е
                        -------------------



       Описание....................................................  3
           Основные компоненты.....................................  4
           Режимы функционирования.................................  6
           Базовые операции........................................  8
       
       Регистры.................................................... 12
           Внешние регистры........................................ 12
           Регистры блока синхронизации............................ 17
           Регистры блока управления ЭЛТ........................... 23
           Регистры графического контроллера....................... 39
           Регистры контроллера атрибутов.......................... 48
           
       Особенности программирования адаптера....................... 53
           Программирование регистров.............................. 53
           Загружаемый генератор символов.......................... 60
           Создание набора из 512 символов......................... 61
           Алфавитно-цифровой режим 80 x 43........................ 63
           Организация прерывания по вертикальному обратному
           ходу луча............................................... 63
           Создание разделенного экрана............................ 64

                               - 3 -

                          О П И С А Н И Е
                          ---------------


       Расширенный  Графический  Адаптер  (Enhanced  Graphics Adapter -
   EGA) фирмы IBM представляет собой графический контроллер,  обеспечи-
   вающий возможность работы в различных видеорежимах совместно с цвет-
   ными или  монохромными  мониторами  с цифровыми входами. Кроме того,
   адаптер обеспечивает возможность работы со световым  пером.  Адаптер
   может функционировать в нескольких графических режимах (используются
   4  битовые плоскости) и обладает возможностью загрузки в видеопамять
   шрифтов в алфавитно-цифровых режимах.
   
       В расширенный графический адаптер встроено ПЗУ с базовой  систе-
   мой ввода-вывода (BIOS) для работы с дисплеем как в алфавитно-цифро-
   вых  (A/N)  так  и  в графических режимах (APA), включая все режимы,
   поддерживаемые  монохронным  дисплейным  адаптером  (MDA)  и цветным
   графическим адаптером. Кроме указанных режимов, адаптер поддерживает
   ряд  дополнительных режимов, таких как монохромный графический режим
   с разрешением 640х350 пикселов и 16-ти  цветные  графические  режимы
   640 x 200, 320 x 200 при использовании цветного монитора фирмы  IBM.
   При использовании усовершенствованного цветного монитора IBM адаптер
   обеспечивает  разрешение 640 x 350 как в алфавитно-цифровом, так и в
   графических режимах. В алфавитно-цифровых режимах символы формируют-
   ся одним из двух генераторов символов в ПЗУ адаптера. Первым обеспе-
   чивается  формирование  символов  размером  7х9  (размер  знакоместа
   9х14).  При использовании усовершенствованного цветного монитора на-
   бор символов 9х14 преобразуется к размеру символов 8х14. Второй  ге-
   нератор символов используется для формирования символов размером 7х7
   (размер  знакоместа 8х8). Эти генераторы содержат битовые образы для
   256 различных символов. Наборы символов идентичны наборам,  встроен-
   ным в видеоадаптеры IBM МDA или CGA.
   

       Адаптер содержит в себе 64Кбайт памяти, оформленной в виде 4 би-
   товых плоскостей по 16 Кбайт. Кроме того, обеспечивается возможность
   расширения памяти адаптера до 128 Кбайт или 256 Кбайт.

       Адаптер  расположен  на  отдельной  плате  размером 13 1/8 дюйма
   (333.50мм). Разъем для подключения монитора расположен на зажней па-
   нели адаптера. На плате адаптера  установлено  5  микросхем  высокой
   степени  интеграции специально спроектированных для этого контролле-
   ра. Адаптер содержит специальный вход (Feature Connector), обеспечи-
   вающий доступ ко внутренним функциям через 32-контактный разъем. Для
   расширения видеопамяти используется отдельный 64-контактный разъем.

                               - 4 -
       
       Ниже представлена структурная схема видеоадаптера EGA.
                                                   
   CPU addr.                              ┌──────┐
         ───┬────────────────────────────>│ MUX  ├──────────┐
   CPU data │       ┌──────┐              │      ├────────┐ │
         ─────────┬>│ /CRTC │              └─────┘        │ │
            │     │ │      ├──────────┐        └─────┐    │ │
            │     │ └─────┘          │   ┌──────┐   │    │ ├──>┌──────┐
            │     ├─────│─────────┬───│──>│ GRAPH│<──┴────│─│──>│    1 │<┐
            │     │     │    ┌────│───│──>│      │<───────│─│>┌──────┐ │ │
         ┌─────┐ │     │    │    │   │   └────┬─┘        │ └>│ BIT 0│─┘ │
         │ ROM  ├─┤     │    │    │   │        └────────┐ │   │ MAP  │<──┤
         │      │ │     │    │    │   │                 │ │   └──────┘   │
         └──────┘ │     │    │    │   │                 │ ├────>┌──────┐ │
                  │     │    │    │   │                ┌│─│────>│    3 │<┤
                  │     │    │    │   │   ┌──────┐     │└┐│   ┌──────┐ │ │
                  │     │    │    ├───│──>│ GRAPH│<────┘ │└──>│ BIT 2│─┘ │
                  │ ┌───┴──┐ ├────│───│──>│      ├─────┬─│───>│ MAP  │<──┘
                  └>│      ├─┘    │   │   └────┬─┘     │ │    └──────┘
                    │ SEQ  ├──────│───│────────│───────│─│───────────────
                    │      ├─┐    │   │        └─────┐ │ │
                    └──────┘ │    │   │             ┌───┐──────>  O
                             │    │   └────────────>│      │──────>  U
                             │    └────────────────>│ATTRIB│──────>  T
                             └─────────────────────>│      │──────>  P
                                                    │      │──────>  U
                                                    └──────┘──────>  T

 
     
                 О С Н О В Н Ы Е     К О М П О Н Е Н Т Ы
                 ---------------------------------------


         Блок управления электронно-лучевой трубкой (CRT Controller)
         -----------------------------------------------------------

       Блок управления электронно-лучевой трубкой (ЭЛТ) управляет  сиг-
   налами  горизонтальной и вертикальной синхронизации, начальным адре-
   сом вывода в видеобуфере, положениев и формой курсора и др.

            Блок синхронизации (Sequencer)
            ------------------------------

       В  блоке  синхронизации  генерируются тактовые сигналы и сигналы
   для синхронизации доступа к видеопамяти. Данным устройством  обеспе-
   чивается  возможность  доступа к видеопамяти со стороны процессора в
   специально выделенные моменты времени в промежутке между интервалами
   времени, необходимыми для доступа к видеопамяти в процессе регенера-
   ции изображения на экране дисплея. В этом же блоке содержится регис-
   тры управления записью данных в битовые плоскости.

                               - 5 -

             Графический контроллер (Graphics Controller)
             --------------------------------------------

       Графический контроллер направляет данные из памяти  в контроллер
   атрибутов и в процессор. В графических режимах данные из видеопамяти
   пересылаются в микросхему контроллера атрибутов  последовательно.  В
   текстовых режимах данные пересылаются в параллельной форме  в  обход
   графического  контроллера. Для быстрого изменения изображения на эк-
   ране дисплея аппапатурой обеспечивается возможность  записи  32  бит
   данных за один цикл памяти (8 бит для каждой плоскости), а  дополни-
   тельная  логика  позволяет процессору записывать данные в дисплейную
   память не придерживаясь границ байтов.

           

             Контроллер атрибутов (Attribute controller)
             -------------------------------------------

       В контроллере атрибутов устанавливается  цветовая палитра из  16
   цветов, каждый из которых может быть определен независимо от осталь-
   ных цветов. На вход монитора подается 6-ти битовый код  цвета.  Этой
   же  микросхемой  выполняются действия по управлению мерцанием и под-
   черкиванием. Контроллер получает данные из видеобуфера и преобразует
   их в управляющие сигналы, подаваемые на вход монитора.
   

             Видеобуфер (Display Buffer)
             ---------------------------

       Размер видеобуфера (называемого также  видеопамятью  или  памяью
   адаптера) равен 64 Кб. Видеобуфер доступен со стороны процессора как
   на  чтение  так  и на запись и состоит из 4 битовых плоскостей по 16
   Кб. Существует возможность расширения вмдеобуфера до 128 Кб. На пла-
   те расширения установлены разъемы для подключения еще 128 Кб памяти,
   что позволяет довести размер видеобуфера до 256 Кб. При этом в  каж-
   дую битовую плоскость добавляется два дополнительнвх банка памяти по
   16 Кб.
       С целью совместивости с более ранними  моделями  видеоадаптеров,
   адреса видеобуфера могут изменяться. Вожможны 4 варианта. Видеобуфер
   может  установлен  длиной  128  Кб  и начинаться с сегметного адреса
   A0000, длиной 64 Кб и начинаться с адреса A0000, длиной 32 Кб и  на-
   чинаться с адреса B0000 или длиной 32 Кб с началом по адресу B8000.
       
       
             Базовая систмема ввода/вывода (BIOS)
             ------------------------------------

       Базовая  система  ввода/вывода  видеоадаптера находится в памяти
   специального ПЗУ установленного на плате адаптера. Видео BIOS  объе-
   диняется с системной базовой системой ввода/вывода. Здесь размещают-
   ся  шрифты,  используемые для генерации символов и управляющие прог-
   раммы видеоадаптера. Размер ПЗУ - 16 Кб, начальный адрес - C0000.

                               - 6 -
    

             Дополнительные логические схемы
             -------------------------------

       На плате адаптера, кроме интегральных микросхем, установлены до-
   полнительные схемы для запоминания значений всех битовых  плоскостей
   при чтении байта данных видеобуфера блоком управления ЭЛТ, процессо-
   ром  и генератором символов. На плате установлены два тактовых гене-
   ратора с частотами 14 и 16 Мгц, определяющие частоту  вывода  точек-
   растра.  На плате также установлены 4 внешних регистра ввода/вывода,
   не входящие в состав микросхем.

                    
       
                   РЕЖИМЫ ФУНКЦИОНИРОВАНИЯ
                   -----------------------


                   Цветной монитор фирмы IBM
                   -------------------------

       В приведенной ниже таблице представлен список  и  характеристики
   допустимых режимов при использовании стандартного монитора IBM.

   ┌─────┬─────┬─────┬─────────┬───────┬────────────┬───────┬────────┐
   │ Ре- │ Тип │Цвета│Текстовый│ Начало│   Размер   │ Макс. │  Разре-│
   │ жим │     │     │  формат │ буфера│ знакоместа │cтраниц│  шение │
   ├─────┼─────┼─────┼─────────┼───────┼────────────┼───────┼────────┤
   │  0  │ А/Ц │ 16  │  40x25  │ B8000 │  8x8       │  8    │ 320x200│
   │  1  │ А/Ц │ 16  │  40x25  │ B8000 │  8x8       │  8    │ 320x200│
   │  2  │ А/Ц │ 16  │  80x25  │ B8000 │  8x8       │  8    │ 640x200│
   │  3  │ А/Ц │ 16  │  80x25  │ B8000 │  8x8       │  8    │ 640x200│
   │  4  │ ГР  │  4  │  40x25  │ B8000 │  8x8       │  1    │ 320x200│
   │  5  │ ГР  │  4  │  40x25  │ B8000 │  8x8       │  1    │ 320x200│
   │  6  │ ГР  │  2  │  80x25  │ B8000 │  8x8       │  1    │ 640x200│
   │  D  │ ГР  │ 16  │  40x25  │ A0000 │  8x8       │ 2/4/8 │ 320x200│
   │  E  │ ГР  │ 16  │  80x25  │ A0000 │  8x8       │ 1/2/4 │ 640x200│
   └─────┴─────┴─────┴─────────┴───────┴────────────┴───────┴────────┘
    
       Режимы  с  0  по  6  соответствуют режимам цветного графического
   адаптера (CGA).
       Режимы 0,2 и 5 идентичны режимам 1,3  и 4 соответсвенно  по  вы-
   ходному интерфейсу.
       Поля  "Максимальное  число  страниц" для режимов D и Е указывают
   число страниц, поддерживаемое при наличии графической памяти  разме-
   ром в 64 Кб, 128 Кб или 256 Кб соответственно.

                               - 7 -

             Монохромный монитор фирмы IBM
             -----------------------------

       Следующая таблица описывает режимы,  поддерживаемые  видео  BIOS
   при использовании монохронного дисплея IBM.
       
   ┌─────┬─────┬─────┬─────────┬───────┬────────────┬───────┬────────┐
   │ Ре- │ Тип │Цвета│Текстовый│ Начало│   Размер   │ Макс. │  Разре-│
   │ жим │     │     │  формат │ буфера│ знакоместа │cтраниц│  шение │
   ├─────┼─────┼─────┼─────────┼───────┼────────────┼───────┼────────┤
   │ 7   │ А/Ц │  4  │  80x25  │ B0000 │  9х14      │  8    │ 720x350│
   │ F   │ ГР  │  4  │  80х25  │ A0000 │  8х14      │ 1/2   │ 640х350│
   └─────┴─────┴─────┴─────────┴───────┴────────────┴───────┴────────┘
   
       Видеорежим  7  эмулирует  соответствующий видеорежим монохроно-
   го дисплейного адаптера.


             Усовершенствованный цветной монитор фирмы IBM
             ---------------------------------------------

       Видеоадаптер EGA обеспечивает возможность  совместной  работы  с
   усовершенствованным монитором IBM. Этот монитор способен работать на
   стандартной телевизионной частоте 15.75КГц, а также частоте 21.85КГц.
   Ниже  приведены основные рабочие характеристики усовершенствованного
   монитора.
   
   ┌───────────────────────────────────┬───────────┬───────────────────┐
   │            Параметры              │телечастота│Высокое разрешение │
   ├───────────────────────────────────┼───────────┼───────────────────┤
   │    Частота строк                  │ 15.75КГц  │     21.85КГц      │
   │    Частота кадров                 │ 60Гц      │     60Гц          │
   │    Полоса пропускания             │ 14.318МГц │     16.275МГц     │
   │    Количество цветов              │ 16максимум│     16 или 64     │
   │    Размер символа                 │ 7х7       │     7х9 пиксела   │
   │    Размер знакоместа              │ 8х8       │     8х14 пиксела  │
   │    Максимальное разрешение        │ 640х200   │     640х350 пикс. │
   │    Алфавитно-цифровые режимы      │ 0,1,2,3   │     0,1,2,3       │
   │    Графические режимы             │ 4,5,6,D,E │     10            │
   └───────────────────────────────────┴───────────┴───────────────────┘
   
       При  работе на телевизионной частоте усовершенствованный дисплей
   IBM функционирует ананалогично цветному монитору IBM как по количес-
   тву цветов так и по разрешению.
       В режиме высокого разрешения  адаптер  обеспечивает  расширенные
   возможности вывода символов. Здесь размер знакоместа равен 8 x 16, а
   количество  одновременно представляемых на экране цветов - 16 из па-
   литры в 64 цвета. Цвета воспроизведения изменяются установкой значе-
   ний соответствующих регистров контроллера атрибутов. Разрешение  эк-
   рана соответствует 320 x 350 в режимах 0 и 1, и 640 x 350 в  режимах
   2 и 3.
       Разрешение  выбирается посредством переключателя, установленного
   на плате EGA.

                               - 8 -
                                  
       При использовании усовершенствованного цветного монитора  сохра-
   няется  совместимость  со  всеми ранее перечисленными видеорежимами.
   Кроме  того,  допускается использование дополнительных видеорежимов,
   поддерживаемых программами базовой системы ввода/вывода EGA.
   
   ┌─────┬─────┬─────┬─────────┬───────┬────────────┬───────┬────────┐
   │ Ре- │ Тип │Цвета│Текстовый│ Начало│   Размер   │ Макс. │  Разре-│
   │ жим │     │     │  формат │ буфера│ знакоместа │cтраниц│  шение │
   ├─────┼─────┼─────┼─────────┼───────┼────────────┼───────┼────────┤
   │  0* │ А/Ц │16/64│  40x25  │ B8000 │  8х14      │  8    │ 320x350│
   │  1* │ А/Ц │16/64│  40x25  │ B8000 │  8х14      │  8    │ 320x350│
   │  2* │ А/Ц │16/64│  80x25  │ B8000 │  8х14      │  8    │ 640x350│
   │  3* │ А/Ц │16/64│  80x25  │ B8000 │  8х14      │  8    │ 640x350│
   │  10*│ ГР  │4/16 │  80x25  │ A0000 │  8х14      │  1/2  │ 640x350│
   │     │     │16/64│         │       │            │       │        │
   └─────┴─────┴─────┴─────────┴───────┴────────────┴───────┴────────┘
   
   *  Режимы  0, 1, 2 и 3  приведены  также и  в  таблице  режимов  для
   цветного  монитора  IBM. Видео-BIOS обеспечивает повышенное качество
   вывода при использовании усовершенствованного цветного монитора.
       В поле "Цвета" определены количество одновременно представленных
   на  экране  цветов в том  или ином видеорежиме и количество цветов в
   палитре.
       Для 10h видеорежима в поле "Цвета"  и  поле  количества  страниц
   приведено  два варианта значений, соответствующих объему установлен-
   ной памяти - 64 Кб или более 64 Кб.
     

                  Б А З О В Ы Е     О П Е Р А Ц И И
                  ---------------------------------


                 Алфавитно-цифровые видеорежимы
                 ------------------------------

       Формат  данных  для  алфавитно-цифровых  режимов EGA совпадает с
   форматом данных адаптеров CGA и MDA.  Однако,  применительно  к  EGA
   третий бит байта атрибутов, может быть переопределен и использовать-
   ся  в  качестве бита управления шрифтом при выводе символа на экран.
   Это дает пользователю возможность одновременного  использования  512
   символьного  набора при условии, что размер видеобуфера не менее 128
   Кб.

       При установке одного из возможных алфавитно-цифровых  видеорежи-
   мов,  программы  BIOS загружают шрифт из ПЗУ в  битовую плоскость 2.
   Коды символов, поступающие со стороны процессора хранятся в 0  бито-
   вой плоскости, а байты атрибутов в битовой плоскости 1. Блок  управ-
   ления  ЭЛТ формирует последовательные адреса и одновременно выбирает
   соответствующие код символа и байт атрибута. По коду  символа  и но-
   меру  сканируемой строки растра из плоскости 2 выбирается соответст-
   вующий байт из растра текущего символа. После этого этот байт  пере-
   дается  контроллеру  атрибутов  и в нем, на основании значения байта
   атрибутов, формируется подаваемая на  вход  монитора  последователь-
   ность сигналов цветности.

                               - 9 -
                                  
                      Графические режимы
                      ------------------

      4-х цветные графические режимы с разрешением  320x200 (режимы 4,5)
      ------------------------------------------------------------------

       Указанные  видеорежимы аналогичны графическому режиму с разреше-
   нием 320 x 200 адаптера CGA. Адрес начала видеобуфера B8000. Изобра-
   жение хранится в битовых плоскостях 0 и 1.


         Монохромный графический режим 640х200 (режим 6)
         -----------------------------------------------

       Адресация, распределение и формат данных такой же, как и в  чер-
   но-белом режиме 640 x 200 CGA. Адрес начала видеобуфера B8000. Изоб-
   ражение хранится в 0 битовой плоскости.


         Монохронная графика 640 x 350 (видеорежим F)
         --------------------------------------------

       Данный режим может быть использован при наличии монохроннго  мо-
   нитора. В этом режиме каждая точка может быть  одного  из  следующих
   типов:  темная,  видимая, мерцающая видимая и видимая повышенной яр-
   кости. Для работы в этом режиме необходимо 56 Кб рамяти. Связывая  в
   цепочки  битовые плоскости 0, 1 и отдельно 2 и 3, можно сформировать
   две битовые плоскости размером по 32 Кб. Такое связывание выполняет-
   ся только при необходимости (если размер видеобуфера менее  128  Кб)
   Первая битовая плоскость - это битовая плоскость видимости, а вторая
   - яркости. Обе плоскости находятся по адресу A0000.
       Два  бита, по одному в каждой плоскости, определяют один элемент
   изображения (пиксел) на экране. Тип выводимой точки и  соответствую-
   щие  ему  значения приведены в таблице. Битовые плоскости обозначены
   C0 и C2.

   ┌─────┬─────┬───────────────────────┬─────────────────────────────┐
   │ C2  │ C0  │     Цвет пиксела      │     Значение атрибута       │
   ├─────┼─────┼───────────────────────┼─────────────────────────────┤
   │  0  │  0  │  темный               │       0                     │
   │  0  │  1  │  видимый              │       3                     │
   │  1  │  0  │  мерцающий видимый    │       C                     │
   │  1  │  1  │  интенсивный видимый  │       F                     │
   └─────┴─────┴───────────────────────┴─────────────────────────────┘


       Организация  байтов в памяти последовательная. Первые 8 пикселов
   определяются значением байта в памяти A000:0, вторые восемь пикселов
   - значением по адресу A000:1 и т.д. Первый пиксел в любом байте  оп-
   ределяется 7-ым битом в байте, а последний пиксел байта - битом 0.
       Монохромная  графика  работает  в режиме чет/нечет. Это означает
   что  данные  с  четными адресами, записывются в четную битовую плос-
   кость, а с нечетными адресами в нечетную битовую плоскость. Так  как
   обе битовые плоскости размещаются по адресу A0000, пользователь дол-

                               - 10 -

   жен определить в какой битовой плоскости необходимо произвести изме-
   нение. Это выполняется при помощи регистра маски плоскости (map mask
   register) блока синхронизации.
   
         Цветной графический режим 16/64 (режим 10h)
         -------------------------------------------

       В  этом  видеорежиме используются все 4 битовые плоскости. Соот-
   ветствие цветов значениям в битовых плоскостях дается в  приведенной
   ниже таблице. Битовые плоскости обозначены C0, C1, C2 и C3.
        
            C0 = синие пикселы
            С1 = зеленые пикселы
            С2 = красные пикселы
            С3 = повышенная яркость

       Четыре  бита (по одному из каждой плоскости) определяют цвет од-
   ного пиксела на экране.
   
   ┌─────┬─────┬─────┬─────┬──────────────────────────────────────────┐
   │  I  │  R  │  G  │  B  │       Цвет                               │
   ├─────┼─────┼─────┼─────┼──────────────────────────────────────────┤
   │  0  │  0  │  0  │  0  │   Черный                                 │
   │  0  │  0  │  0  │  1  │   Синий                                  │
   │  0  │  0  │  1  │  0  │   Зеленый                                │
   │  0  │  0  │  1  │  1  │   Серо-голубой                           │
   │  0  │  1  │  0  │  0  │   Красный                                │
   │  0  │  1  │  0  │  1  │   Малиновый                              │
   │  0  │  1  │  1  │  0  │   Коричневый                             │
   │  0  │  1  │  1  │  1  │   Белый                                  │
   │  1  │  0  │  0  │  0  │   Темно-серый                            │
   │  1  │  0  │  0  │  1  │   Светло-синий                           │
   │  1  │  0  │  1  │  0  │   Светло-зеленый                         │
   │  1  │  0  │  1  │  1  │   Светло-серо-голубой                    │
   │  1  │  1  │  0  │  0  │   Светло-красный                         │
   │  1  │  1  │  0  │  1  │   Светло-малиновый                       │
   │  1  │  1  │  1  │  0  │   Желтый                                 │
   │  1  │  1  │  1  │  1  │   Ярко-белый                             │
   └─────┴─────┴─────┴─────┴──────────────────────────────────────────┘

       Видеобуфер раэмещается по адресу A0000. Для выбора  плоскости  в
   которую  производится  запись  используется  регистр маски плоскости
   (map mask register) блока синхронизации.
   

                 Отображение кодов цветов на экране
                 ----------------------------------

       Расширенный графический адаптер поддерживает  графику  640 x 350
   как при использовании монохромного, так и при использовании  усовер-
   шенствованного  цветного  монитора  IBM. Если в видеоадаптере не ис-

                               - 11 -

   пользуется плата расширения видеопамяти, возможности вывода  ограни-
   чены  4-мя  цветами. Если в адаптере установлено 128 Кб памяти и бо-
   лее, могут быть использованы все 16 цветов. В данном разделе  описы-
   ваются  особенности представления цветов в зависимости от объема ус-
   тановленной в адаптере памяти. Заметим, что цвета с кодами 0,1,4 и 7
   инвариантны к размеру графической памяти.

   ┌────────────┬────────────────┬───────────────┬────────────────────┐
   │    Код     │   Монохронный  │   Режим 10Н   │    Режим 10Н       │
   │   цвета    │                │    64Кбайт    │     >64Кбайт       │
   ├────────────┼────────────────┼───────────────┼────────────────────┤
   │  00Н*      │   Черный       │    Черный     │ Черный             │
   │  01H*      │   Видео        │    Синий      │ Синий              │
   │  02H       │   Черный       │    Черный     │ Зеленый            │
   │  03H       │   Видео        │    Синий      │ Серо-голубой       │
   │  04H*      │   Мерцание     │    Красный    │ Красный            │
   │  05H       │   Интенсивный  │    Белый      │ Малиновый          │
   │  06H       │   Мерцание     │    Красный    │ Коричневый         │
   │  07H       │   Интенсивный  │    Белый      │ Белый              │
   │  08H       │   Черный       │    Черный     │ Темно-серый        │
   │  09H       │   Видео        │    Синий      │ Светло-синий       │
   │  0AH       │   Черный       │    Черный     │ Светло-зеленый     │
   │  0BH       │   Видео        │    Синий      │ Светло-серо-голубой│
   │  0CH       │   Мерцание     │    Красный    │ Светло-красный     │
   │  0DH       │   Интенсивный  │    Белый      │ Светло-малиновый   │
   │  0EH       │   Мерцание     │    Красный    │ Желтый             │
   │  0FH       │   Интенсивный  │    Белый      │ Ярко-белый         │
   └────────────┴────────────────┴───────────────┴────────────────────┘

       Отмеченные "*" цвета не зависят от размера видеобуфера.

                               - 12 -


                         Р Е Г И С Т Р Ы
                         ---------------


                 В Н Е Ш Н И Е   Р Е Г И С Т Р Ы
                 -------------------------------

       Этот раздел содержит описание регистров расширенного графического
   адаптера, которые не содержатся в микросхемах высокой степени интег-
   рации.

   ┌─────────────────────────────────────┬────────────┬───────────────┐
   │              Наименование           │   Порт     │   Индекс      │
   ├─────────────────────────────────────┼────────────┼───────────────┤
   │  Многоцелевой регистр вывода        │   3C2      │     -         │
   │  (Misctllaneous Output Register)    │            │               │
   │  Регистр управления спец. входом    │   3?A      │     -         │
   │  (Feature Control Register)         │            │               │
   │  Входной регистр состояния 0        │   3C2      │     -         │
   │  (Input Status register 0)          │            │               │
   │  Входной регистр состояния 1        │   3?2      │     -         │
   │  (Input Status register 1)          │            │               │
   ├─────────────────────────────────────┴────────────┴───────────────┤
   │  ? = B в монохронных режимах       ? = D в цветных режимах       │
   └──────────────────────────────────────────────────────────────────┘
   

            Многоцелевой регистр вывода
            ---------------------------

       Регистр  типа  "только запись". Адрес порта вывода для этого ре-
   гистра 3С2h. При переустановке аппаратуры адаптера все биты в данном
   регистре сбрасываются в 0.

   ┌──────────────────────────────────────────────────────────────────┐
   │               Формат многоцелевого регистра вывода               │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Выбор адреса ввода-вывода                 │
   │     │ │ │ │ │ │ └────> Разрешение доступа к видеопамяти          │
   │     │ │ │ │ │ └──────> Бит выбора частоты 0                      │
   │     │ │ │ │ └────────> Бит выбора частоты 1                      │
   │     │ │ │ └──────────> Блокировка внутренних видеодрайверов      │
   │     │ │ └────────────> Бит страницы для чет/нечет                │
   │     │ └──────────────> Полярность обратного хода луча для строк  │
   │     └────────────────> Полярность обратного хода луча для кадров │
   └──────────────────────────────────────────────────────────────────┘


   Бит 0      Адрес  ввода-вывода.  Этот  бит переопределяет адрес вво-
              да-вывода блока управления  ЭЛТ  применительно  к  режиму
              эмуляции адаптеров MDA или CGA. Логический 0 устанавлива-
              ет  адреса  регисторов блока управления ЭЛТ в 3BX и адрес

                               - 13 -

              входного регистра состояния 1 3BA для эмуляции MDA. Логи-
              ческая 1 устанавливает адреса портов блока управления ЭЛТ
              в  3DX  и  адрес входного регистра состояния 1 равным 3DA
              для эмуляции видеоадаптера типа CGA.
              
   Бит 1      Разрешение доступа к видеопамяти - логический 0 блокирует
              доступ  к видеопамяти со стороны процессора; логическая 1
              разрешает доступ к видеопамяти.
              
   Бит2-Бит3  Выбор тактовой частоты - эти два бита используются для вы-
              бора тактовой частоты в соответствии со следующей таблицей:

         Биты: 3 2
               ---
               0 0 -  частота 14МГц из канала вводы/вывода процессора
               0 1 -  частота 16МГц встроенного генератора
               1 0 -  внешний источник тактовых  сигналов,  поступающих
                      через Специальный вход (Feature Connector)
               1 1 -  не используется

   Бит 4      Блокировка внутренних видеодрайверов - логический 0 акти-
              визирует внутренние видеодрайверы; логическая 1 блокирует
              внутренние видеодрайверы.  Когда внутренние видеодрайверы
              заблокированы, сигналы на вход монитора подаются со  сто-
              роны Специального входа (Feature Connector).

   Бит 5      Бит страницы для режима записи чет/нечет  -  Используется
              для  выбора  между двумя 64 Кбайтными страницами памяти в
              режимах использующих чет/нечет адресацию (0,1,2,3,7). Ло-
              гический 0 служит для выбора младшей страницы; логическая
              1 - старшей.

   Бит 6      Полярность горизонтальная обратного хода луча - логический
              0 служит для выбора положительной полярности;   логическая
              1 - для выбора отрицательный полярности.

   Бит 7      Полярность вертикального обратного хода луча - логический 0
              служит  для выбора положительной полярности;  логическая 1
              - для выбора отрицательной полярности.

                               - 14 -
                                   
             Регистр управления специальным входом
             -------------------------------------

       Регистр  типа  "только запись". Адрес порта вывода для этого ре-
   гистра 3BA или 3DA.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │        Формат регистра управления специальным входом             │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Бит 0 спец. регистра                      │
   │     │ │ │ │ │ │ └────> Бит 0 спец. регистра                      │
   │     │ │ │ │ └─┴──────> Резервные                                 │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

     
   Бит0-Бит1  Биты управления Специальным входом - эти биты используют-
              ся для передачи информации на Специальный вход.  Значения
              этих  битов  поступают  на контакты FEAT1 и FEAT2 данного
              разъема.


                  Входной регистр состояния 0
                  ---------------------------

       Этот регистр типа "только чтение". Адрес порта вывода для этого ре-
   гистра - 3С2.

   ┌──────────────────────────────────────────────────────────────────┐
   │             Формат входного регистра состояния 0                 │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ └─┴─┴─┴──> Не используются                           │
   │     │ │ │ └──────────> Чувствительность к переключателям         │
   │     │ │ └────────────> Зарезервирован                            │
   │     │ └──────────────> Зарезервирован                            │
   │     └────────────────> Обратный ход луча/вывод изображения       │
   └──────────────────────────────────────────────────────────────────┘

   Бит 4      Чувствительность к переключателям - если данный бит уста-
              новлен  в  1 можно считать положение 4-х установленных на
              плате   видеоадаптера  переключателей.  Значение  в  поле
              CLKSEL определяет положение какого переключателя считыва-
              ется.  Положение  переключателей  считывается  по  адресу
              40:88 в оперативной памяти.

           Бит 3:переключатель 4;логический 0 = переключатель разомкнут
           Бит 2:переключатель 3;логический 0 = переключатель разомкнут
           Бит 1:переключатель 2;логический 0 = переключатель разомкнут
           Бит 0:переключатель 1;логический 0 = переключатель разомкнут

   Бит5-Бит6   Код со Специального входа - значения этих битов соответ-
               ствуют значениям постурающих с контактов FEAT 0 и FEAT 1
               Специального входа.

                               - 15 -
                                   
   Бит 7       Содержит логическую 1 если  в  данный  момент изображение
               выводится  на  экран; 0 - является индикатором обратного
               хода луча.
              

                  Входной регистр состояния 1
                  ---------------------------

       Этот регистр типа "только чтение". Адрес порта вывода  для  этого
   регистра - 3BA или 3DA.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │            Формат входного регистра состояния 1                  │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Вывод                                     │
   │     │ │ │ │ │ │ └────> Строб светового пера                      │
   │     │ │ │ │ │ └──────> Переключатель светового пера              │
   │     │ │ │ │ └────────> Вертикальный обратный вход луча           │
   │     │ │ │ └──────────> Диагностика 1                             │
   │     │ │ └────────────> Диагностика 0                             │
   │     └─┴──────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
                                           
   Бит 0      Логический 0 означает, что в данный момент времени  проис-
              ходит  вертикальный  или горизонтальный обратный ход луча.
              Некоторые программы используют этот бит для вывода  данных
              в видеопамять в не активные интервалы времени. EGA не тре-
              бует принятия мер предосторожностей для вывода данных в не
              активные  периоды  времени для того чтобы избежать "снега"
              на экране.
              
   Бит 1      Строб светового пера - логический 0 означает, что  триггер
              светового пера не включен. 1 - триггер включен.

   Бит 2      Переключатель  светового пера - логический 0 означает, что
              переключатель светового пера разомкнут; логическая 1 озна-
              чает, что переключатель светового пера замкнут.

   Бит 3      Вертикальный обратный ход луча - логический  0  означает,
              что в данный момент времени информация воспроизводится на
              экране ЭЛТ; логическая 1 является признаком обратного хо-
              да  луча. Адаптер EGA можно запрограммировать таким обра-
              зом, что будет возникать прерывание уровня 2 в начале ин-
              тервала времени вертикального обратного  хода  луча.  для
              этого  используются  биты 4 и 5 регистра окончания верти-
              кального обратного хода луча блока управления ЭЛТ.

                               - 16 -
                  
   Бит4-Бит5  Диагностические биты.  Они могут быть связаны по выбору с
              двумя  из  6  выходных сигналов управления цветом пиксела
              контроллера атрибутов. Возможные  варианты  подсоединения
              приведены    в    таблице.    Управление   подсоединением
              осуществляется   значением    в    регистре    разрешения
              отображения битовой плоскости контроллера атрибутов.

   ┌──────────────────────────┬───────────────────────────────────────┐
   │ Регистр разрешения отоб- │           Входной регистр             │
   │ ражения бит. плоскости   │           состояния 1                 │
   ├──────────────────────────┼───────────────────────────────────────┤
   │  Бит 5           Бит 4   │ Бит 5              Бит 4              │
   ├──────────────────────────┼───────────────────────────────────────┤
   │  0               0       │ красный            синий              │
   │  0               1       │ вторичный зеленый  зеленый            │
   │  1               0       │ вторичный красный  вторичный зеленый  │
   │  1               1       │ не используется    не используется    │
   └──────────────────────────┴───────────────────────────────────────┘

                               - 17 -
                                   
         Р Е Г И С Т Р Ы   Б Л О К А  С И Н Х Р О Н И З А Ц И И
         -------------------------------------------------------


   ┌─────────────────────────────────────┬────────────┬───────────────┐
   │              Наименование           │   Порт     │   Индекс      │
   ├─────────────────────────────────────┼────────────┼───────────────┤
   │ Адресный                            │    3C4     │      -        │
   │ (Address)                           │            │               │
   │ Инициализации                       │    3C5     │      00       │
   │ (Reset)                             │            │               │
   │ Тактового режима                    │    3C5     │      01       │
   │ (Clocking mode)                     │            │               │
   │ Маски битовой плоскости             │    3C5     │      02       │
   │ (Map mask)                          │            │               │
   │ Выбора набора символов              │    3C5     │      03       │
   │ (Character map select)              │            │               │
   │ Режима использования памяти         │    3C5     │      04       │
   │ (Memory mode)                       │            │               │
   └─────────────────────────────────────┴────────────┴───────────────┘



              Адресный регистр блока синхронизации
              ------------------------------------

       Адресный - регистр, указывающий на один из регистров блока синх-
   ронизации, расположенный по адресу 3С4.   В этот регистр загружается
   двоичный номер регистра блока синхронизации, в который будет  произ-
   водится  запись.  Номера  регистров,  помещаесые  в адресный регистр
   представлены в поле "Индекс" приведенной выше таблицы.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │        Формат адресного регистра блока синхронизации             │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ └─┴─┴─┴──> Адрес                                     │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

      Бит0-Бит3   Биты адреса регистра блока синхронизации  -  двоичный
                  номер  регистра  блока  синхронизации в который будет
                  производится запись.

                               - 18 -
                                   
                     Регистр инициализации
                     ---------------------

       Регистр типа "только запись". Для доступа к этому регистру зна-
   чение  адресного  регистра  должно быть равным 0. Адрес порта вывода
   регистра инициализации 3C5.

   ┌──────────────────────────────────────────────────────────────────┐
   │             Формат регистра инициализации                        │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Асинхронная инициализация                 │
   │     │ │ │ │ │ │ └────> Синхронная инициализация                  │
   │     └─┴─┴─┴─┴─┴──────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

      Бит 0       Асинхронная инициализация - логический 0 дает команду
                  блоку синхронизации перейти в начальное  состояние  и
                  остановиться. Если бит установлен в 0, все выходы пе-
                  реводятся в режим высокого сопротивления. Если данный
                  бит  установлен  в  1,  блок синхронизации продолжает
                  функционирование до тех пор, пока бит 1 содержит  ло-
                  гическую  1. Асинхронная инициализация блока управле-
                  ния может привести к потере данных в видеопамяти.

      Бит 1       Синхронная инициализация - логический 0 является  ко-
                  мандой  для  блока  синхронизации перейти в начальное
                  состояние и прекратить функционирование. Для нормаль-
                  ного функционирования блока синхронизации биты 1 и  0
                  должны  быть  оба установлены в 1. Для сохранения со-
                  держимого памяти перед изменением  значения  регистра
                  тактового режима  инициализацию  необходимо  произво-
                  дить с помощью данного бита.
                   
       
                   Регистр тактового режима
                   ------------------------

       Регистр типа "только запись". Для доступа к этому регистру зна-
   чение  адресного  регистра  должно быть равным 1. Адрес порта вывода
   регистра тактового режима 3C5.
                  
   ┌──────────────────────────────────────────────────────────────────┐
   │                Регистр тактового режима                          │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> 8/9 точек                                 │
   │     │ │ │ │ │ │ └────> Интервал                                  │
   │     │ │ │ │ │ └──────> Режим загрузки регистров сдвига           │
   │     │ │ │ │ └────────> Частота генерации точек                   │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

                               - 19 -
                                   
      Бит 0       8/9 точечный  размер  символьной  единицы  времени (1
                  символьая  единица времени соответствует выводу одной
                  строки в растре символа и определяет необходимое  ко-
                  личество  точек в одной строке растра символа). Логи-
                  ческий 0 задает длину  символьной  единице  равной  9
                  точкам;  логическая 1 - 8 точкам. Единственный режим,
                  в  котором  растр  строки одного символа состоит из 9
                  точек - монохромный алфавитно-цифровой режим  7h.  Во
                  всех  остальных  случаях  используется  8-ми точечная
                  символьная единица времени.
                  
      Бит 1       Интервал времени для доступа к видеопамяти. Если задан
                  логический 0, то доступ к видеопамяти со стороны кон-
                  троллера ЭЛТ осуществляется в течение 4 из 5 возможн-
                  ых  циклов памяти. Если логическая 1 - в течении 2 из
                  5 циклов памяти. Режимы среднего  разрешения  требуют
                  чтения  меньшего объема данных из видеобуфера при вы-
                  воде одной строки растра на экран. Это  дает  возмож-
                  ность  процессору  иметь больший интервал времени для
                  доступа к видеопамяти. В режимах высокого  разрешения
                  для  регенерации изображения на экране используются 4
                  из 5 циклов памяти.

      Бит 2       Загрузка регистров сдвига.  Если бит установлен  в  0,
                  регистры   сдвига   перегружаются   каждый  такт  дли-
                  тельностью в символьную единицу времени. Если бит  ус-
                  тановлен  в  0,  перегрузка производится каждый второй
                  такт. Этот режим полезен в тех случаях, когда за  один
                  цикл  считывается  16  бит с дальнейшим объединением в
                  регистах сдвига.
                  
      Бит 3       Частота  генерации  точек.  Логический 0 соответствует
                  частоте сигналов генерации  точек  на  входе  главного
                  таймера  блока синхронизации. Если установлена 1, час-
                  тота сигналов генерации точек уменьшается вдвое. Ввиду
                  того, что все остальные тактовые  сигналы  формируются
                  на  основе сигналов генерации точек, частота этих сиг-
                  налов также соответственно изменяется. Уменьшенная в 2
                  раза частота применяется в режимах с разрешением 320 x
                  200 (0,1,4 и 5) в которых частота вывода точек 7Мгц  (
                  9 Мгц для режима Dh).

                               - 20 -
                                   
                Регистр маски битовой плоскости
                -------------------------------

       Регистр типа "только запись". Для доступа к этому регистру зна-
   чение  адресного  регистра  должно быть равным 2. Адрес порта вывода
   регистра маски битовой плоскости 3C5.
                  
   ┌──────────────────────────────────────────────────────────────────┐
   │               Формат регистра маски битовой плоскости            │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> 1 - разрешение изменения бит. плоскости 0 │
   │     │ │ │ │ │ │ └────> 1 - разрешение изменения бит. плоскости 1 │
   │     │ │ │ │ │ └──────> 1 - разрешение изменения бит. плоскости 2 │
   │     │ │ │ │ └────────> 1 - разрешение изменения бит. плоскости 3 │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
      
      Бит0-Бит3   Маскирование  битовой плоскости - логическая 1 в битах
                  с 3 по 0 дает возможность изменения процессором  соот-
                  ветствующей битовой плоскости. Если данный регистр со-
                  держит значение 0Fh, за одну операцию записи процессор
                  записывет в видеопамять 32 бита (по 8 бит в каждую би-
                  товую  плоскость).  Это позволяет резко уменьшить заг-
                  рузку процессора при работе с видеопамятью в графичес-
                  ких режимах. Ускоряются также и операции сдвига данных
                  на экране при записи данных из регистра-фиксатора  при
                  выполнении  последовательности операций чтение-измене-
                  ние-запись. В режимах чет/нечет биты из  каждой  пары
                  бит 0,1 и 2,3 должны содержать одинаковые значения.

         Регистр выбора набора символов
         ------------------------------

       Регистр типа "только запись". Для доступа к этому регистру зна-
   чение  адресного  регистра  должно быть равным 3. Адрес порта вывода
   регистра выбора набора символов 3C5.
                  
   ┌──────────────────────────────────────────────────────────────────┐
   │           Формат регистра выбора набора символов                 │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ └─┴──> Выбор набора символов B                   │
   │     │ │ │ │ └─┴──────> Выбор набора символов A                   │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

      Бит0-Бит1   Выбор набора символов B для хранения таблицы шрифтов.
                  Если бит 3 байта атрибутов символа равен 0,  символь-
                  ные битовые плоскости выбираются согласно таблице.

                               - 21 -

          ┌────────┬─────────┬────────────────────────────────────────┐
          │  Биты  │Набор    │                                        │
          │ 1    0 │символов │  Расположение таблицы растров шрифтов  │
          ├────────┼─────────┼────────────────────────────────────────┤
          │Значения│         │                                        │
          │ 0    0 │    0    │   Первые 8К плоскости 2 банка 0        │
          │ 0    1 │    1    │   Вторые 8К плоскости 2 банка 1        │
          │ 1    0 │    2    │   Третие 8К плоскости 2 банка 2        │
          │ 1    1 │    3    │   Четвертые 8К плоскости 2 банка 3     │
          └────────┴─────────┴────────────────────────────────────────┘

      Бит0-Бит1   Выбор набора символов A для хранения таблицы шрифтов.
                  Если  бит 3 байта атрибутов символа равен 1, символь-
                  ные битовые плоскости выбираются согласно таблице.
          ┌────────┬─────────┬────────────────────────────────────────┐
          │  Биты  │Набор    │                                        │
          │ 3    2 │символов │  Расположение таблицы растров шрифтов  │
          ├────────┼─────────┼────────────────────────────────────────┤
          │Значения│         │                                        │
          │ 0    0 │    0    │   Первые 8К плоскости 2 банка 0        │
          │ 0    1 │    1    │   Вторые 8К плоскости 2 банка 1        │
          │ 1    0 │    2    │   Третие 8К плоскости 2 банка 2        │
          │ 1    1 │    3    │   Четвертые 8К плоскости 2 банка 3     │
          └────────┴─────────┴────────────────────────────────────────┘

       В алфавитно-цифровых режимах бит 3 байта атрибутов символа обыч-
   но  предназначен  для управления яркостью фона знакоместа символа на
   экране. Назначение этого бита может быть изменено так, что он  будет
   использоваться  для  выбора шрифта при выводе символа. Использование
   такого режима оправдано тогда, когда наборы символов A и B  различа-
   ются.  Если они совпадают, возможность выбора шрифта не будет реали-
   зована. Для обеспечения одновременной работы с двумя наборами симво-
   лов, в бит 1 регистра режима использования памяти должна быть  зане-
   сена  логическая  1  (признак того, что установлена плата расширения
   видеопамяти). В противном случае всегда выбирается банк 0.

                Регистр режима использования памяти
                -----------------------------------

       Регистр типа "только запись". Для доступа к этому регистру зна-
   чение  адресного  регистра  должно быть равным 4. Адрес порта вывода
   регистра режима использования памяти 3C5.
   ┌──────────────────────────────────────────────────────────────────┐
   │           Формат регистра режима использования памяти            │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Алфавитно-цифровой режим                  │
   │     │ │ │ │ │ │ └────> Расширение видеопамяти                    │
   │     │ │ │ │ │ └──────> Чет/нечет                                 │
   │     └─┴─┴─┴─┴────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

                               - 22 -

   Бит 0      Алфавитно-цифровой режим. Логический 0 является признаком
              того, что адаптер функционирует в графическом режиме, ло-
              гическая  1  - адаптер функционирует в алфавитно-цифровом
              режиме и используется генератор символов.

   Бит 1      Наличие  платы расширения видеопамяти - логический 0 явля-
              ется признаком отсутствия поаты расширения  памяти,  1  -
              признаком  наличия  дополнительной  памяти, для доступа к
              которой используются адресные биты 14 и 15.

   Бит 2      Чет/нечет.  Если установлен логический 0, данные, направ-
              ляемые по четным адресам попадают в битовые плоскости 0 и
              2,  а  по  нечетным - в плоскости 1 и 3. Если установлена
              логическая 1, производится последовательный доступ к бай-
              там  битовой плоскости. Доступ к плоскостям выполняется в
              соответствии со значениями в регистре маскирования  бито-
              вых плоскостей.

                               - 23 -
   
         Р Е Г И С Т Р Ы   Б Л О К А   У П Р А В Л Е Н И Я  Э Л Т
         --------------------------------------------------------
   
   ┌─────────────────────────────────────┬────────────┬───────────────┐
   │              Наименование           │   Порт     │   Индекс      │
   ├─────────────────────────────────────┼────────────┼───────────────┤
   │ Адресный                            │   3?4      │      -        │
   │ (Address)                           │            │               │
   │ Общей длительность строки           │   3?5      │      00       │
   │ (horisontal total)                  │            │               │
   │ Длительности участка отображения    │   3?5      │      01       │
   │ в строке (Horizontal display        │            │               │
   │ enable end)                         │            │               │
   │ Начала горизонтального гашения      │   3?5      │      02       │
   │ (Start horisontal blank)            │            │               │
   │ Окончания горизонтального гашения   │   3?5      │      03       │
   │ луча (End horisontal blank)         │            │               │
   │ Начала горизонтального обратного    │   3?5      │      04       │
   │ хода луча (Start horisontal retrace)│            │               │
   │ Окончания горизонтального обратного │   3?5      │      05       │
   │ хода луча (End horisontal retrace)  │            │               │
   │ Общего количество строк растра      │   3?5      │      06       │
   │ в кадре (vertical total)            │            │               │
   │ Переполнения                        │   3?5      │      07       │
   │ (Overflow)                          │            │               │
   │ Установки строки растра             │   3?5      │      08       │
   │ (Preset row scan)                   │            │               │
   │ Вертикального размера символа       │   3?5      │      09       │
   │ (Max scan line)                     │            │               │
   │ Начала курсора                      │   3?5      │      0A       │
   │ (Cursor start)                      │            │               │
   │ Окончания курсора                   │   3?5      │      0B       │
   │ (Cursor end)                        │            │               │
   │ Старшей составляющей начального     │   3?5      │      0C       │
   │ адреса (Start address high)         │            │               │
   │ Младшей составляющей начального     │   3?5      │      0D       │
   │ адреса (Start address low)          │            │               │
   │ Старшей составляющей позиции        │   3?5      │      0E       │
   │ курсора (Cursor location high)      │            │               │
   │ Младшей составляющей позиции        │   3?5      │      0F       │
   │ курсора (Cursor location high)      │            │               │
   │ Начала вертикального обратного хода │   3?5      │      10h      │
   │ луча (Vertical retrace start)       │            │               │
   │ Старшей составляющей адреса         │   3?5      │      10h      │
   │ светового пера (Light pen high)     │            │               │
   │ Окончания обратного хода луча       │   3?5      │      11h      │
   │ (Vertical retrace end)              │            │               │
   │ Младшей составляющей адреса         │   3?5      │      11h      │
   │ светового пера (Light pen low)      │            │               │
   │ Длительности участка отображения    │   3?5      │      12h      │
   │ в кадре (Vertical display end)      │            │               │
   ├─────────────────────────────────────┴────────────┴───────────────┤
   │         ? = B в монохромных режимах и D в многоцветных           │
   └──────────────────────────────────────────────────────────────────┘

                               - 24 -
   
                                                           Продолжение
   ┌─────────────────────────────────────┬────────────┬───────────────┐
   │              Наименование           │   Порт     │   Индекс      │
   ├─────────────────────────────────────┼────────────┼───────────────┤
   │ Смещения (Offset)                   │   3?5      │      13h      │
   │ Положения символа подчеркивания     │   3?5      │      14h      │
   │ (Underline location)                │            │               │
   │ Начала вертикального гашения луча   │   3?5      │      15h      │
   │ (Start vertical blank)              │            │               │
   │ Окончания вертикального гашения луча│   3?5      │      16h      │
   │ (End vertical blank)                │            │               │
   │ Управления режимом                  │   3?5      │      17h      │
   │ (Mode control)                      │            │               │
   │ Сравнения строк                     │   3?5      │      18h      │
   │ (Line compare)                      │            │               │
   ├─────────────────────────────────────┴────────────┴───────────────┤
   │         ? = B в монохромных режимах и D в многоцветных           │
   └──────────────────────────────────────────────────────────────────┘

             Адресный регистр блока управления ЭЛТ
             -------------------------------------
       
       Адресный регистр регистр блока управления ЭЛТ расположен по  ад-
   ресу 3В4 или 3D4. Если к адаптеру подключен монохронный дисплей, ис-
   пользуется адрес 3В4. Если к адаптеру подключен цветной дисплей, ис-
   пользуется адрес 3D4. В этот регистр загружается двоичный номер ре-
   гистра блока управления ЭЛТ, в который будет производится запись.
   Номера регистров, помещаесые в адресный регистр представлены в поле
   "Индекс" приведенной выше таблицы.
       
   ┌──────────────────────────────────────────────────────────────────┐
   │      Формат адресного регистра блока управления ЭЛТ              │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ └─┴─┴─┴─┴──> Адрес регистра                            │
   │     └─┴─┴────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
   
   Бит0-Бит4  Биты адреса регистра блока управления ЭЛТ - индекс регис-
              тра блока управления ЭЛТ в который будет производится за-
              пись.
         
         Регистр общей длительности строки
         ---------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного  регистра  должно быть равным 0. Адрес порта вывода
   регистра общей длительности строки 3B5 или 3D5.
       
   ┌──────────────────────────────────────────────────────────────────┐
   │          Формат регистра общей длительности строки               │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Общая длительность строки                 │
   └──────────────────────────────────────────────────────────────────┘

                               - 25 -
                                   
   Значение  этого  регистра задает общее количество символов в строке,
   включая и временной интервал, необходимый для горизонтального обрпт-
   ного хода луча. Это значение непосредственно определяет длительность
   сигнала горизонтального обратного хода луча. Внутренний счетчик сим-
   волов подсчитывает количество сигналов вывода символов (длительность
   сигнала задана в символьных единицах времени)  поступающих  на  вход
   блока управления ЭЛТ. Все сигналы управления горизонтальной и верти-
   кальной разверткой базируются на значении данного регистра. Для  уп-
   равления горизонтальной разверткой в компараторах производится срав-
   нение значения этого регистра с номером текущего символа в строке.
       
   Бит 0-Бит 7  Общая длительность строки в символьных единицах времени
                минус 2.

               Регистр длительности участка отображения
               ----------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного  регистра  должно быть равным 1. Адрес порта вывода
   регистра длительности участка отображения 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │          Формат регистра длительности участка отображения        │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Длительность участка отображения в строке │
   └──────────────────────────────────────────────────────────────────┘
   
   Значение  этого регистра задает длительность сигнала в течение кото-
   рого производится вывод информации на экран в строке растра.

   Бит0-Бит7  Длительность участка отображения - количество  отображае-
              мых в строке символов минус 1.


             Регистр начала горизонтального гашения луча
             -------------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного  регистра  должно быть равным 2. Адрес порта вывода
   регистра начала горизонтального гашения луча 3B5 или 3D5.
              
   ┌──────────────────────────────────────────────────────────────────┐
   │        Формат регистра начала горизонтального гашения луча       │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Начало горизонтального гашения луча       │
   └──────────────────────────────────────────────────────────────────┘

   Значение в этом регистре определяет момент активизации сигнала гори-
   зонтального  гашения  луча.  В  течение интервала времени активности
   сигнала  горизонтального гашения луча, на адресный выход и выход уп-
   равления курсором подключаются выход адреса  строки  сканирования  и
   выход  декодирования строки растра для подчеркивания соответственно.
   По заднему фронту сигнала гашения эти выходные  сигналы  фиксируются
   вне  блока управления ЭЛТ. Сигналы адреса строки сканирования и под-

                               - 26 -
   
   черкивания  остаются активными на выходах в течение длительности еще
   одной сиивольной единицы времени после окончания сигнала гашения лу-
   ча.

   Бит0-Бит7  Номер символьной единицы времени активизации сигнала гоо-
              ризонтального гашения луча.


              Регистр окончания горизонтального гашения луча
              ----------------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного  регистра  должно быть равным 3. Адрес порта вывода
   регистра окончания горизонтального гашения луча 3B5 или 3D5.
       
   ┌──────────────────────────────────────────────────────────────────┐
   │      Формат регистра окончания горизонтального гашения луча      │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ └─┴─┴─┴─┴──> Окончание сигнала гашения                 │
   │     │ └─┴────────────> Управление задержкой                      │
   │     └────────────────> Не используется                           │
   └──────────────────────────────────────────────────────────────────┘
   
   Значение  в этом регистре определяет момент времени в который сигнал
   горизонтального гашения луча перестает быть активным. В течение  ин-
   тервала  времени активности сигнала горизонтального гашения луча, на
   адресный выход и выход управления курсором подключаются выход адреса
   строки сканирования и выход декодирования строки растра для  подчер-
   кивания соответственно. По заднему фронту сигнала гашения эти выход-
   ные  сигналы  фиксируются  вне  блока управления ЭЛТ. Сигналы адреса
   строки сканирования и подчеркивания остаются активными на выходах  в
   течение  длительности  еще  одной  сиивольной  единицы времени после
   окончания сигнала гашения луча.
       
   Бит0-Бит4  Окончание сигнала горизонтального гашения луча. В  данное
              поле  помещается младшие 5 битов значения счетчика симво-
              лов, соответствующего моменту времени прекращения сигнала
              горизонтального  гашения.  Чтобы  обеспечить формирование
              сигнала гашения длительностью W, для расчета  помещаемого
              в  данное  поле  значения используется следующая формула:
              Значение начала горизонтального гашения луча  +  длитель-
              ность  сигнала  гашения  в символьных единицах времени ->
              пять младших битов регистра.
    
   Бит5-Бит6  Управление задержкой отображения данных.  Такая  задержка
              необходима  для того, чтобы обеспечить достаточный проме-
              жуток времени для того чтобы блок  управления  ЭЛТ  успел
              обратиться  к видеопамяти и считать код символа и его ат-
              рибут, обратиться к шрифту,  передать  полученные  данные
              через  регистр  сдвига контроллера атрибутов. Для синхро-
              низации с сигналами горизонтального и вертикального обра-
              тного хода луча при каждом доступе  необходимо  задержать
              сигнал  отображения  на  одну символьную единицу времени.

                               - 27 -
   
              Значения в рассматриваемой паре бит и соответствующие  им
              задержки приведены в таблице.
              
              Биты: 6  5
              ───────────
                    0  0  - отсутствие задержки
                    0  1  - задержка на одну символьную единицу времени
                    1  0  - задержка на две символьные единицы времени
                    1  1  - задержка на три символьные единицы времени
                                           
              
           Регистр начала горизонтального обратного хода луча
           --------------------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного  регистра  должно быть равным 4. Адрес порта вывода
   регистра начала горизонтального обратного хода луча 3B5 или 3D5.
              
   ┌──────────────────────────────────────────────────────────────────┐
   │    Формат регистра начала горизонтального обратного хода луча    │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Начало горизонтального обратного хода луча│
   └──────────────────────────────────────────────────────────────────┘

   Этот регистр используется для горизонтального центрирования  экрана
   и  для задания момента времени начала сигнала горизонтального обрат-
   ного хода луча.

   Бит0-Бит7  Начало горизонтального обратного хода  луча.  Значение  в
              этом  регистре, выраженное в символьных единицах времени,
              определяет момент активизации сигнала горизонтального об-
              ратного хода луча.
                                                                       
                  
          Регистр окончания горизонтального обратного хода луча
          -----------------------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного  регистра  должно быть равным 5. Адрес порта вывода
   регистра окончания горизонтального обратного хода луча 3B5 или 3D5.
       
   ┌──────────────────────────────────────────────────────────────────┐
   │   Формат регистра окончания горизонтального обратного хода луча  │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ └─┴─┴─┴─┴──> Окончание сигнала обратного хода луча     │
   │     │ └─┴────────────> Управление задержкой обратного хода       │
   │     └────────────────> Нечетный начальный адрес видеопамяти      │
   └──────────────────────────────────────────────────────────────────┘
       
   Этот регистр специфицирует символьную позицию  в  которой  прекраща-
   ется сигнал горизонтального обратного хода луча.

                               - 28 -
   

   Бит0-Бит4  Окончание горизонтального обратного хода луча. Для  полу-
              чения  сигнала  горизонтального  обратного хода луча дли-
              тельностью W в регистр заносятся 5 младших  битов  значе-
              ния, подсчитываемого по следующей формуле: Значение в ре-
              гистре  начала горизонтального обратного хода луча + W.

   Бит5-Бит6  Задержка сигнала  горизонтального  обратного  хода  луча.
              Двоичный  0 означает отсутствие такой задержки. Для неко-
              торых режимов необходимо обеспечивать такую  длительность
              сигнала  обратного хода луча, что он занимает весь период
              времени сигнала горизонтального гашения. Некоторые  внут-
              ренние  временные сигналы генерируются с приходом заднего
              фронта сигнала горизонтального обратного хода.  Для  того
              чтобы гарантировать правильность фиксации таких сигналов,
              сигнал  горизонтального обратного хода луча начинается до
              окончания периода отображения данных на экране,  а  затем
              задерживается на несколько символьных единиц времени.

   Бит 7      Нечетный/четный начальный адрес видеопамяти.  Данный  бит
              определяет будет ли первый адрес на выходе блока управле-
              ния  ЭЛТ  после  начала сигнала горизонтального обратного
              хода четным или нет. Если установлен логический 0 -  чет-
              ный  адрес.  1  - нечетный адрес. Этот бит может быть ис-
              пользован для горизонтального сдвига пикселов. Как прави-
              ло, данный бит устанавливается в 0.
                                      
                  
         Регистр общего количества строк растра в кадре
         ----------------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного  регистра  должно быть равным 6. Адрес порта вывода
   регистра общего количества строк растра в кадре 3B5 или 3D5.
              
   ┌──────────────────────────────────────────────────────────────────┐
   │        Формат регистра общего количества строк растра            │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Общее количество строк растра в кадре     │
   └──────────────────────────────────────────────────────────────────┘
                                                    
   Бит0-Бит4
              8 младших битов общего количества строк  растра  к  кадре
              включая и вертикальный обратный ход луча. Значение в этом
              регистре  определяет  длительность  сигнала вертикального
              обратного хода луча. Восьмой бит данного регистра  содер-
              жится в бите 0 регистра переполнения блока управления ЭЛТ.

                               - 29 -
                                   
              Регистр переполнения блока управления ЭЛТ
              -----------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного  регистра  должно быть равным 7. Адрес порта вывода
   регистра переполнения блока управления ЭЛТ 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │         Формат регистра переполнения блока управления ЭЛТ        │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> 8-й бит регистра общего кол-ва строк      │
   │     │ │ │ │ │ │ └────> 8-й бит регистра длительности участка     │
   │     │ │ │ │ │ │            отображения в кадре                   │
   │     │ │ │ │ │ └──────> 8-й бит регистра начала вертикального     │
   │     │ │ │ │ │              обратного хода луча                   │
   │     │ │ │ │ └────────> 8-й бит регистра начала вертикального     │
   │     │ │ │ │                гашения луча                          │
   │     │ │ │ └──────────> 8-й бит регистра сравнения строк          │
   │     │ │ └────────────> 8-й бит регистра позиции курсора          │
   │     └─┴──────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
              
   Бит 0      8-й бит регистра общего количества строк в кадре (06h).
   
   Бит 1      8-й бит регистра длительности участка отображения в кадре
              (12h).
    
   Бит 2      8-й бит регистра начала вертикального обратного хода луча
              (10h).

   Бит 3      8-й бит регистра начала вертикального гашения луча (15h).

   Бит 4      8-й бит регистра сравнения строк (18h).

   Бит 5      8-й бит регистра позиции курсора (0Ah).


         Регистр установки номера начальной строки растра
         ------------------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного  регистра  должно быть равным 8. Адрес порта вывода
   регистра установки номера начальной строки растра 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │    Формат регистра установки номера начальной строки растра      │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ └─┴─┴─┴─┴──> Номер начальной строки растра             │
   │     └─┴─┴────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
    
    Данный  регистр целесообразно использовать для управления скроллин-
    гом изображения на экране.

                               - 30 -
                                   
   Бит0-Бит4  Значение  данного  регистра определяет начальное значение
              счетчика строк растра после вертикального обратного  хода
              луча. Значение счетчика увеличивается на 1 с выводом каж-
              дой  строки растра на экране до тех пор пока не достигнет
              значения равного значению в регистре вертикального разме-
              ра символа, после чего счетчик обнуляется.
             
       
             Регистр вертикального размера символа
             -------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного  регистра  должно быть равным 9. Адрес порта вывода
   регистра вертикального размера символа 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │         Формат регистра вертикального размера символа            │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ └─┴─┴─┴─┴──> Количество строк растра в знакоместе      │
   │     └─┴─┴────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
    
   Бит0-Бит4  Значение в этом регистре определяет количество строк раст-
              ра в знакоместе символа и должно  быть  равно  количеству
              строк растра в знакоместе минус 1.
                                                
              
         Регистр начала курсора
         ----------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 0Ah. Адрес порта вывода
   регистра начала курсора 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │                  Формат регистра начала курсора                  │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ └─┴─┴─┴─┴──> Номер строки растра начала курсора        │
   │     └─┴─┴────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

   Бит0-Бит4  Этот регистр определяет номер строки растра начала  отоб-
              ражения курсора в знакоместе. В данный регистр помещается
              значение на 1 меньше номера строки растра начала курсора.

                               - 31 -
       
                    Регистр окончания курсора
                    -------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 0Ah. Адрес порта вывода
   регистра окончания курсора 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │                  Формат регистра начала курсора                  │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ └─┴─┴─┴─┴──> Номер строки растра начала курсора        │
   │     │ └─┴────────────> Управление задержкой сигнала курсора      │
   │     └────────────────> Не используется                           │
   └──────────────────────────────────────────────────────────────────┘

   Бит0-Бит4
              Значение данного  поля  определяет  номер  строки  растра
              окончания отображения курсора в знакоместе.

   Бит5-Бит6  Данное поле используется для управления задержкой сигнала
              курсора.

              Биты: 5  6
              ──────────
                    0  0  - отсутствие задержки
                    0  1  - задержка на одну символьную единицу времени
                    1  0  - задержка на две символьные единицы времени
                    1  1  - задержка на три символьные единицы времени


         Регистр старшей составляющей позиция курсора
         --------------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 0Eh. Адрес порта вывода
   регистра старшей составляющей позиции курсора 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │        Формат регистра старшей составляющей позиции курсора      │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Старшая составляющая позиции курсора      │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит0-Бит7  В  регистр помещается значение старшей составляющей пози-
              ции курсора.

                               - 32 -
                                   
              Регистр младшей составляющей позиции курсора
              --------------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 0Fh. Адрес порта вывода
   регистра младшей составляющей позиции курсора 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │        Формат регистра младшей составляющей позиции курсора      │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │   └─┴─┴─┴─┴─┴─┴─┴──>   Младшая составляющей позиции курсора      │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит0-Бит7  В регистр помещается младшие 8 бит позиции курсора.


         Регистр начала вертикального обратного хода луча
         ------------------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 10h. Адрес порта вывода
   регистра начала вертикального обратного хода луча 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │     Формат регистра начала вертикального обратного хода луча     │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Младшие 8 бит регистра начала вертикаль-  │
   │                        ного обратного хода луча                  │
   └──────────────────────────────────────────────────────────────────┘
                                                    
   Бит0-Бит7  Регистр начала вертикального обратного хода луча содержит
              младшие  8  бит номера строки растра начала вертикального
              обратного хода луча. Бит 8 этого  регистра  расположен  в
              регистре переполнения (07h).


         Регистр старшей составляющей адреса светового пера
         --------------------------------------------------

       Регистр типа "только чтение". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 10h. Адрес порта вывода
   регистра старшей составляющей адреса светового пера 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │    Формат регистра старшей составляющей адреса светового пера    │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Старшие 8 бит счетчика адреса  памяти     │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит0-Бит7  Старшие 8 бит счетчика адреса  памяти  в  момент  нажатия
              кнопки светового пера.

                               - 33 -
                                   
           Регистр окончания вертикального обратного хода луча
           ---------------------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 11h. Адрес порта вывода
   регистра окончания вертикального обратного хода луча 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │   Формат регистра окончания вертикального обратного хода луча    │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ └─┴─┴─┴──> Окончание вертикального обратного хода    │
   │     │ │ │ │            луча                                      │
   │     │ │ │ └──────────> 0 - очистить прерывание по обратному      │
   │     │ │ │                  хода луча                             │
   │     │ │ └────────────> 1 - разрешить прерывание по обратному     │
   │     │ │                    ходу луча                             │
   │     └─┴──────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
                                                    
   Бит0-Бит7  Регистр начала вертикального обратного хода луча содержит
              младшие  8  бит номера строки растра начала вертикального
              обратного хода луча. Бит 8 этого  регистра  расположен  в
              регистре переполнения (07h).
                  
         Регистр младшей составляющей адреса светового пера
         --------------------------------------------------
     
       Регистр типа "только чтение". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 11h. Адрес порта вывода
   регистра младшей составляющей адреса светового пера 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │    Формат регистра младшей составляющей адреса светового пера    │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Младшие 8 бит счетчика адреса  памяти     │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит0-Бит7  Младшие 8 бит счетчика адреса  памяти  в  момент  нажатия
              кнопки светового пера.

                               - 34 -
                                   
           Регистр длительности участка отображения в кадре
           ------------------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 12h. Адрес порта вывода
   регистра длительности участка отображения в кадре 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │     Формат регистра длительности участка отображения в кадре     │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Младшие 8 бит длительности участка        │
   │                        отображения в кадре                       │
   └──────────────────────────────────────────────────────────────────┘
                           
   Бит0-Бит7  Содержат  младшие  8 бит значения, определяющего длитель-
              ность участка отображения в кадре - номер последней отоб-
              ражаемой на экране строки растра в кадре.

         Регистр смещения
         ----------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 13h. Адрес порта вывода
   регистра смещения 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │                 Формат регистра смещения                         │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Длина логической строки экрана            │
   └──────────────────────────────────────────────────────────────────┘
   
   Бит0-Бит7  Определяют длину логической строки экрана. Именно на эту
              величину  увеличивается  начальный  адрес строки экрана в
              видеобуфере при переходе от вывода одной строки к  выводу
              следующей строки. Длительность строки измеряется в словах
              или в двойных словах в зависимости  о  выбранного  метода
              задания временных сигналов в блоке управления ЭЛТ.

         Регистр положения символа подчеркивания
         ---------------------------------------

       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 14h. Адрес порта вывода
   регистра положения символа подчеркивания 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │         Формат регистра положения символа подчеркивания          │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ └─┴─┴─┴─┴──> Номер строки растра в которой генериру-   │
   │     │ │ │              ется символ подчеркивания                 │
   │     └─┴─┴────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

                               - 35 -
                                   
   Бит0-Бит4  Определяют  положение символа подчеркивания в знакоместе.
              Сюда заносится значение на 1 меньшее номера строки растра
              знакоместа в которой должен появиться символ  подчеркива-
              ния.
   
             Регистр начала вертикального гашения луча
             -----------------------------------------
   
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 15h. Адрес порта вывода
   регистра начала вертикального гашения луча 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │         Формат регистра начала вертикального гашения луча        │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Начало вертикального гашения              │
   └──────────────────────────────────────────────────────────────────┘

   Бит0-Бит7  Определяют значение счетчика строк растра при котором ак-
              тивизируется сигнал вертикального гашения луча. Сюда  за-
              носятся младшие 8 бит значения счетчика. Бит 8 помещается
              в регистр переполнения (07h).
   
         Регистр окончания вертикального гашения луча
         --------------------------------------------
   
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 16h. Адрес порта вывода
   регистра окончания вертикального гашения луча 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │      Формат регистра окончания вертикального гашения луча        │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ └─┴─┴─┴─┴──> Окончание вертикального гашения           │
   │     └─┴─┴────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
   
   Бит0-Бит4  Определяет значение счетчика строк растра при котором сиг-
              нал  вертикального  гашения  перестает быть активным. Для
              получения сигнала вертикального гашения длительностью W в
              рассматриваемые  биты  регистра  заносятся  младшие 5 бит
              значения полученного в результате прибавления W, измерен-
              ного  в строках растра, к значению в регистре начала вер-
              тикального гашения луча.

                               - 36 -
                                   
                   Регистр управления режимом
                   --------------------------
   
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 17h. Адрес порта вывода
   регистра управления режимом 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │             Формат регистра управления режимом                   │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Управление совместимостью                 │
   │     │ │ │ │ │ │ └────> Выбор счетчика адреса в строке            │
   │     │ │ │ │ │ └──────> Выбор сигнала горизонтального обратного   │
   │     │ │ │ │ │          хода                                      │
   │     │ │ │ │ └────────> Деление на 2                              │
   │     │ │ │ └──────────> Управление выходом                        │
   │     │ │ └────────────> Вращение адреса                           │
   │     │ └──────────────> Режим байт/слово                          │
   │     └────────────────> Аппаратный перезапуск                     │
   └──────────────────────────────────────────────────────────────────┘

   Бит 0      Управление совместимостью. Если рассматриваемый  бит  со-
              держит логический 0, то в момент вывода данных  на  экран
              бит  0 счетчика адреса в строке заменяется при формирова-
              нии адреса памяти 13-м битом счетчика  адреса.  В  случае
              логической 1 тринадцатый бит счетчика адреса появляется в
              качестве 13-го бита выходного сигнала адреса памяти блока
              управления ЭЛТ. В адаптере CGA в качестве контроллера ЭЛТ
              используется микросхема 6845 позволяющая адресовать толь-
              ко 128 строк растра. Для получения возможности функциони-
              рования  CGA в графическом режиме 640 x 200, его контрол-
              лер ЭЛТ программируется таким образом,  что  используется
              100  строк  растра  с двумя адресами строк растра на одну
              строку. Бит 0 адреса строки растра становится старшим би-
              том адреса памяти дисплейного буфера. Таким образом, пос-
              ледовательные строки растра отстоят друг от друга в виде-
              опамяти  на 8 Кб. Использование данного бита регистра уп-
              равления режимом адаптера EGA позволяет добиться  совмес-
              тимости  с  микросхемой 6845 при работе в соответствующих
              графических режимах.
              
   Бит 1      Логический 0 вызывает появление  бита  1  счетчика адреса
              в  строке  в  качестве 14-го бита адреса памяти. В случае
              задания логической 1, 14-й бит адреса памяти соответству-
              ет 14-му биту счетчика адреса в строке.
                  
   Бит 2      Выбор сигнала горизонтального обратного хода для управле-
              ния счетчиком строк растра. Логическнй 0 обеспечивает из-
              менение значение счетчика строк растра по получению  каж-

                               - 37 -
                                   
              дого  сигнала  горизонтального обратного хода луча, логи-
              ческая 1 - по получению каждого второго сигнала. Этот бит
              может быть использован для удвоения вертикального  разре-
              шения,  обеспечиваемого  контроллером  ЭЛТ.  Ввиду  того,
              что длина регистра общего количества строк растра в кадре
              составляет 9 бит, счетчик строк растра обеспечивает  мак-
              симальное разрешение в 512 растровых строк. Если прираще-
              ние  значения счетчика строк растра производится с часто-
              той появления сигнала горизонтального обратного хода  де-
              ленной  на два, то вертикальное разрешение может быть уд-
              воено и достигать 1024 строк.
              
   Бит 3      Если этот бит установлен в 0, счетчик адреса памяти изме-
              няется в соответствии с тактовой частотой  (в  символьных
              единицах  времени).  Если  бит  установлен в 1 - тактовая
              частота делится на 2. Данный бит используется для  форми-
              рования адреса для доспупа к байту или слову  в  видеопа-
              мяти в процессе регенерации изображения на экране.
   
   Бит 4      Логический 0 - использование выходных драйверов разрешено.
              Логическая  1  -  все выходы переводятся в режим высокого
              сопротивления.
                  
   Бит 5      С помощью данного бита осуществляется управление  появле-
              нием  бита 13 или бита 14 счетчика адреса памяти на месте
              бита 0 адреса памяти в режиме адресации слов. Если  режим
              адресации  слов  не  используется 0-й бит счетчика адреса
              памяти появляется в качестве бита 0 адреса памяти.  Логи-
              ческая 1 в данном бите регистра управления режимом служит
              для выбора бита 15 счетчика адреса памяти. Если в адапте-
              ре  установлена  память  размеров 64 Кб при использовании
              режима чет/нечет следует выбирать бит 13. Если объем  па-
              мяти превышает 64 Кб следует выбирать бит 15. Данная фун-
              кция необходима для обеспечения совместимости с адаптером
              CGA.
   
   Бит 6      Режим адресации слов или режим адресации байтов. Логичес-
              кий 0 - все адреса памяти в режиме адресации слов сдвига-
              ются на 1 бит влево, а старший  бит  счетчика  становится
              младшим  битом адреса памяти (см. приведенную ниже табли-
              цу). Логическая 1 - режим адресации байтов.

                               - 38 -
                                   
                      ┌───────────────────────────────────────────────┐
                      │  Сигналы внутреннего счетчика адреса памяти   │
                      │  подаваемые на выходной мультиплексор         │
   ┌──────────────────┼───────────────────────┬───────────────────────┤
   │ Выход котроллера │  Режим адресации      │  Режим адресации      │
   │        ЭЛТ       │  байтов               │  слов                 │
   ├──────────────────┼───────────────────────┼───────────────────────┤
   │    MA 0/RFA 0    │  MA 0                 │  MA 15 или MA 13      │
   │    MA 1/RFA 1    │  MA 1                 │  MA 0                 │
   │    MA 2/RFA 2    │  MA 2                 │  MA 1                 │
   │    MA 3/RFA 3    │  MA 3                 │  MA 2                 │
   │       .          │    .                  │    .                  │
   │       .          │    .                  │    .                  │
   │       .          │    .                  │    .                  │
   │    MA 14/RS 3    │  MA 14                │  MA 13                │
   │    MA 15/RS 4    │  MA 15                │  MA 14                │
   └──────────────────┴───────────────────────┴───────────────────────┘
                  
   Бит 7      Аппаратный перезапуск - установка логического 0  вызывает
              очистку  горизонтального и вертикального счетчиков. Логи-
              ческая 1 переводит адаптер в режим нормального функциони-
              рования счетчиков.
                  
         Регистр сравнения строк
         -----------------------
   
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 18h. Адрес порта вывода
   регистра сравнения строк 3B5 или 3D5.
   
   ┌──────────────────────────────────────────────────────────────────┐
   │                Формат регистра сравнения строк                   │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> Номер строки                              │
   └──────────────────────────────────────────────────────────────────┘
   
   Бит0-Бит7  В данном регистре  размещаются  8  младших  битов  номера
              строки  для сравнения. Когда значение счетчика строк ста-
              новится равным указанному  в  данном  регистре,  значение
              счетчика  очищается.  Это позволяет защитить часть экрана
              от изменения при выполнении операции прокрутки (скроллин-
              га). Бит 8 рассматриваемого регистра содержится в регист-
              ре переполнения (07h).

                               - 39 -
                                   
                  
     Р Е Г И С Т Р Ы   Г Р А Ф И Ч Е С К О Г О    К О Н Т Р О Л Л Е Р А
     ------------------------------------------------------------------

   ┌─────────────────────────────────────┬────────────┬───────────────┐
   │              Наименование           │   Порт     │   Индекс      │
   ├─────────────────────────────────────┼────────────┼───────────────┤
   │ Регистр позиции графики 1           │    3СС     │      -        │
   │ (Graphics 1 Position )              │            │               │
   │ Регистр позиции графики 2           │    3СA     │      -        │
   │ (Graphics 2 Position )              │            │               │
   │ Адресный регистр графического конт- │    3CE     │      -        │
   │ роллера (Graphics 1 & 2 Address)    │            │               │
   │ Цвета (Set/Reset)                   │    3CF     │      00       │
   │ Разрешения цвета (Enable Set/Reset) │    3CF     │      01       │
   │ Сравнения цвета (Color Compare)     │    3CF     │      02       │
   │ Вращения данных (Data rotate)       │    3CF     │      03       │
   │ Выбора плоскости для чтения         │    3CF     │      04       │
   │ (Read Map Select)                   │            │               │
   │ Выбора режима (Mode)                │    3CF     │      05       │
   │ Многоцелевой (Miscellaneous)        │    3CF     │      06       │
   │ Регистр независимости от значения   │            │               │
   │ плоскости при чтении                │    3CF     │      07       │
   │ (Color Don't Care)                  │            │               │
   │ Маски (Bit Mask)                    │    3CF     │      08       │
   └─────────────────────────────────────┴────────────┴───────────────┘
   
         Регистр позиции графики 1
         -------------------------
   
       Регистр  типа  "только запись". Адрес порта вывода для этого ре-
   гистра 3CC.
       
   ┌──────────────────────────────────────────────────────────────────┐
   │              Формат регистра позиции графики 1                   │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Позиция 0                                 │
   │     │ │ │ │ │ │ └────> Позиция 1                                 │
   │     └─┴─┴─┴─┴─┴──────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
       
   Бит0-Бит1  Биты иерархии графических микросхем. Регистр позиции  оп-
              ределяет, за обработку каких двух битов процессорных дан-
              ных отвечает каждая графическая микросхема. Для  адаптера
              EGA в этот регистр всегда заносится значение 0.

                               - 40 -
                                   
         Регистр позиции графики 2
         -------------------------
   
       Регистр  типа  "только запись". Адрес порта вывода для этого ре-
   гистра 3CA.
       
   ┌──────────────────────────────────────────────────────────────────┐
   │              Формат регистра позиции графики 2                   │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Позиция 0                                 │
   │     │ │ │ │ │ │ └────> Позиция 1                                 │
   │     └─┴─┴─┴─┴─┴──────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
       
   Бит0-Бит1  Биты иерархии графических микросхем. Регистр позиции  оп-
              ределяет, за обработку каких двух битов процессорных дан-
              ных отвечает каждая графическая микросхема. Для  адаптера
              EGA в этот регистр всегда заносится значение 1.
                  
         Адресный регистр графического контроллера
         -----------------------------------------
                  
       Регистр  типа  "только запись". Адрес порта вывода для этого ре-
   гистра 3CE.
                  
   ┌──────────────────────────────────────────────────────────────────┐
   │        Формат адресного регистра графического контроллера        │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ └─┴─┴─┴──> Адрес регистра                            │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
              
   Бит0-Бит3  Биты адреса регистра графического  контроллера  -  индекс
              регистра  графического контроллера в который будет произ-
              водится запись.
                  
         Регистр цвета
         -------------
                  
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 00h. Адрес порта вывода
   регистра цвета 3CF.

   ┌──────────────────────────────────────────────────────────────────┐
   │                    Формат регистра цвета                         │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Значения для плоскости 0                  │
   │     │ │ │ │ │ │ └────> Значения для плоскости 1                  │
   │     │ │ │ │ │ └──────> Значения для плоскости 2                  │
   │     │ │ │ │ └────────> Значения для плоскости 3                  │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

                               - 41 -
                                   
   Бит0-Бит3  Эти биты представляют собой значения помещаемые  в  соот-
              ветствующие  битовые плоскости при записи данных в режиме
              записи 0 при условии, что  в  регистре  разрешения  цвета
              соответствующая плоскость разрешена. Плоскости могут быть
              разрешены  для  записи  значением из регистра цвета путем
              помещения в регистр разрешения цвета необходимого  значе-
              ния командой типа OUT.
                  
         Регистр разрешения цвета
         ------------------------
                  
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 01h. Адрес порта вывода
   регистра разрешения цвета 3CF.

   ┌──────────────────────────────────────────────────────────────────┐
   │             Формат регистра разрешения цвета                     │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Разрешение битовой плоскости 0            │
   │     │ │ │ │ │ │ └────> Разрешение битовой плоскости 1            │
   │     │ │ │ │ │ └──────> Разрешение битовой плоскости 2            │
   │     │ │ │ │ └────────> Разрешение битовой плоскости 3            │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит0-Бит3  Эти  биты  используются для разрешения заполнения каждого
              бита в байте битовой плоскости значением бита из регистра
              цвета для соответствующей плоскости при использовании ре-
              жима записи 0. Если установлен режим записи 0 и плоскость
              не разрешена для записи значением из регистра цвета, то в
              данную  плоскость при выполнении процессором операции за-
              писи в память видеоадаптера заносится байт данных  посту-
              пающий  от процессора.
         
         Регистр сравнения цвета
         -----------------------
                  
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 02h. Адрес порта вывода
   регистра сравнения цвета 3CF.

   ┌──────────────────────────────────────────────────────────────────┐
   │              Формат регистра сравнения цвета                     │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Бит 0 кода цвета для сравнения            │
   │     │ │ │ │ │ │ └────> Бит 1 кода цвета для сравнения            │
   │     │ │ │ │ │ └──────> Бит 2 кода цвета для сравнения            │
   │     │ │ │ │ └────────> Бит 3 кода цвета для сравнения            │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

                               - 42 -
                                   
   Бит0-Бит3  Эти биты используются для задания 4-х битового кода цве-
              та для сравнения. Если для графических микросхем установ-
              лен режим чтения 1 и выполняется операция чтения видеопа-
              мяти, то в прочитанном байте каждый бит для которого зна-
              чения всех четырех плоскостей совпадает с соответствующи-
              ми битами из рассматриваемого регистра будет установлен в
              1 и в 0 в противном случае.
                  
         Регистр вращения данных
         -----------------------
                  
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 03h. Адрес порта вывода
   регистра вращения данных 3CF.

   ┌──────────────────────────────────────────────────────────────────┐
   │              Формат регистра вращения данных                     │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ └─┴─┴──> Число бит на которое производится сдвиг   │
   │     │ │ │ └─┴────────> Логическая функция                        │
   │     └─┴─┴────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит0-Бит2  Двоичное значение, определяющее число бит на которое про-
              изводится  циклический  сдвиг данных процессора влево при
              записи данных  в  видеобуфер.  Эта  операция  выполняется
              только  в  режиме  записи 0. Для записи данных без сдвига
              эти биты должны быть установлены в 0.
                  
   Бит3-Бит4
              При выполнении операции записи, данные  процессора  могут
              быть  логически обработаны вместе с данными хранящимися в
              регистре-фиксаторе.  Ниже  представлен  список допустимых
              битовых функций.
                  
              Биты
              4  3
              ─────
              0  0   Данные не изменяются
              0  1   AND со значением в регистре-фиксаторе
              1  0   OR  со значением в регистре-фиксаторе
              1  1   XOR со значением в регистре-фиксаторе
                         
              Если должен быть выполнен циклический сдвиг, то  операция
              сдвига выполняется до выполнения логической операции.

                               - 43 -
                                   
         Регистр выбора плоскости для чтения
         -----------------------------------
                                            
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 04h. Адрес порта вывода
   регистра выбора плоскости для чтения 3CF.

   ┌──────────────────────────────────────────────────────────────────┐
   │           Формат регистра выбора плоскости для чтения            │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ └─┴─┴──> Номер плоскости для чтения                │
   │     └─┴─┴─┴─┴────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит0-Бит2  Двоичное  число,  определяющее номер плоскости из которой
              будут читаться данные при выполнении  операции  чтения  в
              режиме 0. Значение в данном регистре не оказывает влияния
              на результат выполнения операции в режиме чтения 1.
                  
         Регистр выбора режима
         ---------------------
                                            
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 05h. Адрес порта вывода
   регистра выбора режима 3CF.

   ┌──────────────────────────────────────────────────────────────────┐
   │               Формат регистра выбора режима                      │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ └─┴──> Режим записи                              │
   │     │ │ │ │ │ └──────> Бит тестирования                          │
   │     │ │ │ │ └────────> Режим чтения                              │
   │     │ │ │ └──────────> Чет/нечет                                 │
   │     │ │ └────────────> Режим регистра сдвига                     │
   │     └─┴──────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

                               - 44 -
                                   
   Бит0-Бит1  Режим записи
              Биты
              1  0
              ─────
              0  0   В  том случае, если для битовой плоскости не уста-
                     новлен бит разрешения в регистре разрешения цвета,
                     в соответствующую битовую плоскость заносятся дан-
                     ные процессора сдвинутые в соответствии со  значе-
                     нием в регистре вращения. Все 8 бит  байтов  плос-
                     костей  для  которых установлен бит разрешения за-
                     полняются значением для данной плоскости из регис-
                     тра цвета.
              0  1   Каждая битовая плоскость заполняется соответствую-
                     щим значением из регистра-фиксаторе. Загрузка  ре-
                     гистра-фиксатора  производится при выполнении про-
                     цессором операции чтения видеобуфера.
              1  0   Все 8 бит байта битовой плоскости n (от  0  до  3)
                     заполняются значением n-го бита записываемого про-
                     цессором в видеобуфер байта.
              1  1   Не используется.
                                 
   Бит 2
              При установке в 1 все выходы графического контроллера пе-
              реводятся в режим высокого сопротивления для тестирования.
                  
   Бит 3      Режим  чтения. Логический 0 - процессор осуществляет чте-
              ние данных из плоскости заданной значением в регистре вы-
              бора  плоскости  для  чтения. Логическая 1 - в результате
              выполнения операции чтения в 1 будут  установлены  только
              те биты в байте, для которых цвет совпадает с цветом, за-
              данным в регистре сравнения цвета.
              
   Бит 4      Логическая 1 используется  для  выбора  режима  адресации
              чет/нечет  который является полезным при работе в режимах
              совместимости с адаптерами типа CGA. Обычно значение дан-
              ного бита совпадает со значением бита 3  регистра  режима
              использования памяти блока синхронизации.
              
   Бит 5      Логическая 1 - в регистрах сдвига каждой графической мик-
              росхемы последовательный поток данных форматируется таким
              образом, что биты с четными номерами помещаются в битовые
              плоскости  с четными номерами, а с нечетными номерами - в
              нечетные битовые плоскости.

                               - 45 -
                                   
         Многоцелевой регистр
         --------------------
    
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 06h. Адрес порта вывода
   многоцелевого регистра 3CF.

   ┌──────────────────────────────────────────────────────────────────┐
   │                Формат многоцелевого регистра                     │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Графический режим                         │
   │     │ │ │ │ │ │ └────> Сцепление нечетных плоскостей с четными   │
   │     │ │ │ │ │ └──────> Битовая плоскость 0                       │
   │     │ │ │ │ └────────> Битовая плоскость 1                       │
   │     └─┴─┴─┴──────────> Не используюся                            │
   └──────────────────────────────────────────────────────────────────┘
       
   Бит 0      Используется для управления адресацией в алфавитно-цифро-
              вых режимах. Логическая 1 перводит адаптер в  графический
              режим.  В  графическом режиме фиксация адресов генератора
              символов не производится.
   Бит 1      Логическая 1 - Бит 0 генерируемого процессором адреса за-
              меняет старший бит адреса и, таким образом  четная/нечет-
              ная плоскость выбирается в зависимости от того четный или
              нечетный адрес формирует процессор при обращении к видео-
              памяти.
   Бит2-Бит3
              Данные биты используются для отображения пространства ад-
              ресов процессора на видеопамять.
       
              Биты
              3  2
              ─────
              0  0   A000h длиной 128 Кб
              0  1   A000h длиной  64 Кб
              1  0   B000h длиной  32 Кб
              1  1   B800h длиной  32 Кб
              
              Если пространство адресов начинается с A000h и имеет дли-
              ну 128 Кб, в системе не может быть дополнительно установ-
              лен никакой другой дисплейный адаптер.

                               - 46 -
                                   
         Регистр независимости от цвета
         ------------------------------
    
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 07h. Адрес порта вывода
   регистра независимости от значения плоскости при чтении 3CF.
                                                  
   ┌──────────────────────────────────────────────────────────────────┐
   │      Формат независимоти от значения плоскости при чтении        │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Независимость от значения плоскости 0     │
   │     │ │ │ │ │ │ └────> Независимость от значения плоскости 1     │
   │     │ │ │ │ │ └──────> Независимость от значения плоскости 2     │
   │     │ │ │ │ └────────> Независимость от значения плоскости 3     │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит 0      Логическая 1 - при чтении с использованием регистра срав-
              нения цвета значение в битовой плоскости 0  не  оказывает
              влияния на результат.
   Бит 1      Логическая 1 - при чтении с использованием регистра срав-
              нения цвета значение в битовой плоскости 1  не  оказывает
              влияния на результат.
   Бит 2      Логическая 1 - при чтении с использованием регистра срав-
              нения цвета значение в битовой плоскости 2  не  оказывает
              влияния на результат.
   Бит 3      Логическая 1 - при чтении с использованием регистра срав-
              нения цвета значение в битовой плоскости 3  не  оказывает
              влияния на результат.
                                                        
         Регистр маски
         -------------
                      
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 08h. Адрес порта вывода
   регистра маски 3CF.
                                                  
   ┌──────────────────────────────────────────────────────────────────┐
   │                   Формат регистра маски                          │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     └─┴─┴─┴─┴─┴─┴─┴──> 0 - значение не изменяется                │
   │                        1 - значение может быть изменено          │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит0-Бит7  Если n-й бит регистра маски установлен в  0,  n-й  бит  в
              каждой  из  4-х плоскостей при выполнении операции записи
              не будет изменен (при  условии,  что  последняя  операция
              чтения  производилась процесоором по тому же адресу что и
              запись). Если бит установлен в 1, то соответствующий  бит
              может быть изменен в соответствии с правилами, определяе-
              мыми значениями других регистров графического контроллера.

                               - 47 -
                                   
              Битовая  маска используется при всех вариантах выполнения
              операции записи (при циклическом сдвиге, применении логи-
              ческих операций OR, XOR, AND, при записи плоскостей  дан-
              ными из регистра цвета и т.д.). Для того чтобы с  помощью
              регистра  маски защитить определенные биты в байте от из-
              менения, находящиеся по рассматриваемому адресу  видеопа-
              мяти  данные  должны  быть  помещены  во  внутренний  ре-
              гистр-фиксатор адаптера. При выполнении процессором  опе-
              рации  чтения байта видеопамяти данные всех четырех плос-
              костей автоматически помещаются в регистр-фиксатор. Бито-
              вая  маска одновременно применяется ко всем четырем плос-
              костям.
                  

                               - 48 -
                                   
                                   
       Р Е Г И С Т Р Ы    К О Н Т Р О Л Л Е Р А   А Т Р И Б У Т О В
       ------------------------------------------------------------

   ┌─────────────────────────────────────┬────────────┬───────────────┐
   │              Наименование           │   Порт     │   Индекс      │
   ├─────────────────────────────────────┼────────────┼───────────────┤
   │ Адресный регистр (Address Register) │   3C0      │      -        │
   │ Регистры палитры (Palette Registers)│   3C0      │   00 - 0F     │
   │ Регистр управления режимом          │   3C0      │   10          │
   │ (Mode Control Register)             │            │               │
   │ Регистр управления цветом бордюра   │   3C0      │   11          │
   │ (Overscan Color Register)           │            │               │
   │ Регистр разрешения отображения бито-│   3C0      │   12          │
   │ вой плоскости (Color Plane Enable   │            │               │
   │ Register)                           │            │               │
   │ Горизонтального сдвига пикселов     │   3C0      │   13          │
   │ (Horisontal Pel Panning Register)   │            │               │
   └─────────────────────────────────────┴────────────┴───────────────┘

         Адресный регистр контроллера атрибутов
         --------------------------------------
              
       Регистр  типа  "только запись". Адрес порта вывода для этого ре-
   гистра 3C0.
              
   ┌──────────────────────────────────────────────────────────────────┐
   │         Формат адресного регистра контроллера атрибутов          │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ └─┴─┴─┴─┴──> Адрес регистра                            │
   │     │ │ └────────────> Доступ к регистрам палитры                │
   │     └─┴──────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
                                                      
   Бит0-Бит4  Адресный регистр является регистром-указателем и доступен
              для записи через порт с адресом 3C0h. В этот регистр заг-
              ружается двоичный код регистра  контроллера  атрибутов  к
              которому будет производиться обращение. В контроллере ат-
              рибутов  как адресный регистр, так и регистры данных дос-
              тупны через порт с одним и тем же адресом - 3COh.  Внутри
              контроллера  адресация  организована  таким  образом, что
              каждый раз после записи в порт 3COh, производится  перек-
              лючение: адресный регистр -> регистр данных, соответству-
              ющий  значению адресного регистра и наоборот. Для инициа-
              лизации  процесса переключения адресный регистр - регистр
              данных (вначале доступ к адресному регистру,  а  потом  к
              регистру  данных  и  т.д.)  необходимо выполнить операцию
              чтения из порта с адресом 3BAh или 3DAh. После выполнения
              операции чтения, первый доступ к порту 3C0h будет обраще-
              нием к адресному регистру  контроллера  атрибутов.  После
              загрузки  адресного  регистра, следующая команда вывода в
              порт 3C0h приведет к записи требуемого значения  в  соот-

                               - 49 -
                                   
              ветствующий  регистр данных контроллера атрибутов. Выпол-
              нение этой команды снова делает адресный регистр  доступ-
              ным для записи и процесс может быть продолжен.
              
   Бит 5      При загрузке регистров палитры данный бит должен быть ус-
              тановлен в 0. Для обеспечения доступа к регистрам палитры
              в  процессе  регененрации  изображения на экране значение
              этого бита должно быть равным 0.
                  
         Регистры палитры (от 00h до 0Fh)
         --------------------------------
                  
       Регистры  типа "только запись". Адрес порта вывода для  этих ре-
   гистров 3C0.
              
   ┌──────────────────────────────────────────────────────────────────┐
   │                 Формат регистра палитры                          │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Синий                                     │
   │     │ │ │ │ │ │ └────> Зеленый                                   │
   │     │ │ │ │ │ └──────> Красный                                   │
   │     │ │ │ │ └────────> Вторичный синий                           │
   │     │ │ │ └──────────> Вторичный зеленый                         │
   │     │ │ └────────────> Вторичный красный                         │
   │     └─┴──────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит0-Бит5  6-ти битовые регистры палитры предназначены  для  динами-
              ческого  отображения атрибутов символов или цветов пиксе-
              лов в графических режимах в конкретные цвета  их  образов
              на  экране  дисплея. Логическая 1 используется для выбора
              соответствующей составляющей в сигнале цветности на входе
              монитора. Для того чтобы  избежать  появления  на  экране
              различного рода срывов изображения, регистры цветовой па-
              литры  следует  модифицировать только в интервалы времени
              обратного хода луча. Заметьте, что некоторые мониторы  не
              имеют входа для управления интенсивностью луча и, в связи
              с  этим, обеспечивают возможность формирования не более 8
              цветов. Мониторы с 4 входами обеспечивают возможность ис-
              пользования 16 цветов, тогда как мониторы с 6 входами для
              сигналов цветности - 64 цветов.

                               - 50 -
                                   
         Регистр управления режимом
         --------------------------
                  
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 10h. Адрес порта вывода
   регистра управления режимом 3C0.
                  
   ┌──────────────────────────────────────────────────────────────────┐
   │             Формат регистра управления режимом                   │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Алфавитно-цифровой/графический режим      │
   │     │ │ │ │ │ │ └────> Тип дисплея                               │
   │     │ │ │ │ │ └──────> Расширение символов псевдографики         │
   │     │ │ │ │ └────────> Выбор интенсивность или мигание           │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит 0      Логическая 1 - графический режим. Логический 0 - алфавит-
              но-цифровой
                  
   Бит 1      Монохромный дисплей/цветной дисплей. Логический 0  -  ин-
              терпретация  атрибутов  символов применительно к цветному
              дисплею. Логическая 1 - интерпретация атрибутов  символов
              как монохромных.
                                                                   
   Бит 2      Если данный бит установлен в 0, 9-й столбец в растре всех
              символов будет заполнен цветом фона. Логическая 1 -  при-
              менительно  к  символам  псевдографики с кодами от C0h до
              DFh включительно, 9-й столбец растра символа будет совпа-
              дать с 8-м столбцом. Если загружена кодовая таблица в ко-
              торой символы из указанного  интервала  заменены  другими
              символами, данный бит следует установить в 0. В противном
              случае, начертания на экране указанных символов будут ис-
              кажены. Использование данного бита существенно только при
              работе  в  режиме совместимости с монохромным графическим
              адаптером (MDA), для которого ширина знакоместа составля-
              ет 9 точек.
                                                                 
   Бит 3      Логический 0 - соответствующий бит байта атрибутов симво-
              ла интерпретируется как  бит  управления  интенсивностью.
              Такое использование указанного бита допускается в адапте-
              рах типа MDA и CGA. Логическая 1 - использование  указан-
              ного  бита байта атрибута для мигания символа на экране в
              алфавитно-цифровых  режимах. В графических режимах, в ко-
              торых допускается мигание, данный бит регистра управления
              режимом должен также быть установлен в 1.

                               - 51 -
         
         Регистр управления цветом бордюра
         ---------------------------------
                  
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 11h. Адрес порта вывода
   регистра управления цветом бордюра 3C0.
                  
   ┌──────────────────────────────────────────────────────────────────┐
   │           Формат регистра управления цветом бордюра              │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ │ │ │ └──> Синий                                     │
   │     │ │ │ │ │ │ └────> Зеленый                                   │
   │     │ │ │ │ │ └──────> Красный                                   │
   │     │ │ │ │ └────────> Вторичный синий                           │
   │     │ │ │ └──────────> Вторичный зеленый                         │
   │     │ │ └────────────> Вторичный красный                         │
   │     └─┴──────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит0-Бит5  Определяет цвет рамки (бордюра) на экране монитора.  При-
              менительно к монохромным дисплеям значение данного регис-
              тра следует установить равным 0.
              
         Регистр разрешения отображения битовой плоскости
         ------------------------------------------------
                  
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 12h. Адрес порта вывода
   регистра разрешения отображения битовой плоскости 3C0.
                  
   ┌──────────────────────────────────────────────────────────────────┐
   │     Формат регистра разрешения отображения битовой плоскости     │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ └─┴─┴─┴──> Разрешить отображение битовой плоскости   │
   │     │ │ └─┴──────────> Видео статус                              │
   │     └─┴──────────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘

   Бит0-Бит3  Логическая  1 в одном или нескольких из указанных битов -
              соответствующая битовая плоскость (плоскости)  будет  ис-
              пользована  при  формировании изображения на экране дисп-
              лея.  Логический  0  запрещает  использование   плоскости
              (плоскостей) при выводе изображения на экран.
              
   Бит4-Бит5  Используются для  выбора  доступности  для  чтения  через
              входной  регистр  состояния  1 двух из шести составляющих
              цвета. В  следущей  таблице  приведен  список  допустимых
              комбинаций.

                               - 52 -
                                   
   ┌──────────────────────────┬───────────────────────────────────────┐
   │ Регистр разрешения отоб- │           Входной регистр             │
   │ ражения бит. плоскости   │           состояния 1                 │
   ├──────────────────────────┼───────────────────────────────────────┤
   │  Бит 5           Бит 4   │ Бит 5              Бит 4              │
   ├──────────────────────────┼───────────────────────────────────────┤
   │  0               0       │ красный            синий              │
   │  0               1       │ вторичный зеленый  зеленый            │
   │  1               0       │ вторичный красный  вторичный зеленый  │
   │  1               1       │ не используется    не используется    │
   └──────────────────────────┴───────────────────────────────────────┘
                  
         Регистр горизонтального сдвига пикселов
         ---------------------------------------
                  
       Регистр типа "только запись". Для доступа к этому регистру  зна-
   чение  адресного регистра должно быть равным 13h. Адрес порта вывода
   регистра горизонтального сдвига пикселов 3C0.
            
   ┌──────────────────────────────────────────────────────────────────┐
   │         Формат регистра горизонтального сдвига пикселов          │
   ├──────────────────────────────────────────────────────────────────┤
   │Биты 7 6 5 4 3 2 1 0                                              │
   │     │ │ │ │ └─┴─┴─┴──> Горизонтальный сдвиг                      │
   │     └─┴─┴─┴──────────> Не используются                           │
   └──────────────────────────────────────────────────────────────────┘
                  
   Бит0-Бит3
              Значение в рассматриваемых 4-х битах определяет количест-
              во пикселов на которое необходимо произвести горизонталь-
              ный сдвиг видеоданных влево. Такой сдвиг возможен  как  в
              алфавитно-цифровых, так и в графических режимах. В монох-
              ромном  алфавитно-цифровоим режиме изображение может быть
              сдвинуто не более чем на 9 пикселов.  Во  всех  остальных
              режимах  -  не  более чем на 8 пикселов. Далее приводятся
              последовательности  значений,  используемые  для   сдвига
              изображения на 0,1,2 и т.д. пикселов:
                  
              9 точек/символ: 8,0,1,2,3,4,5,6,7
              (Только для монохромного-алфавитно цифрового режима);
                  
              8 точек/символ: 0,1,2,3,4,5,6,7
              (Для всех остальных режимов).

                               - 53 -
                                   
                  
                          О С О Б Е Н Н О С Т И
                          ---------------------
              П Р О Г Р А М М И Р О В А Н И Я  А Д А П Т Е Р А
              ------------------------------------------------
                  
                  
                      Программирование регистров
                      --------------------------
                  
       Каждая из микроскхем адаптера обладает адресным регистром и нес-
   колькими регистрами данных. Адресный регистр используется в качестве
   указателя  на тот или иной регистр данных. Адресный регистр является
   регистром типа "только запись" в который процессор при помощи коман-
   ды OUT может быть помещен индекс выбранного регистра данных.
       Регистры  данных каждой микросхемы адаптера доступны через соот-
   ветствующий порт ввода/вывода. Доступ к различным  регистрам  данных
   осуществляется  путем  предварительного занесения в адресный регистр
   индекса требуемого регистра данных с последующей выдачей команды OUT
   со стороны процессора для занесения в него необходимого значения.
       Внешние регистры, не являющиеся компонентами микросхем с высокой
   степенью интеграции, а также регистры Графики 1 и 2, доступны непос-
   редственно и не требуют использования каких-либо адресных  регистров
   для обращения к ним.
       В нижеследующих таблицах приведены значения, помещаемые програм-
   мами видеообслуживания базовой системы ввода/вывода в регистры адап-
   тера EGA для всех видеорежимов, описанных в данном документе.
                                                                        
       
   ВНЕШНИЕ РЕГИСТРЫ
  ┌───────────────╥─────────────────────────────────────────────────────┐
  │   Регистр     ║                     Видеорежим                      │
  ├───────┬───┬───╫──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┤
  │       │По │Инд║  │  │  │  │  │  │  │  │  │  │  │  │ +│ +│ *│ *│ *│ *│
  │  Имя  │рт │екс║0 │1 │2 │3 │4 │5 │6 │7 │D │E │F │10│F │10│0 │1 │2 │3 │
  ╞═══════╪═══╪═══╬══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╡
  │Много-й│3C2│ - ║23│23│23│23│23│23│23│A6│23│23│A2│A7│A2│A7│A7│A7│A7│A7│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Спец.вх│3?A│ - ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Сост. 0│3C2│ - ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Сост. 1│3?2│ - ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ╞═══════╧═══╧═══╩══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╡
  │ ? = B  в монохромных режимах;    ? = D  в цветных режимах.          │
  ├─────────────────────────────────────────────────────────────────────┤
  │ * При использовании усовершенствованного монитора IBM               │
  ├─────────────────────────────────────────────────────────────────────┤
  │ + При объеме памяти более 64 Кб                                     │
  └─────────────────────────────────────────────────────────────────────┘

                               - 54 -
                                   
       
   РЕГИСТРЫ БЛОКА СИНХРОНИЗАЦИИ
  ┌───────────────╥─────────────────────────────────────────────────────┐
  │   Регистр     ║                     Видеорежим                      │
  ├───────┬───┬───╫──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┤
  │       │По │Инд║  │  │  │  │  │  │  │  │  │  │  │  │ +│ +│ *│ *│ *│ *│
  │  Имя  │рт │екс║0 │1 │2 │3 │4 │5 │6 │7 │D │E │F │10│F │10│0 │1 │2 │3 │
  ╞═══════╪═══╪═══╬══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╡
  │Адресн.│3C4│ - ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Инициал│3C5│00 ║03│03│03│03│03│03│03│03│03│03│03│03│03│03│03│03│03│03│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Такт.р.│3C5│01 ║0B│0B│01│01│0B│0B│01│00│0B│01│05│05│01│01│0B│0B│01│01│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Маски  │3C5│02 ║03│03│03│03│03│03│01│03│0F│0F│0F│0F│0F│0F│01│01│01│01│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Симв.пл│3C5│03 ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Р.памят│3C5│04 ║03│03│03│03│02│02│06│03│06│06│00│00│06│06│03│03│03│03│
  ╞═══════╧═══╧═══╩══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╡
  │ * При использовании усовершенствованного монитора IBM               │
  ├─────────────────────────────────────────────────────────────────────┤
  │ + При объеме памяти более 64 Кб                                     │
  └─────────────────────────────────────────────────────────────────────┘

                               - 55 -
                                   
       
   РЕГИСТРЫ БЛОКА УПРАВЛЕНИЯ ЭЛТ
  ┌───────────────╥─────────────────────────────────────────────────────┐
  │   Регистр     ║                     Видеорежим                      │
  ├───────┬───┬───╫──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┤
  │       │По │Инд║  │  │  │  │  │  │  │  │  │  │  │  │ +│ +│ *│ *│ *│ *│
  │  Имя  │рт │екс║0 │1 │2 │3 │4 │5 │6 │7 │D │E │F │10│F │10│0 │1 │2 │3 │
  ╞═══════╪═══╪═══╬══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╡
  │Адресн.│3?4│ - ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Дл.стр.│3?5│00 ║37│37│70│70│37│37│70│60│37│70│60│5B│60│5B│2D│2D│5B│5B│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Отобр.с│3?5│01 ║27│27│4F│4F│27│27│4F│4F│27│4F│4F│4F│4F│4F│27│27│4F│4F│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Нач.г.г│3?5│02 ║2D│2D│5C│5C│2D│2D│59│50│2D│50│50│53│50│53│2D│2D│53│53│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Кон.г.г│3?5│03 ║37│37│2F│2F│37│37│2D│3A│37│2D│1A│17│3A│37│2D│2D│37│37│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Н.г.о.х│3?5│04 ║31│31│5F│5F│30│30│5E│51│30│5E│50│50│50│52│28│28│51│51│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │К.г.о.х│3?5│05 ║15│15│07│07│14│14│06│60│14│06│E0│BA│60│00│6D│6D│5B│5B│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Кол.стр│3?5│06 ║04│04│04│04│04│04│04│70│04│04│70│6C│70│6C│6C│6C│6C│6C│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Перепол│3?5│07 ║11│11│11│11│11│11│11│1F│11│11│1F│1F│1F│1F│1F│1F│1F│1F│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Ус.стр.│3?5│08 ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │В.р.сим│3?5│09 ║07│07│07│07│01│01│01│0D│00│00│00│00│00│00│0D│0D│0D│0D│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Нач.кур│3?5│0A ║06│06│06│06│00│00│00│0B│00│00│00│00│00│00│0B│0B│0B│0B│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Кон.кур│3?5│0B ║07│07│07│07│00│00│00│0C│00│00│00│00│00│00│0C│0C│0C│0C│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Ст.адр.│3?5│0C ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Мл.адр.│3?5│0D ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ╞═══════╧═══╧═══╩══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╡
  │ ? = B  в монохромных режимах;    ? = D  в цветных режимах.          │
  ├─────────────────────────────────────────────────────────────────────┤
  │ * При использовании усовершенствованного монитора IBM               │
  ├─────────────────────────────────────────────────────────────────────┤
  │ + При объеме памяти более 64 Кб                                     │
  └─────────────────────────────────────────────────────────────────────┘

                               - 56 -
                                   
       
   РЕГИСТРЫ БЛОКА УПРАВЛЕНИЯ ЭЛТ (продолжение)
  ┌───────────────╥─────────────────────────────────────────────────────┐
  │   Регистр     ║                     Видеорежим                      │
  ├───────┬───┬───╫──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┤
  │       │По │Инд║  │  │  │  │  │  │  │  │  │  │  │  │ +│ +│ *│ *│ *│ *│
  │  Имя  │рт │екс║0 │1 │2 │3 │4 │5 │6 │7 │D │E │F │10│F │10│0 │1 │2 │3 │
  ╞═══════╪═══╪═══╬══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╡
  │Ст.кур.│3?5│0E ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Мл.кур.│3?5│0F ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Н.в.о.х│3?5│10 ║E1│E1│E1│E1│E1│E1│E0│5E│E1│E0│5E│5E│5E│5E│5E│5E│5E│5E│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Ст.пера│3?5│10 ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │К.в.о.х│3?5│11 ║24│24│24│24│24│24│23│2E│24│23│2E│2B│2E│2B│2B│2B│2B│2B│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Мл.пера│3?5│11 ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Дл.отоб│3?5│12 ║C7│C7│C7│C7│C7│C7│C7│5D│C7│C7│5D│5D│5D│5D│5D│5D│5D│5D│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Смещен.│3?5│13 ║14│14│28│28│14│14│28│28│14│28│14│14│28│28│14│14│28│28│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Подчерк│3?5│14 ║08│08│08│08│00│00│00│0D│00│00│0D│0F│0D│0F│0F│0F│0F│0F│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Нач.в.г│3?5│15 ║E0│E0│E0│E0│E0│E0│DF│5E│E0│DF│5E│5F│5E│5F│5E│5E│5E│5E│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Кон.в.г│3?5│16 ║F0│F0│F0│F0│F0│F0│EF│6E│F0│EF│6E│0A│6E│0A│0A│0A│0A│0A│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Режим  │3?5│17 ║A3│A3│A3│A3│A2│A2│C2│A3│E3│E3│8B│8B│E3│E3│A3│A3│A3│A3│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Ср.стр.│3?5│18 ║FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│
  ╞═══════╧═══╧═══╩══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╡
  │ ? = B  в монохромных режимах;    ? = D  в цветных режимах.          │
  ├─────────────────────────────────────────────────────────────────────┤
  │ * При использовании усовершенствованного монитора IBM               │
  ├─────────────────────────────────────────────────────────────────────┤
  │ + При объеме памяти более 64 Кб                                     │
  └─────────────────────────────────────────────────────────────────────┘

                               - 57 -
                                   
       
   РЕГИСТРЫ ГРАФИЧЕСКОГО КОНТРОЛЛЕРА
  ┌───────────────╥─────────────────────────────────────────────────────┐
  │   Регистр     ║                     Видеорежим                      │
  ├───────┬───┬───╫──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┤
  │       │По │Инд║  │  │  │  │  │  │  │  │  │  │  │  │ +│ +│ *│ *│ *│ *│
  │  Имя  │рт │екс║0 │1 │2 │3 │4 │5 │6 │7 │D │E │F │10│F │10│0 │1 │2 │3 │
  ╞═══════╪═══╪═══╬══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╡
  │Граф. 1│3CC│ - ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Граф. 2│3CA│ - ║01│01│01│01│01│01│01│01│01│01│01│01│01│01│01│01│01│01│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Адресн.│3CE│ - ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Цвета  │3CF│00 ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Разр.цв│3CF│01 ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Срав.цв│3CF│02 ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Вращен.│3CF│03 ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Пл.чтен│3CF│04 ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Режим  │3CF│05 ║10│10│10│10│30│30│00│10│00│00│10│10│00│00│10│10│10│10│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Много-й│3CF│06 ║0E│0E│0E│0E│0F│0F│0D│0A│05│05│07│07│05│05│0E│0E│0E│0E│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Незав.ц│3CF│07 ║00│00│00│00│00│00│00│00│0F│0F│0F│0F│0F│0F│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Маска  │3CF│08 ║FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│FF│
  ╞═══════╧═══╧═══╩══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╡
  │ * При использовании усовершенствованного монитора IBM               │
  ├─────────────────────────────────────────────────────────────────────┤
  │ + При объеме памяти более 64 Кб                                     │
  └─────────────────────────────────────────────────────────────────────┘

                               - 58 -
                                   
       
   РЕГИСТРЫ КОНТРОЛЛЕРА АТРИБУТОВ
  ┌───────────────╥─────────────────────────────────────────────────────┐
  │   Регистр     ║                     Видеорежим                      │
  ├───────┬───┬───╫──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┤
  │       │По │Инд║  │  │  │  │  │  │  │  │  │  │  │  │ +│ +│ *│ *│ *│ *│
  │  Имя  │рт │екс║0 │1 │2 │3 │4 │5 │6 │7 │D │E │F │10│F │10│0 │1 │2 │3 │
  ╞═══════╪═══╪═══╬══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╡
  │Адресн.│3C0│ - ║- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │- │
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│00 ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│01 ║01│01│01│01│13│13│17│08│01│01│08│01│08│01│01│01│01│01│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│02 ║02│02│02│02│15│15│17│08│02│02│00│00│00│02│02│02│02│02│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│03 ║03│03│03│03│17│17│17│08│03│03│00│00│00│03│03│03│03│03│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│04 ║04│04│04│04│02│02│17│08│04│04│18│04│18│04│04│04│04│04│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│05 ║05│05│05│05│04│04│17│08│05│05│18│07│18│05│05│05│05│05│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│06 ║06│06│06│06│06│06│17│08│06│06│00│00│00│06│14│14│14│14│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│07 ║07│07│07│07│07│07│17│08│07│07│00│00│00│07│07│07│07│07│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│08 ║10│10│10│10│10│10│17│10│10│10│00│00│00│38│38│38│38│38│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│09 ║11│11│11│11│11│11│17│18│11│11│08│01│08│39│39│39│39│39│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│0A ║12│12│12│12│12│12│17│18│12│12│00│00│00│3A│3A│3A│3A│3A│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│0B ║13│13│13│13│13│13│17│18│13│13│00│00│00│3B│3B│3B│3B│3B│
  ╞═══════╧═══╧═══╩══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╡
  │ * При использовании усовершенствованного монитора IBM               │
  ├─────────────────────────────────────────────────────────────────────┤
  │ + При объеме памяти более 64 Кб                                     │
  └─────────────────────────────────────────────────────────────────────┘

                               - 59 -
                                   
  
   РЕГИСТРЫ КОНТРОЛЛЕРА АТРИБУТОВ (продолжение)
  ┌───────────────╥─────────────────────────────────────────────────────┐
  │   Регистр     ║                     Видеорежим                      │
  ├───────┬───┬───╫──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┤
  │       │По │Инд║  │  │  │  │  │  │  │  │  │  │  │  │ +│ +│ *│ *│ *│ *│
  │  Имя  │рт │екс║0 │1 │2 │3 │4 │5 │6 │7 │D │E │F │10│F │10│0 │1 │2 │3 │
  ╞═══════╪═══╪═══╬══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╪══╡
  │Палитры│3C0│0C ║14│14│14│14│14│14│17│18│14│14│00│04│00│3C│3C│3C│3C│3С│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│0D ║15│15│15│15│15│15│17│18│15│15│18│07│18│3D│3D│3D│3D│3D│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│0E ║16│16│16│16│16│16│17│18│16│16│00│00│00│3E│3E│3E│3E│3E│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Палитры│3C0│0F ║17│17│17│17│17│17│18│17│17│00│00│00│3F│3F│3F│3F│3F│3F│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Режим  │3C0│10 ║08│08│08│08│01│01│01│01│01│01│08│08│08│01│08│08│08│08│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Бордюр │3C0│11 ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Отобр.п│3C0│12 ║0F│0F│0F│0F│03│03│01│0F│0F│0F│05│05│05│0F│0F│0F│0F│0F│
  ├───────┼───┼───╫──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┤
  │Сдвиг  │3C0│13 ║00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│00│
  ╞═══════╧═══╧═══╩══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╧══╡
  │ * При использовании усовершенствованного монитора IBM               │
  ├─────────────────────────────────────────────────────────────────────┤
  │ + При объеме памяти более 64 Кб                                     │
  └─────────────────────────────────────────────────────────────────────┘

                               - 60 -
                                   
                 Загружаемый генератор символов
                 ------------------------------
       
       Видеоадаптер  EGA  обладает  загружаемым  генератором символов с
   максимальным вертикальным размером символа в  32  строки  растра.  В
   состав  базовой системы ввода/вывода адаптера включены два генратора
   символов один из которых автоматически загружается в видеопамять при
   выборе алфавитно-цифрового видеорежима. Регистр выбора набора симво-
   лов может запрограммирован так, что бит 3 байта атрибутов будет  ис-
   пользоваться  для выбора из двух наборов символов (т.е. для переклю-
   чения между двумя генераторами символов). Это дает возможность выбо-
   ра пользователем любой пары наборов символов, размещенных в  битовой
   плоскости 2, вследствие чего допускается использование набора из 512
   символов вместо 256-ти символьного набора. Такая возможность появля-
   ется при размере видеопамяти не менее 128 Кб. Если объем видеопамяти
   составляет 256 Кб в памяти адаптера может быть размещено 4 генерато-
   ра символов.
       Структура памяти для размещения генераторов символов представле-
   на  на  приведенном ниже рисунке. Символьные таблицы располагаются в
   битовой плоскости 2 и должны быть защищены от  изменения  с  помощью
   регистра маски битовой плоскости.
                                    
              +0K   ┌┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┐
                    ├┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┤ Генератор символов 0
              +8K   ├┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┤
                    ├─────────────────────┤
              +16K  ├┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┤
                    ├┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┤ Генератор символов 1
                    ├┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┤
                    ├─────────────────────┤
              +32K  ├┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┤
                    ├┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┤ Генератор символов 2
                    ├┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┤
                    ├─────────────────────┤
              +48K  ├┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┤
                    ├┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┼┤ Генератор символов 3
                    ├┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┤
                    ├─────────────────────┤
              +64K  └─────────────────────┘
       
       Следующий  рисунок описывает формат одного символа (знакоместа).
   Если регистры блока управления ЭЛТ запрограммированы таким  образом,
   что  символ состоит из n строк растра, для каждого символа в генера-
   торе символов необходимо заполнить n байт, задающих начертание  сим-
   вола. В рассматриваемом примере размер символа - 8 строк.

                               - 61 -
                                   
                  
                           Битовый образ
       Адрес         ┌──┬──┬──┬──┬──┬──┬──┬──┐  Данные
       CC * 32 + 0   │  │  │  │██│██│  │  │  │  18h
                     ├──┼──┼──┼──┼──┼──┼──┼──┤
               + 1   │  │  │██│██│██│██│  │  │  3Ch
                     ├──┼──┼──┼──┼──┼──┼──┼──┤
               + 2   │  │██│██│  │  │██│██│  │  66h
                     ├──┼──┼──┼──┼──┼──┼──┼──┤
               + 3   │  │██│██│  │  │██│██│  │  66h
                     ├──┼──┼──┼──┼──┼──┼──┼──┤
               + 4   │  │██│██│██│██│██│██│  │  7Eh
                     ├──┼──┼──┼──┼──┼──┼──┼──┤
               + 5   │  │██│██│  │  │██│██│  │  66h
                     ├──┼──┼──┼──┼──┼──┼──┼──┤
               + 6   │  │██│██│  │  │██│██│  │  66h
                     ├──┼──┼──┼──┼──┼──┼──┼──┤
               + 7   │  │  │  │  │  │  │  │  │  00h
                     └──┴──┴──┴──┴──┴──┴──┴──┘
                            
       Здесь  CC представляет собой код символа. В частности, ASCII код
   символа 'A' равен 41h.
       
       
                 Создание набора из 512 символов
                 -------------------------------
       
       В данном разделе описывается как создается 512-ти символьный на-
   бор для цветного монитора. Заметьте, что  на  печатающем  устройстве
   может быть выведено только 256 символов. В рассматриваемом  примере,
   в  случае,  если  бит 3 байта атрибутов установлен в 0, используется
   шрифт 8 x 14 и шрифт 8 x 8, если бит 3 равен 1. Приведенную програм-
   му  следует рассматривать только ка демонстрационный пример. Началь-
   ный адрес программы - 100h, символьная строка расположена по  адресу
   200h.  Программа  может  функционировать только при том условии, что
   объем установленной видеопамяти не менее 128 Кб.

                               - 62 -
                                   
       
   a100
   mov ax,1102   ; загрузка шрифта 8 x 8 в генератор символов с номе-
   mov bl,02     ; ром 2
   int 10
       
   mov ax,1103   ; выбор 512-ти символьного набора
   mov bl,08     ; если бит 3 байта атрибутов равен 1 - шрифт 8 x 8
   int 10        ; если бит 3 байта атрибутов равен 0 - шрифт 8 x 14
       
   mov ax,1000   ; установить регистр разрешения битовой плоскости рав-
   mov bx,0712   ; ным 7h - запрет использования бита 3 байта атрибутов
   int 10        ; при доступе к регистрам палитры
       
   mov ax,1301
   mov bx,000F   ; вывод символьной строки с битом байта атрибутов = 1
   mov cx,003A   ; cx - длина символьной строки
   mov dx,1600   ; вывод символьной строки в строку 22 экрана
   mov bp,0200   ; указатель на начало строки
   push cs
   pop es
   int 10
       
   mov ax,1301
   mov bx,000F   ; вывод символьной строки с битом байта атрибутов = 0
   mov cx,003A   ; cx - длина символьной строки
   mov dx,1700   ; вывод символьной строки в строку 23 экрана
   mov bp,0200   ; указатель на начало строки
   push cs
   pop es
   int 10
       
   a200 db       "This character string is used to show 512
                 characters"

                               - 63 -
                                   
                 Алфавитно-цифровой режим 80 x 43
                 --------------------------------
                 
       В  примере  показано, как установить алфавитно-цифровой и графи-
   ческий режимы, обеспечивающие отображение на экране  80 x 43  симво-
   лов  применительно к монохромному дисплею. Программы видеообслужива-
   ния позволяют формировать на экране текст с 80-ю символами в  строке
   и  n  строками.  Такие  действия могут быть выполнены одновременно с
   загрузкой шрифта. При этом, для того чтобы программа  печати  экрана
   могла  обрабатывать дополнительные строки, она также должна быть мо-
   дифицирована путем обращения к соответствующей программаме видеообс-
   луживания. Ниже приведены программы на языке ассемблера для  тексто-
   вого и графического режимов.
       
   mov al,7      ; монохромный алфавитно-цифровой режим
   int 10        ; обращение к программам видеообслуживания
   mov ax,1112
   mov bl,0      ; загрузка шрифта 8 x 8
   int 10        ; обращение к программам видеообслуживания
   mov ax,1200
   mov bl,20     ; выбор альтернативной программы печати экрана
   int 10        ; обращение к программам видеообслуживания
   int 3
                       
   mov ax,F      ; монохромный графический режим
   int 10        ; обращение к программам видеообслуживания
   mov ax,1123
   mov bl,0      ; загрузка шрифта 8 x 8
   mov dl,2B     ; 43 символьные строки
   int 10        ; обращение к программам видеообслуживания
   mov ax,1200   ;
   mov bl,20     ; выбор альтернативной программы печати экрана
   int 10        ; обращение к программам видеообслуживания
   int 3
                 
       
              Организация прерывания по вертикальному обратному
              -------------------------------------------------
                               ходу луча
                               ---------
       
       
       Видеоадаптер  EGA может быть запрограммирован таким образом, что
   по началу вертикального обратного хода луча генерируется сигнал пре-
   рывания.  Для  использования  такой возможности разработчиком должна
   быть написана специальная  программа  обработки  такого  прерывания.
   Прерывание по обратному ходу луча формируется на IRQ2. Процессор мо-
   жет  опрашивать бит 7 входного регистра состояния 0 адаптера для оп-
   ределения момента прерывания.
       Регистр окончания обратного хода луча (11h) блока управления ЭЛТ
   содержит два бита, используемые для управления прерыванием. Значения
   остальных битов указанного регистра должны соответствовать значениям
   приведенным в таблицах значений регистров для различных видеорежимов.

                               - 64 -
                                   
   Бит 5    Логический 0 - разрешение прерывания.
   Бит 4    Логический 0 - очистка прерывания.
   
       В  драйвере обработки прерывания должна быть реализована следую-
   щая последовательность действий:
       
   1. Запрет прерывания и подключение драйвера.
   2. Разрешить роерываний.
   3. Ожидание возникновения прерывания по обратному ходу.
   4. Опрос входного регистра состояния 0 для подтверждения  того,  что
      прерывание сгенерировано видеоадаптером.
   5. Если  прерывание  сгенерировано видеоадаптером - запрет  прерыва-
      ния; Переход на другую программу обработки прерывания в противном
      случае.
   6. Разрешение прерываний.
   7. Выполнение действий по изменению состояния адаптера, которве дол-
      жны быть произведены во время обратного хода луча.
   8. Ожидание возникновения прерывания.
               
       
                  Создание разделенного экрана
                  ----------------------------
       
       Адаптер EGA позволяет на аппаратном уровне создавать так называ-
   емый  разделенный  экран  в алфавитно-цифровом режиме. Верхнюю часть
   экрана будем называть экраном A, а нижнюю - экраном B, как это пока-
   зано на рисунке.
       
                  ┌───────────────────────────┐
                  │                           │
                  │          Экран A          │
                  │                           │
                  ├───────────────────────────┤
                  │                           │
                  │          Экран B          │
                  │                           │
                  └───────────────────────────┘
       
   На  нижеследующем рисунке показано отображение экраном  на  видеопа-
   мять размером в 32  Кб.  Заметьте,  чтов  алфавитно-цифровом  режиме
   адаптер имеет видеобуфер размером в 32 Кб. Информация в экране A на-
   ходится по адресу определенному значениями регистров старшей и млад-
   шей составляющих начального адреса (0Ch и 0Dh) блока управления ЭЛТ.
   Данные экрана B всегда расположены в видеобуфере по адресу 0000h.
       
            0000h ┌───────────────────────────┐
                  │      Область данных       │
                  │                           │
            0FFFh │         экрана B          │
                  ├───────────────────────────┤
            1000h │      Область данных       │
                  │                           │
                  │         экрана A          │
            7FFFh └───────────────────────────┘

                               - 65 -
                                  
       Для  организации  работы  с  разделенным  экраном   используется
   регистр  сравнения  строк  (18h)  блока управления ЭЛТ. В этом блоке
   содержится внутренний  счетчик  выведенных  в  текущем  кадре  строк
   растра,   значение  которого  постоянно  сравнивается  со  значением
   регистра сравнения строк. Как полько их значения становятся равными,
   генератор адреса памяти сбрасывается в 0.  После  этого  генератором
   адреса формируются последовательные адреса начиная с нулевого адреса
   до завершения вывода кадра.
       Экран B может плавно перемещаться вверх/вниз по экрану  монитора
   для  чего  необходимо  во  время  обратного  вертикального хода луча
   производить соответствующие изменения значения в регистре  сравнения
   строк. В экране B не может производится аппаратный  скроллинг,  т.к.
   для его организации используются регистры старшей и младшей  состав-
   ляющих начального адреса.
                          
