                                                     Г Л А В А  4
-----------------------------------------------------------------
     
                          A S K  (ЗАПРОС)
     
-----------------------------------------------------------------
     
     Услуга Главного Ask меню является душой системы Paradox. Это
мощное средство используется для задания запросов и манипулирова-
ния информацией в ваших таблицах системы Paradox.
     Вопросы, которые  вы задаете о вашей базе данных, называются
запросами. Вы можете задавать запросы об одной таблице или  объе-
динять две или более таблиц вместе в едином запросе. В запросе вы
можете выбирать:
     
  -  какие таблицы содержат информацию;
     
  -  какие поля вы хотите отобразить;
     
  -  какие записи вы хотите выбрать;
     
  -  какие вычисления вы хотите выполнить.
     
     Вы также можете использовать запросы для выполнения операций
поиска, изменения, добавления или удаления информации. Вы можете:
     
  -  вставить новые записи в таблицу;
     
  -  удалить записи из таблицы;
     
  -  изменить значения в полях;
     
  -  найти записи в таблице.
     
     Кроме того, вы можете использовать запросы  для  определения
множеств  и групп информации внутри ваших таблиц и для выполнения
операций вычислений и сравнений над этими множествами. Вы  можете
использовать  запросы совместно с встроенными средствами создания
таблиц кросстабуляции и графикой, чтобы легко исследовать  откло-
нения  и  образцы  в  ваших данных, которые трудно разглядеть при
простом просмотре таблицы.
     Метод, который  вы используете для задания запросов и выпол-
нения операций запроса, называется запросом по образцу (примеру).
Вместо того, чтобы тратить время, описывая, как  сделать  запрос,
вы  просто  указывате системе Paradox пример результатов, которые
вы хотели бы получить. Paradox берет образец и автоматически  на-
ходит  самый  быстрый путь, чтобы дать ответ или выполнить опера-
цию.
     Запросы гибки,  интерактивны  и итеративны. Если запрос дает
не совсем тот результат, который вы хотите, вы легко можете пере-
настроить (уточнить) запрос и выполнить  его  снова.  Конструируя
запросы,  которые построены один на другом, вы можете проигрывать
с вашими данными ситуации по типу "что, если...?".
     Вы можете также использовать запросы, чтобы организовывать и
обобщать ваши данные для создания более эффективных таблиц кросс-
табуляции  и  графиков.  Для получения более подробной информации
о графиках смотрите главу 8.




   ФОРМЫ ЗАПРОСА
-----------------------------------------------------------------
     
     Вы составляете запрос путем заполнения форм запроса для таб-
лиц, содержащих информацию. После того, как  вы  выбирете  услугу
Ask из Главного меню, Paradox запросит у вас имя таблицы.
                               
     
     
     Отображение форм запроса
-----------------------------------------------------------------
     
     Введите имя  таблицы,  по  которой вы хотите сделать запpос,
или выбирите ее из меню. Вы увидите фоpму  запpоса  для  таблицы,
содеpжащую все поля таблицы, но без данных.
     Повтоpите этот пpоцесс для отображения фоpм запpоса для всех
таблиц,  вовлеченных в ваш запpос. Ваш запpос может ссылаться од-
новpеменно на столько таблиц, сколько может быть pазмещено в  па-
мяти вашего  компьютеpа.  Нет определенного (встpоенного) пpедела
для числа таблиц, котоpые вы можете включить в один запpос.
                   
                             
     
   Использование форм запроса
-----------------------------------------------------------------
     
     Заполнение форм  осуществляется вводом определенных значений
в ее поля. Поля "эластичны": каждое из них может  расширяться  до
255 символов. Зарезервированные слова и операторы, которые вы мо-
жете  использовать, приведены в табл.4-1; все они описываются да-
лее в этой главе.

Таблица 4-1.
-----------------------------------------------------------------
Категория     Оператор              Значение
-----------------------------------------------------------------
Зарезерви-   "галочка" (см.прим.)   отобразить данное поле в
рованные                            таблице answer
слова        "галочка"+             отобразить поле и включить
                                    повторяющиеся значения
             "галочка""тре-         отобразить поле со значения-
              угольник"             ми в убывающем порядке
              calc                  вычислить новое поле
              insert                вставить новые записи с ука-
                                    занными значениями
              delete                удалить выбранную запись из
                                    таблицы
              changeto              изменить значения в выбранных
                                    записях
              find                  найти выбранный записи в таб-
                                    лице
              set                   определить выбранные записи
                                    как набор для сравнений
                                    
Арифмети-     +                     добавление или конкатенация
ческие        -                     вычитание
операторы     *                     умножение
              /                     деление
              ()                    операторы группирования
              
Операторы     =                     равен...(необязателен)
диапазона     >                     больше, чем...
              <                     меньше, чем...
              >=                    больше или равен...
              <=                    меньше или равен...
              
Операторы     ..                    любые символы
шаблона       @                     любой единичный символ
(маски)

Специальные   like                  подобен...
операторы     not                   не совпадает с...
              blank                 нет значения
              today                 сегодняшняя дата
              or                    задает условие "или" в поле
              ,                     задает условие "и" в поле
              as                    задает имя поля в answer
              !                     отображает все записи в поле,
                                    независимо от совпадений
                                    
Операторы     average               среднее значений
обобщения     count                 число значений
              max                   наибольшее значение
              min                   наименьшее значение
              sum                   сумма значений
              all                   вычислить сумму, основанную
                                    на всех значениях в группе,
                                    включая повторяющиеся
              unique                вычислить сумму, основанную
                                    только на уникальных значени-
                                    ях в группе
                                    
Операторы     only                  отобразить записи, которые
сравнения                           совпадают с единичными члена-
наборов                             ми определенного набора
              no                    отобразить записи, которые не
                                    совпадают с членами опреде-
                                    ленного набора
              every                 отобразить записи, которые
                                    совпадают со всеми членами
                                    определенного набора
              exactly               отобразить записи, которые
                                    совпадают со всеми членами
                                    определенного набора, и боль-
                                    ше никакие
                                    
Примечание. О "галочке" и других символах, которые по техническим
            причинам не могут быть воспроизведены в данном  текс-
            те, смотрите в разделе .....                             ????
-----------------------------------------------------------------

     Внесение изменений в форму запроса очень похоже на  редакти-
рование  таблицы  (см. главу 7), но вам не нужно входить в специ-
альный режим редактирования, чтобы делать это. Вы можете  исполь-
зовать  клавишу  {Basckspace} для внесения изменений с конца поля
или нажать {Alt}{F5}  (просмотр  поля)  для  перемещения  курсора
внутрь него.
     Заметим, что  соглашения  по  отображению  данных (например,
отображение разделителей целых частей чисел) не  могут  быть  ис-
пользованы в формах запросов.
     Все формы запросов, находящиеся в рабочем поле, являются ак-
тивными.  Вместе  они  составляют  текущий оператор (предложение)
запроса, который будет выполнен при нажатии {F2} (выполнить).  Вы
можете  использовать услугу Scripts/Query/Save для сохранения те-
кущего оператора запроса в скрипте.
     В результате запроса выбранные вами поля по умолчанию  отоб-
ражаются в последовательности, в которой они появлявляются в таб-
лицах,  представленных  формами запросов. Нажатие {Сtrl}{R} (вра-
щать) для изменения порядка полей в форме запроса, как описано  в
главе 8, не влияет на порядок полей в результате.

  -  Вы можете  сделать  таблицу  answer (ответ) чувствительной к
     порядку столбцов в форме  запроса  путем  запуска  программы
     конфигурации (Paradox Custom Configuration Program) и выбора
     затем услуги  Defaults/Query/ImageOrder.  Если вы установите
     параметр ImageOrder в качестве используемого  по  умолчанию,
     то  поля в таблице answer всегда будут отображяться в том же
     порядке, как они появляются в формах запросов.  После  этого
     вы сможете изменять порядок сортировки таблицы answer, пере-
     мещая столбцы в форме запроса. (....)
     
     Установка ImageOrder  особенно полезна для графиков и таблиц
     кросстабуляции. Однако она может  явиться  причиной  проблем
     совместимости  для таких операций, как Tools/Copy/JustFamily
     и Tools/More/Add. Изменение порядка сортировки запроса может
     также вызвать потенциальную несовместимость для  приложений,
     разработанных в предыдущих версиях системы Paradox. Смотрите
     раздел,  посвященный ССР в главе 14 для получения более под-
     робной информации об этой установке.
                
                
                
    Выполнение запроса
-----------------------------------------------------------------

     После того, как вы заполните формы  запросов,  нажмите  {F2}
(выполнить). Paradox выполнит запрос с теми таблицами, которые вы
определили.
           
           
              
    Таблица answer
-----------------------------------------------------------------

     Результат вашего  запроса обычно отображается в таблице, на-
зываемой answer (ответ). Answer - это временная таблица, как опи-
сано в главе 2 в разделе "Объекты системы Paradox". Она будет пе-
резаписана новой таблицей answer, когда вы в следующий раз выпол-
ните запрос, и уничтожена, когда вы выйдете из  системы  Paradox.
Если  вы  захотите  сохранить эту таблицу, воспользуйтесь услугой
Tools/Rename для ее переименования.
     Вы можете строить один запрос  на  другом  путем  построения
запросов с использованием таблицы answer. от ответа. Новая табли-
ца answer заменит старую.
     За исключением запросов поиска (find) и тех, которые исполь-
зуют  check plus ("галочка"+) (описанные ниже в этой главе), таб-
лица answer сортируется по значениям в полях слева направо.
                            
                                                                         
                                                                         
                            
    СОСТАВЛЕНИЕ ОПЕРАТОРОВ ЗАПРОСА
-----------------------------------------------------------------

     При применении запроса по примеру (образцу) (запросы  именно
этого  типа  используются в системе Paradox) вы составляете форму
запроса, которая выглядит как пример информации, которая вас  ин-
тересует. Процесс составления запроса включает определение полей,
которые  вы  хотите включить в таблицу answer, и задание критерия
для выбора записей.



    Выбор полей
-----------------------------------------------------------------

     Для определения полей, которые должны  появиться  в  таблице
answer, просто пометьте их в форме запроса. То есть перемещайтесь
к  очередному полю и нажимайте клавишу {F6}. После этого в поле в
форме запроса появится маленькая "галочка". Клавиша {F6} является
переключаемым, поэтому если вы измените свой первоначальный замы-
сел и захотите, чтобы отмеченное поле все-таки  не  отображалось,
нажмите {F6} повторно. "Галочка" пропадет.
     Для выбора сразу всех полей таблицы переместите курсор к са-
мому левому полю и нажмите {F6}. "Галочки" появятся во всех полях
формы. Аналогично, вы можете повторно нажать {F6} в крайнем левом
поле для удаления всех "галочек".
     Выбранные поля обычно имеют такие же имена в таблице answer,
как  и в форме запроса. Если вы хотите, чтобы некоторое поле поя-
вилось в answer под другим именем, просто  наберите  в  выбранном
поле оператор as и следом за ним новое имя. Оператор as не  изме-
нит имя поля в первоначальной таблице - только в answer.


     Включение повторяющихся записей
     -------------------------------
     Если вы  хотите  видеть ВСЕ записи, найденные при выполнении
запроса, включая повторяющиеся, нажмите {Alt}{F6}  вместо  просто
{F6}.  Появится  символ  "галочка"+. Если этот символ находится в
любом поле запроса, Paradox включит каждую  запись,  возвращенную
запросом,  в таблицу answer, невзирая на повторения. Когда вы ис-
пользуете символ "галочка"+, записи в таблице answer не  сортиру-
ются.


     Сортировка записей в таблице answer
     -----------------------------------
     Paradox сортирует записи в таблице answer на основе значений
в их полях слева направо. Это означает, что записи сначала сорти-
руются по их значениям в первом поле, затем у совпадающих по пер-
вому полю сравниваются значения во втором поле и т.д.

  -  Это справедливо как для случая, когда поля в answer основаны
     на их порядке в таблицах, так и для случая, когда они  осно-
     ваны  на  их порядке в формах запроса. Если вы выбрали уста-
     новку Detaults/QueryOrder/ImageOrder в программе  конфигура-
     ции,  переупорядочивание  ("вращение") полей в форме запроса
     может изменить их порядок в answer. Так как сортировка запи-
     сей зависит от порядка полей, то это может повлиять на поря-
     док записей.
      
     Paradox обычно  сортирует  записи  по каждому полю в порядке
возрастания, т.е. от меньших к большим числам, от более ранних  к
более поздним датам или в алфавитном порядке от А до Z.
     Однако вы можете также запросить Paradox отсортировать  выб-
ранные  поля в таблице answer по убыванию - от больших к меньшим,
от поздних к ранним, от Z к A. Для этого вместо {F6}  для  выбора
поля  нажмите {Ctrl}{F6}. После символа "галочка" появится символ
"треугольник", означающий, что записи будут отсортированы по это-
му полю в убывающем порядке.
     
     Примечание. В одном запросе можно комбинировать порядки сор-
     тировки (по убыванию и  возрастанию).  Например,  вы  можете
     указать,  чтобы  значения первого поля располагались по воз-
     растанию (скажем, номер товара), а второго (дата продажи)  -
     по убыванию.

     Любая сортировка (в порядке убывания или возрастания) всегда
удаляет повторяющиеся записи. Напомним, что когда вы  используете
{Alt}{F6},  чтобы  оставить  повторяющиеся  записи,  то  записи в
answer не сортируются.



      Выбоp записей
-----------------------------------------------------------------
      
     В большинстве случаев вы интеpесуетесь только теми записями,
котоpые удовлетворяют опpеделенным условиям. То есть вы указывае-
те системе Paradox отобразить только  те  записи,  котоpые  имеют
опpеделенные значения в одном или более полях. Paradox пpедостав-
ляет  вам  большую гибкость в описании того, какие стpоки вас ин-
теpесуют.
     Вы можете  выбpать  записи,  основанные на точном совпадении
значения в поле (заказы, сделанные заказчиком #9004) или диапазо-
не значений (заказы на количество товара больше 5 единиц). Вы мо-
жете использовать специальные (мета-) символы для задания  шабло-
нов  (заказчики,  имя  которых  начинается  на "М" и кончается на
"s").
     Используя опеpатоp like, вы можете пpосмотpеть неточные сов-
падения (заказчики, чье имя похоже на Chen - like Chen). Это  бы-
вает  весьма полезно, когда вы не увеpены в точном написании име-
ни. Кроме того, вы можете использовать оператор like для  опpеде-
ления  сходного написания в таблице, напpи - меp, для удаления из
адpесного списка повторяющихся записей, котоpые немного  pазлича-
ются по имени или адpесу.
     Вы можете  также  делать  выбоp,  основанный на вычислениях.
Пpедположим, вы имеете таблицу служащих, котоpая  показывает  для
каждого  из  них заpплату и менеджеpа. Вы можете отобразить, ска-
жем, записи  для служащих, котоpые получают зарплату меньше поло-
вины того, что получает их шеф.
     В общем,  независимо  от  сложности и назначения запpоса, вы
выбиpаете интеpесующие вас записи  путем  заполнения  фоpмы  (или
форм) запpоса образцом (примером), которому должны отвечать иско-
мые данные.
               
               
      Точные совпадения
      -----------------
     Если вы  интеpесуетесь  записями, котоpые имеют опpеделенные
значения в одном из полей - для заказчика по  имени  Mossey,  или
кого-либо,  кто  купил точно одну единицу товара - пpосто введите
значение в соответствующее поле.
     Рассматpивайте стpоку запpоса как шаблон. Выбиpаются  только
те  записи, котоpые подходят под шаблон. Вы можете вводить записи
во столько полей, во сколько хотите. При  этом  поле,  в  которое
вводится  элемент  шаблона,  не  обязательно должно быть помечено
"галочкой" (т.е. оно не обязательно должно появляться в answer).
     Когда вводите значение, будьте остоpожны, пишите пpавильно и
на нужном регистре. Если вы наберете Мassey, а на самом деле зна-
чение  в  таблице Massy или MASSEY, то Paradox не выбеpет эту за-
пись. (Вы можете использовать шаблон или оператор like, описанные
ниже в этом pазделе, если вы не увеpены в написании или в размере
букв.)
     Если значение содержит знаки пунктуации,  заключайте  его  в
двойные  кавычки, например, "Barnum & Bailey" или "Smith, Harry".
Более подробно об этом смотрите в разделе "Использование  двойных
кавычек" позже в данной главе.


                     Использование диапазона
                     -----------------------
     Иногда вам  необходим  выбоp записей по некотоpому диапазону
значений. Напpимеp, вы можете захотеть отобpазить товары, котоpые
стоит более чем 1000$, или заказы, поступившие между 1  янваpя  и
30 июня 1987г.
     Вы можете  опpеделить диапазон в фоpме запpоса, задавая зна-
чения с помощью одного из следующих опеpатоpов диапазона.
                                                                                                                                                                                                                                                               
               Опеpатоp        Значение
               ------------------------------------
                   =           pавно (необязателен)
                   >           больше, чем
                   <           меньше, чем
                   >=          больше или pавно
                   <=          меньше или pавно
                                                                                                                                                                                                                                                               
     Опеpатоpы диапазона могут использоваться с любым  типом  по-
лей: алфавитно-цифровым, числовым или даты. Напpимеp, если вы хо-
тите  найти  имена всех заказчиков, чья фамилия начинается с букв
пеpвой половины алфавита, вы должны ввести  <N  в  поле  имени  в
фоpме  запpоса для таблицы, содержащей сведения о заказчиках. Для
отобpажения всех заказов поступивших с 1 июня  1987г.  вы  должны
напечатать >=6/1/87 в поле даты фоpмы запpоса для таблицы, содер-
жащей сведения о заказах.


    Шаблоны
    -------
     Иногда вам  нужны записи, котоpые имеют символьные значения,
отвечающие тому или иному шаблону. Напpимеp, вы можете не помнить
имя заказчика - Brown или Braun, или вы знаете, что описание  то-
вара содеpжит слово clock, но вы не знаете где точно. Для задания
шаблона  вы  можете использовать один из двух опеpатоpов шаблона:
.. и @.
      
      
    * Цепочки символов
    
     Опеpатоp шаблона .. употpебляется для обозначения последова-
тельности из любого количества символов, включая отсутствие  сим-
волов или пpобелы. Напpимеp, если вы хотите посмотpеть инфоpмацию
о  заказчиках,  чьи имена начинаются с W и заканчиваются на r, то
вы должны использовать шаблон W..r. Это указывает системе Paradox
на то, что вы хотите просмотреть те имена, которые  начинаются  с
W,  заканчиваются на r, и которые имеют между ними любую последо-
вательность символов, например, Weidner  или  Walter.  Имя  может
также включать пробелы (например, Wilson Ir).
     Когда вы  используете  шаблон,  не  имеет  значения вид букв
(заглавные или прописные). Вы  можете  набрать  w..r,  W..R,  или
w..R, и Paradox выдаст одинаковые результаты.
     Позволяется любая  комбинация из символов и точек. Например,
шаблон ..s..n.., введенный в поле фамилии таблицы  customer  (за-
казчик),  даст  такие  имена, как Smith-Iones, Simpson, Suenvald,
Samuelson, Witherspoon, Sampson, и Hawes-Anderson.
     Как видите, из-за  того,  что  перед  s  есть  оператор  ..,
Paradox  находит  любое  имя, содержащее s перед n, независимо от
того, начинается это имя с s или s возникает где-то посередине.
     Вы можете использовать оператор ... с любым типом поля, поэ-
тому вы можете искать шаблоны для чисел и дат точно так же, как и
для алфавитно-цифровых значений. Напpимеp, в зависимости от уста-
новленного для экрана фоpмата даты, вы можете найти  все  даты  в
июне  1988г.  путем ввода 6/../88, .. Jun 88, или .."."06.88. Для
получения более подробной информации смотрите раздел "Даты и чис-
ла" ниже.
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
   * Единичные символы
      
     Опеpатоp @ заменяет любой единичный символ.
     
   
   * Двойные кавычки
                                                                                                                                                                                                                                                               
     Для включения  знаков  пунктуации и дpугих заpезеpвиpованных
символов (например, "*") в шаблон, заключайте их в двойные кавыч-
ки. Напpимеp, для нахождения денежного значения $5 (и любого  ко-
личества центов), введите S"."... Пеpвая точка (в кавычках) явля-
ется десятичным разделителем, а последние две являются оператором
шаблона. Более подpобно об этом смотрите в разделе "Использование
кавычек" ниже.
Отметим, что
                                                                                                                                                                                                                                                               
     Даты.
     -----
     Для получения значений дат по точному шаблону Вы можете использо-
 вать любую из тpех экpанных фоpматов пpедставления даты -mm/dd/yy,
 dd=Mon-yy, или dd.mm.yy- в фоpме запpоса. Однако, когда Вы используе-
 те шаблон с датой, шаблон должен отобpажать текущий экpанный фоpмат
 дат (См. главу 2 для инфоpмации о тpех возможных экpанных фоpматов
 дат).	   Если текущий фоpмат дат - dd-Mon-yy, ввод шаблона 3.. pабо-
 тать не будет. Обpатите внимание, что Вы должны стpоить шаблон сог -
 ласно текущему фоpмату даты, хотя Вы можете использовать Image/Format
 для изменения фоpмата даты, отобpажаемой в обpазе таблицы.
                                                                                                                                                                                                                                                               
     Числа.
     ------
     Когда Вы вводите числа в фоpму запpоса, не используйте отделение
 целых частей. Это пpименяется, когда Вы пpедставляете числа по между-
 наpодному или национальному соглашению CША.
 То есть, для пpосмотpа заказов на более чем миллион единиц, Вы должны
 всегда использовать pазделитель, такой как "." в фоpмате США.
    Для включения десятичного pазделителя как части шаблона, Вы можете
 выделить pазделитель кавычками. Напpимеp, для поиска всех Заказчиков,
 котоpые заказали некотоpое количество, котоpое включает около четыpех
 десятков единиц, используйте запpос.
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
    Неточные совпадения: опеpатоp  like.
    ------------------------------------
    Уникальной особенностью Paradox-а является опеpатоp like, котоpый
 позволяет Вам получать инфоpмацию, даже когда Вы не знаете точно, что
 Вы ищете. Опеpатоp like высвечивает записи, котоpые похожи, но не выг-
 лядят точно также как вводимое значение.
    Like специально пpименим для обнаpужения несовпадения написанного в
 таблицах. Напpимеp, сотpудница Вашего отдела использет Paradox для pу-
 ководства подписчиками жуpнала. Один конкpетный запpос высвечивает все
 жуpналы, за исключением одного - Readers Digest.
    После часов, потpаченных на выявление нестыковки она догадывается,
 что входом в таблицу является Readers Digest. Из-за пpопуска апостpофа
 запpос не находит по точному совпадению и поэтому не высвечивает за-
 пись.
    Условие like Readers Digest, с дpугой стоpоны, найдет эту запись.
 Моpаль: если запpос не дает ожидаемого pезультата, попытайтесь исполь-
 зовать like, чтобы посмотpеть, не  заключается ли пpоблема в  пpостом
 несовпадении написания.
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
   Отpицание обpазца:опеpатоp Not.
   -------------------------------
   Если Вас интеpесуют записи не отвечающие некотоpым условиям, ис -
      пользуйте кpитеpий выбоpа с опеpатоpом Not (НЕ).  Вы можете использо-
      вать опеpатоp Not для точного выбоpа диапазонов, обpазцов, подобного
      или любого дpугого вида кpитеpия выбоpа.
   Пpимеp 4-11 показывает заказы в котоpых запас (Stock#)  не  pавен
      519. Тепеpь пpедположим, что Вы хотите посмотpеть всех клиентов, кото-
      pые не заказывали данный пpодукт. Вы можете модифициpовать запpос пpо-
      стой пpовеpкой поля Cust ID. Но это не даст Вам пpавильный ответ, так
      как опеpатоp Not не пpовеpяет индивидуально каждую запись. Итак, кли-
      ент котоpый заказал как #519 так и #556 будет ошибочно включен в ответ
      (т.к. #558 действительно НЕ #519).
   Существует способ получения ответа на подобные запpосы пpи котоpых
      пpосматривается за один раз несколько записей: используйте оператор Nо
      (нет) вместо Not. Оператор No и остальное множество операторов сравне-
      ния Paradox-а описаны в " Работа с множеством записей" ниже  в   этой
      главе.
                                                                                                                                                                                                                                                               
  4-10. Неточный выбор.
  ---------------------
  Предположим, что Вы хотите получить информацию о клиентах которые
     живут в столице Саудовской Аравии. Вы знаете ее произношение "Ree-ahd",
     но не помните как оно пишется. Критерий выбора like поможет найти соот-
     ветствующие записи.
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
     Условие Like riad найдет запись с городом который Вы хотите, Riyadh.
     Заметьте, что Вы не можете использовать образец R..d чтобы найти Riy-
     adh, поскольку d	не является последней буквой.(Между прочим, Riyadh,
     Riyad и Riad альтернативные написания названия этого города. Если Вы
     не уверены, что все записи в таблице используют одинаковое написание,
     то неплохо использовать Like в запросах связанных с этим городом).
  Когда Вы используете Like, вариант (строчные	или прописные) букв
     которые Вы вводите не имеет значение. Однако, Вы должны выбирать пер-
     вую букву точно.Другими словами Like Triad не выберет Riyadh).
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
  4-11. Выбор записей, которые не сравнимы с величиной.
  -----------------------------------------------------
  Предположим, что Вы хотите узнать о заказах на все прродукты, кро-
     ме домашних роботов (заказ #519)(Stock #519).
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
  4-12. Выбор записей, которые не сравнимы с образцом.
  ----------------------------------------------------
  Пусть Вам нужна информация о заказах сделанных в любом месяце, кро-
     ме декабря. Поскольку Вым интересны преимущественно большие заказы,
     внутри каждого продукта записи сортируются в убывающем порядке по коли-
     честву (Quant).
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
  Пустое значение: пустой оператор.
  --------------------------------
  Вы можете иногда захотеть найти записи без значений в одном или
     нескольких полях. Возможно пустое значение означает, что поле непри-
     метно (например, пустой штат для неамериканских клиентов, или пустые
     комиссионные для непроданных	говоров). Или, возможно, Вы не мог-
     ли заполнить значение в некоторых записях когда вводили их, а теперь
     готовы сделать это.
  Вы можете отобразить эти записи в таблице которая содержит пустые
      значения в отдельных полях напечатав слово BLANK	в поле в форме зап-
      роса. Результирующая таблица с ответом будет содержать только записи
      с пустыми значениями в этом поле.

  4-14. Выбор записей с пустыми значениями.
  -----------------------------------------
  В таблице Customer (клиент), записи  для американских клиентов все
      имеют пустое значение в поле Country (страна). Предположим, Вы хотите
      отобразить эти записи, отсортировав их по штатам. Для сортировки таким
      образом, преобразуйте таблицу так, чтобы поле Country (страна) и Stats
      (штат) предшествовали длругим выбираемым полям.





 Рис.




   Для преобразования формы запроса Customer для данного запроса, пе-
       реместите  курсор на  State  и нажмите Rotate (Ctrl F1). Затем переме-
       стить его на Cust ID и нажмите Rotate (Ctrl H) дважды.
   Примечание: Чтобы получить таблицу Answer (ответ) чувствительную к
       преобразованию формы запроса Вы должны выбрать Defaulte/Query Order/
       Image Order в программе конфигурации Custom. См. часть 14 ( Дополни-
       тельный раздел) для детализации и пояснений.
       Так как все записи в таблице Answer имеют одинаковые значения (пустые)
       в первом поле, Conntry (страна), они сортируются по второму полю,Sta-
       te (Штат). Внутри каждого штата, записи отсортированы по третьему по-
       лю (Сust ID).


   Сегодняшняя дата: оператор Today.
   --------------------------------
   В полях типа дата, оператор Today определяет сегодняшнюю дату.
       Для того, чтобы оператор Today работал правильно необходимо, чтобы
       календарь Вашего компьютера был верно установлен. Оператор Today осо-
       бенно полезен для определения подлежащих уплате и получению в сочета-
       нии с Paradox -ким арифметическим оператором.(См. следующий раздел
       "Арифметические выражения").

   Арифметические выражения.
   -------------------------
   В плановых полях и полях типа дата Вы можете использовать ариф-
       метические выражения в формах запросов. Для этого Вы можете констру-
       ировать выражения с арифметическим оператором приведенным ниже:

   _____________________________________________________
  :    Оператор    :	   Значение			:
  : ----------------------------------------------------:
  :	  +	   :	   сложение			:
  :	  -	   :	   вычитание			:
  :	  *	   :	   умножение			:
  :	  /	   :	   деление			:
  :	  ( )	   :	   группирование выражений	:
   -----------------------------------------------------

   Арифметические операторы особенно полезны совместно с оператором
      Today, а также с элементами образцов, которые обсуждаются в "Запросы
      из более чем одной таблиц" ниже в этой части.
   Вы можете использовать запрос аналогично запросу в этом примере с
      таблицами подлежащих уплате и получению для нахождения счетов, кото-
      рые просрочены более, чем на 30 дней.
                                                                                                                                                                                                                                                               
   Арифметические операции  с датой.
   ---------------------------------
   Даты могут использоваться в арифметических выражениях.
   Вы можете:
   - добавить число (дней) к дате;
   - вынести число (дней) из даты;
   - вынести дату из даты (результат  - число дней).
                                                                                                                                                                                                                                                               
   Коннатенация значений.
   ----------------------
   В дополнение к его арифметическим функциям оператор + может быть
      использован для комбинации (коннатенации)
      алфавитно-цифровых значений. См. пример 4-39 далее в этой части.
                                                                                                                                                                                                                                                               
   4-15. Выбор записей по сегодняшней дате.
   ----------------------------------------
   Предположим, сегодня 24 июня 1988г. и Вы хотите отобразить все
      заказы сделанные до сего дня.
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
		 Рис.
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
   4-16. Выбор записей, используя арифметические выражения.
   --------------------------------------------------------
   Допустим, сегодня 24 июня 1988г. и Вы хотите отобразить все зака-
      зы сделанные более чем 90 дней тому назад.
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
		    Рис.
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               


	 Использование кавычек.
	 ----------------------
	 Если Вы хотите ввести алфавитно-цифровое значение содержащее зна-
     ки пунктуации или зарезервированные слова, набирайте их в двойных ка-
     вычках ("). Paradox  распознает символы кавычек как значения и не при-
     дает им их специального значения.
	 Аналогично, предположим, Вы хотите отобразить информацию о клиен-
     тах у которых вместо фамилии стоит пробел.
	 Если Вы просто напечатаете пробел в форме запроса,то Paradox ото-
     бразит эти записи со значением "пробел" (тогда как это отсутствие зна-
     чения) в поле Last Name (фамилия). Вместо этого, напечатайте "Blank"
     и Paradox	отобразит информацию которая Вам нужна.
	 Кавычки не нужны для ограничения пробелов внутри значений. Однако,
     они необходимы для ограничения всех других символов, которые имеют спе-
     циальное значение в Paradox-e включая точки, периоды, звездочки и т.д.
	 Если значение само имеет двойные кавычки, экранируйте двойные ка-
     вычки наклонной чертой (\), как в следующем примере:
	  "Margaret\"Hot lips\"Houlihan".
	 Аналогично, если значение содержит наклонную черту (\), экранируй-
     те ее другой наклонной чертой.
	 Два условия в одном поле.
	 ------------------------
	 Если Вы хотите ввести более чем одно условие выбора в поле, и тре-
     буете, чтобы они все выполнялись, разделяйте их запятыми, как показано
     в примере 4-18.

	 4-17. Использование двойных кавычек.
	 -----------------------------------
	 Предположим Вам необходима информация о клиенте по имени R.Elspeth,
     111. Если Вы просто введете Elspeth,111  в поле Last Name формы запроса
     Customer, Paradox использует Elspeth и 111  как два отдельных значения
     для совпадения, и ни одна запись не будет найдена. Вы можете использо-
     вать двойные кавычки для отображения необходимой Вам записи.



			      Рис.





	 4-18. Два условия в одном поле.
	 -------------------------------
	 Предположим, Вы хотите знать, какой клиент заказал более чем один
     robot-valet между 31 мая и 31 октября 1988г.


			      Рис.



	 Использование в запросах логического ИЛИ.
	 -----------------------------------------
	 Вы уже знаете ( см.пример 4-6 и др.) как вводить более чем одно
     условие запроса без поиска записей. Когда Вы вводите более одного кри-
     терия выбора в одной строке формы запроса, то выбираемые записи должны
     отвечать всем критериям. Формально, этот тип требования называется ло-
     гическим "и", так как записи должны  удовлетворять первому и второму
     критериям одновременно ( и другим критериям, если их больше).
	 Но иногда Вы хотите выбрать записи, которые удовлетворяют либо пер-
     вому критерию, либо второму( либо обоим). Например, Вам необходима ин-
     формация о покупателях, которые живут  в Калифорнии или в Нью-Йорке.Или
     возможно Вам нужно знать какие клиенты заказали robot-valet иди носовые
     платки (или и то и другое).Этот вид условий иногда называют логическое
     ИЛИ.
	 Если необходимо получить записи в запросе удовлетворяющие какому-
     нибудь одному ( или более) из нескольких условий в одном поле запроса,
     то Вы можете использовать оператор Paradox-а ИЛИ (OR). Просто напеча -
     тайте все условия для поля на одной строке формы запроса, а каждое ус-
     ловие  разделяйте оператором OR (ИЛИ), как показано в примере 4-19.
     Paradox отобразит все записи удовлетворяющие любому условию для данно-
     го поля.
	 Могут быть условия ИЛИ, которые не помещаются в одной строке. Если
     условия относятся к различным полям, или существует несколько множест
     условий, то Вы можете ввести их на отдельных строках, как показано в
     примере 4-20. Когда запрос содержит несколько строк условий, Paradox
     отобразит все записи удовлетворяющие любой строке. Вы можете также ис-
     пользовать оператор OR(ИЛИ) для обьединения условий внутри каждого по-
     ля.
	 Вы можете ввести до 22 строк на одну форму запроса. Вообще все ст-
     роки должны иметь соответствующие поля проверяемые при исполнении зап-
     роса.
	 Обычно, когда Вы используете оператор OR (ИЛИ) или устанавливаете
     условия в отдельных строках, дубликаты записей  удаляются из таблицы
     ответа (Answer).
	 Вы можете использовать оператор OR (ИЛИ) с альтернативными услови-
     ями в более чем одном поле на соответствующей строке. Пусть Вам необ -
     ходимо просмотреть всех клиектов которые живут в Нью-Йорке, Калифорнии
     или Флориде и которые имеют ограничения кредита более чем $1.000 000
     или менее чем $500 000. Вы можете использовать оператор OR в обоих по-
     лях State (штат) и Credit (кредит), и ввести запрос на одной строке.
	 Вы можете использовать оператор OR для точного выбора, диапазонов,
     образцов, подобных или любых других видов критерия выбора, но нельзя
     его использовать с элементами образцов используемых для связывания таб-
     лиц.
	 Вы можете смешивать операторы OR и AND  в одном запросе как показа-
     но в примере 4-21.

	 4-19. Условие "ИЛИ" в одном поле.
	 ---------------------------------
	 Предположим Вам необходимо узнать какие клиенты заказали либо ro-
     bot-valet (Stock# 519), либо норковый воротник (Stock# 244), либо оба.



			    Рис.


	  Заметим, что клиент #9004, который удовлетворяет обоим условиям
      дважды включен в ответ.

	  4-20. Условие "ИЛИ" в разных полях и разных  строках.
	  -----------------------------------------------------
	  Предположим нам необходимо получить информацию о клиентах, кото-
	  рые:
	  - живут в Калифорнии, Нью-Йорке или Флориде;
	  - имеют ограничения кредита более чем $ 1000 000.



			     Рис.


	  Различные условия для различных полей могут быть введены на раз-
      личных строках. В этом запросе соответствующие поля могут проверяться
      в  каждой строке.

	  4-21. Условие "И" и "ИЛИ" в одном запросе.
	  ------------------------------------------
	  Предположим нам необходимо узнать кто из клиентов:
	  - живет в Калифорнии и имеет ограничения кредита более $ 1000 000;
	  - живет в Нью-Йорке или во Флориде и имеет ограничения кредита
	    более $ 500 000.


			     Рис.



	  Поскольку условия кредита являются одинаковыми  для Нью-Йорка и
      Флориды, Вы можете комбинировать условия для двух штатов на одной сто-
      роке используя оператор OR (ИЛИ). Поскольку условия кредита (Credit)
      для Калифорнии отличаются, оно должно быть введено в отдельной строке.






	  ЧАСТЬ 4.
	  ---------
	  Запросы более, чем из одной таблицы.
	  ------------------------------------
	  Запрос из нескольких таблиц аналогичен запросу из одной таблицы
      за исключением:
	  - Вы запрашиваете данные из каждой таблицы;
	  - Вы должны использовать элементы образцов без сообщения Paradox-у
	    какая информация в таблицах должна быть взаимосвязана.

	  Элементы примеров.
	  -----------------
	  Таблицы в множественном запросе связываются общими полями, которые
      должны содержать аналогичные виды информации. Например, образец таблиц
      заказы (Orders) и клиенты (Сustomer)имеет общие поля содержащие номер
      клиента  (названный Cust ID  в  обоих таблицах). Поля не должны  иметь
      идентичные имена, но типы этих полей должны быть совместимы. Для ука-
      зания общих полей в Paradox-е, вводятся элементы образцов в эти поля в
      формах запросов.
	  Элементы образцов являются расширением общего Парадоксовского под-
      хода запросов по образцу. Кроме соединения таблиц, элементы образцов
      позволяют Вам обьединить значения вместе в одной таблице,выполнить вы-
      числения над значениями, вставить новую запись основанную на старых и
      выдавать множество интересующих Вас  запросов о Ваших данных.
		      F5  Пример (Example)
	  В форме запроса, элементы образйа выглядят точно также, как значе-
      ние введенное как критерий выбора, но оно выделено или появляется в
      контрастирующем цвете. Для того, чтобы ввести элементы образца, нажми-
      те Example (F5) и наберите значение. Выделение появится во время набо-
      ра.

	  4-22. Связывание таблиц.
	  -----------------------
	  Предположим Вы хотите получить описание товаров закупленгных каж-
      дым клиентом после 1 июня 1982г. Таблица orders cодержит информацию о
      покупках каждого клиента, но информация о покупках ограничена только
      полем Stock #. Таблица products содержит описание каждого товара, но
      не содержит информацию о заказах. Для того, чтобы ответить на вопрос,
      Вам необходимо скомбинировать информацию из обоих таблиц.


			    Рис.







	  Поскольку поле Stock # (Запас) является общим полем через которое
      обе таблицы обьединяются, оно содержит элемент образца. По существу,
      Paradox выбирает запись из таблицы "Заказы"(Orders) и проверяет дан-
      ные на предмет включения в запрос. Затем он просматривает поле с эле-
      ментами образца (Stock#), то проверяет был ли товар заказан. Далее он
      идет в таблицу Products (продукты) просматривает поля с аналогичнымми
      элементами образца (Stock#) и находит запись с аналогичным значением.
      В конце концов он получает описание из таблицы "Продукты"(Products)
      и обьединяет две записи вместе в таблице "Ответ"(Answer). Элемент об-
      разца здесь - xyz - может быть просто 12 или b000.
	  В "Ответе" (Answer), проверяемые поля из каждой таблицы отобража-
      ются в порядке в котором их формы запросов появились на рабочем прост-
      ранстве. Каждое поле таблиц появляется по умолчанию в порядке в кото-
      ром они появились в таблице. Однако, Вы можете сделать порядок полей
      чувствительным к следованию полей в формах запросов выбором Defanlte/
      Query Order/Imase Order  в программе Custom Configuration. См. часть
      14 для более подробной информации.
	  Элементы " примера":
	  -------------------
	  - должны состоять из букв алфавита (А-Z, больших  или матеньких)
	    или цифр (0-9). Другие символы не могут быть использованы;
	  - не должны содержать пробелы.
	  Внутри этих ограничений, сами значения могут быть любыми  на ваш
      вкус - Mary  или 999, или xyz, или data - но необходимо использование
      одинаковых элементов "примера" в соединяемых полях.
	  Элемент примера устанавливается для конкретного значения выбирае-
      мого из таблицы. С целью соединения таблиц вместе, элемент "примера"
      есть "place markers" (маркер поля), который означает: если запись выб-
      ранная из таблицы имеет значение в определенном поле, она должна быть
      связана со всеми записями из другой таблицы, которые имеют такое же
      значение в соответствующем поле.
	   Вы можете использовать "пример" для связывания сколько угодно
      таблиц, число которых ограничивается только размером памяти Вашего
      компьютера.

	   4-23. Связывание дополнительных таблиц.
	   ---------------------------------------
	   Предположим, вместо номера идентификатора клиента (Customer ID)
       в примере 4-22, Вы хотите получить список имен клиентов. Поскольку
       эта информация не содержится ни в таблице Orders (заказы), ни в Pro-
       ducts (продукты), Вы должны добавить в запрос таблицу Customer (кли-
       ент).




			    Рис.


	   Пример показывает как использовать несколько множеств элементов
       образцов в одном запросе: xyz - вязывает поля Stock #  в таблицах
       Orders (заказы) и Produkts (продукты) как и раньше, тогда как 999
       связывает поля Cust ID в таблицах Orders и Customer.
	   Заметьте, что Вы не можете контролировать (отображать) поля ко-
       торые содержат элементы образцов (подобно Cust ID) если Вы не включи-
       ли их в таблицу Answer (ответ).

	   4-24. Связывание еще больше числа таблиц.
	   -----------------------------------------
	   Предположим, что в дополнение к информации в примере 4-23, Вы хо-
       тите также получить список имен поставщиков (Salesperson) которые взя-
       ли заказ. Эта информация содержится в таблице Employee, которая долж-
       на быть связана с таблицей Orders  через поле Emp #.



			     Рис.





	   Элемент образца Salesrep  присоединяет поле Emp # в таблице Orders
       с полем ID# в таблице Employee. Как показывает этот пример связываемые
       поля не имеют и не должны иметь одинаковые имена.
	   Отметим, что Paradox просто различает два поля Last	Name,  одно
       для таблицы Customer  и другое для таблицы Employee. Вы можете ис-
       пользовать оператор AS для присвоения (уникального) имени  каждому
       полю, как показано в примере 4-25.

	   Использование элементов "пример" с условиями выбора.
	   ----------------------------------------------------
	   Когда Вы используете "пример" для связывания таблиц, Вы можете до-
       бавить столько сколько хотите критериев выбора. Вы можете расположить
       условия в любой форме запроса, в то же время эта форма может быть свя-
       зана "примером" с остальными операторами запроса.
	   Как иллюстрирует пример 4-25, установка множественных критериев в
       форме запроса с нескольктми таблицами подобна работе с одной таблицей.
	   Запрос "или-или" к многим таблицам также подобен запросу к одной
       таблице. Вы можете использовать оператор OR, когда Вы хотите устано-
       вить альтернативные условия в одном поле, как показано в примере 4-26.
       "ИЛИ" в различных полях или более чем одно множество условий OR долж-
       ны вводиться на раздельных строках (Пример 4-27).
	   При вводе элементов "пример" убедитесь, что Вы связываете точные
       правильные) строки. Оператор "ИЛИ" (OR)  не может быть использован с
       "примером".

	   4-25. "И" условие в связанных таблицах.
	   ---------------------------------------
	   Предположим Вы хотите получить список имен покупателей, описание
       продуктов ии цены (представленные) для всех заказов поступивших:
	   - c июня 1, 1988г.;
	   - от покупателей с Западного побережья ( ip code>=90 000);
	   - количеством менее чем 5 единиц;
	   - которые стоят менее чем 300 000$.



			    Рис.


	   Форма запроса Emplyee  содержит оператор AS для того чтобы отли-
       чить имя поля этой таблицы Last Name  от поля Last Name	таблицы
       Customer. В противном случае второе появление будет помечено "Last
       Name-1" для того, чтобы избежать дублирования имен в таблице,см.при-
       мер 4-24.

