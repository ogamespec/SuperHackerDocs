                                                         ГЛАВА 10
-----------------------------------------------------------------
     
                     РЕДАКТОР СКРИПТОВ PAL 
     
-----------------------------------------------------------------
     
     Редактор скриптов системы Paradox используется для создания, 
соединения и редактирования скриптов. Так как скрипты PAL являют- 
ся  текстовыми файлами, их можно создавать с помощью любого текс- 
тового редактора. Однако редактор скриптов PAL работает совместно 
с отладчиком PAL, описанным в главе 11, составляя вместе интегри- 
рованную среду для создания, отладки и изменения программ на язы- 
ке PAL. 
     В этой главе описано:
     
  -  как входить и выходить в редактор скриптов;
     
  -  как работать с редактором скриптов;
     
  -  как редактировать запросы;
     
  -  как использовать другие редакторы для редактирования скрип-
     тов.
                
     
     
                        ЗАПУСК РЕДАКТОРА 
-----------------------------------------------------------------
     
     Существуют два способа запуска редактора скриптов:
     
  -  из системы Paradox, используя режим Scripts/Editor;
     
  -  из отладчика PAL, используя режим Edit  (или  нажав  клавишу
     {Ctrl}{E});
   
     Работая  в  системе Paradox, выбирите режим Script/Editor из
главного меню:
     
     Play BeginRecord  QuerySave  RepeatPlay  ShowPlay  Editor
                                                        ------
     Use the Script Editor to write or edit a script.
     
     Появится меню из двух режимов:
     
     Write  Edit
     -----
     Write a new Script, using a Script Editor.
     
     Режим Write предназначен для создания новых скриптов, а  ре-
жим  Edit  -  для изменения существующих скриптов. В любом случае
система Paradox спросит у вас имя редактируемого файла. Из отлад-
чика PAL вход в режим редактирования осуществляется выбором опции
Edit или нажатием клавиш {Ctrl}{E}. Меню редактора имеет вид:
     
     Value  Step  Next  Go  MiniScript  Where?  Quit  Pop  Editor
                                                           ------
     Stop script play and edit current script.
     
     После выбора режима редактирования отладка завершается и от-
лаживаемый  скрипт  загружается в редактор скриптов. Курсор нахо-
дится в начале командной строки.
     
     
     
                       РАБОТА С РЕДАКТОРОМ
-----------------------------------------------------------------
     
     Редактор скриптов является экранным тестовым редактором. Ра-
бота с ним почти аналогична работе с генератором отчетов системы
Paradox. Основное отличие состоит в том, что в генераторе отчетов
строки могут быть неограниченной длины, а  в  редакторе  скриптов
они  ограничены  максимальным  размером выражения PAL, равным 132
символам. Скрипты, созданные с помощью редактора, могут иметь не-
ограниченное число строк. 
     
     
                              Экран
-----------------------------------------------------------------
     
     В  примере на рис. 10-1 приведен внешний вид скрипта  в окне
экранного  редактора.  На  экране  редактора  появляется  участок
скрипта, находящийся в окне, состоящем из 21 строки и 80 позиций.
С помощью редактора можно:
     
  -  перемещать курсор по экрану и двигаться по тексту;
     
  -  редактировать текст с помощью специальных функций;
     
  -  вводить и редактировать строки скрипта;
     
  -  с помощью клавиши {F10} высвечивать меню редактора, содержа-
     щее дополнительные режимы.
     
     
     Changing script c:\Paradox2\people         Script Ins
     
       ....+...10....+...20....+...30....+...40....+...50....+...
     14 WHILE (TRUE)
     15    @0,0
     16    SHOWMENU
     17       "Add" 
     18       "Change"
     19       "Delete"
     20       "Show"
     21       "Return"
     22    TO choice
     23 IF choice="ESC" THEN
     24    QuitLoop
     25 TNDIF
     26 CLEAR
     
     
               Рис. 10-1. Работа с редактором скриптов.
     
     Во время работы с редактором можно запускать  скрипты,  ис- 
пользуя  режим  Play меню PAL, но для их запуска необходимо выйти 
из режима редактирования. 
                     
     
                     Клавиши редактирования
-----------------------------------------------------------------
     
     В табл. 10-1 представлены клавиши, используемые для передви- 
жения курсора, изменения режимов редактирования и удаления текста.
     
               Табл. 10-1. Клавиши редактирования.
-----------------------------------------------------------------
     Клавиши                      Функция
-----------------------------------------------------------------
    {Alt}{F7}               Печать текущего скрипта
    {F10}                   Меню редактора
    {Backspace}             Удаление символа слева от курсора
    {Ctrl}{Y}               Удаление участка от курсора до конца
                            строки
    {Ctrl}{V}               Вкл./Выкл. номеров строк
    {Enter}                 Вставка строки в текст
    {Home}                  Перемещение к первой строке скрипта
    {Ctrl}{Home}            Перемещение к началу строки
    {End}                   Перемещение к последней строке
                            скрипта
    {Ctrl}{End}             Перемещение к концу строки
    {PgUp}                  Перемещение вверх на половину экрана
    {PgDn}                  Перемещение вниз на половину экрана
    {Del}                   Удаление символа в текущей позиции
    {Ins}                   Вкл./Выкл. режима вставки
    {Left}                  Переход на один символ влево
    {Right}                 Переход на один символ вправо
    {Up}                    Переход на один символ вверх
    {Down}                  Переход на один символ вниз 
    {Ctrl}{Left}            Перемещение окна влево на пол-экрана
    {Ctrl}{Right}           Перемещение окна вправо на
                            пол-экрана
-----------------------------------------------------------------
                                                   
     Эффект  от  нажатия  {Enter} зависит от режима, в котором вы
находитесь:
     
  -  если высвечивается меню, то с помощью {Enter} выбирается вы-
     деленная опция;
     
  -  для вставки новой строки необходимо, чтобы редактор находил-
     ся в режиме вставки. Если курсор находится не в конце  стро-
     ки, текст справа от курсора переносится в новую строку;
     
  -  при  работе в режиме замены {Enter} переводит курсор в нача-
     ло новой строки. 
     
     
                         Меню редактора
-----------------------------------------------------------------
     
     Меню редактора выглядит так:
     
     Read  Go  Print  Help  DOIT!  Cancel
     ----
     Read contents of another script into this script starting 
     at the cursor.
     
     Это меню высвечивается в любом режиме редактора  при нажатии
клавиши  {F10}.  Опции меню позволяют связать редактор скриптов с
любыми другими компонентами интегрированной среды разработки при-
ложений PAL. Меню имеет 6 опций:
     
  -  READ  -  для  включения скприпта в окно редактора, начиная с
     текущей позиции.
     
  -  GO - для сохранения сделанных изменений,  завершения  режима
     редактирования и запуска скрипта.
     
  -  PRINT  - для печати редактируемого скрипта (аналогичное зна-
     чение имеет {ALT}{F7}).
     
  -  HELP - для высвечивания информации о редакторе  (аналогичное
     значение имеет {F1}).
     
  -  DO-IT!  -  для  сохранения  сделанных изменений и возврата в
     систему Paradox (аналогично {F2}).
     
  -  CANCEL - для завершения работы в режиме  редактирования  без
     сохранения изменений и возврата в систему Paradox.
     
     
                          Команда Read
                          ------------
     
     Команда  READ  предназначена для загрузки скрипта в редактор
из файла на диске. После выбора READ система спросит  вас,  какой
скрипт  вы  хотите  загрузить.  Введите  имя  скрипта или нажмите
{Enter}, а затем выберите его из меню.
     Текст вызванного скрипта включается в  текст  редактируемого
скрипта,  начиная  с  позиции,  занимаемой курсором. При этом все
строки редактируемого скрипта перемещаются вниз на  число  строк,
которое имеет вставляемый скрипт. При этом на диске редактируемый
и вызванный скрипт остаются в первоначальном виде. 
     Так как скрипт читается непосредственно после того, как вве-
дено  его имя, перед выполнением команды READ следует убедиться в
том, что курсор находится в нужной позиции.
                           
     
                           Команда Go
                           ----------
     
     Выбирая команду GO из меню редактора скриптов, вы  завершае-
те редактирование, сохраняете отредактированный скрипт и запуска-
ете его на выполнение.  Эта  команда  совмещает  функции  команды
DO-IT!  из меню редактора и команды Play из меню скриптов системы
Paradox. Тестируя скрипты, вы оцените эту команду.
     
     
                          Команда Print
                          -------------
     
     С  помощью  команды  Print  или  с  помощью  нажатия  клавиш
{Alt}{F7}  можно распечатать редактируемый скрипт. Длина страницы
распечатки управляется параметром Report Page Length,  устанавли-
ваемым  программой  Custom Configuraztion Program. При разработке
больших  программ по желанию можно установить этот параметр  рав-
ным C для распечатки без разделения на страницы.
     Устройство вывода, на которое посылается информация этой ко- 
манды, определяется текущим портом принтера, задаваемым в диалоге 
с  Custom  Configuration Program (CCP) в режиме Setups. Вы можете 
изменить это назначение в диалоге с системой Paradox, выбрав  ре- 
жим  Report/SetPrinter/Override из главного меню системы Paradox. 
Если текущий принтер не указан ни в  CCP,  ни  с  помощью  режима 
главного меню, то скрипт будет направлен в меню с логическим име- 
нем LPT1. 
     PAL делает попытку печатать каждую  строку  полностью.  Если
число символов в строке больше числа позиций принтера, избыточные
символы могут печататься с начала строки, или обрезаться, или пе-
реноситься на следующую строку  в зависимости от принтера. Следу-
ет убедиться, что принтер готов  печатать  длинные  строки  перед
тем, как выводить на печать скрипты, содержащие их.
     
     
     
                       ВЫХОД ИЗ РЕДАКТОРА
-----------------------------------------------------------------
     
     Для выхода из редактора можно использовать три опции меню.
     
  -  Для тестирования редактируемого скрипта используется команда
     GO. Если в процесе тестирования обнаружена ошибка, вы можете
     войти  в  отладчик  с помощью опции Debug, а затем перейти в
     режим редактирования, нажав {Ctrl}{E}.
     
  -  Для   завершения   редактирования    используется    команда
     DO-IT!({F2}).  При этом обрабатываемый скрипт запоминается в
     файле на диске, и происходит переход в систему Paradox.
     
  -  Для завершения редактирования без записи измененного файла на
     диск используется команда Cancel.
     
     
     
     РЕДАКТИРОВАНИЕ СКРИПТОВ, ЗАПИСАННЫХ В РЕЖИМЕ QuerySave
-----------------------------------------------------------------
     
     Как сказано в главе 9, если вы записываете в скрипт формули- 
ровку  запроса  с  помощью режима Script/QuerySave, то полученный 
скрипт представлят собой графическое представление формы запроса. 
Редактор  скриптов можно использовать для просмотра, редактирова- 
ния и соединения скриптов  нескольких запросов  аналогично  тому, 
как это делается с другими видами скриптов. Однако,  существенные 
изменения в запросы следует вводить в режиме диалога  с  системой 
Paradox. 
     Редактировать  запросы в диалоге с системой Paradox удобнее,
потому что она обеспечивает поддержку создания  и  редактирования
запросов.Например, формы запросов в системе Paradox являются гиб-
кими: размеры полей могут изменяться,  обеспечивая  ввод  больших
величин. Кроме того, система Paradox обеспечивает проверку типа и
правильности по определенным критериям,  вводимым  вами  в  форму
запроса.  Система также гарантирует, что формулировка запроса бу-
дет иметь соответствующий вид во время выполнения запроса. Ни од-
на  из  этих функций не реализуется, когда   вы редактируете зап-
рос, пользуясь редактором скриптов.
     Приведем несколько правил редактирования формулировок запро-
сов:
     
     1. Работая в системе Paradox, используйте режим Scripts/Play 
для запуска скрипта, содержа щего  изменяемый  запрос.  При  этом 
формулировка запроса будет высвечиваться в рабочей области. 
     2. Внесите требуемые изменения в запрос. 
     3. Для  включения  измененного запроса в скрипт используйте 
режим Scripts/QuerySave. 
     
     
     
                 ИСПОЛЬЗОВАНИЕ ДРУГИХ РЕДАКТОРОВ
-----------------------------------------------------------------
     
     У  каждого  программиста есть свой любимый редактор. Так как
скрипт PAL представляет собой текст в кодах ASCII, для его созда-
ния  и  модификации  можно использовать любой текстовый редактор.
Следует убедиться в том, что ваш редактор может создавать тексто-
вые файлы без скрытых управляющих команд форматирования и печата-
ния и без управляющих символов.
     Для подключения вашего редактора к  среде  системы  Paradox
следует использовать опцию PAL/Editor программы CCP. Это позволит
вам использовать ваш редактор, не покидая Paradox. Если вы  подк-
лючили ваш редактор к системе Paradox, у вас есть возможность:
     
  -  обращаться  к вашему редактору, выбирая опцию Scripts/Editor
     главного меню системы Paradox или выбирая опцию Editor  (или
     нажимая клавиши {Ctrl}{E}) в процессе отладки;
     
  -  редактировать  защищенные  скрипты, если в процессе текущего
     диалога с системой Paradox вы ввели соответствующий пароль.
   
     Программа CCP позволяет вам передать  вашему  редактору  имя 
текущего  скрипта  и  номер его текущей строки. Также имитируется 
эффект опции GO меню редактора при нажатии {Ctrl}{G}. 
     В зависимости от возможности вашего редактора,  может  и  не
получиться  полное "бесшовное" соединение вашего редактора с сис-
темой Paradox. Например, может быть исключен прямой доступ к  от-
лаживаемой строке. 
     Заметьте, что во время использования вашего редактора систе- 
ма Paradox остается в оперативной памяти,  аналогично  тому,  как 
это  происходит, если вы нажали клавиши обращения к DOS {Ctrl}{O} 
или {Alt}{O}. Это следует иметь в виду, работая  в  редакторе.  В 
общем,  следует убедиться, что среда, существовавшая перед входом 
в редактор, осталась неизменной при возращении в Paradox. В  осо- 
бенности убедитесь в том, что вы: 
     
  -  не уничтожили и не изменили ни один из системных файлов сис- 
     темы Paradox и ни один из файлов, содержащих объекты системы 
     Paradox, исключая редактируемый скрипт. 
     
  -  не запустили ни одну из резидентных программ, кроме тех, что
     были запущены перед началом диалога с системой Paradox; сюда
     включаются команды DOS print и mode.
     
     Полный список предостережений содержится в описании  команды 
toDOS  в  главе 10 руководства пользователя системы Paradox. Под- 
робности процесса стыковки вашего редактора  с  системой  Paradox 
содержатся в главе 14 руководства пользователя системы Paradox. 
     Если вы не подключили ваш редактор к системы Paradox, им все 
равно можно пользоваться для редактирования скриптов, однако  это 
будет все же менее удобно. В частности, вы будете вынуждены выхо- 
дить из системы Paradox каждый раз, когда вам будет  нужно  изме- 
нить скрипт. Кроме того, у вас не будет возможности редактировать 
защищенные скрипты. 
     
     
                                                           
