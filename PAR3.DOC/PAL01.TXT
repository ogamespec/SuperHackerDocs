                                                     Г Л А В А  1
-----------------------------------------------------------------

                            В В Е Д Е Н И Е
     
-----------------------------------------------------------------


     Эта  глава  посвящена введению в PAL, язык приложений системы
Paradox. PAL позволяет вам расширить возжможности системы  Paradox
по созданию прикладных систем баз данных любого уровня сложности с
минимальной затратой усилий.
     Используя PAL, вы легко можете создавать прикладные  системы,
которые работают и выглядят в точности как система Paradox. Вы мо-
жете даже разработать замкнутые прикладные системы, с помощью  ко-
торых  ваши  пользователи  смогут  эффективно работать, не обладая
системой Paradox и даже не зная о ней!
     PAL является наиболее сложным и всесторонним из средств, рас-
ширяющих Paradox в целях создания прикладных систем:

  -  Если  вы просто хотите автоматизировать ежедневно выполняемые
     задачи, вы можете записать их в виде скриптов  системы  Para-
     dox, и затем запустить их, когда это потребуется.
     
  -  Если вам необходимо разработать законченные прикладные систе-
     мы, вам  нет  необходимостми  программировать  -  используйте
     Personal Programmer системы Paradox. Он автоматически генери-
     рует скрипты PAL, которые Вы затем можете  усовершенствовать.
     Таким образом, это идеальное средство создания прототипов.
     
  -  Если вам необходимо усовершенствовать возможности или  струк-
     туру скриптов системы Paradox или прикладных систем, написан-
     ных с помощью Personal Programmer, в этом  вам  тоже  поможет
     PAL.
         
     Использование PAL -  это  программирование.  Это  руководство
предполагает  наличие  у пользователя знания хотя бы основных кон-
цепций программирования; мы не  будем  учить  вас  программировать
здесь.  Если  вы  программировали  на Си, Паскале или другом языке
программирования, или языке баз данных , вы, вероятно, знаете дос-
таточно,  чтобы  начать  немедленно эффективно пользоваться языком
PAL. Если вы новичек в программировании, эти книги помогут вам по-
нять, что к чему:
     
-    George Ledin & Victor Ledin, The Programmer's Book of
     Rules. Lifetime Learning Publications,1979.

-    Paul Heckel, The Element of FriendlySoftware Desing. Warner
     Books,1984.
 
-    Al Kelley & Ira Pohl, C by Dissection. Benjamin/Cummings,
     1986.
      
      
      
                         ЧТО ТАКОЕ PAL?
-----------------------------------------------------------------
     
     PAL  является  структурированным  языком программирования баз
данных высокого уровня с полным набором прикладных средств, позво-
ляющим  вам писать сложные программы для системы Paradox (скрипты)
и прикладные программы. PAL имеет два аспекта:

-    язык как таковой: команды, функции и конструкции

-    набор средств для работы с языком: особое меню PAL, редактор
     скриптов, встроенный отладчик и несколько средств для созда-
     ния и запуска скриптов.
     

                          PAL и PARADOX
-----------------------------------------------------------------
     
     Разработчик прикладных систем баз данных с помощью PAL  может
использовать все возможности системы Paradox. Кроме того, он может
пользоваться набором средств программирования и инструментов,  ха-
рактерных  для  наиболее  совершенных  систем  создания прикладных
программ. Ниже представлены основные средства PAL:

  -  С помощью PAL  вы  можете  пользоваться  всей  мощью  системы
     Paradox.  PAL  можно себе представить в виде робота. Програм-
     мист, работающий в системе Paradox - это агент,  который  уп-
     равляет системой, контролируя с помощью ее действия пользова-
     теля. Пользуясь PAL, вы имеете в своем распоряжении все сред-
     ства  системы Paradox. Ниже приведены некоторые средства сис-
     темы Paradox, важные для разработчика прикладных программ.
     
       -  Язык запросов системы Paradox, с помощью системы  запро-
          сов по образцу позволяет вам легко конструировать запро-
          сы от самых простых до самых сложных. Paradox имеет воз-
          можность соединять много таблиц в один запрос; кроме то-
          го PAL предоставляет вам возможность включать переменные
          в  формулировки  запросов. Пользуясь средством QuerySave
          системы Paradox, вы можете легко использовать  созданные
          вами формулировки запросов в программе на языке PAL.
          
       -  PAL  имеет прямой доступ к средствам диагностики системы
          Paradox. Определенные величины, такие,  как  календарные
          даты,  проверяются автоматически. Другие типы диагности-
          ки, включая форматирование шаблонов, просмотры таблиц, и
          автоматическое заполнение величин в таблицах, могут быть
          быстро установлены в любой точке.
          
       -  Как только вам это понадобится, вы можете создать  новые
          табличные структуры. Вы можете также изменять существую-
          щие табличные структуры без риска потерять  данные.  За-
          метьте,   что  ,если  вы  изменяете  структуру  таблицы,
          Paradox автоматически обновляет все объекты, связанные с
          этой таблицей, т.е. формы, отчеты и указатели.

       -  Вы  можете  использовать  многотабличные  формы  системы
          Paradox для сложных прикладных программ ввода  и  вывода
          данных , таких как ввод накладных или заказов, требующих
          отношений типа 1:M (один-ко-многим), M:M (многие-ко-мно-
          гим)  и M:1 (многие-к-одному) между записями, содержащи-
          мися в различных таблицах. Вы можете использовать много-
          записевые  формы,чтобы автоматически обеспечить просмотр
          областей подробных записей в этих типах прикладных  сис-
          тем.
      
       -  PAL  обеспечивает  доступ  к  генератору отчетов системы
          Paradox, что дает вам возможность разрабатывать  практи-
          чески бесконечное множество форматов вывода без програм-
          мирования.Генератор отчетов поддерживает до  16  уровней
          группирования.  Он  также  выводит вычисленные величины,
          основываясь на выражениях,содержащих одно или более  по-
          лей.  Вы можете разработать спецификации отчета в диало-
          говом режиме с помощью системы Paradox,  а  затем  легко
          включить их в программы на языке PAL.
          
       -  Вы можете усилить ваши программы на языке PAL, используя
          встроенное в Paradox средство графики повышенного качес-
          тва,  с  помощью  которой облегчается поддержка принятия
          решений и анализа прикладных систем.
     
  -  Неограниченное количество переменных и  массивов:  в  системе
     PAL число переменных и массивов, которые вы можете задать ог-
     раничивается только памятью системы. Массивы  могут  состоять
     из почти неограниченного числа элементов. Встроенные примити-
     вы использования массивов для обработки записей  как  единого
     целого позволяют вам быстро перемещать  записи между таблица-
     ми.
     
  -  Очень мощные возможности процедур: PAL не налагает  ограниче-
     ний  на число определений процедур, которые могут быть актив-
     ными одновременно. Кроме того процедуры PAL позволяют:
         
     -    Локальные  и глобальные переменные
          
     -    Рекурсии и  вложения  скриптов и процедур
          
     -    Динамическое определение области  видимости переменных
     
     -    Автоматическое распределение памяти для процедур (заг-
          рузка их  в память и  выгрузка)
          
     -    Определение и использование процедур по стилю похоже  на
          используемые  в языках Си и Паскаль, а также возможность
          автоматического создания и поддержания библиотек опреде-
          лений, синтаксис которых автоматически проанализирован.
     
  -  Полный набор встроенных  функций:
          
     -    Большое число основных математических, статистических и
          трансцендентных  функций
          
     -    Финансовые функции,такие ,как расчет платежей по долгам
          и  вычисление настоящих и будущих  величин
          
     -    Мощные функции синтаксического анализа, сопоставления
          и форматирования строк
          
     -    Группа функций, позволяющих манипулировать и определя-
          ть  состояние объектов системы  Paradox
      
  -  Широкие возможности ввода с клавиатуры и вывода на экран: PAL
     позволяет вам полностью управлять вводом/выводом и взаимодей-
     ствием  с конечными пользователями. Система Paradox позволяет
     вашим прикладным программам организовать ввод данных и  вывод
     их  на экран без программирования в диалоговом режиме. Особый
     примитив WAIT  дает  вам  возможность  передавать  управление
     пользователям, чтобы они могли наращивать или обновлять запи-
     си, поля и целые таблицы до тех пор пока они не нажмут клави-
     шу завершения,которая возвращает управление вашему скрипту.
     
  -  Управляющие  примитивы: В дополнение к традиционным управляю-
     щим структурам ,таким  как  IF-THEN-ESLE,  WHILE-ENDWHILE,  а
     также  SWITCH-CASE,  PAL имеет мощную структуру SCAN, которая
     позволяет очень быстро задавать  последовательности  операций
     над каждой записью таблицы.
     
  -  Легкосоздаваемые  вторичные  индексы: С помощью PAL вы можете
     установить вторичные указатели на  таблицы  системы  Paradox.
     Нет  необходимости  беспокоиться о них в процессе разработки.
     Они могут быть легко созданы  после  осознания  необходимости
     улучшения  программы. Если вы установили эти индексы, вам нет
     необходимости следить за ними - они  будут  использоваться  и
     обновляться автоматически, если возникнет потребность.
     
  -  Защита  с помощью пароля: Используя Paradox,вы можете избира-
     тельно защищать данные в таблицах и скриптах. Вы можете конт-
     ролировать  доступ пользователя к данным вплоть до отдельного
     поля. Вы можете также контролировать доступ к формам, отчетам
     и другим объектам.
     
  -  Вычисление  макрокоманд: вы можите задавать системе командные
     строки.
     
  -  Сокращенные команды меню: PAL содержит специальный класс  ко-
     манд, позволяющий вам имитировать процесс выбора из меню сис-
     темы Paradox, используя при этом синтаксис языка программиро-
     вания и параметры.
     
  -  Многопользовательские средства: вы можете воспользоваться
     встроенными в Paradox средствами защиты файлов и записей, а
     также широким набором примитивов для явной постановки зам-
     ков.
 
  -  Целостность: При использовании многотабличных форм Paradox
     автоматически поддерживает  целостность связанных  таблиц.
     
  -  Обработка ошибок: вы можете определить специальные процедуры
     для локализации и обработки ошибок в скриптах , возникающих
     при исполнении.
 
     
                          Средства PAL
-----------------------------------------------------------------
     
     Язык PAL встроен в Paradox наряду с целостной системой сред-
ств для работы с ним, включая:
     
-    Меню  PAL
     
-    Редактор скриптов  PAL

-    Отладчик  PAL

-    Средства для записи и  запуска скриптов

     Эти средства составляют мощную интегрированную среду для соз-
дания прототипов, разработки, тестирования и  запуска  скриптов  и
прикладных  систем.  Их  взаимоотношения - имена командных клавиш,
режимов меню, а также команды PAL, которые переводят  пользователя
от одного средства к другому показаны на рис.1.1.
     Кроме  того  существуют три средства, помогающие в построении
сложных автономных прикладных систем:
     
  -  Personal Programmer системы Paradox, используемый для автома-
     тической  генерации  кода  и соединения записанных скриптов в
     полную прикладную систему.
     
  -  Подсистема Runtime системы  Paradox,  которая  позволяет  вам
     предоставить  вашу прикладную систему пользователям, не обла-
     дающим системой Paradox.
     
  -  Набор средств ввода данных (Data Entry  Toolkit),  библиотека
     процедур, поддерживающих расширенный набор средств ввода дан-
     ных.
 
     Хотя мы считаем, что среда PAL обеспечивает оптимальную  под-
держку  разработки  прикладных систем, вы можете и не использовать
перечисленные средства для создания программ на языке PAL. Так как
программы на языке PAL являются текстовыми файлами , вы можете ис-
пользовать ваш собственный редактор для их создания, если Вы поже-
лаете (в самом деле, вы можете легко включить ваш любимый редактор
в среду PAL). Для создания, тестирования и использования  программ
на  языке PAL не нужно иметь каких-либо дополнительных или скрытых
файлов.

     

                      ЗАЧЕМ НЕОБХОДИМ PAL?
-----------------------------------------------------------------
     
     Paradox является мощной и простой  в  использовании  системой
управления базами данных. Так как PAL предоставляет вам все средс-
тва управления  системой Paradox, то с помощью  него  легко  можно
разработать пользовательские программы и прикладные системы, кото-
рые также будут мощными и простыми в использовании.
     Среда PAL, как и среда Paradox,  является  объектноориентиро-
ванной.  Она  направляет процесс создания, модификации и поддержки
прикладных систем. С помощью нее  вы  можете  скомпоновать  полные
прикладные системы с минимальной затратой труда.
     Программирование  в этой  среде  состоит  из трех  этапов:
     
1.   Так  как  PAL  использует все возможности системы Paradox, вы
     можете сначала с использованием системы Paradox в  диалоговом
     режиме  создать  таблицы, запросы, формы, отчеты и другие об-
     ъекты, необходимые для прикладной системы.
  
2.   Вы можете затем записать протокол диалога в скрипты и исполь-
     зовать  Personal  Programmer  системы  Paradox  для  создания
     структуры меню и определения отношений между элементами вашей
     прикладной системы.
     
3.   После  этого с помощью редактора скриптов, отладчика и других
     средств PAL вы можете усовершенствовать и настроить вашу сис-
     тему.
     
     Другие  языки управления базами данных, не являющиеся объект-
ноориентированными,не  позволяют  разрабатывать  составные   части
прикладной системы в диалоговом режиме. Они могут не обладать вст-
роенным редактором или средствами поддержания диалога или  генера-
тором  отчетов.  Кроме  того,  их  генераторы прикладных систем не
всегда обеспечивают широкий доступ к меню, отчетам  или  пользова-
тельским формам.
     Короче говоря, программисты, использующие другие системы  баз
данных , часто видят , что они должны программировать со "скрипом"
- то есть создавать прикладные системы баз данных без помощи или с
небольшой помощью СУБД. Для пользователей систем PAL и Paradox все
обстоит иначе.Поработав,вы обратите внимание на то, что вы  прово-
дите большую часть времени, используя Paradox в режиме диалога для
создания компонентов вашей системы и  значительно  меньше  времени
пишите программы непосредственно на языке PAL.

     
     
                ПЕРЕД ТЕМ, КАК ИСПОЛЬЗОВАТЬ PAL
-----------------------------------------------------------------
     
     PAL  и  Paradox  сильно  связаны. Таким образом, чем лучше вы
знаете Paradox, тем в большей степени вы сможете пользоваться им в
ваших программах на языке PAL.
     Мы  считаем,  что вы прочли и поняли руководство пользователя
системы Paradox и имеете опыт использования системы Paradox в диа-
логовом режиме. Вы должны представлять себе:
 
-    как делать выбор из меню и каковы взаимосвязи различных меню
     и режимов системы Paradox;
     
-    как создавать таблицы, формы и отчеты;
     
-    как формулировать запросы, используя язык запросов по образ-
     цу;
        
-    как сортировать таблицы;
     
-    как Paradox использует клавиатуру.
     
     Если  вы  не имеете этих важнейших навыков, мы предлагаем вам
провести немного больше времени, работая с системой Paradox, перед
тем, как пробовать программировать на языке PAL.
     Если  вы  программировали прикладные системы на языках других
систем баз данных, естественно будет предположить, что  вы  можете
писать программы на языке PAL без понимания системы Paradox. В са-
мом деле, PAL является всего лишь языком программирования баз дан-
ных, не так ли? Нет, не так!
     Например,  если  бы вы не знали, что Paradox имеет встроенные
средства форматирования календарных дат, вы бы  предположили,  что
даты  следует  вводить  всегда одним способом и что вам необходимо
написать программу для вывода их в другом формате. Это  верно  для
других  систем  баз данных, но Paradox имеет одинадцать встроенных
форматов календарных дат и поддерживает простую арифметику  с  ис-
пользованием  любого из них. Так что, если бы вы не были знакомы с
системой Paradox, вы бы потратили время и силы на изобретенние ко-
леса.
     Этот  простой  пример  имеет  аналоги  почти во всех областях
программирования. По мере того, как вы будете знакомиться с систе-
мой  Paradox  вы  начнете уважать ее мощь и чувствовать себя более
уютно, заставляя эту мощь работать на вас. Вы поймете, что вы  мо-
жете разрабатывать программы в условиях менее жестких ограничений.
Мы еще раз подчеркиваем: чем лучше вы знаете Paradox, тем лучше вы
будете понимать PAL.
     
     
     
            КАК ПОЛЬЗОВАТЬСЯ НАСТОЯЩИМ РУКОВОДСТВОМ?
-----------------------------------------------------------------
     
     Эта  книга  является  всесторонним справочным руководством по
элементам, командам и средствам языка PAL. Хотя она - не  учебник,
вы найдете в ней множество примеров программ, а также значительное
количество советов по практическим методикам, как эффективно рабо-
тать с PAL. Руководство делится на пять частей:

  -  Часть  I. Основные элементы языка: Содержит подробное ние ос-
     новных элементов PAL. Сюда входят скрипты и команды,  выраже-
     ния, переменные и массивы, управляющие структуры и процедуры.
     
  -  Часть  II.  Средства PAL: Описывает инструментальные средства
     для работы с языком PAL. Сюда входят меню PAL,  средства  для
     создания и запуска скриптов, редактор скриптов и отладчик.
     
  -  Часть III. Использование PAL: Рассматривается, какие команды,
     функции, конструкции, методики и средства необходимо  исполь-
     зовать  для выполнения часто встречающихся операций с помощью
     PAL. В этой главе говорится, как управлять системой  Paradox,
     взаимодействовать с пользователем, манипулировать величинами,
     рационально распределять и использовать  ресурсы,  разрабаты-
     вать макрокоманды клавиатуры, работать с многотабличными фор-
     мами, управлять несколькими  пользователями  и  разрабатывать
     прикладные системы.
     
  -  Часть IV. Справочник команд и функций: Содержит полное описа-
     ние всех команд и функций PAL, включая их синтаксис , исполь-
     зование и примеры.
     
  -  Часть  V. Примеры прикладных систем: Описывает две прикладные
     системы на языке PAL, которые включены в диск  Sample  Tables
     системы Paradox. Первая глава описывает цели и замысел полной
     прикладной системы, выделяет некоторые из используемых  мето-
     дик  и содержит полностью документированный структурированный
     текст программы. Вторая глава описывает набор  средств  ввода
     данных  PAL,  с  помощью которого вы можете усовершенствовать
     ввод/вывод в ваших прикладных системах. Эта часть служит  до-
     полнительным  курсом  обучения  методике  программирования на
     языке PAL.
     
     В конце книги приведены четыре справочных приложения, словарь
и указатель. В общем, части I и II содержат основу PAL и его сред-
ства. После прочтения их вы будете в состоянии продуктивно исполь-
зовать PAL, пользуясь справками из части III по поводу того, каки-
ми командами и функциями вы можете пользоваться. Часть IV является
настольным справочником: держите ее при себе, программируя на PAL.
Наконец, части III и V содержат некоторые  специальные  вопросы  и
тонкости  языка  PAL.  После  того,  как вы разработаете несколько
прикладных программ, перечитайте эти две части  ,  чтобы  углубить
ваше понимание языка PAL и использовать его более эффективно.
     Хотя  эта  книга сопровождает систему Paradox версии 3.0 , вы
можете использовать ее для разработки скриптов, пользуясь версиями
1.0, 1.1 и 2.0 системы Paradox. Команды, функции и методики, кото-
рые не применяются в ранних версиях системы  Paradox,  отмечены  в
справочнике  команд и функций (часть IV) и собраны в приложении D.
При использовании этих команд в прикладной системе,  помните,  что
они будут вызывать ошибки, если система запущена в той версии сис-
темы Paradox, которая не поддерживает эти команды.
     
     
                           Обозначения
-----------------------------------------------------------------
     
     В этой книге мы используем ряд соглашений. Когда мы говорим о
режимах  из  меню системы Paradox, мы будем писать их по английски
слитно, например:MiniScript или Tools/QuerySpeedup.  Имена  файлов
DOS будем обозначать заглавными буквами, например: Paradox3.EXE.
     Все  примеры  программ  будут представлены в виде, похожем на
распечатку принтера и помещены вне текста, например :

     SETKEY "F11"  SORT  TABLE()  ON FIELD()

     В части IV, где мы описываем команды и функции  PAL,  мы  ис-
пользуем  специальные  обозначения  для  указания  синтаксиса. Эти
обозначения описаны полностью в начале части IV.
     Возможности заполнения перечислены в таблице в  начале  главы
20  в  разделе "Переменные параметры PAL". Когда в встретите соот-
ветствующее слово в определении синтаксиса, посмотрите в эту  таб-
лицу, чтобы выяснить, выражение какого типа допустимо здесь.
