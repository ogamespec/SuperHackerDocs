                                                                С. М. Абель
              Генерация прикладных систем помощи

    Программа Helpgen генерирует файл помощи, который может использоваться под
управлением драйвера HELP фирмы Flambeaux Software (версия 3.0).
    Исходными данными для программы Helpgen служат файлы, подготовленные
пользователем и содержащие разделы помощи (меню и/или тексты). Имена разделов
должны иметь вид <имя>.ххх, где <имя> - имя, общее для всех файлов генерируемой
системы помощи, а ххх - трехзначный номер от 000 до 253. Эти номера должны быть
последовательными.

    Разделы с номерами 000, 001 и 002 должны быть предоставлены обязательно,
так что общее число файлов на входе должно быть не меньше трех.
    Файл 000 - это приветственный экран, который будет выдаваться в начальный
момент вызова системы помощи. Этот экран может содержать до 18 строк текста,
первая из которых является титулом всей системы помощи, имеет длину до 32
символов и будет выдаваться в левом верхнем углу каждого экрана помощи.
Остальные строки (до 17) образуют верхнюю часть приветственного экрана
(нижняя часть формируется программно).

    Раздел 002 должен содержать главное меню системы помощи. Этот раздел будет
выдаваться первым после приветственного  экрана.

Раздел 001 может содержать "тематическое оглавление" системы помощи. Если
драйвер запускается с параметром "тема" (командой help тема), то будет выдан
тот раздел, на который ссылается пункт раздела 001 с именем, начинающимся со
слова "тема".

    В результате работы программы Helpgen формируется единственный файл с именем
<имя>.h!, готовый для вызова по команде: help /m=[путь]имя.h!

                          Структура разделов 001-253

    Разделы 001-253 создаются как обычные текстовые файлы с длиной строки до 78
и числом строк до 256. Допускаются любые коды ASCII (исключая 00..05 и FF,
автоматически заменяемых пробелами). Первая строка каждого файла трактуется как
титул раздела (длиной до 60 символов) и выдается при просмотре вверху экрана
с автоматическим центрированием.

    Если желательно, чтобы раздел (например, меню) умещался на одном экране, то
такой раздел должен содержать не более 22 строк, включая титульную (и не считая
служебных, описанных ниже).

    Любая часть любой строки раздела (кроме титульной) может быть определена
как поле выбора ("тема"). Это означает, что поле будет выделено на экране
и доступно для выбора курсором. Каждое поле должно ссылаться на номер раздела
(меню или текста), к которому будет осуществлен переход, если пользователь
выберет данное поле (т.е. переместит к нему курсор и нажмет Enter).

    Таким образом, меню логически не отличаются от обычного текста помощи.
Благодаря ссылкам структура системы помощи оказывается сетевой. Допускаются,
в частности, циклические комбинации ссылок и петли (ссылки на себя).

    Особые случаи ссылок:

    - на раздел 000 ссылаться нельзя;

    - ссылка 254 приводит к возврату в "логически предыдущий" раздел, т.е. в тот
раздел, из  которого был  выбран текущий  раздел; такая  ссылка не допускается в
главном меню (002);

    - ссылка 255 приводит к немедленному выходу из системы помощи.


    Чтобы определить поле выбора, перед строкой, содержащей поле, следует
вставить служебную строку. В этой строке, в точности над позициями поля выбора,
записываются:

    - трехзначный номер раздела, на который ссылается поле;

    - если поле длиннее трех символов, то точки до конца поля;

    - то же самое для каждого поля, если в строке несколько полей;

    - последним символом служебной строки должен быть код 0ffH (ASCII 255).

    Поле не может быть короче трех символов. Ссылка на раздел ххх означает, что
соответствующий текст находится в файле <имя>.ххх.

    Служебная строка может также использоваться для представления трех
специальных символов с кодами 09 (табуляция), 0D (возврат строки) и 1A
(конец файла), не допускаемых текстовыми редакторами. А именно, в служебной
строке над соответствующими позициями кодируются латинские буквы A (над 09),
B (над 0D) или C (над 1A). При генерации системы помощи служебные строки будут
удалены, а буквы A,B,C заменены на служебные символы в нужных позициях.

    Поля выбора не должны содержать специальных символов.

    Служебные строки не надо включать в подсчет числа строк в разделе. В строке
допускается несколько полей выбора, и они могут даже вплотную примыкать
друг к другу.

    Пример части раздела помощи в исходном текстовом файле (& обозначает 0ffH):

<Служебная строка>                 004.....                    C&
<Обычная строка>    Для перемещения фрейма используйте клавиши х или...
<Служебная строка>              005.........         012..........&
<Обычная строка>    Чтобы выдать тип фрейма, выберите меню Frames, а затем...

    Вспомогательная программа HelpXref может использоваться для получения таблиц
перекрестных ссылок между исходными файлами создаваемой системы помощи.

    При генерации файла помощи можно использовать сжатие текста. Оно позволяет
(при удачно подобранной таблице сжатия) значительно уменьшить объем результата.
Таблица сжатия подготавливается как обычный текстовый файл с именем <имя>.888
и помещается в тот же путь, что и остальные входные файлы. Таблица должна
содержать не более 252 строк. Каждая такая строка (длиной до 40 символов) при ее
встрече в результирующем файле заменяется на двухбайтовый код. Не следует
помещать в таблицу сжатия последовательности повторяющихся символов (черточки и
т.п.), так как такие последовательности сжимаются безусловно, без использования
таблицы.
