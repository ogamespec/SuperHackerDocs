                                   Оглавление                                  
       Windows 3.0/Ref/2#7                                        = 1 =

       Глава 4. СПИСОК ФУНКЦИЙ........................................5
       AccessResource.................................................6
       AddAtom........................................................6
       AddFontResource................................................7
       AdjustWindowRect...............................................8
       AdjustWindowRectEx [3.0].......................................9
       AllocDStoCSAlias [3.0]........................................10
       AllocResource.................................................11
       AllocSelector [3.0]...........................................11
       AnimatePalette [3.0]..........................................12
       AnsiLower.....................................................13
       AnsiLowerBuff [3.0]...........................................14
       AnsiNext......................................................14
       AnsiPrev......................................................15
       AnsiToOem.....................................................15
       AnsiToOemBuff [3.0]...........................................16
       AnsiUpper.....................................................17
       AnsiUpperBuff [3.0]...........................................17
       AnyPopup......................................................18
       AppendMenu [3.0]..............................................18
       Arc...........................................................22
       ArrangeIconicWindows [3.0]....................................23
       BeginDeferWindowPos [3.0].....................................25
       BeginPaint....................................................25
       BitBlt........................................................26
       BringWindowToTop..............................................29
       BuildCommDCB..................................................30
       CallMsgFilter.................................................32
       CallWindowProc................................................32
       Catch.........................................................33
       CangeClipboardChain...........................................34
       ChangeMenu....................................................35
       ChangeSelestor  [3.0].........................................35
       CheckDlgButton................................................36
       CheckMenuItem.................................................37
       CheckRadioButton..............................................38
       ChildWindowFromPoint..........................................39
       Chord.........................................................40
       ClearCommBreak................................................41
       ClientToScreen................................................41
       ClipCursor....................................................42
       CloseClipboard................................................43
       CloseComm.....................................................43
       CloseMetaFile.................................................43
       CloseSound....................................................44
       CloseWindow...................................................44
       CombineRgn....................................................45
       CopyMetaFile..................................................46
       CopyRect......................................................47
       CountClipboardFormats.........................................48
       CountVoiceNotes...............................................48
       CreateBitmap..................................................48
       CreateBitmapIndirect..........................................49

       Windows 3.0/Ref/2#7                                        = 2 =

       CreateBrushIndirect...........................................50
       CreateCaret...................................................50
       CreateCompatibleBitmap........................................52
       CreateCompatibleDC............................................53
       CreateCursor   [3.0]..........................................54
       CreateDC......................................................54
       CreateDialog..................................................56
       CreateDialogIndirect..........................................58
       CreateDialogIndirectParam   [3.0].............................60
       CreateDialogParam   [3.0].....................................61
       CreateDIBitmap [3.0]..........................................62
       CreateDIBPatternBrush  [3.0]..................................64
       CreateDiscardableBitmap.......................................65
       CreateEllipticRgn.............................................65
       CreateEllipticRgnIndirect.....................................66
       CreateFont....................................................67
       CreateFontIndirect............................................70
       CreateHatchBrush..............................................71
       CreateIC......................................................72
       CreateIcon  [3.0].............................................73
       CreateMenu....................................................74
       CreateMetaFile................................................74
       CreatePalette   [3.0].........................................75
       CreatePatternBrush............................................75
       CreatePen.....................................................76
       CreatePenIndirect.............................................77
       CreatePolygonRgn..............................................78
       CreatePolyPolygonRgn  [3.0]...................................78
       CreatePopupMenu  [3.0]........................................80
       CreateRectRgn.................................................80
       CreateRectRgnIndirect.........................................81
       CreateRoundRectRgn   [3.0]....................................82
       CreateSolidBrush..............................................82
       CreateWindow..................................................83
       CreateWindowEx   [3.0].......................................102
       DebugBreak [3.0].............................................105
       DefDlgProc [3.0].............................................105
       DefferWindowProc [3.0].......................................106
       DefFrameProc [3.0]...........................................108
       DefHookProc..................................................110
       DefineHandleTable [3.0]......................................111
       DefMDIChildProc [3.0]........................................112
       DefWindowProc................................................114
       DeleteAtom...................................................115
       DeletеDC.....................................................115
       DeleteMenu [3.0].............................................116
       DeleteMetaFile...............................................117
       DeleteObject.................................................118
       DestroyCaret.................................................118
       DestroyCursor [3.0]..........................................119
       DestroyIcon [3.0]............................................120
       DestroyMenu..................................................120
       DestroyWindow................................................121

       Windows 3.0/Ref/2#7                                        = 3 =

       DeviceCapabilites [3.0]......................................122
       DeviceMode...................................................126
       DialogBox....................................................127
       DialogBoxIndirect............................................129
       DialogBoxIndirectParam [3.0].................................131
       DialogBoxParam [3.0].........................................132
       DispatchMessage..............................................133
       DlgDirList...................................................134
       DlgDirListComboBox [3.0].....................................136
       DlgDirSelect.................................................138
       DlgDirSelectComboBox [3.0]...................................139
       DOS3Call [3.0]...............................................140
       DPtoLP.......................................................141
       DrawFocusRect [3.0]..........................................142
       DrawIcon.....................................................142
       DrawMenuBar..................................................143
       DrawТеxt.....................................................144
       Ellipse......................................................147
       EmptyClipboard...............................................147
       EnableHardwareInput..........................................148
       EnableMenuItem...............................................148
       EnableWindow.................................................150
       EndDeferWindowPos [3.0]......................................151
       EndDialog....................................................151
       EndPaint.....................................................152
       EnumChildWindows.............................................153
       EnumClipboardsFormats........................................154
       EnumFonts....................................................155
       EnumMetaFile.................................................157
       EnumObjects..................................................159
       EnumProps....................................................160
       EnumTaskWindows..............................................163
       EnumWindows..................................................165
       EqualRect....................................................166
       EqualRgn.....................................................166
       Escape.......................................................167
       EscapeCommFunction...........................................168
       ExcludeClipRect..............................................169
       ExcludeUpdateRgn.............................................170
       ExitWindows [3.0]............................................171
       ExtDeviceMode [3.0]..........................................171
       ExtFloodFill [3.0]...........................................174
       ExtTextOut...................................................175
       FatalAppExit [3.0]...........................................178
       FatalExit....................................................178
       FillRect.....................................................179
       FillRgn......................................................180
       FindAtom.....................................................181
       FindResource.................................................181
       FindWindow...................................................183
       FlashWindow..................................................184
       FloodFill....................................................185
       FlushComm....................................................185

       Windows 3.0/Ref/2#7                                        = 4 =

       FrameRect....................................................186
       FrameRgn.....................................................187
       FreeLibrary..................................................187
       FreeModule [3.0].............................................188
       FreeProcInstance.............................................188
       FreeResource.................................................189
       FreeSelector [3.0]...........................................189

       Windows 3.0/Ref/2#7                                        = 5 =

                                                                               
            Глава 4. СПИСОК ФУНКЦИЙ
       ----------------------------------------------------------------

             Эта глава  содержит  в  алфавитном  порядке список функций
        интерфейса  прикладных  программ   (API)   Microsoft   Windows.
        Документация  для  каждой  функции содержит строку,  содержащую
        правильный  синтаксис,  описание  задач  функции,  описание  ее
        входных  параметров,  и  описание  ее  возвращаемого  значения.
        Документация  для  некоторых  функций  содержит  дополнительную
        важную   информацию,   в   которой  нуждается  разработчик  при
        использовании функции.



       Windows 3.0/Ref/2#7                                        = 6 =

                                    AccessResource                             

        Синтаксис

             int  AccessResource(hInstance,hResInfo)

             Эта функция  открывает  заданный файл ресурса и перемещает
        указатель файла  на   начало   указанного   ресурса,   позволяя
        прикладной программе   считать   ресурс   из   файла.   Функция
        AccessResource  предоставляет  дескриптор  файла  DOS,  который
        может  быть использован в последовательных вызовах чтения файла
        для загрузки ресурса. Файл открыт только для чтения.

             Прикладная программа,  которая  использует  эту   функцию,
        должна  закрыть  файл  ресурса с помощью вызова функции _Iclose
        после считывания ресурса.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hInstance         HANDLE   Идентифицирует        экземпляр
                               модуля, выполняемый    файл     которого
                               содержит ресурс.

             hResInfo          HANDLE  Идентифицирует требуемый ресурс.
                               Этот дескриптор  должен  быть  создан  с
                               помощью функции FindResource.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  определяет  дескриптор   указанного
        файла DOS для необходимого ресурса.  Оно равно -1,  если ресурс
        не может быть найден.

        Примечание

             Функция AccessResource    может    исчерпать     доступные
        дескрипторы файлов DOS,  что приведет к ошибкам,  если открытые
        файлы не были закрыты после получения ресурса.

        ───────────────────────────────────────────────────────────────
                                       AddAtom                                 

        Синтаксис

             ATOM AddAtom(lpString)

             Эта функция   добавляет   символьную  строку,  на  которую
        указывает параметр lpString,  в таблицу атомов и создает  новый
        атом, который однозначно идентифицирует строку. Атом может быть

       Windows 3.0/Ref/2#7                                        = 7 =

        использован в последующей функции  GetAtomName  для  нахождения
        строки в таблице атомов.

             Функция AddAtom  запоминает  не более одной копии заданной
        строки в таблице атомов.  Если строка уже  имеется  в  таблице,
        функция возвращает существующее значение атома и увеличивает на
        1 счетчик ссылок на строку.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpString          LPSTR   Указывает на символьную  строку,
                               добавляемую в   таблицу.  Строка  должна
                               быть  оканчивающейся  нулем   символьной
                               строкой.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  определяет  вновь  созданный  атом,
        если  функция  завершена успешно.  В противном случае оно равно
        NULL.

        Примечание

             Значения атома,   возвращаемые   AddAtom,   расположены  в
        диапазоне шестнадцатеричных значений от C000 до FFFF.  На атомы
        не оказывает влияние режим регистра (верхний или нижний).

        ───────────────────────────────────────────────────────────────
                                   AddFontResource                             

        Синтаксис

             short AddFontResource(lpFileName)

             Эта функция добавляет ресурс шрифта  из  файла,  заданного
        параметром lpFileName,  в таблицу шрифтов Windows. Впоследствии
        шрифт может быть использован любой программой.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpFileName        LPSTR   Указывает на символьную  строку,
                               идентифицирующую   имя   файла   ресурса
                               шрифта,    или    содержит    дескриптор
                               загружаемого   модуля.  Если  lpFileName
                               указывает на имя файла  ресурса  шрифта,
                               то   строка  должна  завершаться  нулем,
                               иметь имя файла в формате DOS и включать
                               расширение.   Если  lpFileName  содержит

       Windows 3.0/Ref/2#7                                        = 8 =

                               дескриптор,  то   он   располагается   в
                               младшем  слове,  а  старшее  слово равно
                               нулю.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение    определяет    число   добавляемых
        шрифтов. Оно равно 0, если шрифты не загружены.

        Примечание

             Любая прикладная программа,  которая добавляет или удаляет
        шрифты из таблицы шрифтов Windows, должна известить другие окна
        об изменении, послав сообщение WM_FONTCHANGE с параметром hWnd,
        утановленным  в  -1,  с помощью функции SendMessage.  Сообщение
        должно быть послано  во  все  окна верхнего уровня системы.

             Рекомендуется удалять    ресурс    шрифта,     добавленный
        прикладной программой, как только она закончила с ним работу.

             Информация о   ресурсах  шрифта  приведена  в  Руководстве
        программиста.

        ───────────────────────────────────────────────────────────────
                                   AdjustWindowRect                            

        Синтаксис

             void AdjustWindowRect(lpRect,dwlStyle,bMenu)

             Эта функция   вычисляет   размер  прямоугольника  окна  на
        основании    требуемого    размера    прямоугольника    области
        пользователя    окна.    Прямоугольник    окна    может   затем
        использоваться как параметр в функции CreateWindow для создания
        окна, область пользователя которого имеет требуемый размер.

             Прямоугольник области   пользователя   -   это  наименьший
        прямоугольник,  который  полностью  заключает  в  себе  область
        пользователя.    Прямоугольник    окна    -    это   наименьший
        прямоугольник, который полностью заключает в себе окно. Размеры
        результирующего  прямоугольника  окна зависят от типа окна и от
        того, имеет ли окно меню.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpRect            LPRECT   Указывает на  структуру  данных
                               RECT, содержащую              координаты
                               прямоугольника области пользователя.

             lStyle            long Определяет тип окна,  для  которого

       Windows 3.0/Ref/2#7                                        = 9 =

                               должен  быть  преобразован прямоугольник
                               области пользователя.

             bMenu             BOOL Информирует, имеет ли окно меню.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсутствует.

        Примечание

             Эта функция  подразумевает  одну строку меню.  Если строка
        меню переносится на вторую  строку  или  более,  то  координаты
        являются неверными.

        ───────────────────────────────────────────────────────────────
                               AdjustWindowRectEx [3.0]                        

        Синтаксис

             void AdjustWindowRectEx(lpRect,dwlStyle,bMenu,dwExStyle)

             Эта функция вычисляет требуемый размер прямоугольника окна
        с расширенным    типом    на   основании   требуемого   размера
        прямоугольника области пользователя  окна.  Прямоугольник  окна
        может    затем    использоваться   как   параметр   в   функции
        CreateWindowEx для создания окна, область пользователя которого
        имеет требуемый размер.

             Прямоугольник области   пользователя   -   это  наименьший
        прямоугольник,  который  полностью  заключает  в  себе  область
        пользователя.    Прямоугольник    окна    -    это   наименьший
        прямоугольник, который полностью заключает в себе окно. Размеры
        результирующего  прямоугольника  окна зависят от типа окна и от
        того, имеет ли окно меню.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpRect            LPRECT   Указывает на  структуру  данных
                               RECT, содержащую              координаты
                               прямоугольника области пользователя.

             lStyle            long Определяет тип окна,  для  которого
                               должен  быть  преобразован прямоугольник
                               области пользователя.

             bMenu             BOOL Информирует, имеет ли окно меню.

             dwExstyle         DWORD   Определяет   расширенный     тип
                               созданного окна.

             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 10 =


        Возвращаемое значение

             Отсутствует.

        Примечание

             Эта функция  подразумевает  одну строку меню.  Если строка
        меню переносится на вторую  строку  или  более,  то  координаты
        являются неверными.

        ───────────────────────────────────────────────────────────────
                                AllocDStoCSAlias [3.0]                         

        Синтаксис

                 WORD  AllocDStoCSAlias(wSelector)

             Эта функция  получает доступ к селектору сегмента данных и
        возвращает селектор   сегмента   кода,   который   может   быть
        использован для  выполнения  кода  в сегменте данных.  В случае
        защищенного режима,  попытка выполнить  код  прямо  в  сегменте
        данных приведет    к    нарушению    защиты   памяти.   Функция
        AllocDstoCSAlias позволяет прикладной программе выполнять  код,
        который прикладная  программа создала в ее собственном сегменте
        стека.

             Прикладная программа  должна  освободить  новый   селектор
        посредством вызова функции FreeSelector.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             wSelector         WORD    Определяет   селектор   сегмента
                               данных.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  -  это  селектор   сегмента   кода,
        переданный селектору   сегмента   данных.   Если   функция   не
        разместила новый селектор, то возвращаемое значение равно нулю.

        Примечание

            Система Windows  не   отслеживает   перемещения   сегмента.
        Поэтому,   сегмент   данных  должен  быть  фиксированным  и  не
        сбрасываемым;  в  противном   случае   сегмент   данных   может
        перемещятся, делая не корректным селектор сегмента кода.

       Windows 3.0/Ref/2#7                                       = 11 =


             Функция ChangeSelector обеспечивает другой метод получения
        селектора кода, передаваемого селектору данных.

             Прикладная программа должна использовать эту функцию, если
        это  только  абсолютно  необходимо.  Использование этой функции
        нарушает предпочтительные принципы программирования Windows.

        ───────────────────────────────────────────────────────────────
                                    AllocResource                              

        Синтаксис

             HANDLE AllocResource(hInstance,hResInfo,dwSize)

             Эта функция   выделяет   неинициализированную  память  для
        размещения ресурса.  Под все ресурсы должна быть предварительно
        выделена  память при помощи этой функции.  Функция LoadResource
        вызывает эту функцию перед загрузкой ресурса.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hInstance         HANDLE Идентифицирует экземпляр  модуля,
                               выполняемый   файл   которого   содержит
                               ресурс.

             hResInfo          HANDLE Идентифицирует требуемый  ресурс.
                               Предполагается,  что этот дескриптор был
                               создан с помощью функции FindResource.

             dwSize            DWORD Определяет  требуемый   размер   в
                               байтах,  который необходимо выделить для
                               ресурса.  Он игнорируется,  если  размер
                               равен нулю.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

              Возвращаемое значение  идентифицирует   блок   глобальной
        памяти, выделенный для ресурса.

        ───────────────────────────────────────────────────────────────
                                 AllocSelector [3.0]                           

        Синтаксис

             WORD  AllocSelector (wSelector)

             Эта функция  размещает  новый  селектор.   Если   параметр
        wSelector -  это  допустимый  селектор,  функция  AllocSelector
        возвращает новый селектор,  который  точно  копирует  селектор,

       Windows 3.0/Ref/2#7                                       = 12 =

        определенный параметром wSelector. Если wSelector NULL, функция
        возвращает новый, неинициализированный селектор.

             Прикладная программа  должна  освободить  новый   селектор
        посредством вызова функции FreeSelector.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             wSelector         WORD    Определяет   селектор,   который
                               должен быть скопирован,  или NULL,  если
                               AllocSelector размещает           новый,
                               неинициализированный селектор.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  -  это   либо   селектор,   который
        копирует существующий        селектор,        либо       новый,
        неинициализированный селектор. Если функция не может разместить
        новый селектор, возвращаемое значение равно нулю.

        Примечание

             Прикладная программа  может  вызвать функцию AllocSelector
        для размещения селектора,  который может быть  передан  функции
        ChangeSelector.

             Прикладная программа не должна использовать эту функцию до
        тех пор  пока  это  абсолютно  необходимо.  Использование  этой
        функции  нарушает  предпочтительные  принципы  программирования
        Windows.

        ───────────────────────────────────────────────────────────────
                                 AnimatePalette [3.0]                          

        Синтаксис

             void AnimatePalette(hPalette,wStartIndex,wNumEntries,
                                                       lpPaletteColors)

             Эта функция   замещает   элементы   логической    палитры,
        определенной параметром  hPalette.  Когда  прикладная программа
        вызывает функцию AnimatePalette,  она  не  должна  изменять  ее
        область пользователя, потому, что Windows немедленно отображает
        новые элементы в системной палитре.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hPalette          HPALETTE Определяет логическую палитру.


       Windows 3.0/Ref/2#7                                       = 13 =

             wStartIndex       WORD Определяет   первый    элемент    в
                               палитре, который должен быть изменен.

             wNumEntries       WORD Определяет количество  элементов  в
                               палитре, которые должны быть изменены.

             lpPaletteColors   LPPALETTEENTRY Указывает    на    первый
                               элемент    массива    структуры   данных
                               PALETTEENTRY  для  замещения   элементов
                               палитры,     определенных    параметрами
                               wStartIndex и wNumEntries.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсуствует

        Примечание

             Функция AnimatePalette изменит только  элементы  с  флагом
        PC_RESERVED, установленном  в  переданном  поле palPaletteEntry
        структуры данных   LOGPALETTE,   которая   определяет   текущую
        логическую палитру.  Функция  CreatePalette  создает логическую
        палитру.

        ───────────────────────────────────────────────────────────────
                                      AnsiLower                                

        Синтаксис

             LPSTR AnsiLower(lpString)

             Эта функция преобразует заданную строку символов в символы
        нижнего регистра. Преобразование осуществляется драйвером языка
        на основе  критериев  текущего языка,  выбранного пользователем
        при установке или с помощью программы "Панель Управления".


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpString          LPSTR   Указывает    на   оканчивающуюся
                               нулем символьную  строку,  или одиночный
                               символ.  Если  указатель  ссылается   на
                               одиночный      символ,     то     символ
                               располагается в младшем слове и  старшее
                               слово содержит нуль.

             ──────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                       = 14 =

        Возвращаемое значение

             Возвращаемое значение    указывает    на     преобразуемую
        символьную строку,  если параметр функции определяет символьную
        строку. В   противном   случае  оно  является  32-ух  разрядным
        значением,  которое в младшем  байте  младшего  слова  содержит
        преобразованный символ.

        ───────────────────────────────────────────────────────────────
                                 AnsiLowerBuff [3.0]                           

        Синтаксис

             WORD AnsiLowerBuff(lpString,nLength)

             Эта функция   преобразует  строку  символов  в  буфер  для
        нижнего регистра. Преобразование осуществляется драйвером языка
        на  основе  критериев текущего языка,  выбранного пользователем
        при установке или с помощью программы "Панель Управления".


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpString          LPSTR  Указывает  на  буфер,  содержащий
                               один или несколько символов.

             nLength           WORD Определяет  количество  символов  в
                               буфере определенном параметром lpString.
                               Если     nLength    ноль,    то    длина
                               64K(65.536).

             ──────────────────────────────────────────────────────────

        Возвращаемое значение


             Возвращаемое значение определяется длинной преобразованной
        строки.

        ───────────────────────────────────────────────────────────────
                                       AnsiNext                                

        Синтаксис

             LPSTR AnsiNext(lpCurrentChar)

             Эта функция перемещает указатель  на  следующий  символ  в
        строке.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             lpCurrentChar     LPSTR Указывает   на  символ  в  строке,
                               оканчивающейся нулем.
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 15 =


        Возвращаемое значение

             Возвращаемое значение  указывает  на  следующий  символ  в
        строке,  или,  если нет следующего символа, то на символ нуля в
        конце строки.

        Примечание

             Функция AnsiNext  используется для перемещения по строкам,
        символы которых имеют два или  более  байтов  каждый  (например
        строки, состоящие из набора символов японского алфавита).

        ───────────────────────────────────────────────────────────────
                                       AnsiPrev                                

        Синтаксис

             LPSTR AnsiPrev(lpStart,lpCurrentChar)

             Эта функция перемещает указатель на предшествующий  символ
        в строке.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpStart           LPSTR Указывает на начало строки.

             lpCurrentChar     LPSTR  Указывает  на  символ  в  строке,
                               оканчивающейся нулем.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение указывает на предшествующий символ в
        строке,  или  на  первый  символ  в   строке,   если   параметр
        lpCurrentChar эквивалентен параметру lpStart.

        Примечание

             Функция AnsiPrev  используется для перемещения по строкам,
        символы которых имеют два или  более  байтов  каждый  (например
        строки, состоящие из набора символов японского алфавита).

        ───────────────────────────────────────────────────────────────
                                      AnsiToOem                                

        Синтаксис

       Windows 3.0/Ref/2#7                                       = 16 =


             BOOL AnsiToOem(lpAnsiStr,lpOemStr)

             Эта функция  преобразует  строку,  на  которую   указывает
        параметр  lpAnsiStr,  из  набора  символов  кода  ANSI  в набор
        символов, определенный  в  коде  OEM.  Эта  строка  может  быть
        длиннее, чем 64K.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpAnsiStr         LPSTR  Указывает на оканчивающуюся нулем
                               строку  символов из набора символов кода
                               ANSI, заканчивающуюся нулем.

             lpOemStr          LPSTR Указывает  на  ячейки,  в  которые
                               преобразованная       строка       будет
                               скопирована.  Для  преобразования строки
                               на том же месте параметр lpOemStr должен
                               быть таким же, как lpAnsiStr.

             ──────────────────────────────────────────────────────────


        Возвращаемое значение

             Возвращаемое значение всегда равно -1.

        ───────────────────────────────────────────────────────────────
                                 AnsiToOemBuff [3.0]                           

        Синтаксис

             void AnsiToOemBuff(lpAnsiStr,lpOemStr,nLength)

             Эта функция   преобразует  строку  в  буфере,  на  который
        указывает параметр lpAnsiStr,  из набора символов кода  ANSI  в
        набор символов, определенный в коде OEM.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpAnsiStr         LPSTR   Указывает  на  буфер, содержащий
                               один или несколько  символов  из  набора
                               символов кода ANSI.

             lpOemStr          LPSTR Указывает  на  ячейки,  в  которые
                               преобразованная       строка       будет
                               скопирована.  Для  преобразования строки
                               на том же месте параметр lpOemStr должен
                               быть таким же, как lpAnsiStr.

       Windows 3.0/Ref/2#7                                       = 17 =


             nLength           WORD Определяет  количество  символов  в
                               буфере     определенном       параметром
                               lpAnsiStr.  Если nLength ноль,  то длина
                               64K (65.536).

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсуствует


        ───────────────────────────────────────────────────────────────
                                      AnsiUpper                                

        Синтаксис

             LPSTR AnsiUpper(lpString)

             Эта функция преобразует данную строку  символов  в  строку
        символов верхнего   регистра.   Преобразование   осуществляется
        драйвером языка на основе критериев текущего языка,  выбранного
        пользователем  при  установке  или  с помощью программы "Панель
        Управления".


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpString          LPSTR Указывает  на оканчивающуюся нулем
                               символьную строку или одиночный  символ.
                               Если указатель  ссылается  на  одиночный
                               символ,   то   символ   располагается  в
                               младшем байте младшего слова,  и старшее
                               слово равно нулю.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение     указывает    на    преобразуемую
        символьную строку,  если параметр функции определяет символьную
        строку. В противном случае оно является 32-ух разрядным словом,
        которое в младшем байте младшего слова содержит преобразованный
        символ.

        ───────────────────────────────────────────────────────────────
                                 AnsiUpperBuff [3.0]                           

        Синтаксис

             WORD AnsiUpperBuff(lpString,nLength)

       Windows 3.0/Ref/2#7                                       = 18 =


             Эта функция   преобразует  строку  символов  в  буфер  для
        верхнего регистра.   Преобразование   осуществляется  драйвером
        языка  на   основе   критериев   текущего   языка,   выбранного
        пользователем  при  установке  или  с помощью программы "Панель
        Управления".


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpString          LPSTR  Указывает  на  буфер,  содержащий
                               один или несколько символов.

             nLength           WORD Определяет  количество  символов  в
                               буфере определенном параметром lpString.
                               Если     nLength    ноль,    то    длина
                               64K(65.536).

             ──────────────────────────────────────────────────────────

        Возвращаемое значение


             Возвращаемое значение определяется длинной преобразованной
        строки.

        ───────────────────────────────────────────────────────────────
                                                                               
       AnyPopup

        Синтаксис

             BOOL AnyPopup( )

             Эта функция  указывает,  существует ли окно накладываемого
        типа на экране.  Она производит поиск по  всему  экрану,  а  не
        только в  области  пользователя,  откуда  она вызвана.  Функция
        AnyPopup  возвращает  ненулевое  значение  даже  тогда,   когда
        накладываемое окно полностью закрыто другим окном.


             Эта функция не имеет параметров.


             Возвращаемое значение

             Возвращаемое значение   не   равно   нулю,    если    окно
        накладываемого типа существует. В противном случае равно нулю.


        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 19 =

                                   AppendMenu [3.0]                            

        Синтаксис

             BOOL AppendMenu(hMneu,wFlags,wIDNewItem,lpNewItem)

             Эта функция  добавляет  новый  элемент   в   конец   меню.
        Прикладная программа  может  определить состояние элемента меню
        установкой значения параметра wFlags.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hMenu             HMENU Определяет  меню,  которое  должно
                               быть изменено.

             wFlags            WORD Определяет информацию  о  состоянии
                               нового элемента меню, при его добавлении
                               в меню.  Этот параметр содержит одну или
                               несколько величин, приведенных в разделе
                               "Примечание".

             wIDNewItem        WORD Определяет  либо  ID команды нового
                               элемента меню,    либо    если    wFlags
                               установлен  в MF_POPUP,  дескриптор меню
                               накладываемого меню.

             lpNewItem         LPSTR Определяет    содержимое    нового
                               элемента меню.  Интерпритация  параметра
                               lpNewItem зависит от установки параметра
                               wFlags.

                               Если wFlags равен   lpNewItem
                               ─────────────────   ─────────

                               MF_STRING           Содержит     длинный
                                                   указатель         на
                                                   оканчивающуюся нулем
                                                   символьную строку.

                               MF_BITMAP           Содержит  дескриптор
                                                   растровой      карты
                                                   HBITMAP    в     его
                                                   младшем байте.

                               MF_OWNERDRAW        Содержит,
                                                   предоставляемое
                                                   прикладной
                                                   программой    32-ух
                                                   битовое    значение,
                                                   которое   прикладная
                                                   программа      может
                                                   использовать     для
                                                   поддержки

       Windows 3.0/Ref/2#7                                       = 20 =

                                                   дополнительных
                                                   данных  связанных  с
                                                   элементом меню.  Это
                                                   32-ух      разрядное
                                                   значение  имеется  в
                                                   распоряжении
                                                   прикладной программы
                                                   в   поле    itemData
                                                   структуры    данных,
                                                   указанной параметром
                                                   lParam     сообщений
                                                   WM_MEASUREITEM     и
                                                   WM_DRAWITEM,
                                                   посланных        при
                                                   инициализации    или
                                                   изменении   элемента
                                                   меню.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  определяется  результатом  функции.
        Это TRUE,  если функция завершена успешно.  В противном  случае
        это FALSE.

        Примечание

             Каждый раз   при   изменении  меню  (независимо  от  того,
        отображается или нет  на  экране  окно,  которому  данное  меню
        принадлежит)   прикладная   программа  должна  вызвать  функцию
        DrawMenuBar.

             Каждая из нижеприведенных групп содержит взаимоисключающие
        флаги, которые не должны использоваться вместе:

             - MF_BYCOMMAND и MF_BYPOSITION.

             - MF_DISABLED, MF_ENABLED и MF_GRAYED.

             - MF_BITMAP, MF_STRING и MF_OWNERDRAW.

             - MF_MENUBARBREAK и MF_MENUBREAK.

             - MF_CHECKED и MF_UNCHECKED.

             Ниже приведен список  возможных  значений,  которые  можно
             использовать для параметра wFlags.

             Значение         Описание
             ──────────────────────────────────────────────────────────
             MF_BITMAP        Использовать растр как элемент.   Младшее
                              слово lpNewItem   является   дескриптором

       Windows 3.0/Ref/2#7                                       = 21 =

                              растровой карты.

             MF_CHECKED       Расположить контрольную отметку рядом  с
                              элементом. Если    программа   определяет
                              собственную контрольную отметку (смотрите
                              SetMenuItemBitmap),   в  этом  случае  за
                              элементом   выводится   растровая   карта
                              включенной контрольной отметки.

             MF_DISABLED      Сделать   недоступным   элемент  (то есть
                              элемент не   может   быть   выбран)   без
                              изменения его внешнего вида.

             MF_ENABLED       Сделать доступным элемент,   разрешая его
                              выборку и восстановить его,  если он  был
                              серым.

             MF_GRAYED        Сделать   недоступным элемент  и изменить
                              его цвет  на  серый   для   того,   чтобы
                              показать, что он не может быть выбран.

             MF_MENUBARBREAK  Действие аналогично  флагу   MF_MENUBREAK
                              за исключением     того,     что      для
                              накладываемого    меню    новый   столбец
                              отделяется   от   старого    вертикальной
                              разделительной линией

             MF_MENUBREAK     Для статических меню   (типа меню-строки)
                              расположить элемент на новой строке.  Для
                              накладываемого меню расположить элемент в
                              новом столбце  без  разделительной  линии
                              между столбцами.

             MF_OWNERDRAW     Определяет, что данный  элемент программа
                              будет рисовать    самостоятельно.     При
                              исходном   отображении   элемента,  окно,
                              которому принадлежит  это  меню  получает
                              сообщение       WM_MEASHUREITEM,      для
                              определения его высоты  и  ширины.  Затем
                              при  каждом  изменении состояния элемента
                              окну  посылается  сообщение  WM_DRAWITEM.
                              Этот  флаг  не  применим  к элементу меню
                              верхнего уровня.

             MF_POPUP         Связать   накладываемое  меню с элементом
                              меню. Параметр     wIDNewItem    -    это
                              дескриптор меню.  Добавляет накладываемое
                              меню к меню верхнего уровня или каскадное
                              меню к накладываемым меню.

             MF_SEPARATOR     Рисует горизонтальную     разделительную
                              линию. Этот   флаг   можно   использовать
                              только с накладываемыми меню.  Эта  линия

       Windows 3.0/Ref/2#7                                       = 22 =

                              не может быть сделана серой,  недоступной
                              или подсвеченной.  Параметры lpNewItem  и
                              wIDNewItem игнорируются.

             MF_STRING        Использовать строку как элемент (флаг по
                              умолчанию). Параметр lpNewItem -  длинный
                              указатель  на  символьную  строку  в коде
                              ASCII, заканчивающуюся нулем.

             MF_UNCHECKED     Не располагать контрольную отметку рядом
                              с элементом.   Контрольная   отметка   не
                              используется если не  использованы  флаги
                              ни   MF_CHECKED,  ни  MF_UNCHECKED.  Если
                              программа     определяет      собственную
                              контрольную       отметку       (смотрите
                              описание функции  SetMenuItemBitmap),   в
                              этом   случае   за   элементом  выводится
                              растровая карта  выключенной  контрольной
                              отметки.


        ───────────────────────────────────────────────────────────────
                                         Arc                                   

        Синтаксис

             BOOL Arc(hDC,X1,Y1,X2,Y2,X3,Y3,X4,Y4)

             Эта функция   рисует   эллиптическую  дугу.  Центром  дуги
        является центр  ограничивающего  прямоугольника,  определяемого
        X1,   Y1,   X2  и  Y2.  Дуга  начинается  в  точке  X3,  Y3,  а
        заканчивается  в  X4,  Y4.  Дуга  рисуется,  используя  текущее
        выбранное перо,   против  часовой  стрелки.  Так  как  дуга  не
        является замкнутой фигурой, она не заливается.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDC               HDC Идентифицирует контекст устройства.

             X1                int Определяет логическую x - координату
                               верхнего  левого  угла   ограничивающего
                               прямоугольника.

             Y1                int Определяет логическую y - координату
                               верхнего  левого  угла   ограничивающего
                               прямоугольника.

             X2                int Определяет логическую x - координату
                               нижнего правого   угла   ограничивающего
                               прямоугольника.


       Windows 3.0/Ref/2#7                                       = 23 =

             Y2                int Определяет логическую y - координату
                               нижнего правого   угла   ограничивающего
                               прямоугольника.

             X3                int Определяет логическую x - координату
                               начальной точки   дуги.   Эта  точка  не
                               должна точно лежать на дуге.

             Y3                int Определяет логическую y - координату
                               начальной точки   дуги.   Эта  точка  не
                               должна точно лежать на дуге.

             X4                int Определяет логическую x - координату
                               конечной точки дуги. Эта точка не должна
                               точно лежать на дуге.

             Y4                int Определяет логическую y - координату
                               конечной точки дуги. Эта точка не должна
                               точно лежать на дуге.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение определяет была ли нарисована  дуга.
        Это не ноль если дуга нарисована. В противном случае это ноль.


        Примечание

             Ширина прямоугольника,  определяемая  абсолютным значением
        X2 - X1,  не должна превышать  32767  единиц.  Это  ограничение
        накладывается также и на высоту прямоугольника.


        ───────────────────────────────────────────────────────────────
                              ArrangeIconicWindows [3.0]                       

        Синтаксис

             WORD ArrangeIconicWindows (hWnd)

             Эта функция расставляет все  минимизированные  (  иконы  )
        дочерние окна окна, определяемого параметром hWnd.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hMwnd             HWND Определяет окно.


             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 24 =


        Возвращаемое значение

             Возвращаемое значение - это высота одного ряда  икон,  или
        ноль если иконы отсуствуют.


        Примечание

             Прикладные программы,    которые     поддерживают     свои
        собственные  иконы  дочерних  окон  вызывают  эту  функцию  для
        расположения икон в области  пользователя.  Эта  функция  также
        распологает иконы  на окне "рабочего стола",  которое покрывает
        весь экран. Функция GetDesktopWindow возвращает дескриптор окна
        "рабочего стола".

             Для расположения   икон   дочерних   окон   MDI   в   окне
        пользователя  MDI,  прикладная  программа  посылает   сообщение
        WM_MDIICONARRANGE окну пользователя MDI.


        ───────────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                       = 25 =

                              BeginDeferWindowPos [3.0]                        

        Синтаксис

             HANDLE BeginDeferWindowPos(nNumWindows)

             Эта функция  определяет  память  для  содержания структуры
        данных нескольких положений  окна  и  возвращает  дескриптор  в
        структуру.   Функция  DeferWindowPos  заполняет  эту  структуру
        данных информацией о конечной позиции для окна,  которое должно
        быть  перемещено.  Функция  EndDeferWindowPos получает доступ к
        этой структуре данных и немедленно перемещает  окно,  используя
        информацию сохраненную в этой структуре.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             nNumWindows       int Определяет  исходное  число окон для
                               которых должна быть сохранена информация
                               в      структуре     данных.     Функция
                               DeferWindowPos    увеличивает     размер
                               структуры если необходимо.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение    определяет    структуру    данных
        нескольких положений окна.  Возвращаемое значение  равно  NULL,
        если   нет   в  наличии  системных  ресурсов  для  расположения
        структуры данных.

        ───────────────────────────────────────────────────────────────
                                      BeginPaint                               

        Синтаксис

             HDC BeginPaint(hWnd,lpPaint)

             Эта функция  подготавливает  данное  окно  для рисования и
        заполняет структуру рисования,  на которую  указывает  lpPaint,
        информацией о рисовании.

             Структура рисования    содержит    дескриптор    контекста
        устройства  для  окна,  структуру  данных  RECT,   определяющую
        наименьший  прямоугольник,  который  полностью включает область
        редактирования, и флаг, определяющий очистить или нет фон.

             Функция BeginPaint  автоматически  устанавливает   область
        отсечения  контекста  устройства  для исключения любой области,
        кроме  редактируемой.  Область  редактирования  устанавливается
        функциями InvalidateRect  и  InvalidateRgn  и  системой,  после

       Windows 3.0/Ref/2#7                                       = 26 =

        изменения размеров окна,  перемещения,  создания, прокрутки или
        любой другой операции,  воздействующей на область пользователя.
        Если  область  редактирования  должна  быть  очищена,   функция
        BeginPaint посылает в окно сообщение WM_ERASEBKGND.

             Прикладная программа не должна вызывать функцию BeginPaint
        за исключением при ответе на сообщение WM_PAINT.  Каждый  вызов
        функции  BeginPaint  должен иметь соответствующий вызов функции
        EndPaint.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND Идентифицирует окно, которое должно
                               быть перерисовано.

             lpPaint           LPPAINTSTRUCT Указывает   на   структуру
                               данных PAINTSTRUCT, которая используется
                               для получения  информации  о  рисовании,
                               такой как контекст устройства для окна и
                               редактируемый прямоугольник.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  идентифицирует контекста устройства
        для специфицированного окна.

        Примечание

              Если в  области  рисования  находится  псевдокурсор,   то
        функция  BeginPaint  автоматически  делает  его  невидимым  для
        предотвращения его затирания.


        ───────────────────────────────────────────────────────────────
                                        BitBlt                                 

        Синтаксис

             BOOL BitBlt(hDestDC,X,Y,nWidth,nHeight,hSrcDC,XSrc,
                                                            YSrc,dwRop)

             Эта функция      перемещает     растровую     карту     от
        устройства-источника, определяемого   параметром   hSrcDC,    к
        устройству-приемнику,  определенному hDestDC.  Параметры XSrc и
        YSrc определяют на устройстве-источнике начало растровой карты,
        который  будет  перемещен.  Параметры  X,  Y,  nWidth и nHeight
        определяют  начало,   ширину   и   высоту   прямоугольника   на
        устройстве-приемнике,   на  котором  будет  размещена растровая
        карта. Параметр dwRop (растровая операция) определяет, как биты

       Windows 3.0/Ref/2#7                                       = 27 =

        источника и приемника будут комбинироваться.



             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDestDC           HDC  Идентифицирует контекст  устройства,
                               который будет принимать растровую карту.

             X                 int  Определяет логическую координату  х
                               верхнего левого   угла   прямоугольника,
                               принимающего изображение.

             Y                 int  Определяет логическую координату  y
                               верхнего левого   угла   прямоугольника,
                               принимающего изображение.

             nWidth            int   Определяет ширину  ( в  логических
                               единицах) прямоугольника,   принимающего
                               изображение, и исходной растровой карты.

             nHeight           int   Определяет высоту  ( в  логических
                               единицах) прямоугольника,   принимающего
                               изображение, и исходной растровой карты.

             hSrcDC            HDC Идентифицирует контекст  устройства,
                               с которого растр будет копироваться.  Он
                               может быть  NULL,  если  параметр  dwRop
                               определяет  растровую операцию,  которая
                               не включает источник.

             XSrc              int  Определяет логическую координату  х
                               верхнего левого угла исходной  растровой
                               карты.

             YSrc              int  Определяет логическую координату  y
                               верхнего левого угла исходной  растровой
                               карты.

             dwRop             DWORD Определяет  выполняемую  растровую
                               операцию.Коды  растровых  операций (ROP)
                               определяют,  как GDI комбинирует цвета в
                               операциях   вывода,   которые   включают
                               текущую кисть,  возможно растр источника
                               и    растр   приемника.   Список   кодов
                               растровых  операций  приведен  в   табл.
                               4.1, "Растровые операции".

             ──────────────────────────────────────────────────────────

        Возвращаемое значение


       Windows 3.0/Ref/2#7                                       = 28 =

             Возвращаемое значение  определяет   была   ли   нарисована
        растровая карта. Не равно 0, если растровая карта нарисована. В
        противном случае равно 0.

        Примечание

             GDI преобразует парметры nWidth и nHeigh, иногда используя
        контекст отображения приемника,  а иногда контекст  отображения
        источника.  Если результирующего пространства недостаточно,  то
        при необходимости GDI использует функцию StretchBlt для  сжатия
        или растяжения   растровой   карты   источника.   Если   растры
        приемника,  источника  и  изображения  не   имеют   одинакового
        цветного  формата,  то  BitBlt  преобразует  растры источника и
        изображения в соответствии  с  приемником.  При  преобразовании
        используются фоновые и основные цвета приемника.

             Если BitBlt  преобразует  монохромный растр в цветной,  то
        белые биты (1) устанавливаются в цвет фона, а черные биты (0) в
        основной цвет.  Используются основные и фоновые цвета контекста
        устройства приемника.  Для преобразования цвета в  монохромный,
        BitBlt  устанавливает  пиксели  цвета  фона в белый (1),  а все
        другие пиксели в черный (0).  Используются основные  и  фоновые
        цвета контекста устройства источника.

             Основной цвет   является   текущим   цветом   текста   для
        специфицированного контекста устройства,  и цвет фона  является
        для него текущим цветом фоном.

             Не все   устройства   поддерживают   функцию  BitBlt.  Для
        получения дополнительной информации смотрите растровую операцию
        RC_BITBLT  функции  GetDeviceCaps,  приведенную  позже  в  этой
        главе.


             Таблица 4.1  содержит  список  различных  кодов  растровых
        операций для параметра dwRop.


             Таблица 4.1    Растровые операции
             ──────────────────────────────────────────────────────────
             Код            Описание
             ──────────────────────────────────────────────────────────

             BLACKNESS      Делает весь вывод черным.

             DSTINVERT      Инвертирует растр приемника.

             MERGECOPY      Комбинирует изображение и растр  источника,
                            используя булевскую операцию AND.

             MERGEPAINT     Комбинирует инвертируемый растр источника с
                            растром приемника,    используя   булевскую
                            операцию OR.

       Windows 3.0/Ref/2#7                                       = 29 =


             NOTSRCCOPY     Копирует инвертированный растр источника  в
                            приемник.

             NOTSRCERASE    Инвертирует  результат комбинации   растров
                            источника и приемника, используя булевскую
                            операцию AND.

             PATCOPY        Копирует изображение в растр приемника.

             PATINVERT      Комбинирует растр приемника с изображением,
                            используя булевскую операцию OR.

             PATPAINT       Комбинирует инвертированный растр,используя
                            булевскую операцию      OR.     Комбинирует
                            результат этой    операции    с     растром
                            приемника, используя булевскую операцию OR.

             SRCAND         Комбинирует   пиксели растров  источника  и
                            приемника, используя  булевскую   операцию
                            AND.

             SRCCOPY        Копирует растр источника в растр приемника.

             SRCERASE       Инвертирует растр приемника  и  комбинирует
                            результат с  растром  источника,  используя
                            булевскую операцию AND.

             SRCINVERT      Комбинирует пиксели  растров  приемника   и
                            источника, используя   булевскую   операцию
                            XOR.

             SRCPAINT       Комбинирует  пиксели растров  приемника   и
                            источника, используя булевскую операцию OR.

             WHITENESS      Делает весь вывод белым.

             ──────────────────────────────────────────────────────────

             Полный перечень кодов растровых операций смотрите в  Главе
        11, "Двоичные  и троичные коды растровых операций",  Справочное
        Руководство, Том 2.


        ───────────────────────────────────────────────────────────────
                                   BringWindowToTop                            

        Синтаксис

             void BringWindowToTop(hWnd)

             Эта функция перемещает окно накладываемого  или  дочернего
        типа на  вершину  стека перекрывающихся окон.  В дополнение она

       Windows 3.0/Ref/2#7                                       = 30 =

        делает активным накладываемое или  дочернее  окно.  Она  должна
        использоваться  для того,  чтобы сделать видимым окно,  которое
        частично  или  полностью  закрыто   другими,   перекрывающимися
        окнами.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND Идентифицирует окно  дочернего  или
                               накладываемого типа.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсутствует.

        ───────────────────────────────────────────────────────────────
                                     BuildCommDCB                              

        Синтаксис

             int BuildCommDCB(lpDef,lpDCB)

             Эта функция  преобразует  строку  определений,  задаваемую
        параметром  lpDef,  в  соответствующие  коды  блока  управления
        устройством  и  помещает эти коды в блок,  на который указывает
        параметр lpDCB.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpDef             LPSTR Указывает        на        строку,
                               оканчивающуюся  нулем   и   определяющую
                               информацию    управления    устройством.
                               Строка должна иметь такую же форму,  как
                               параметр  строки  команды  MODE  системы
                               DOS.

             lpDCB             DCB FAR * Указывает на структуру  данных
                               DCB,     используемую    для    хранения
                               преобразованной    строки.     Структура
                               определяет      установки     управления
                               последовательным устройством связи.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  определяется  результатом  функции.
        Оно равно 0,  если строка преобразована,  и отрицательно,  если

       Windows 3.0/Ref/2#7                                       = 31 =

        имеется ошибка.

        Примечание

             Функция BuildCommDCB  заполняет  только буфер.  Прикладная
        программа  должна  вызвать  функцию  SetCommState  для   подачи
        параметров  установки  в  порт.  Также,  по умолчанию,  функция
        BuildCommDCB  определяет  Xon/Xoff  и  "плавающие"  выключатели
        аппаратуры,  как  неразрешенные.  Прикладная  программа  должна
        установить соответсвующие  поля  в  структуре  данных  DCB  для
        разрешения "плавающих" выключателей.


        ───────────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                       = 32 =

                                    CallMsgFilter                              

        Синтаксис

             BOOL CallMsgFilter(lpMsg,nCode)

             Эта функция  передает  данное  сообщение  и  код в текущую
        функцию фильтра сообщения.  Функция фильтра сообщения  является
        специфицированной   прикладной   программой  функцией,  которая
        проверяет и модифицирует все  сообщения.  Прикладная  программа
        специфицирует функцию, используя функцию SetWindowsHook.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpMsg             LPMSG Указывает на структуру данных MSG,
                               которая  содержит сообщение,  подлежащее
                               фильтрации.

             nCode             int Определяет     код,     используемый
                               функцией  фильтра  для определения того,
                               как обработать сообщение.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение    определяет   состояние   процесса
        обработки сообщения.  Оно равно TRUE,  если сообщение не должно
        обрабатываться фильтром,  и равно FALSE,  если сообщение должно
        быть обработано.

        Примечание

             Функция CallMsgFilter  обычно   вызывается   Windows   для
        позволения  прикладным  программам  контролировать  и управлять
        потоком сообщений  во  время  внутренней  обработки  в  меню  и
        панелях  прокрутки  или  при  перемещении или изменении размера
        окна.

             Значения, задаваемые   параметром   nCode,    не    должны
        конфликтовать с  любыми  значениями MSGF_ и HC_ ,  передаваемых
        Windows в функцию фильтра сообщений.


        ───────────────────────────────────────────────────────────────
                                    CallWindowProc                             

        Синтаксис

             LONG CallWindowProc(lpPrevWndFunc,hWnd,wMsg,wParam,
                                                             lParam)

       Windows 3.0/Ref/2#7                                       = 33 =


             Эта функция   передает  информацию  о  сообщении  функции,
        специфицированной   lpPrevWndFunc.    Функция    CallWindowProc
        используется  для  определения подкласса окна.  Обычно все окна
        одного и того же класса разделяют одну и ту  же  функцию  окна.
        Подкласс - это окно или набор окон, принадлежащих одному и тому
        же  классу   окна,   сообщения   которого   перехватываются   и
        обрабатываются  другой функцией (или функциями) перед тем,  как
        быть переданными функции окна данного класса.

             Функция SetWindowLong  создает  подкласс  изменяя  функцию
        окна,  связанную  с  данным  окном,  заставляя  среду  ПОЛИФЕЙС
        вызвать новую функцию окна вместо прежней.  Любое сообщение, не
        обработанное с помощью новой функции окна, должно быть передано
        предыдущей функции окна при помощи вызова  CallWindowProc.  Это
        позволяет создать цепочку функций окон.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpPrevWndFunc     FARPROC Содержит    адрес     экземпляра
                               процедуры предыдущей функции окна.

             hWnd              HWND Идентифицирует   окно,   передающее
                               сообщение.

             wMsg              WORD  Определяет номер сообщения.

             wParam            WORD Определяет           дополнительную
                               информацию, зависящую от сообщения.

             lParam            DWORD Определяет          дополнительную
                               информацию, зависящую от сообщения.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   определяет   результат   обработки
        сообщения. Возможное значение зависит от посланного сообщения.




        ───────────────────────────────────────────────────────────────
                                        Catch                                  

        Синтаксис

             int Catch(lpCatchBuf)

             Эта функция выбирает информацию о текущей среде выполнения

       Windows 3.0/Ref/2#7                                       = 34 =

        и  копирует  ее  в  буфер,  на   который   указывает   параметр
        lpCatchBuf.  Среда  выполнения  информирует  о  состоянии  всех
        системных регистров и счетчика команд.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             lpCatchBuf        (LPCATCHBUF) указывает на структуру типа
                               CATCHBUF,    в    которую     копируется
                               информация о среде выполнения.
             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращает значение определяющее скопирована ли информация
        о среде выполнения в буффер.  Равно  нулю,  если  информация  о
        среде скопирована в буфер.


             Примечание

             Функция Trrow использует буффер для  восстановления  среды
        выполнения в ее предыдущие значения.

             Функция  Catch  похожа  на  C-функцию  setjmp  (которая не
        совместима со средой Windows).


        ───────────────────────────────────────────────────────────────
                                 CangeClipboardChain                           

        Синтаксис

             BOOL CangeClipboardChain( hWnd, hWndNext )

             Эта функция удаляет окно определенное параметром  hWnd  из
        цепочки   наблюдений   за  системным  буффером  и  делает  окно
        определенное параметром hWndNext приемником  параметра  hWnd  в
        цепочке.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND    Идентифицирует   окно,   которое
                               удаляется   из    цепочки.    Дескриптор
                               предварительно   должен   быт  обработан
                               функцией SetClipboardViewer.

             hWndNext          HWND   Идентифицирует   окно,    которое
                               следует  за hWnd в цепочке наблюдений за
                               системным   буффером   (это   дескриптор
                               возвращаемый                    функцией
                               SetClipboardViewer,     если      только
                               последовательность  не  была  изменена в

       Windows 3.0/Ref/2#7                                       = 35 =

                               ответ на сообщение WM_CHANGECBCHAIN)

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращает значение определяющее состояние окна  hWnd.  Не
        ноль, если окно не найдено или удалено. Ноль, во всех остальных
        случаях.


        ───────────────────────────────────────────────────────────────
                                      ChangeMenu                               

        Синтаксис         BOOL CangeClipboardChain( hWnd, hWndNext )

             В SDK Microsoft Windows версии 3.0 эта функция заменена на
        пять специализированных функций. Вот эти функции:

             Функция           Описание
             ──────────────────────────────────────────────────────────

             AppendMenu        Добавляет объект меню в конец меню.

             Delete Menu       Удаляет объект  меню  из меню,  разрушая
                               объект меню.

             InsertMenu        Вставляет объект меню в меню.

             ModifyMenu        Изменяет объект меню в меню.

             RemoveMenu        Удаляет объект  меню  из  меню,  но   не
                               разрушая объект меню.

             ──────────────────────────────────────────────────────────

             Прикладные программы написанные для SDK версии 2.1 и более
        ранних могут продолжать вызывать ChangeMenu как и раньше. Новые
        прикладные  программы  должны  вызывать новые функции описанные
        выше.

        ───────────────────────────────────────────────────────────────
                                ChangeSelestor  [3.0]                          

        Синтаксис

             WORD ChangeSelector(wDestSelector,wSourceSelector)

             Эта  функция генерирует селектор кода, который принадлежит
        селектору данных,  или  селектор  данных,  который  принадлежит
        селектору кода.

             Параметр wDestSelector  определяет  принимающий  селектор;

       Windows 3.0/Ref/2#7                                       = 36 =

        параметр  wSourceSelector  это селектор, который предварительно
        размещен с помощью вызова функции AllocSelector. ChangeSelector
        изменяет принимающий селектор так,  что  бы  он  соответствовал
        селектору-источнику, но имел противоположные аттрибуты кода или
        данных.  Эта функция изменияет только аттрибуты селектора, а не
        значение селектора.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             wDestSelector     WORD  Опрелеляет селектор предварительно
                               размещенный   функцией    AllocSelestor,
                               которая    резервирует    селектор   для
                               перевода.

             wSourceSelector   WORD Определяет селектор, который  нужно
                               перевести.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращает значение определяющее скопирован ли и переведен
        ли селектор. Равно нулю если произошел сбой.

             Примечание

             Система Windows    не   пытается   отслеживать   изменения
        селектора-источника.  Прикладная программа должна  использовать
        переведенный селектор сразуже после того как он будет возвращен
        функцией, до любых действий с памятью.

             Прикладная  программа  не должна использовать эту функцию,
        если только без нее обойтись нельзя.

        ───────────────────────────────────────────────────────────────
                                    CheckDlgButton                             

        Синтаксис

             void CheckDlgButton(hDlg,nIDButton,wCheck)

             Эта функция помещает или  удаляет  контрольную  отметку  в
        клавишном   блоке   управления,   или  изменяет  состояние  3-х
        позиционной мягкой клавиши.  CheckDlgButton посылает  сообщение
        BM_SETCHECK   тому   клавишному  блоку  управления,  который  в
        заданной панели диалога имеет указанный ID.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDlg              HWND   Идентифицирует   панель  диалога,
                               содержащую мягкую клавишу.

       Windows 3.0/Ref/2#7                                       = 37 =


             nIDButton         int   специфицирует    клавишный    блок
                               управления,    который    должен    быть
                               модифицирован.

             wCheck            WORD определяет действие, которое должно
                               быть предпринято. Если wCheck  не  равно
                               нулю, то функция CheckDlgButton помещает
                               контрольную  отметку  в  мягкой клавише;
                               если равно нулю  -  контрольная  отметка
                               (если  она  существует)  удаляется.  Для
                               трехпозиционных  клавиш,   если   wCheck
                               равно  2, то клавиша сереет; если wCheck
                               равно 1  -  устанавливается  контрольная
                               отметка;  и  если  wCheck равно нулю, то
                               контрольная  отметка  (если  она   есть)
                               удаляется.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Отсутствует.


        ───────────────────────────────────────────────────────────────
                                    CheckMenuItem                              

        Синтаксис

             BOOL CheckMenuItem(hMenu,wIDCheckItem,wCheck)

             Эта функция   помещает  или  удаляет  контрольную  отметку
        ("галочку") элемента  накладываемого  меню,  специфицированного
        hMenu.  Параметр wIDCheckItem определяет элемент меню,  который
        будет изменен.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hMenu             HMENU идентифицирует меню.

             wIDCheckItem      WORD  определяет  элемент  меню, который
                               будет проконтролирован.

             wCheck            WORD  определяет,   как   контролировать
                               элемент   меню   и  как  определить  его
                               позицию.    Параметр    wCheck    должен
                               представлять   собой   комбиницию  флага
                               MF_CHECKED  или  MF_UNCHECKED  с  флагом
                               MF_BYPOSITION  или  MF_BYCOMMAND.  Флаги
                               должны   комбинироваться   при    помощи
                               поразрядной   оператора  OR.  Они  имеют

       Windows 3.0/Ref/2#7                                       = 38 =

                               следующие назначения:

                               Величина       Значение
                               ────────       ────────

                               MF_BYCOMMAND   Параметр     wIDCheckItem
                                              задает  ID  элемента меню
                                              (используется          по
                                              умолчанию).

                               MF_BYPOSITION  Параметр     wIDCheckItem
                                              задает  позицию  элемента
                                              меню  (первый элемент - в
                                              нулевой позиции).

                               MF_CHECKED     Добавляется   контрольная
                                              отметка.

                               MF_UNCHECKED   Контрольная       отметка
                                              удаляется.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Определяет    предыдущее    состояние    элемента.     Оно
        соответствует   либо   MF_CHECKED,   либо   MF_UNCHECKED.  Если
        возвращаемая величина равна -1, то элемента меню не существует.


             Примечание

             Параметр  wIDCheckItem  может   идентифицировать   элемент
        накладываемого  меню  также,  как  и элемент меню. Для контроля
        элемента накладываемог меню не требуется специальных шагов.

             Элементы меню верхнего уровня не могут  иметь  контрольную
        отметку.

             Элемент  налагаемого  меню должен быть отмечен позиции так
        как он не имеет идентификатора объекта меню ассоцируемого с ним.


        ───────────────────────────────────────────────────────────────
                                   CheckRadioButton                            

        Синтаксис

             void CheckRalioButton(hDlg, nIDFirstButton, nIDLastButton,
                                                        nIDCheckButton)


             Эта функция ставит на контроль мягкую  клавишу  установки,

       Windows 3.0/Ref/2#7                                       = 39 =

        специфицированную nIDCheckButton, и удаляет контрольные отметки
        со  всех  других  клавиш  установки  в  группе  мягких  клавиш,
        специфицированных     nIDFirstButton      и      nIDLastButton.
        Функция CheckRadioButton посылает  сообщение  BM_SETCHECK  тому
        блоку управления клавишей установки,  который в заданной панели
        диалога имеет указанный ID.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDlg              HWND идентифицирует панель диалога.

             nIDFirstButton    int специфицирует  идентификатор  первой
                               клавиши установки в группе.

             nIDLastButton     int     специфицирует      идентификатор
                               последней клавиши установки в группе.

             nIDCheckButton    int      содержит      значение      ID,
                               идентифицирующее   клавишу    установки,
                               которая  должна   быть   поставлена   на
                               контроль.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Отсутствует.

        ───────────────────────────────────────────────────────────────
                                 ChildWindowFromPoint                          

        Синтаксис

             HWND ChildWindowFromPoint(hWndParent,Point)

             Эта функция определяет, какое из дочерних окон  (если  оно
        вообще существует), принадлежащее заданному родительскому окну,
        содержит специфицированную точку.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWndParent        HWND идентифицирует родительское окно.

             Point             POINT определяет структуру данных POINT,
                               содержащую     координаты    точки    (в
                               координатах    пользователя),    которая
                               должна быть проверена.

             ──────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                       = 40 =

             Возвращаемое значение

             Идентифицирует дочернее окно, содержащее  точку,  и  равно
        NULL, если заданная точка лежит вне  родительского  окна.  Если
        точка находится внутри родительского  окна,  но  не  содержится
        внутри  какого-либо  дочернего  окна,  возвращается  дескриптор
        родительского окна.

        ───────────────────────────────────────────────────────────────
                                        Chord                                  

        Синтаксис

             BOOL Chord(hDC,X1,Y1,X2,Y2,X3,Y3,X4,Y4)


             Эта функция рисует хорду (область, ограниченная эллипсом и
        линейным сегментом). Параметры X1,  Y1  и  X2,  Y2  определяют,
        соответственно,   верхний   левый   и   нижний   правый    углы
        прямоугольника, ограничивающего эллипс, который является частью
        хорды. Параметры  X3,  Y3  и  X4,  Y4  определяют  начальную  и
        конечную точки  линии,  пересекающей  эллипс.  Хорда  рисуется,
        используя  текущее  выбранное  перо  и  заливается,   используя
        текущую выбранную кисть.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDC               HDC идентифицирует контекст  устройства,
                               на котором будет рисоваться хорда.

             X1                int  определяют  x  координату  верхнего
                               левого угла прямоугольника.

             Y1                int  определяют  y  координату  верхнего
                               левого угла прямоугольника.

             X2                int  определяют  x  координату   нижнего
                               правого угла прямоугольника.

             Y2                int  определяют  y  координату   нижнего
                               правого угла прямоугольника.

             X3                int определяет  x  координату  начальной
                               точки линейного сегмента.

             Y3                int определяет  y  координату  начальной
                               точки линейного сегмента.

             X4                int определяет  x  координату   конечной
                               точки линейного сегмента.


       Windows 3.0/Ref/2#7                                       = 41 =

             Y4                int определяет  y  координату   конечной
                               точки линейного сегмента.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Не равно нулю, если хорда нарисована. В  противном  случае
        равно нулю.


        ───────────────────────────────────────────────────────────────
                                    ClearCommBreak                             

        Синтаксис

             short ClearCommBreak(nCid)


             Эта функция  возобновляет  передачу  символа  и  переводит
        линию передачи в рабочий режим.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             nCid              int определяет устройство связи,  работа
                               которого   будет    возобновлена.    Эту
                               величину возвращает функция OpenComm.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Равно нулю,  если  функция  была  завершена  успешно.  Оно
        отрицательно,  если  параметр  nCid   определяет   некорректное
        устройство.

        ───────────────────────────────────────────────────────────────
                                    ClientToScreen                             

        Синтаксис

             void ClientToScreen(hWnd,lpPoint)

             Эта  функция  преобразует  координаты   пользователя   для
        заданной  точки  на  экране,  в  координаты   экрана.   Функция
        ClientToScreen использует координаты клиента в структуре данных
        POINT, на которую указывает параметр  lpPoint,  для  вычисления
        новых координат экрана; затем эта функция замещает координаты в
        структуре на новые.  Новые  координаты  экрана  устанавливаются
        относительно верхнего левого угла экрана системного дисплея.


       Windows 3.0/Ref/2#7                                       = 42 =

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND идентифицирует дескриптор окна.

             lpPoint           LPPOINT указывает  на  структуру  данных
                               POINT, содержащую             координаты
                               пользователя,     которые     необходимо
                               преобразовать.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Отсутствует.

             Примечание

             Функция  ClientToScreen  предполагает,  что  данная  точка
        задана в координатах пользователя и располагается  относительно
        заданного окна.


        ───────────────────────────────────────────────────────────────
                                      ClipCursor                               

        Синтаксис

             void ClipCursor(lpRect)

             Эта  функция  используется  для   ограничения   системного
        курсора заданным прямоугольником на  экране.  Если  последующая
        позиция курсора, заданная функцией  SetCursorPos  или  "мышью",
        лежит вне прямоугольника, Windows  автоматически  устанавливает
        позицию так,  чтобы  курсор  находился  внутри.  Если  параметр
        lpRect равен NULL, курсор может использовать полный экран.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpRect            LPRECT  указывает  на  структуру  данных
                               RECT, которая    содержит     координаты
                               верхнего  левого и нижнего правого углов
                               ограничивающего    прямоугольника     (в
                               координатах экрана).

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Отсутствует.

             Примечание


       Windows 3.0/Ref/2#7                                       = 43 =

             Системный курсор является разделяемым ресурсом. Прикладная
        программа,     которая     ограничивает     курсор     заданным
        прямоугольником,  должна   освободить   его   перед   передачей
        управления другой прикладной программе.


        ───────────────────────────────────────────────────────────────
                                                                               
       CloseClipboard

        Синтаксис

             BOOL CloseClipboard( )

             Эта   функция   закрывает   системный    буфер.    Функция
        CloseClipboard должна быть вызвана тогда, когда окно  закончило
        проверку или изменение системного буфера. Она позволяет  другим
        прикладным программам получить доступ к системному буферу.

             Эта функция не имеет параметров.

             Возвращаемое значение

             Не равно нулю, если системный буфер  закрыт.  В  противном
        случае равно нулю.

        ───────────────────────────────────────────────────────────────
                                      CloseComm                                

        Синтаксис

             short CloseComm(nCid)

             Эта  функция  закрывает  устройство  связи,   определяемое
        параметром nCid и освобождает память,  выделенную  под  очереди
        передачи и приема устройства.  Все  символы  в  очереди  вывода
        (передачи) посылаются перед тем,  как  устройство  связи  будет
        закрыто.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             nCid              int  определяющее  устройство,   которое
                               будет закрыто.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Равно 0, если устройство закрыто. Оно  отрицательно,  если
        имеются ошибки.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 44 =

                                                                               
       CloseMetaFile

        Синтаксис

             HANDLE CloseMetaFile(hDC)

             Эта функция  закрывает  контекст  устройства  метафайла  и
        создает дескриптор метафайла, который может быть  применен  для
        вывода метафайла с помощью функции PlayMetaFile.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDC               HANDLE Идентифицирует контекст устройства
                               закрываемого                  метафайла.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение    идентифицирует   метафайл,   если
        функция выполнилась успешно. В противном случае равно NULL.

        ───────────────────────────────────────────────────────────────
                                                                               
       CloseSound

        Синтаксис

             void CloseSound()

             Эта функция закрывает доступ к громкоговорителю прикладной
        программы  и  делает  его  доступным   для   открытия   другими
        программами.  Функция  CloseSound  сбрасывает   все   голосовые
        очереди  и  освобождает  любые  буфера,  выделенные  для   этих
        очередей.

             Эта функция не имеет параметров.

             Возвращаемое значение

             Отсутствует.

        ───────────────────────────────────────────────────────────────
                                     CloseWindow                               

        Синтаксис

             void CloseWindow(hWnd)

             Эта функция делает  иконой  специфицированное  окно.  Если
        окно является перекрывающимся окном, оно преобразуется в икону,
        при этом удаляется с  экрана  дисплея  область  пользователя  и
        заголовок открытого окна, а икона перемещается в  область  икон
        на экране.

       Windows 3.0/Ref/2#7                                       = 45 =


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND идентифицирует окно, которое должно
                               быть иконой.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Отсутствует.

             Примечание

             Эта функция не имеет смысла, если параметр  hWnd  является
        дескриптором накладываемого или дочернего окна.

        ───────────────────────────────────────────────────────────────
                                      CombineRgn                               

        Синтаксис

             short CombineRgn(hDestRgn,hSrcRgn1,hSrcRgn2,nCombineMode)

             Эта  функция  создает  новую   область,   комбинируя   две
        существующие  области.  Способ,  применяемый   для   комбинации
        областей, определяется параметром nCombineMode.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDestRgn          HRGN     идентифицирует     существующую
                               область, которая будет заменена на новую
                               область.

             hSrcRgn1          HRGN     идентифицирует     существующую
                               область.

             hSrcRgn2          HRGN     идентифицирует     существующую
                               область.

             nCombineMode      short определяет  операцию,  совершаемую
                               над двумя существующими  областями.  Она
                               может быть одной из приведенных ниже:


                               Величина       Значение
                               ────────       ────────
                               RGN_AND        Используются
                                              перекрывающиеся      зоны
                                              обеих            областей
                                              (пересечение)

       Windows 3.0/Ref/2#7                                       = 46 =


                               RGN_COPY       Создается копия Области 1
                                              (идентифицируемая
                                              параметром hSrcRgn1)

                               RGN_DIFF       Сохраняются зоны  Области
                                              1       (идентифицируемая
                                              параметром     hSrcRgn1),
                                              которые    не    являются
                                              зонами     Области      2
                                              (идентифицируемая
                                              параметром hSrcRgn2)

                               RGN_OR         Объединяются   все   зоны
                                              обеих            областей
                                              (объединение)

                               RGN_XOR        Объединяются
                                              неперекрывающиеся    зоны
                                              обеих областей

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение определяет тип новой области.  Может
        быть одним из следующих:

             Величина          Значение
             ────────          ────────

             COMPLEXREGION     Новая    область     отсечения     имеет
                               перекрываемые границы.

             ERROR             Новая область не создана.

             NULLREGION        Новая область отсечения пуста.

             SIMPLEREGION      Новая   область   отсечения   не   имеет
                               перекрываемых границ.

             ──────────────────────────────────────────────────────────

             Примечание

             Параметр  hDestRgn  не  проверяет  существование  области,
        прикладная  программа  должна  обработать  дальний   указатель,
        предварительно разместив HRGN как параметр hDestrgn.



        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 47 =

                                     CopyMetaFile                              

        Синтаксис

             HANDLE CopyMetaFile(hSrcMetaFile,lpFilename)

             Эта функция копирует исходный метафайл в  файл,  указанный
        посредством  параметра  lpFilename,  и  возвращает   дескриптор
        нового метафайла. Если параметр lpFilename  равен  0,  источник
        копируется в метафайл памяти.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hSrcMetaFile      HANDLE идентифицирует исходный метафайл.

             lpFilename        LPSTR указывает на оканчивающуюся  нулем
                               символьную  строку,   определяющую   имя
                               файла, в который копируется метафайл.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Идентифицирует новый метафайл.

        ───────────────────────────────────────────────────────────────
                                       CopyRect                                

        Синтаксис

             int CopyRect(lpDestRect,lpSourceRect)

             Эта   функция   копирует    прямоугольник,    определяемый
        параметром lpSourceRect,  в  структуру  данных  типа  RECT,  на
        которую указывает параметр lpDestRect.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpDestRect        LPRECT  указывает  на  структуру  данных
                               типа RECT.

             lpSourceRect      LPRECT  указывает  на  структуру  данных
                               типа RECT.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Хотя  эта  функция  возвращает  целое  значение,  оно   не
        используется и не имеет смысла.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 48 =

                                                                               
       CountClipboardFormats

        Синтаксис

             int CountClipboardFormats( )

             Эта   функция   возвращает   число    форматов,    которые
        поддерживает системный буфер.

             Эта функция не имеет параметров.

             Возвращаемое значение

             Возвращаемое значение  определяет  число форматов данных в
        системном буфере.

        ───────────────────────────────────────────────────────────────
                                                                               
       CountVoiceNotes

        Синтаксис

             int CountVoiceNotes(nVoice)

             Эта функция возвращает значение счетчика количества нот  в
        указанной очереди. Подсчитываются  только  те  записи  очереди,
        которые являются результатом вызова функции SetVoiceNote.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             nVoice            int  Определяет  голосовую  очередь,   в
                               которой  должен   проводиться   подсчет.
                               Первая голосовая очередь имеет номер 1.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Определяет количество нот в данной очереди.

        ───────────────────────────────────────────────────────────────
                                     CreateBitmap                              

        Синтаксис

          HBITMAP CreateBitmap(nWidth,nHеight,nPlanes,nBitCount,lpBits)

             Эта   функция    создает    растровую    карту,    имеющую
        соответствующую ширину, высоту и битовый  шаблон.  Впоследствии
        эта карта с помощью функции SelectObject может быть выбрана как
        текущая карта для отображения памяти.

             Хотя  растровая  карта  не  может   непосредственно   быть

       Windows 3.0/Ref/2#7                                       = 49 =

        скопирована на устройство  отображения,  функция  BitBlt  может
        копировать ее из контекста отображения памяти  (в  котором  она
        является  текущей  растровой  картой)  на   любое   совместимое
        устройство.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             nWidth            int Определяют ширину растровой  карты
                               в пикселях.

             nHеight           int Определяют высоту растровой карты  в
                               пикселях.

             nPlanes           BYTE Определяет число цветовых планов  в
                               растровой  карте.  Каждый   план   имеет
                               nWidth*nHеight*nBitCount битов.

             nBitCount         BYTE Определяет число цветовых битов для
                               пикселя изображения.

             lpBits            LPSTR  Указывает  на   массив   коротких
                               целых,  содержащий  начальные   значения
                               битов растровой  карты.  Если   параметр
                               lpBits  равен  NULL,  то новая растровая
                               карта   остается   неинициализированной.
                               Более  полная информация дана в главе 7,
                               "Типы и структуры  данных",  Справочного
                               руководства, Том 2.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение идентифицирует растровую карту, если
        функция выполнилась успешно. В противном случае равно NULL.

        ───────────────────────────────────────────────────────────────
                                 CreateBitmapIndirect                          

        Синтаксис

             HBITMAP CreateBitmapIndirect(lpBitmap)

             Эта  функция  создает  растровую  карту,  имеющую  ширину,
        высоту и битовый шаблон, содержащиеся в  структуре  данных,  на
        которую указывает параметр lpBitmap. Хотя эта  карта  не  может
        быть непосредственно выбрана для  устройства  отображения,  она
        может быть выбрана как текущая карта для отображения памяти,  и
        скопирована  на  любое   устройство,   совместимое   с   данным
        устройством отображения, используя функцию BitBlt.


       Windows 3.0/Ref/2#7                                       = 50 =

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpBitmap          BITMAP  FAR  *  Указывает  на  структуру
                               данных BITMAP,      которая     содержит
                               информацию о растровой карте.
             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Идентифицирует растровую карту, если  функция  выполнилась
        успешно. В противном случае равно NULL.

        ───────────────────────────────────────────────────────────────
                                 CreateBrushIndirect                           

        Синтаксис

             HBRUSH CreateBrushIndirect(lpLogBrush)

             Эта функция создает логическую кисть, имеющую тип, цвет  и
        шаблон, содержащиеся в структуре данных, на  которую  указывает
        параметр lpLogBrush. Кисть может быть затем выбрана как текущая
        кисть для любого устройства.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpLogBrush        LOGBRUSH FAR *  Указывает  на  структуру
                               данных LOGBRUSH,    которая     содержит
                               информацию о кисти.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение  идентифицирует кисть,  если функция
        выполнилась успешно. В противном случае равно NULL.

             Примечание

             Кисть создается,  используя одноцветную  (одноплановую,  с
        одним  битом на пиксель) растровую карту и рисуется,  используя
        текущий цвет для текста и фона.  Пиксель, представленный битом,
        установленным  в  ноль,  рисуется  цветом  текста,  а  пиксель,
        представленный битом, установленным в 1, рисуется цветом фона.


        ───────────────────────────────────────────────────────────────
                                     CreateCaret                               

        Синтаксис

             void CreateCaret(hWnd,hBitmap,nWidth,nHеight)

       Windows 3.0/Ref/2#7                                       = 51 =


             Эта  функция  создает  новое  очертание   для   системного
        псевдокурсора и передает этот псевдокурсор данному окну. Формой
        спевдокурсора может  быть  линия,  блок  или  растровая  карта,
        определенная параметром hBitmap. Если параметр hBitmap является
        дескриптором растровой карты,  то параметры  nWidth  и  nHeight
        игнорируются;  растровая  карта  сама  определяет  его ширину и
        высоту.  (Дескриптор растровой карты должен быть предварительно
        создан  с  помощью  функции  CreateBitmap,  CreateDIBitmap  или
        LoadBitmap.) Если параметр hBitmap равен NULL или 1,  то ширине
        и высоте псевдокурсора присваиваются значения параметров nWidth
        и nHeight (в логических единицах); конкретные значения ширины и
        высоты зависят от режима работы Windows.

             Если параметры nWidth и nHeght равны  нулю,  то  ширине  и
        высоте псевдокурсора присваиваются  значения  ширины  и  высоты
        системных границ окна. Использование  ширины  и  высоты  границ
        окна гарантирует, что псевдокурсор будет  отображен  с  высоким
        разрешением.

             Функция   CreateCaret   автоматически   разрушает    форму
        предыдущего псевдокурсора,  не  считаясь  с  тем,  кто  владеет
        псевдокурсором.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND   Идентифицирует   окно,    которое
                               владеет  псевдокурсором.

             hBitmap           HBITMAP Идентифицирует растровую   карту
                               которая определяет  форму псевдокурсора.
                               Если параметр  hBitmap  равен  NULL,  то
                               псевдокурсор   сплошной.  Если  параметр
                               hBitmap равен 1, то псевдокурсор серый.

             nWidth            int   Определяет ширину псевдокурсора (в
                               логических единицах).

             nHeight           int   Определяет высоту псевдокурсора (в
                               логических единицах).

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Отсутствует.

             Примечание

             Системный псевдокурсор это разделяемый ресурс. Окно должно
        создавать окно  имеет  фокус  ввода  или  активно.  Оно  должно

       Windows 3.0/Ref/2#7                                       = 52 =

        разрушать псевдокурсор перед тем как  отдать  фокус  ввода  или
        перед тем как стать не активным.

            Ширина  или  высота  системной  границы  окна  может   быть
        восстановлена с помощью функции  GetSystemMetrics  с  индексами
        SM_CXBORDER и SM_CYWORDER.


        ───────────────────────────────────────────────────────────────
                                CreateCompatibleBitmap                         

        Синтаксис

             HBITMAP CreateCompatibleBitmap(hDC,nWidth,nHeight)

             Эта  функция  создает  растровую  карту,   совместимую   с
        устройством, определяемым параметром hDC. Эта карта имеет то же
        число цветовых планов  или  формат  битов  на  пиксель,  что  и
        специфицированное устройство. Эта карта может быть выбрана  как
        текущая для любого устройства памяти, совместимого с hDC.

             Если параметр   hDC   -  контекст  устройства  памяти,  то
        растровая  карта  возвращается,  имея  формат,  совпадающий   с
        текущей выбранной картой в этом контексте устройства.  Контекст
        устройства памяти - это блок памяти, который представляет экран
        дисплея.  Он  может быть использован для подготовки изображения
        перед  копированием   его   на   экран   дисплея   совместимого
        устройства.

             Когда   создается   контекст   устройства   памяти,    GDI
        автоматически выбирает для него монохромную карту.

             Поскольку цветовой контекст устройства памяти может  иметь
        текущую цветовую или монохромную карту, формат растровой карты,
        возвращаемый CreateCompatibleBitmap, не всегда одинаков; однако
        формат совместимой растровой  карты  для  контекста  устройства
        (кроме контекста устройства памяти) всегда задается  в  формате
        устройства.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDC               HDC Идентифицирует контекст устройства.

             nWidth            int Определяют высоту растровой карты  в
                               битах.

             nHеight           int Определяют ширину растровой карты  в
                               битах.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

       Windows 3.0/Ref/2#7                                       = 53 =


             Возвращаемое значение идентифицирует растровую карту, если
        функция выполнилась успешно. В противном случае равно NULL.


        ───────────────────────────────────────────────────────────────
                                  CreateCompatibleDC                           

        Синтаксис

             HDC CreateCompatibleDC(hDC)

             Эта функция создает контекст  устройства  памяти,  который
        совместим с устройством, определяемым параметром hDC.  Контекст
        устройства памяти является блоком памяти, который  представляет
        поверхность экрана. Он может быть  использован  для  подготовки
        образов в памяти перед  тем,  как  скопировать  на  поверхность
        отображения совместимого устройства.

             Когда контекст устройства памяти создан, GDI автоматически
        выбирает для него монохромный растр.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDC               HDC Идентифицирует контекст  устройства.
                               Если hDC равен нулю, то функция  создает
                               контекст устройства памяти,  совместимый
                               с системным дисплеем.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Соответствует новому  контексту  устройства  памяти,  если
        функция выполняется успешно. В противном случае оно равно нулю.

             Примечание

             Эта функция может быть использована  только  для  создания
        совместимых  контекстов  устройств,  поддерживающих   растровые
        операции.  Для  дополнительной  информации   смотрите   функцию
        GetDeviceCaps и флаг RC_BITBLT, которые описаны  позже  в  этой
        главе.

             Функции вывода GDI могут быть  использованы  с  контекстом
        устройства памяти только в том случае, если растр был создан  и
        выбран в этом контексте.

             Когда прикладной программе больше  не  требуется  контекст
        устройства,  она  должна  освободитьь  его  с  помощью  функции
        DeleteDC.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 54 =

                                 CreateCursor   [3.0]                          

        Синтаксис

             HCURSOR  CreateCursor(  hInstance,  nXhotspot,  nYhotspot,
                          nWidth, nHeight, lpANDbitPlan, lpXORbitplan )

             Эта функция создает  курсор,  который  имеет  определенную
        ширину, высоту и битовые параметры.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hInstance         HANDLE   Определяет   экземпляр   модуля
                               создания курсора.

             nXhotspot         int  Определяет  горизонтальную  позицию
                               курсора.

             nYhotspot         int  Определяет   вертикальную   позицию
                               курсора.

             nWidth            int Определяет ширину курсора в пикселях.


             nHeight           int Определяет высоту курсора в пикселях.


             lpANDbitPlan      LPSTR  Указывает   на   массив   байтов,
                               содержащих битовые  значения  AND  маски
                               курсора.    Это    могут    быть    биты
                               аппаратно-независимой        одноцветной
                               растровой карты.

             lpXORbitplan      LPSTR  Указывает   на   массив   байтов,
                               содержащих битовые  значения  XOR  маски
                               курсора.    Это    могут    быть    биты
                               аппаратно-независимой        одноцветной
                               растровой карты.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемая величина идентифицирует курсор,  если  работа
        функции прошла нормально. Во всех остальных случаях NULL.

        ───────────────────────────────────────────────────────────────
                                       CreateDC                                

        Синтаксис

             HDC  CreateDC(lpDriverName,lpDeviceName,lpOutput,

       Windows 3.0/Ref/2#7                                       = 55 =

                                                           lpInitData)

             Эта  функция  создает   контекст   заданного   устройства.
        Параметры  lpDriverName,  lpDeviceName  и  lpOutput  определяют
        драйвер устройства, имя устройства и  физическую  среду  вывода
        (файл или порт), соответственно.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpDriverName      LPSTR Указывает на оканчивающуюся  нулем
                               символьную  строку,   определяющую   имя
                               файла    драйвера    устройства,     без
                               расширения (например, Epson (R)).

             lpDeviceName      LPSTR Указывает на оканчивающуюся  нулем
                               символьную  строку,   определяющую   имя
                               поддерживаемого   устройства   (например
                               Epson     FX-80).     Этот      параметр
                               используется, если  модуль  поддерживает
                               больше одного устройства.

             lpOutput          LPSTR Указывает на оканчивающуюся  нулем
                               символьную строку, определяющую файл DOS
                               или  имя  устройства  физической   среды
                               вывода (файл или порт вывода).

             lpInitData        LPDEVMODE Указывает на структуру  данных
                               DEVMODE содержащую дпнные  инициализации
                               для   драйвера   заданного   устройства.
                               Параметр lpInitData  должен  быть  равен
                               нулю, если драйвер устройства использует
                               инициализацию  по  умолчанию  (если  она
                               необходима), заданную через панель блока
                               управления.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение  cоответствует контексту устройства,
        если функция завершена успешно. В противном случае равно нулю.

             Примечание

             Соглашения  по  именам   устройств   подчинены   правилам,
        принятым в DOS, а именно: имя оканчивается  двоеточием,  причем
        это правило не обязательное, но рекомендуемое. Windows отделяет
        завершающее двоеточие, так что  имя  устройства,  завершающееся
        двоеточием, преобразуется в  такой  же  порт,  что  и  имя  без
        двоеточия. Имена драйвера и порта не должны содержать пробелы в
        начале и в конце.
        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 56 =

                                     CreateDialog                              

        Синтаксис

             HWND  CreateDialog(hInstance,lpTemplateName,hWndParent,
                                                          lpDialogFunc)

             Эта  функция  создает  бестипную  панель  диалога.  Шаблон
        диалога, заданный lpTemplateName,  определяет  атрибуты  панели
        диалога такие,  как  размер,  тип и блоки управления.  Параметр
        hWndParent идентифицирует окно  прикладной  программы,  которое
        обладает панелью диалога. Диалоговая функция, специфицированная
        параметром lpDialogFunc,    обрабатывает    любые    сообщения,
        получаемые панелью диалога.

             Функция CreateDialog посылает  сообщение  WM_INITDIALOG  в
        функцию  диалога  перед  индицированием  панели  диалога.   Это
        сообщение дает указание функции диалога инициализировать  блоки
        управления панели диалога.

             Функция  CreateDialog  после   создания   панели   диалога
        немедленно возвращает управление. Она не ожидает,  пока  панель
        диалога начнет обработку входной информации.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hInstance         HANDLE Идентифицирует экземпляр  модуля,
                               выполняемый   файл   которого   содержит
                               шаблон диалога.

             lpTemplateName    LPSTR  Указывает  на  строку   символов,
                               именующую  шаблон  диалога.  Эта  строка
                               должна  быть  строкой  символов  в  коде
                               ASCII, заканчивающейся нулем.

             hWndParent        HWND  Идентифицирует  окно,   обладающее
                               панелью диалога.

             lpDialogFunc      FARPROC   Содержит   адрес    экземпляра
                               функции панели диалога.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение -  это  дескриптор  панели  диалога.
        Равно NULL, если панель диалога не может быть создана.

             Примечание


       Windows 3.0/Ref/2#7                                       = 57 =

             Если панель диалога должна появиться в  родительском  окне
        сразу после его создания, то для шаблона  диалога  используется
        тип WS_VISIBLE.

             Для  разрушения  панели  диалога,  созданной  при   помощи
        функции CreateDialog, используется функция DestroyWindow.

             Панель диалога может содержать до 255 блоков управления.

             Функция   многократного   вызова    должна    использовать
        соглашения по вызову системы Pascal и быть объявлена  как  FAR.

             Функция   многократного   вызова

             BOOL FAR PASCAL DialogFunc(hWnd,wMsg,wParam,lParam)
             HWND hDlg;
             WORD wMsg;
             WORD wParam;
             DWORD lParam;

             Здесь  DialogFunc  используется  вместо   имени   функции,
        предоставляемой прикладной пограммой.  Фактическое  имя  должно
        быть  экспортировано  посредством  включения  его  в   оператор
        EXPORTS файла определения модуля прикладной программы.

             Параметры         Определение
             ──────────────────────────────────────────────────────────

             hDlg              Идентифицирует панель  диалога,  которая
                               принимает сообщения.

             wMsg              Определяет   номер   сообщения.

             wParam            Содержит 16 бит  добавочной  информации,
                               зависящей от сообщения.

             lParam            Содержит 32 бит  добавочной  информации,
                               зависящей от сообщения.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             В ответ на сообщение WM_INITDIALOG, функция диалога должна
        возвратить  значение,  которое  не  равно  нулю,  если  функция
        обработала сообщение и равно нулю в противоположном  случае.  В
        ответ  на  сообщение  WM_INITDIALOG,  функция  диалога   должна
        возвратить значение, которое  равно  нулю,  если  она  вызывает
        функцию SetFocus для установки фокуса ввода в  один  из  блоков
        управления в панели диалога. Во  всех  остальных  случаях,  она
        должна возвратить ненулевое значение, в случае которого Windows
        установит  фокус  ввода  в  первый  блок  управления  в  панели
        диалога, в который может быть помещен фокус ввода.

       Windows 3.0/Ref/2#7                                       = 58 =


             Примечания

             Функция диалога используется только  в  том  случае,  если
        панель диалога имеет класс диалога. Это класс по  умолчанию,  и
        используется  тогда,  когда  в  шаблоне   диалога   не   указан
        какой-либо   определенный   класс.   Хотя    функция    диалога
        представляет собой просто функцию окна, она не  может  вызывать
        функцию DefWindowProc для  обработки  "неожидаемых"  сообщений.
        "Неожидаемые"  сообщения  обрабатываются  внутри  функции  окна
        класса диалога.

             Адрес   функции   диалога,   посылаемый    как    параметр
        lpDialogFunc,   должен   быть   создан   с   помощью    функции
        MakeProcInstance.


        ───────────────────────────────────────────────────────────────
                                 CreateDialogIndirect                          

        Синтаксис

             HWND   CreateDialogIndirect(hInstance,lpDialogTemplate,
                                               hWndParent,lpDialogFunc)

             Эта функция  создает  бестипную  панель  диалога,  которая
        имеет размер,  тип  и  блоки  управления,  определяющие  шаблон
        панели   диалога,   задаваемый   параметром   lpDialogTemplate.
        Параметр hWndParent идентифицирует окно  прикладной  программы,
        которое  владеет  панелью  диалога.  Функция диалога,  заданная
        параметром   lpDialogFunc,   обрабатывает   любые    сообщения,
        посылаемые панелью диалога.

             Функция    CreateDialogIndirect     посылает     сообщение
        WM_INITDIALOG  функции  диалога   перед   отображением   панели
        диалога.    Это    сообщение    позволяет    функции    диалога
        инициализировать блоки управления панели диалога.

             Функция CreateDialogIndirect  завершается  непосредственно
        после создания панели диалога. Она не ожидает начала  обработки
        ввода для панели диалога.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hInstance         HANDLE Идентифицирует экземпляр  модуля,
                               выполняемый   файл   которого   содержит
                               шаблон панели диалога.

             lpDialogTemplate  LPSTR  Указывает  на  структуру  шаблона
                               панели диалога.

             hWndParent        HWND   Идентифицирует   окно,    которое

       Windows 3.0/Ref/2#7                                       = 59 =

                               владеет панелью диалога.

             lpDialogFunc      FARPROC   Содержит   адрес    экземпляра
                               процедуры панели диалога.

           ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение   идентифицирует   дескриптор   окна
        панели диалога.  Оно равно NULL,  если функция не может создать
        либо панель диалога,  либо  любые  блоки  управления  в  панели
        диалога.

             Примечание

             Используйте режим WS_VISIBLE  в  шаблоне  панели  диалога,
        если панель диалога должна появиться в родительском окне  сразу
        после его создания.

             Панель диалога может содержать до 255 блоков управления.

             Функция   многократного   вызова    должна    использовать
        соглашение по вызову системы Паскаль и  должна  быть  объявлена
        FAR.

        Функция многократного вызова


             BOOL FAR PASCAL DialogFunc(hWnd,wMsg,wParam,lParam)
             HWND hDlg;
             WORD wMsg;
             WORD wParam;
             DWORD lParam;

             DialogFunc    является    полем    шаблона    для    имени
        функции,предоставляемой прикладной программой. Фактическое  имя
        должно  быть  экпортировано  путем  включения  его  в  оператор
        EXPORTS в файл определения модуля прикладной программы.

             Параметры         Определение
             ──────────────────────────────────────────────────────────
             hDlg              Идентифицирует панель  диалога,  которая
                               принимает сообщения.

             wMsg              Определяет   номер   сообщения.

             wParam            Содержит 16 бит  добавочной  информации,
                               зависящей от сообщения.

             lParam            Содержит 32 бит  добавочной  информации,
                               зависящей от сообщения.
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 60 =


             Возвращаемое значение

             В ответ на сообщение WM_INITDIALOG, функция диалога должна
        возвратить  значение,  которое  не  равно  нулю,  если  функция
        обработала сообщение и равно нулю в противоположном  случае.  В
        ответ  на  сообщение  WM_INITDIALOG,  функция  диалога   должна
        возвратить значение, которое  равно  нулю,  если  она  вызывает
        функцию SetFocus для установки фокуса ввода в  один  из  блоков
        управления в панели диалога. Во  всех  остальных  случаях,  она
        должна возвратить ненулевое значение, в случае которого Windows
        установит  фокус  ввода  в  первый  блок  управления  в  панели
        диалога, в который может быть помещен фокус ввода.

             Примечания

             Функция диалога используется только  в  том  случае,  если
        панель диалога имеет класс диалога. Это класс по  умолчанию,  и
        используется  тогда,  когда  в  шаблоне   диалога   не   указан
        какой-либо   определенный   класс.   Хотя    функция    диалога
        представляет собой просто функцию окна, она не  может  вызывать
        функцию DefWindowProc для  обработки  "неожидаемых"  сообщений.
        "Неожидаемые"  сообщения  обрабатываются  внутри  функции  окна
        класса диалога.

             Адрес   функции   диалога,   посылаемый    как    параметр
        lpDialogFunc,   должен   быть   создан   с   помощью    функции
        MakeProcInstance.


        ───────────────────────────────────────────────────────────────
                          CreateDialogIndirectParam   [3.0]                    

        Синтаксис

            HWND CreateDialogIndirectParam(hInstance,lpDialogTemplate,
                                 hWndParent, lpDialogFunc, dwInitParam)

             Эта функция создает  бестипную  панель  диалога,  посылает
        сообщение WM_INITDIALOG в функцию  диалога  перед  отображением
        панели диалога,  и передает параметр dvInitParam как  сообщение
        lParam.     Это    сообщение    позволяет    функции    диалога
        инициализировать  блоки  управления  панели  диалога.  Во  всем
        остальном, эта функция идентична функции CreateDialogIndirect.

             Для получения   дополнительной   информации   о   создании
        бестипной   панели   диалога    смотрите    описание    функции
        CreateDialogIndirect.


       Windows 3.0/Ref/2#7                                       = 61 =

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hInstance         HANDLE Идентифицирует экземпляр  модуля,
                               выполняемый   файл   которого   содержит
                               шаблон панели диалога.

             lpDialogTemplate  LPSTR Указывает на блок памяти, который
                               содержит структуру данных DLGTEMPLATE.

             hWndParent        HWND   Идентифицирует   окно,    которое
                               владеет панелью диалога.

             lpDialogFunc      FARPROC   Содержит   адрес    экземпляра
                               процедуры  панели  диалога.  Для   более
                               конкретной  информации  смотрите  раздел
                               "Комментарии"   в    описании    функции
                               CreateDialogIndirect.

             dwInitParam       DWORD  32-ух битовое  значение,  которое
                               функция        CreateDialogIndirectParam
                               передает  функции  диалога,  когда   она
                               создает панель диалога.
             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение это дескриптор окна панели  диалога.
        Оно равно NULL  если  функция  не  может  создать  либо  панель
        диалога либо блок управления в панели диалога.


        ───────────────────────────────────────────────────────────────
                              CreateDialogParam   [3.0]                        

        Синтаксис

             HWND CreateDialogParam(hInstance,lpTemplateName,
                                 hWndParent, lpDialogFunc, dwInitParam)

             Эта функция создает  бестипную  панель  диалога,  посылает
        сообщение WM_INITDIALOG в функцию  диалога  перед  отображением
        панели диалога,  и передает параметр dvInitParam как  сообщение
        lParam.     Это    сообщение    позволяет    функции    диалога
        инициализировать  блоки  управления  панели  диалога.  Во  всем
        остальном, эта функция идентична функции CreateDialog.

             Для дополнительной информации о создании бестипной  панели
        диалога смотрите описание функции CreateDialog.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hInstance         HANDLE Идентифицирует экземпляр  модуля,
                               выполняемый   файл   которого   содержит

       Windows 3.0/Ref/2#7                                       = 62 =

                               шаблон панели диалога.

             lpTemplateName    LPSTR  Указывает  на  строку   символов,
                               являющейся   именем    шаблона    панели
                               диалога. Эта строка должна заканчиваться
                               нулевым символом.

             hWndParent        HWND   Идентифицирует   окно,    которое
                               владеет панелью диалога.

             lpDialogFunc      FARPROC   Содержит   адрес    экземпляра
                               процедуры  панели  диалога.  Для   более
                               конкретной  информации  смотрите  раздел
                               "Комментарии"   в    описании    функции
                               CreateDialogIndirect.

             dwInitParam       DWORD  32-ух битовое  значение,  которое
                               CreateDialogIndirectParam       передает
                               функции  диалога,  когда   она   создает
                               панель диалога.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение это дескриптор окна панели  диалога.
        Оно равно -1 если функция не может создать панель диалога.


        ───────────────────────────────────────────────────────────────
                                 CreateDIBitmap [3.0]                          

        Синтаксис

             HBITMAP  CreateDIBitmap(hDC,lpInfoHeader,dwUsage,
                                          lpInitBits,lpInitInfo,wUsage)

             Эта  функция  создает  растровую  карту  для   конкретного
        устройства  из  спецификации  аппаратно-независимой   растровой
        карты (DIB) и, возможно, устанавливает биты  в  этой  растровой
        карте.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDC               HDC  Идентифицирует контекст устройства.

             lpInfoHeader      LBITMAPINFOHEADER Указывает на структуру
                               данных     BITMAPINFOHEADNR,     которая
                               описывает      размер      и      формат
                               аппаратно-независимой растровой карты.

             dwUsage           Показывает, должна  ли   растровая карта

       Windows 3.0/Ref/2#7                                       = 63 =

                               быть инициализирована.   Если   параметр
                               dwUsage установлен   в   CBM_INIT,    то
                               CreateDIBitmap   будет  инициализировать
                               растровую  карту  битами,  определенными
                               параметрами lpInitBits и lpInitInfo.

             lpInitBits        LPSTR  Указывает   на   массив   байтов,
                               который    содержит     значения     для
                               инициализации  растровой  карты.  Формат
                               значений растровой карты зависит от поля
                               biBitCount структуры данных  BITMAPINFO,
                               идентифицированной            параметром
                               lpInitInfo.      Для      дополнительной
                               информации смотрите  описание  структуры
                               данных  BITMAPINFO  в  Главе 7,  "Типы и
                               структуры данных",  в Томе 2 Справочного
                               руководства.

             lpInitInfo        LPBITMAPINFO  Указывает   на   структуру
                               данных  BITMAPINFO,  которая   описывает
                               размеры и цветовой формат lpInitBits.

             wUsage            WORD  Определяет,   содержит   ли   поле
                               bmiColors[] структуры данных  lpInitInfo
                               точно  определенные  RGB  значения   или
                               индексы в  текущей  логической  палитре.
                               Параметр wUsage может принимать одно  из
                               следующих значений:

                               Величина       Значение
                               ________       ________

                               DIB_PAL_COLORS Таблица  цветов  содержит
                                              массив   16-ти    битовых
                                              индексов    в     текущей
                                              логической  палитре.

                               DIB_RGB_COLORS Таблица  цветов  содержит
                                              конкретные величины RGB.

        ───────────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение идентифицирует растровую карту, если
        работа функции прошла нормально. Во всех остальных стлучаях оно
        равно NULL.

             Примечание

             Эта     функция     также      принимает      спецификацию
        аппаратно-независимой  растровой  карты,   сформированной   для
        Microsoft OS/2 Presentation  Manager  версий  1.1  и  1.2, если

       Windows 3.0/Ref/2#7                                       = 64 =

        lpInfoHeader указывает на структуру данных  BITMAPCOREHEADER, а
        параметр   lpInitInfo    указывает    на    структуру    данных
        BITMARCOREINFO.


        ───────────────────────────────────────────────────────────────
                             CreateDIBPatternBrush  [3.0]                      

        Синтаксис

             HBRUSH CreateDIBPatternBrush( hPackedDIB, wUsage )

             Эта функция создает логическую  кисть,  у  которой  шаблон
        специфицирован    аппартно-независимой    растровой     картой,
        определенной   параметром   hPackedDIB.   Кисть   может    быть
        впоследствии   выбрана   для   любого    устройства,    которое
        поддерживает растровые операции.  Для получения  дополнительной
        информации  смотрите  растровую возможность RC_BITBLT в функции
        GetDeviceCaps.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hPackedDIB        GLOBALHANDLE    Идентифицирует    объект
                               глобальной      памяти,       содержащий
                               упакованную        аппаратно-независимую
                               растровую  карту.  Для  получения  этого
                               дескриптора     прикладная     программа
                               вызывает   функцию    GlobalAlloc    для
                               размещения  блока  глобальной  памяти  и
                               затем, заполняет эту память  упакованной
                               растровой картой.

             wUsage            WORD  Определяет,   содержит   ли   поле
                               bmiColors[] структуры данных  BITMAPINFO
                               точно  определенные  RGB  значения   или
                               индексы в  текущей  логической  палитре.
                               Параметр wUsage может принимать одно  из
                               следующих значений:

                               Величина       Значение
                               ________       ________

                               DIB_PAL_COLORS Таблица  цветов  содержит
                                              массив   16-ти    битовых
                                              индексов    в     текущей
                                              логической  палитре.

                               DIB_RGB_COLORS Таблица  цветов  содержит
                                              конкретные величины RGB.

             ──────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                       = 65 =

             Возвращаемое значение

             Возвращаемое  значение  идентифицирует  логическую  кисть,
        если  работа  функции  прошла  нормально.  Во  всех   остальных
        стлучаях оно равно NULL.


        ───────────────────────────────────────────────────────────────
                               CreateDiscardableBitmap                         

        Синтаксис

             HBITMAP CreateDiscardableBitmap(hDC,nWidth,nHeight)

             Эта  функция   создает   сбрасываемую   растровую   карту,
        совместимую  с  устройством,   определенным   параметром   hDC.
        Растровая карта имеет то же число цветовых  планов  или  формат
        битов на пиксель, что и специфицированное устройство. Эта карта
        может быть выбрана, как текущая для любого  устройства  памяти,
        совместимого с устройством, заданным параметром hDC.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDC               HDC Идентифицирует контекст устройства.

             nWidth            int Определяет высоту растровой карты  в
                               битах.

             nHеight           int Определяет ширину растровой карты  в
                               битах.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение идентифицирует растровую карту, если
        функция выполнилась успешно. В противном случае равно NULL.

             Примечание

             Операционная среда Windows может сбросить растровую карту,
        созданную этой функцией, только в том случае,  если  прикладная
        программа не выбрала ее в  контексте  отображения.  Если  среда
        Windows сбросила растровую карту, когда она не была выбрана,  и
        прикладная  позднее   попытается   выбрать   ее,   то   функция
        SelectObject  возвратит  нулевое  значение.   В   этом   случае
        прикладная программа должна удалить дескриптор растровой карты,
        используя функцию DeleteObject.


        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 66 =

                                  CreateEllipticRgn                            

        Синтаксис

             HRGN CreateEllipticRgn(X1,Y1,X2,Y2)

             Эта функция создает эллиптическую область.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             X1                int  Определяет  x-координату   верхнего
                               левого   угла   ограничивающего   эллипс
                               прямоугольника.

             Y1                int  Определяет  y-координату   верхнего
                               левого   угла   ограничивающего   эллипс
                               прямоугольника.

             X2                int  Определяет   x-координату   нижнего
                               правого  угла   ограничивающего   эллипс
                               прямоугольника.

             Y2                int  Определяет   y-координату   нижнего
                               правого  угла   ограничивающего   эллипс
                               прямоугольника.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение идентифицирует новую  область,  если
        функция выполнилась успешно. В противном случае равно NULL.

             Примечание

             Ширина прямоугольника, определяемая  абсолютным  значением
        (X2  -  X1),  не  должны  превышать  32767  единиц.  Такое   же
        ограничение налагается и на высоту прямоугольника.


        ───────────────────────────────────────────────────────────────
                              CreateEllipticRgnIndirect                        

        Синтаксис

             HRGN CreateEllipticRgnIndirect(lpRect)

             Эта функция создает эллиптическую область.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpRect            LPRECT  Указывает  на  структуру  данных

       Windows 3.0/Ref/2#7                                       = 67 =

                               RECT, содержащую  логические  координаты
                               верхнего левого и нижнего правого  углов
                               ограничивающего эллипс прямоугольника.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение  идентифицирует новую область,  если
        функция выполнилась успешно. В противном случае равно NULL.

             Примечание

             Ширина прямоугольника не должны  превышать  32767  единиц.
        Такое же ограничение налагается и на высоту прямоугольника.

        ───────────────────────────────────────────────────────────────
                                      CreateFont                               

        Синтаксис

             HFONT  CreateFont( nHeight,      nWidth,      nEscapement,
                                nOrientation,     nWeight,     cItalic,
                                cUnderline,    cStrikeOut,    cCharSet,
                                cOutputPrecision,       cClipPrecision,
                                cQuality, cPitchAndFamily, lpFacename)

             Эта  функция  создает  логический  шрифт,  который   имеет
        заданные характеристики. В дальнейшем  этот  шрифт  может  быть
        выбран как текущий для любого устройства.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             nHеight           int   Определяет  требуемую  высоту   (в
                               логических  единицах)   шрифта.   Высота
                               шрифта  может  быть   определена   тремя
                               способами: Если параметр nHeight  больше
                               нуля,  то высота преобразуется в единицы
                               устройства   и   подбирается    наиболее
                               близкая  высота  знакоместа существующих
                               шрифтов.  При  равенстве  nHеight   нулю
                               используется   подходящее   значение  по
                               умолчанию. Если параметр nHеight  меньше
                               нуля,  то высота преобразуется в единицы
                               устройства   и    абсолютное    значение
                               подбирается     по     высоте    символа
                               существующих    шрифтов.    При     всех
                               сравнениях  по  высоте разметчик шрифтов
                               ищет  наибольший   шрифт,   который   не
                               превышает  затребованный размер,  и если
                               такого   шрифта   нет,    то    выбирает
                               наименьший шрифт из существующих.

       Windows 3.0/Ref/2#7                                       = 68 =


             nWidth            int   Определяет среднюю ширину символов
                               шрифта  в  логических   единицах.   Если
                               параметр nWidth   равен  0,  коэффициент
                               сжатия устройства  будет  подгоняться  к
                               оцифрованному     коэффициенту    сжатия
                               существующих    шрифтов     в     поиске
                               минимального     абсолютного    значения
                               разницы между ними.

             nEscapement       int   Определяет угол (в  десятых  долях
                               градуса)    каждой     линии     текста,
                               выведенного шрифтом (относительно нижней
                               границы страницы).

             nOrientation      int   Определяет угол (в  десятых  долях
                               градуса) линии  основы  каждого  символа
                               относительно нижней границы страницы.

             nWeight           int   Определяет желаемую яркость шрифта
                               в диапазоне 0 до 1000 (Например,  400  -
                               нормальный шрифт,  700  -  жирный). Если
                               параметр   равен   0,   то   применяется
                               значение по умолчанию.

             cItalic           BYTE  Определяет,  является   ли   шрифт
                               курсивом.

             cUnderline        BYTE   Определяет,   подчеркивается   ли
                               шрифт.

             cStrikeOut        BYTE  Определяет,   перечеркиваются   ли
                               символы шрифта.

             cCharSet          BYTE Определяет желаемый набор символов.
                               Параметр   может   принимать   одно   из
                               следующих значений:

                               ANSI_CHARSET
                               OEM_CHARSET
                               SYMBOL_CHARSET

                               Набор     символов     OEM      является
                               аппаратно-зависимым.

                               В системе  может  существовать  шрифт  и
                               с  другими   наборами   символов.   Если
                               прикладная программа использует шрифт  с
                               неизвесным  набором  символов,  она   не
                               должна переводить  или  интерпритировать
                               строки, которые написанные этим шрифтом.
                               Вместо  этого,  строки  должны  напрямую
                               выводится на дравер устройства вывода.

       Windows 3.0/Ref/2#7                                       = 69 =


             cOutputPrecision  BYTE   Определяет   желаемую    точность
                               вывода. Точность  вывода  характеризует,
                               как  приблизительно  должны  подбираться
                               при выводе  требуемые  nHeight,  nWidth,
                               nOrientation  символа,   nEscapement   и
                               cPitchAndFamily.     Параметр      может
                               принимать одно из следующих значений:

                               OUT_CHARACTER_PRECIS
                               OUT_DEFAULT_PRECIS
                               OUT_STRING_PRECIS
                               OUT_STROKE_PRECIS

             cClipPrecision    BYTE Определяет точность отсечения окна.
                               Этот  параметр  задает,   как   отсекать
                               символы,  которые  частично  расположены
                               вне   области   отсечения.   Он    может
                               принимать одно из следующих значений:

                               CLIP_CHARACTER_PRECIS
                               CLIP_DEFAULT_PRECIS
                               CLIP_STROKE_PRECIS

             cQuality          BYTE   Определяет   желаемое    качество
                               вывода. Этот параметр задает, как  точно
                               GDI  должен   попытаться   подобрать   в
                               соответствии  с  атрибутами  логического
                               шрифта существующий физический шрифт. Он
                               может  принимать   одно   из   следующих
                               значений:

                               DEFAULT_QUALITY
                               DRAFT_QUALITY
                               PROOF_QUALITY

             cPitchAndFamily   BYTE Определяет шаг и семейство  шрифта.
                               Младшие  два  бита   характеризуют   шаг
                               шрифта и могут представлять одно  из  из
                               следующих значений:

                               DEFAULT_PITCH
                               FIXED_PITCH
                               VARIABLE_PITCH

                               Четыре  старших  бита  поля   определяют
                               семейство шрифта  и  могут  представлять
                               одно из следующих значений:

                               FF_DECORATIVE
                               FF_DONTCARE
                               FF_MODERN
                               FF_ROMAN

       Windows 3.0/Ref/2#7                                       = 70 =

                               FF_SCRIPT
                               FF_SWISS

             lpFacename        LPSTR указывает  на оканчивающуюся нулем
                               символьную   строку,   содержащую    имя
                               шрифта. Количество  символов в строке не
                               должно  превышать  тридцати   символоав.
                               Функция     EnumFonts     может     быть
                               использована для перечисления имен  всех
                               доступных шрифтов.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение   идентифицирует  логический  шрифт,
        если функция выполнилась  успешно.  В  противном  случае  равно
        NULL.

             Примечание

             Функция  не  создает  новый  шрифт,  а  выбирает  наиболее
        подходящий из существующих физических шрифтов в пуле GDI.


        ───────────────────────────────────────────────────────────────
                                  CreateFontIndirect                           

        Синтаксис

             HFONT CreateFontIndirect(lpLogFont)

             Эта   функция   создает    логический    шрифт,    имеющий
        характеристики, содержащиеся в структуре  данных  с  указателем
        lpLogFont. В дальнейшем шрифт может быть выбран как текущий для
        любого устройства.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpLogFont         LOGFONT FAR  *  Указывает  на  структуру
                               данных LOGFONT,             определяющую
                               характеристики шрифта.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение  идентифицирует  логический   шрифт,
        если  функция  выполнилась  успешно.  В  противном случае равно
        NULL.

             Примечание

       Windows 3.0/Ref/2#7                                       = 71 =


             CreateFontIndirect cоздает логический шрифт,  имеющий  все
        соответствующие  характеристики.  Когда  шрифт   выбирается   с
        помощью функции SelectObject, разметчик  шрифтов  GDI  пытается
        подобрать логическому  шрифту  существующий  физический  шрифт.
        Если такое соответствие не найдено, то он  пытается  обеспечить
        по возможности наиболее близкие  характеристики  из  требуемых.
        Для описания разметчика  шрифтов  смотрите  Главу  2,  "Функции
        интерфейса графических устройств".


        ───────────────────────────────────────────────────────────────
                                   CreateHatchBrush                            

        Синтаксис

             HBRUSH CreateHatchBrush(nIndex,crColor)

             Эта функция создает логическую кисть, имеющую определенную
        штриховку и цвет. Кисть может быть затем  выбрана  как  текущая
        кисть для любого устройства.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             nIndex            short Определяет тип штриховки кисти. Он
                               может быть одним из следующих значений:

                               Величина       Значение
                               ────────       ────────

                               HS_BDIAGONAL   Наклонная штриховка снизу
                                              вверх   под   углом    45
                                              градусов  слева   направо
                                              (обратная диагональная).

                               HS_CROSS       Горизонтальная          и
                                              вертикальная
                                              пересекающаяся  штриховка
                                              (перекрестная).

                               HS_DIAGCROSS   Пересекающаяся  штриховка
                                              под  углом  45   градусов
                                              (пересекающаяся
                                              диагональная).

                               HS_FDIAGONAL   Наклонная       штриховка
                                              сверху вниз под углом  45
                                              градусов  слева   направо
                                              (прямая диагональная).

                               HS_HORIZONTAL  Горизонтальная штриховка.


       Windows 3.0/Ref/2#7                                       = 72 =

                               HS_VERTICAL    Вертикальная штриховка.

             crColor           COLORREF  Определяет  цвет  фона   кисти
                               (цвет штриховки).

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение   идентифицирует  логическую  кисть,
        если функция выполнилась  успешно.  В  противном  случае  равно
        NULL.


        ───────────────────────────────────────────────────────────────
                                       CreateIC                                

        Синтаксис

             HDC  CreateIC(lpDriverName,lpDeviceName,lpOutput,
                                                            lpInitData)

             Эта функция создает информационный контекст для  заданного
        устройства. Информационный контекст обеспечивает  быстрый  путь
        для получения информации об устройстве без  создания  контекста
        устройства.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpDriverName      LPSTR Указывает на оканчивающуюся  нулем
                               символьную  строку,   определяющую   имя
                               файла  драйвера   устройства   DOS,  без
                               расширения (например EPSON).

             lpDeviceName      LPSTR Указывает на оканчивающуюся  нулем
                               символьную  строку,   определяющую   имя
                               поддерживаемого   устройства   (например
                               EPSON     FX-80).     Этот      параметр
                               используется, если  модуль  поддерживает
                               больше, чем одно устройство.

             lpOutput          LPSTR Указывает на оканчивающуюся  нулем
                               символьную строку, определяющую файл DOS
                               или  имя  устройства  физической   среды
                               вывода (файл или порт).

             lpInitData        LPSTR Указывает на данные  инициализации
                               для   драйвера   заданного   устройства.
                               Параметр  lpInitData  равен  нулю,  если
                               драйвер      устройства       использует
                               инициализацию  по  умолчанию  (если  она
                               необходима), определяемую  пользователем

       Windows 3.0/Ref/2#7                                       = 73 =

                               через панель блока управления.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение     идентифицирует    информационный
        контекст,  если функция завершена успешно.  В противном  случае
        равно NULL.

             Примечание

             Соглашения по именам устройств подчинены правилам принятым
        в DOS,  а  именно:  имя  оканчивается  двоеточием,  причем  это
        правило не обязательное,  но  рекомендуемое.  Windows  отделяет
        завершающее двоеточие, так что  имя  устройства,  завершающееся
        двоеточием, преобразуется в такой же порт, что и тоже  имя  без
        двоеточия.

             Имя драйвера и порта не должны содержать пробелы в  начале
        и в конце.

             Функции  вывода  GDI  не   могут   быть   использованы   с
        информационным контекстом.


        ───────────────────────────────────────────────────────────────
                                  CreateIcon  [3.0]                            

        Синтаксис

             HICON CreateIcon(hInstans,  hWidth,  hHeight,  nBitsPixel,
                                                  lpANDbits, lpXORbits)

             Эта функция создает  икону,  которая  имеет  определенную
        ширину, высоту и битовые параметры.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hInstance         HANDLE   Определяет   экземпляр   модуля
                               создаваемой иконы.

             nWidth            int Определяет ширину курсора в пикселях.


             nHeight           int Определяет высоту курсора в пикселях.

             nPlans            BYTE Определяет число планов  маски  XOR
                               иконы.

             nBitsPixel        BYTE  Определяет  количество  битов   на
                               пиксель в маске XOR иконы.

       Windows 3.0/Ref/2#7                                       = 74 =


             lpANDbits         LPSTR  Указывает   на   массив   байтов,
                               содержащих битовые  значения  AND  маски
                               иконы.    Это    должены    быть    биты
                               определяющие одноцветную маску.

             lpXORbitps        LPSTR  Указывает   на   массив   байтов,
                               содержащих битовые  значения  XOR  маски
                               иконы.    Это    могут     быть     биты
                               аппаратно-зависимой  цветной   растровой
                               карты.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемая величина идентифицирует икону,  если  работа
        функции прошла нормально. Во всех остальных случаях NULL.

        ───────────────────────────────────────────────────────────────
                                                                               
       CreateMenu

        Синтаксис

             HMENU CreateMenu( )

             Эта функция служит для создания меню.  Меню  первоначально
        пусто, но оно может быть заполнено элементами  меню  с  помощью
        функции AppendMenu и InsertMenu.

             Эта функция не имеет параметров

             Возвращаемое значение

             Возвращаемое значение идентифицирует вновь созданное меню.
        Оно равно NULL, если меню не может быть создано.

        ───────────────────────────────────────────────────────────────
                                    CreateMetaFile                             

        Синтаксис

             HANDLE CreateMetaFile(lpFilename)

             Эта функция создает контекст устройства метафайла.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpFilename        LPSTR Указывает на символьную  строку  с
                               именем метафайла, оканчивающуюся  нулем.
                               Если параметр lpFilename равен нулю,  то
                               создается   контекст   устройства    для

       Windows 3.0/Ref/2#7                                       = 75 =

                               метафайла памяти.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение  идентифицирует  контекст устройства
        метафайла, если функция выполнилась успешно. В противном случае
        равно NULL.

        ───────────────────────────────────────────────────────────────
                                CreatePalette   [3.0]                          

        Синтаксис

             HPALLETTE CreatePalette( lpLogPalette )

             Эта функция создает логическую палитру цвета.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpLogPallete      LPLOGPALETTE  Указывает   на   структуру
                               данных      LOGPALLETTE,      содержащую
                               информацию   о   чветах   в   логической
                               палитре.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение определяет логическую  палитру, если
        работа функции прошла  нормально.  Во  всех  остальных  случаях
        NULL.

        ───────────────────────────────────────────────────────────────
                                  CreatePatternBrush                           

        Синтаксис

             HBRUSH CreatePatternBrush(hBitmap)

             Эта  функция  создает   логическую   кисть   по   шаблону,
        определяемому  параметром  hBitmap.  Кисть  может  быть   затем
        выбрана,   как   текущая   кисть   для    любого    устройства,
        поддерживающего растровые операции (см.  операцию  RC_BITBLT  в
        функции GetDeviceCaps).

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hBitmap           HBITMAP Идентифицирует растровую  карту.
                               Предполагается,  что  она  создается,  с

       Windows 3.0/Ref/2#7                                       = 76 =

                               помощью      функции       CreateBitmap,
                               CreateBitmapIndirect                 или
                               CreateCompatibleBitmap.      Mинимальный
                               размер растровой карты, применяемой  для
                               заполняемого шаблона - 8х8.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение  идентифицирует  логическую   кисть,
        если  функция  выполнилась  успешно.  В  противном случае равно
        NULL.

             Примечание

             Кисть данного образца можно удалить функцией  DeleteObject
        без  воздействия  на  связанную  с  ним  растровую  карту.  Это
        означает, что  растровая  карта  может  быть  использована  для
        создания любого числа кистей данного образца.

             Кисть   созданная   с   использованием    одноцветной    (
        одноплановой,  с  одним  битом  на  пиксель)  растровой   карты
        рисуется текущими цветами фона и текста. Пиксели представленные
        битом, установленным в 0, будут  рисоваться  с  текущим  цветом
        текста, а пиксели  представленные  битом,  установленным  в  1,
        будут рисоваться с текущим цветом фона.


        ───────────────────────────────────────────────────────────────
                                      CreatePen                                

        Синтаксис

             HPEN CreatePen(nPenStyle,nWidth,crColor)

             Эта функция создает логическое перо соответствующего типа,
        толщины и цвета. Перо  в  дальнейшем  может  быть  выбрано  как
        текущее перо для любого устройства.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             nPenStyle         int  Определяет  тип  пера.  Перо  может
                               быть:

                               Тип пера       Значение
                               ────────       ────────

                               PS_SOLID       0

                               PS_DASH        1


       Windows 3.0/Ref/2#7                                       = 77 =

                               PS_DOT         2

                               PS_DASHDOT     3

                               PS_DASHDOTDOT  4

                               PS_NULL        5

                               PS_INSIDEFRAME 6

                               Если ширина пера больше,  чем  1  и  тип
                               пера  PS_INSIDERFRAME,  линия   рисуется
                               внутри границ всех  примитивов  исключая
                               прямоугольники и составные линии;  кисть
                               рисуется с логическим  цветом  если  цве
                               пера  не  соответствует  допустимой  RGB
                               величине. Тип PS_INSIDERFRAME  действует
                               также как тип PS_SOLID, если ширина пера
                               меньше или равна 1.

             nWidth            int Определяет ширину (толщину)  пера  в
                               логических единицах.

             crColor           COLORREF  Определяет  цвет пера.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение идентифицирует логическое перо, если
        функция выполнилась успешно. В противном случае равно NULL.

             Примечание

             Перья с физической шириной  больше  одного  пикселя  будут
        иметь либо нулевой, либо сплошной тип.

        ───────────────────────────────────────────────────────────────
                                  CreatePenIndirect                            

        Синтаксис

             HPEN CreatePenIndirect(lpLogPen)

             Эта функция создает логическое перо, имеющее тип,  толщину
        и цвет, заданные  в  структуре  данных,  на  которую  указывает
        lpLogPen.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpLogPen          LOGPEN  FAR  *  указывает  на  структуру

       Windows 3.0/Ref/2#7                                       = 78 =

                               данных LOGPEN,  содержащую информацию  о
                               логическом пере.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение идентифицирует логическое перо, если
        функция выполнилась успешно. В противном случае равно NULL.

             Примечание

             Перья с физической шириной  больше  одного  пикселя  будут
        иметь либо нулевой, либо сплошной тип.

        ───────────────────────────────────────────────────────────────
                                   CreatePolygonRgn                            

        Синтаксис

             HRGN CreatePolygonRgn(lpPoints,nCount,nPolyFillMode)

             Эта функция создает многоугольную область.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpPoints          LPPOINT  указывает  на  массив  структур
                               данных POINT.  Каждая  точка  определяет
                               координаты   x   и  y  одной  из  вершин
                               многоугольника.

             nCount            int Определяет число точек в массиве.

             nPolyFillMode     int    Определяет    режим    заполнения
                               многоугольника, используемый при заливке
                               областей. Он может  быть  ALTERNATE  или
                               WINDING  (информацию  об  этих   режимах
                               смотрите     в     описании      функции
                               SetPolyFillMode).

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение  идентифицирует новую область,  если
        функция выполнилась успешно. В противном случае равно NULL.

        ───────────────────────────────────────────────────────────────
                             CreatePolyPolygonRgn  [3.0]                       

        Синтаксис


       Windows 3.0/Ref/2#7                                       = 79 =

             HRGN CreatePolyPolygonRgn(lpPoints, lpPolyCounts,  nCount,
                                       nPolyFillMode)

             Эта  функция   создает   область,   содержащую   несколько
        замкнутых многоугольников. Область заполняется с использованием
        режима, определенного параметром nPolyFillMode.  Многоугольники
        могут накладываться, но это нежелательно.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpPoints          LPPOINT  указывает  на  массив  структур
                               данных POINT.  Каждая  точка  определяет
                               координаты  x  и  y  одной   из   вершин
                               многоугольника.   Каждый   многоугольник
                               должен быть замкнут.  Многоугольники  не
                               замыкаются автоматически. Многоугольники
                               определены последовательно.

             lpPolyCounts      LPINT Указывает на массив  целых  чисел,
                               каждый из которых определяет число точек
                               в одном  из  многоугольников  в  массиве
                               lpPoints.

             nCount            int Определяет общее    количество целых
                               чисел в массиве lpPolyCounts.

             nPolyFillMode     int    определяет    режим    заполнения
                               многоугольника, используемый при заливке
                               областей. Он может  быть:

                               Величина       Значение
                               ────────       ────────

                               ALTERNATE      Выбирает   альтернативный
                                              режим.

                               WINDING        Выбирает режим "намотки".

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое  значение  идентифицирует  область.  Во  всех
        остальных случаях равно NULL.

             Примечание

             Вообще говоря,     режимы    заполнения    многоугольников
        различаются только  в  случаях,  когда  должны  быть  заполнены
        сложные,      перекрывающиеся     многоугольники     (например,
        пятисторонний  многоугольник,  который  формирует  пятиугольную
        звезду  с  пятиугольником  в  центре).  В таких случаях,  режим

       Windows 3.0/Ref/2#7                                       = 80 =

        ALTERNATE   заполняет   каждую   вложенную    область    внутри
        многоугольника  (то  есть,  вершины  звезды),  а  режим WINDING
        заполняет всю область (то есть, вершины и пятиугольник).

             Когда установлен режим ALTERNATE,  GDI  заполняет  область
        между нечетными и четными сторонами  многоугольника  на  каждой
        сканируемой линии. То есть, GDI заполняет область между  первой
        и второй сторонами, между третьей и четвертой сторонами, и  так
        далее.

             Для  заполнения  всех  частей   области,   режим   WINDING
        указывает  GDI  высчитать  и  нарисовать  границу,   включающую
        область   без   перекрытий.   Например,   в   режиме    WINDING
        пятисторонний многоугольник, который  формирует  звезду,  будет
        принят за десятисторонний  многоугольник  с  неперекрывающимися
        сторонами; в результате звезда будет заполнена.


        ───────────────────────────────────────────────────────────────
                                                                               
       CreatePopupMenu  [3.0]

        Синтаксис

             HMENU CreatePopupMenu ()

             Эта  функция  создает  и  возвращает  дескриптор   пустого
        налагаемого меню.

             Прикладная программа добавляет объекты в налагаемое  меню,
        вызывая функции  InsertMenu и AppendMenu.  Прикладная программа
        может добавить налагаемое меню к  уже  существующему  меню  или
        налагаемому меню, или она может отобразить выбранную полоску на
        налагаемом меню с помощью вызова функции TrackPopupMenu.

             Эта функция не имеет параметров.

             Возвращаемое значение

             Возвращаемое значение идентифицирует вновь созданное меню.
        Возвращается NULL если меню не может быть создано.

        ───────────────────────────────────────────────────────────────
                                    CreateRectRgn                              

        Синтаксис

             HRGN CreateRectRgn(X1,Y1,X2,Y2)

             Эта функция создает прямоугольную область.


       Windows 3.0/Ref/2#7                                       = 81 =

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             X1                int  Определяет  x-координату   верхнего
                               левого угла прямоугольника.

             Y1                int  Определяет  y-координату   верхнего
                               левого угла прямоугольника.

             X2                int  Определяет   x-координату   нижнего
                               правого угла прямоугольника.

             Y2                int  Определяет   y-координату   нижнего
                               правого угла прямоугольника.
             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение  идентифицирует новую область,  если
        функция выполнилась успешно. В противном случае равно NULL.

             Примечание

             Ширина и высота прямоугольника, определяемая (X2 - Х1)  не
        должны превышать 32767 единиц. Такое же ограничение  налагается
        и на высоту прямоугольника.

        ───────────────────────────────────────────────────────────────
                                CreateRectRgnIndirect                          

        Синтаксис

             HRGN CreateRectRgnIndirect(lpRect)

             Эта функция создает прямоугольную область.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpRect            LPRECT  указывает  на  структуру  данных
                               RECT, содержащую  логические  координаты
                               верхнего  левого и нижнего правого углов
                               прямоугольника.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение идентифицирует новую  область,  если
        функция выполнилась успешно. В противном случае равно NULL.

             Примечание

             Ширина прямоугольника не должна  превышать  32767  единиц.

       Windows 3.0/Ref/2#7                                       = 82 =

        Такое же ограничение налагается и на высоту прямоугольника.


        ───────────────────────────────────────────────────────────────
                              CreateRoundRectRgn   [3.0]                       

        Синтаксис

             HRGN CreateRoundRectRgn(X1,Y1,X2,Y2,X3,Y3)

             Эта функция создает прямоугольную область с  закругленными
        углами.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             X1                int  Определяет  x-координату   верхнего
                               левого угла области.

             Y1                int  Определяет   y-координату  верхнего
                               левого угла области.

             X2                int  Определяет   x-координату   нижнего
                               правого угла области.

             Y2                int  Определяет   y-координату   нижнего
                               правого угла области.

             X3                int   Определяет     ширину     эллипса,
                               используемого для создания  закругленных
                               углов.

             Y3                int    Определяет    высоту     эллипса,
                               используемого для создания  закругленных
                               углов.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение идентифицирует новую  область,  если
        функция выполнилась успешно. В противном случае равно NULL.

             Примечание

             Ширина и высота прямоугольника, определяемая (X2 - Х1)  не
        должны превышать 32767 единиц. Такое же ограничение  налагается
        и на высоту прямоугольника.


        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                       = 83 =

                                                                               
       CreateSolidBrush

        Синтаксис

             HBRUSH CreateSolidBrush(crColor)

             Эта функция создает логическую кисть, имеющую определенный
        ровный цвет. Кисть затем может быть выбрана как  текущая  кисть
        для любого устройства.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             crColor           COLORREF Определяет цвет кисти.
             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение   идентифицирует  логическую  кисть,
        если функция выполнилась  успешно.  В  противном  случае  равно
        NULL.

        ───────────────────────────────────────────────────────────────
                                     CreateWindow                              

        Синтаксис

             HWND        CreateWindow(lpClassName,lpWindowName,dwStyle,
                                      X, Y, nWidth, nHeight,hWndParent,
                                      hMenu,    hInstance,     lpParam)

             Эта  функция  создает  перекрывающиеся,  накладываемые   и
        дочерние окна.   Функция   CreateWindow   специфицирует  класс,
        заголовок,  тип,и (необязательно) начальную  позицию  и  размер
        окна.  Кроме  того,  она  определяет  родительское  окно  (если
        таковое существует) и меню окна.

             Для  перекрывающихся,  накладываемых   и   дочерних   окон
        функция CreateWindow      посылает     сообщения     WM_CREATE,
        WM_GETMINMAXINFO и WM_NCCREATE.  Сообщение  WM_CREATE  содержит
        значение,   заданное   параметром   lpParam.   Если  задан  тип
        WS_VISIBLE,   CreatWindow   посылает   окну   все    сообщения,
        необходимые для его активизации и индицирования.

             Если в  типе  окна  задан  заголовок,  то  он  указывается
        посредством параметра  lpWindowName  и  индицируется  в  строке
        заголовка окна. Когда  функция  CreateWindow  используется  для
        создания блоков управления, таких как  мягкие  клавиши,  панели
        контроля  и   текстовые   блоки   управления,   то   параметром
        lpWindowName задается текст блоков управления.


       Windows 3.0/Ref/2#7                                       = 84 =

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpClassName       LPSTR Указывает на оканчивающуюся  нулем
                               строку символов, именующую  класс  окна.
                               Имя  класса  может  быть  любым  именем,
                               зарегистрированным  при  помощи  функции
                               RegisterClass, или любым  из  встроенных
                               имен    класса     блока     управления,
                               приведенных в таблице 4.2.

             lpWindowName      LPSTR Указывает на оканчивающуюся  нулем
                               строку  символов,   представляющую   имя
                               окна.

             dwStyle           DWORD Определяет тип создаваемого  окна.
                               Это может быть любая  комбинация  типов,
                               приведенных в  таблице 4.3.  Могут также
                               быть    использованы     типы     блоков
                               управления,  приведенные  в таблице 4.4.
                               Типы     могут     комбинироваться     с
                               использованием операции поразрядного OR.

             X                 int      Определяет       первоначальное
                               расположение  окна   по   оси   x.   Для
                               перекрывающихся  и  накладываемых   окон
                               параметр X - первоначальное положение по
                               оси  x  их  верхнего  левого   угла   (в
                               координатах экрана). Если значение этого
                               параметра  равно CW_USEDEFAULT,  Windows
                               выбирает позицию  верхнего  левого  угла
                               окна по умолчанию. Для дочерних окон X -
                               положение по оси x левого верхнего  угла
                               в координатах пользователя родительского
                               окна.

             Y                 int      Определяет       первоначальное
                               расположение  окна   по   оси   y.   Для
                               перекрывающихся  и  накладываемых   окон
                               параметр Y - первоначальное положение по
                               оси  y  верхнего  их  левого   угла   (в
                               координатах экрана). Для  накладываемого
                               окна Y - положение по оси y его верхнего
                               левого угла (в координатах экрана).  Для
                               панели перечня Y - положение  по  оси  y
                               верхнего     левого     угла     области
                               пользователя   блока   управления.   Для
                               дочерних окон Y - положение по оси y его
                               левого верхнего угла. Все эти координаты
                               даются  для  окна,  а  не  для   области
                               пользователя окна.

             nWidth            int Определяет ширину окна  (в  единицах
                               устройства).  Для  перекрывающихся  окон
                               этот параметр или задает ширину окна  (в

       Windows 3.0/Ref/2#7                                       = 85 =

                               координатах    экрана)     или     равен
                               CW_USEDEFAULT. Если   параметр    nWidth
                               равен  CW_USEDEFAULT,  Windows  выбирает
                               ширину  и  высоту  окна   по   умолчанию
                               (ширина  по  умолчанию  отсчитывается от
                               первоначальной позиции окна по оси x  до
                               правой  границы  экрана,  а  высота - от
                               первоначальной позиции окна по оси y  до
                               верхней границы области икон).

             nHeight           int Определяет высоту окна  (в  единицах
                               устройства). Для  перекрывающихся  окон,
                               этот  параметр  задает  высоту  окна  (в
                               координатах   экрана).   Если   параметр
                               nWidth равен CW_USEDEFAULT, то  параметр
                               nHeight игнорируется.

             hWndParent        HWND  Идентифицирует  родительское  окно
                               для  создаваемого  окна.  Этот  параметр
                               должен иметь значение NULL при  создании
                               перекрывающихся   окон.   При   создании
                               дочернего окна для параметра  hWndParent
                               должно  быть задано допустимое значение.
                               При   создании    накладываемого    окна
                               параметр hWndParent      может     иметь
                               ненулевое значение, но это не требуется.

             hMenu             HMENU Определяет меню или  идентификатор
                               дочернего окна. Значение зависит от типа
                               окна.    Для     перекрывающихся     или
                               накладываемых окон  параметр  определяет
                               меню,  которое  будет  использоваться  с
                               окном. Если  параметр  hMenu равен NULL,
                               используется меню класса.  При  создании
                               дочернего   окна   hMenu   специфицирует
                               идентификатор дочернего окна -  короткое
                               целое   значение.   ID   дочернего  окна
                               определяется прикладной  программой;  он
                               должен  быть  уникальным  среди дочерних
                               окон одного и того же родителя.

             hInstance         HANDLE Идентифицирует экземпляр  модуля,
                               связанного с окном.

             lpParam           LPSTR  Указывает  на  длинное  значение,
                               которое передается окну  через  параметр
                               lpParam сообщения WM_CREATE.

             ──────────────────────────────────────────────────────────

             Возвращаемое значение

             Возвращаемое значение  идентифицирует  новое  окно.  Равно

       Windows 3.0/Ref/2#7                                       = 86 =

        NULL, если окно не создано.

             Примечание

             Для   перекрывающихся   окон,   где   параметр   X   равен
        CW_USEDEFAULT, параметр Y  должен  быть  одним  из  параметров,
        описанных в функции ShowWindow или,  для  впервые  создаваемого
        перекрывающегося окна,  он  должен  быть  параметром  nCmdShow,
        передаваемым функции WinMain.

             В таблице  4.2  показаны  встроенные  классы  окон  блоков
        управления; В таблице 4.3 показаны типы окон, а в  таблице  4.4
        приведен список типов блоков управления.


       Windows 3.0/Ref/2#7                                       = 87 =


        Таблица 4.2    Классы блоков управления
        ───────────────────────────────────────────────────────────────
         Класс            Значение
        ───────────────────────────────────────────────────────────────
         BUTTON           Клавишный блок  управления  -  это  небольшое
                          прямоугольное дочернее окно в  виде  клавиши,
                          которую  пользователь  может   "нажимать"   и
                          "отпускать"  при  помощи  "мыши".   Клавишные
                          блоки  управления  могут  быть   использованы
                          отдельно  или  в  группе,   а   также   могут
                          помечаться   или   сопровождаться    текстом,
                          появляющимся вне клавишного блока управления.
                          Клавишные блоки  управления  обычно  изменяют
                          внешний вид при его "нажатии" пользователем.

         COMBOBOX         Обозначает блок управления состоящий из полей
                          выбора с редактируемых  блоков  управления  и
                          панелей   перечня.   Панель   перечня   может
                          отображаться    все    время    или     может
                          раскрываться,   когда   пользователь   выбрал
                          "налагаемую     панель",      соответствующую
                          выбранному полю.

                          В зависимости от типа комбинированной  панели
                          диалога,  пользователь  может  или  не  может
                          редактировать содержимое  поля  выбора.  Если
                          панель перечня раскрыта, то ввод  символов  в
                          панель  выбора   будет   вызывать   выделение
                          первого  элемента  панели  перечня,   который
                          соотвтствует вводимым   символам.   Выбранный
                          элемент в панели перечня отображает выбранный
                          текст в поле выбора.

         EDIT             Обозначает  прямоугольное  дочернее  окно,  в
                          которое пользователь может  вводить  текст  с
                          клавиатуры.   Пользователь   выбирает    блок
                          управления и настраивает его на  ввод  данных
                          при нажатии кнопок "мыши"  внутри  блока  или
                          попадая в него при помощи клавиши  табуляции.
                          Пользователь может вводить текст, когда  блок
                          управления отображает мигающий  псевдокурсор.
                          "Мышь" может использоваться  для  перемещения
                          курсора и выбора места  расположения  символа
                          или  позиционирования  курсора  для   вставки
                          символов.  Клавиша   BACKSPACE   может   быть
                          использована для удаления символов.

                          Редактируемые  блоки  управления   используют
                          системный  шрифт   с   переменным   шагом   и
                          отображают символы в  коде  ANSI.  Прикладные
                          программы   скомпанованные   для   предыдущих
                          версий Windows отображают текст  с  системным

       Windows 3.0/Ref/2#7                                       = 88 =

                          шрифтом с переменным шагом, если  только  они
                          не помечены утилитой MARK с параметром MEMORY
                          FONT.  Прикладная   программа   может   также
                          посылать сообщение WM_SETFONT  для  изменения
                          действующего  шрифта  в  редактируемом  блоке
                          управления.

                          Редактируемые  блоки   управления   расширяют
                          символы  табуляции   на   необходимое   число
                          пробелов для перемещения к следующей  позиции
                          табуляции.   Предполагается,   что    позиции
                          табуляции располагаются через  каждые  восемь
                          символов.

         LISTBOX          Обозначают  панель  с   перечнем   символьных
                          строк.  Этот  блок  управления   используется
                          каждый  раз,   когда   прикладной   программе
                          необходимо представить список имен, таких как
                          имена  файлов,  которые  пользователь   может
                          просмотреть  и  сделать  выбор.  Пользователь
                          может  выбирать  строки  при  помощи  "мыши",
                          указав на текстовую  строку  и  нажав  кнопку
                          "мыши".  Выбранные  строки  подсвечиваются  и
                          родительскому  окну  посылается  уведомляющее
                          сообщение.  Строка   прокрутки   может   быть
                          использована  с  блоком  управления   панелью
                          перечня для прокрутки списка, если он слишком
                          длинный или широкий  для  размещения  в  окне
                          блока управления. В случае надобности  строка
                          прокрутки   автоматически   появляется    или
                          исчезает.

         MDICLIENT        Обозначает окно  пользователя  MDI.      Окно
                          пользователя MDI принимает сообщения, которые
                          управляют дочерним   окном   MDI   прикладной
                          программы.         Рекомендуемые        типы:
                          WS_CLIPCHILDREN и  WS_CHILD.   Для   создания
                          прокручиваемого    окна   пользователя   MDI,
                          которое позволяет  полюзователю  прокручивать
                          дочернее  MDI  окно  для  обзора,  прикладная
                          программа  может  также   использовать   типы
                          W_HSCROLL и W_VSCROLL.

         SCROLLBAR        Блок    управления    прокруткой    -     это
                          прямоугольник, содержащий бегунок  и  стрелки
                          направления в обоих концах. Строка  прокрутки
                          посылает уведомляющее сообщение родительскому
                          окну каждый раз, когда пользователь  нажимает
                          кнопку    "мыши"    в    блоке    управления.
                          Родительское окно отвечает  за  корректировку
                          позиции бегунка, если  это  необходимо.  Блок
                          управления этого класса имеет тот же  внешний
                          вид и выполняет те же функции, что  и  строка

       Windows 3.0/Ref/2#7                                       = 89 =

                          прокрутки в обычных окнах. В отличии от строк
                          прокрутки, блоки  управления  данного  класса
                          могут располагаться  в  любом  месте  окна  и
                          использоваться   каждый   раз,   когда    это
                          необходимо    для    обеспечения    прокрутки
                          введенной информации.

                          Класс   Scrollbar   также   включает    блоки
                          управления  панелями   размера.   Этот   блок
                          управления - небольшой прямоугольник, который
                          пользователь может передвигать для  изменения
                          размеров окна.

         STATIC           Статические блоки  управления  -  это  просто
                          текстовые  поля,  панели  и   прямоугольники,
                          которые могут быть использованы для  отметки,
                          обрамления  или  разделения   других   блоков
                          управления.   Эти   блоки    управления    не
                          поддерживают ввод и не обеспечивают вывод

        ───────────────────────────────────────────────────────────────





       Windows 3.0/Ref/2#7                                       = 90 =

        Таблица 4.3 Типы окон
        ───────────────────────────────────────────────────────────────
        Тип                    Назначение
        ───────────────────────────────────────────────────────────────

        DS_LOCALEDIT           Определяет, что    редактируемый    блок
                               управления   в   панели   диалога  будет
                               использовать память  в  сегменте  данных
                               прикладной программы.  По умолчанию, все
                               редактируемые блоки управления в панелях
                               диалога  используют  память вне сегмента
                               данных   прикладной    программы.    Эту
                               возможность    можно    изменить   путем
                               добавления флага DS_LOCALEDID в  команду
                               STYLE для панели диалога. Если этот флаг
                               не использован, сообщения EM_GETHAHDLE и
                               EM_SETHAHDLE  не  должны  использоваться
                               так  как  память  для  блока  управления
                               находится    не    в   сегменте   данных
                               прикладной программы. Эта возможность не
                               имеет  эффекта  для редактируемых блоков
                               управления созданных вне панели диалога.

        DS_MODALFRAME          Создает панель   диалога   с   модальной
                               структурой,    которая    может     быть
                               скомбинирована  с со строкой заголовка и
                               системным меню путем  объединения  типов
                               WS_CAPTION и WS_SYSMENU.

        DS_NIODLEMSG           Подавляет сообщение        WM_ENTERIDLE,
                               которое Windows в противоположном случае
                               будет посылать владельцу панели диалога,
                               пока панель диалога отображается.

        DS_SYSMODAL            Создает системно-модальную        панель
                               диалога.

        WS_BORDER              Создает окно, которое имеет окантовку.

        WS_CAPTION             Создает окно,   которое   имеет   строку
                               заголовка      (подразумевается      тип
                               WS_BORDER).  Этот  тип  не  может   быть
                               использован с типом WS_DLGFRAME

        WS_CHILD               Создает дочернее  окно.  Не  может  быть
                               использовано с типом WS_POPUP.

        WS_CHILDWINDOW         Создает дочернее   окно,   имеющее   тип
                               WS_CHILD.

        WS_CLIPCHILDREN        Исключает область,  занимаемую дочерними
                               окнами,     при     рисовании     внутри
                               родительского  окна.  Используется   при

       Windows 3.0/Ref/2#7                                       = 91 =

                               создании родительского окна.

        WS_CLIPSIBLINGS        Удаляет дочерние окна относительно  друг
                               друга;  то  есть если отдельное дочернее
                               окно получает сообщение  для  рисования,
                               удалить   все   другие   перекрывающиеся
                               дочерние окна из области дочернего окна,
                               которое   должно  быть  скорректировано.
                               (Если не  задан  тип  WS_CLIPSIBLINGS  и
                               дочерние окна перекрываются, то возможно
                               при  рисовании  в  области  пользователя
                               дочернего  окна  рисовать  и  в  области
                               пользователя соседнего дочернего  окна).
                               Используется только с типом WS_CHILD.

        WS_DISABLE             Создает окно,    которое   первоначально
                               недоступно.

        WS_DLGFRAME            Создает окно  с  двойной окантовкой,  но
                               без заголовка.

        WS_GROUP               Специфицирует первый  блок управления из
                               группы  блоков  управления,  в   которой
                               пользователь   может   передвигаться  от
                               одного блока управления  к  другому  при
                               помощи  клавиш управления курсором.  Все
                               блоки  управления,  определенные   после
                               первого   блока   управления   с   типом
                               WS_GROUP,  принадлежат  той   же   самой
                               группе.   Следующий  блок  управления  с
                               типом WS_GROUP заканчивает первую группу
                               и  начинает следующую (т.е.  одна группа
                               заканчивается   там,   где    начинается
                               следующая). Этот тип используется только
                               панелью диалога.

        WS_HSCROLL             Создает окно,   имеющее   горизонтальную
                               строку прокрутки.

        WS_ICONIC              Создает окно,    которое   первоначально
                               существует в  виде  иконы.  Используется
                               только с типом WS_OVERLAPPED.

        WS_MAXIMIZE            Создает окно максимального размера.

        WS_MAXIMIZEBOX         Создает окно,       имеющее       панель
                               максимизации.

        WS_MINIMIZE            Создает окно минимального размера.

        WS_MINIMIZEBOX         Создает окно,       имеющее       панель
                               минимизации.


       Windows 3.0/Ref/2#7                                       = 92 =

        WS_OVERLAPPED          Создает перекрывающееся окно.  Оно имеет
                               заголовок и бордюр.

        WS_OVERLAPPEDWINDOW    Создает перекрывающееся   окно,  имеющее
                               типы     WS_CAPTION,      WS_OVERLAPPED,
                               WS_THICKFRAME        и       WS_SYSMENU,
                               WS_MAXIMIZEBOX и WS_MINIMIZEBOX.

        WS_POPUP               Создает накладываемое  окно.  Не   может
                               быть использовано с типом WS_CHILD.

        WS_POPUPWINDOW         Создает накладывающееся  окно,   имеющее
                               типы  WS_POPUP,  WS_BORDER и WS_SYSMENU.
                               Тип WS_CAPTION должен быть скомбинирован
                               с  типом WS_POPUPUPWINDOW для того,  что
                               бы сделать меню видимым.

        WS_SYSMENU             Создает   окно,    которое имеет панель
                               системного меню   в   строке  заголовка.
                               Используется только для окон со  строкой
                               заголовка.

        WS_TABSTOP             Специфицирует   некоторое число  блоков
                               управления,  через которые пользователь
                               может перемещаться при  помощи  клавиши
                               TAB. Клавиша табуляции перемещает поль-
                               зователя  к следующему блоку управления
                               с типом WS_TABSTOP. Используется только
                               с панелью диалога.

        WS_THICKFRAME          Создает окно с панелью размера.

        WS_VISIBLE             Создает окно, которое первоначально ви-
                               димо. Используется  для накладываемых и
                               перекрывающихся  окон.  Для перекрываю-
                               щихся  окон параметр Y используется как
                               параметр функции ShowWindow.

        WS_VSCROLL             Создает  окно,   имеющее   вертикальную
                               строку прокрутки.





       Windows 3.0/Ref/2#7                                       = 93 =

        Таблица 4.4  Типы блоков управления
        ───────────────────────────────────────────────────────────────
        Тип                    Значение
        ───────────────────────────────────────────────────────────────
        Класс BUTTON
        ───────────────────────────────────────────────────────────────

        BS_AUTOCHECKBOX        Идентично BS_CHECKBOX   за   исключением
                               того,  что мягкая клавиша  автоматически
                               переключает    свое   состояние,   когда
                               пользователь нажимает на нее.

         BS_AUTORADIOBUTTON    Идентично BS_ RADIOBUTTON за исключением
                               того,  что  когда  клавиша  ставится  на
                               контроль,  прикладная программа получает
                               уведомляющее сообщение BN_CLICKED,  и со
                               всех  других  клавиш  установки   данной
                               груупы удаляются контрольные отметки.

         BS_AUTO3STATE         Идентично BS_3STATE,   за    исключением
                               того,  что  мягкая клавиша автоматически
                               переключает свое состояние  каждый  раз,
                               когда пользователь нажимает ее.

         BS_CHECKBOX           Небольшая прямоугольная  мягкая  клавиша,
                               которая  может  ставится   на   контроль
                               (панель контроля). Ее граница становится
                               толще, когда пользователь "нажимает" ее.
                               Справа    от    клавиши    располагается
                               некоторый текст.

         BS_DEFPUSHBUTTON      Небольшая мягкая  клавиша  эллиптической
                               формы      с     утолщенной     границей
                               (альтернативная клавиша  по  умолчанию).
                               Эта     клавиша    представляет    ответ
                               пользователя   по   умолчанию.    Внутри
                               клавиши  индицируется  некоторый  текст.
                               Система Windows    посылает    сообщение
                               родительскому окну,  когда  пользователь
                               нажимает на клавишу.

         BS_GROUPBOX           Прямоугольник, в  котором  сгруппированы
                               некоторые   мягкие   клавиши.   В  левом
                               верхнем углу прямоугольника индицируется
                               текст.

         BS_LEFTTEXT           Текст располагается   на  левой  стороне
                               клавиши установки или  панели  контроля.
                               Этот тип используется совместно с типами
                               BS_CHECKBOX,     BS_RADIOBUTTON      или
                               BS_3STATE.

         BS_OWNERDRAW          Мягкая клавиша,             определяемая

       Windows 3.0/Ref/2#7                                       = 94 =

                               пользователем.     Родительское     окно
                               получает уведомление,  когда  нажимается
                               клавиша.   Уведомление  включает  запрос
                               нарисовать,  инвертировать и  уничтожить
                               клавишу, когда это необходимо.

         BS_PUSHBUTTON         Небольшая эллиптическая         клавиша,
                               содержащая    заданный    текст.    Блок
                               управления       посылает      сообщение
                               родительскому  окну  всякий  раз,  когда
                               пользователь нажимает клавишу.

         BS_RADIOBUTTON        Небольшая мягкая  клавиша  круглой формы
                               (клавиша   установки),    чья    граница
                               утолщается,  когда пользователь нажимает
                               ее.    Какой    нибудь    текст    может
                               располагаться справа от клавиши. Обычно,
                               две  или  более   клавиши   группируются
                               вместе  и  представляют несколько команд
                               для выполнения,  так как  не  более  чем
                               одна клавиша в группе тестируется в одно
                               время.

         BS_3STATE             Идентично BS_CHECKBOX,   за  исключением
                               того,  что мягкая клавиша может  сереть,
                               контролироваться          или         не
                               контролироваться.  Серый   цвет   обычно
                               используется  для того,  чтобы показать,
                               что панель контроля запрещена.

        ───────────────────────────────────────────────────────────────
         Класс COMBOBOX
        ───────────────────────────────────────────────────────────────
         CBS_AUTOHSCROLL      Прокручивает текст в редактируемом  блоке
                              управления   влево    когда  пользователь
                              набирает символ в конце строки. Если этот
                              тип  не  установлен,  то  допустим только
                              текст   который   вмещается   в   границы
                              прямоугольника.

         CBS_DROPDOWN         То же  что  CBS_SIMPLE,   однако   панель
                              перечня не отображается если пользователь
                              не нажал "кнопку выброса",  следующую  за
                              полем выбора.

         CBS_DROPDOWNLIST     То же     что     CBS_DROPDOWN,    однако
                              редактируемый  блок  управления  содержит
                              статический   текст,  который  отображает
                              текущий выбор в панели перечня.

         CBS_HASSTRING        Определяет    комбинированный        блок
                              управления,    рисуемый    пользователем,
                              который   содержит   элементы  содержащие

       Windows 3.0/Ref/2#7                                       = 95 =

                              строки.  Комбинированный блок  управления
                              поддерживает память и указатели для строк
                              таким образом,  что прикладная  программа
                              может  использовать  сообщение LB_GETTEXT
                              для  возвращения   текста   определенному
                              элементу.

         CBS_OEMCONVERT       Текст, введенный  в  редактируемом  блоке
                              комбинированного     блока    управления,
                              конвертируется  из  символьной  установки
                              ANSI  в  символьную установку OEM и затем
                              обратно  в  ANSI.   Этим   обеспечивается
                              правильное преобразование символов, когда
                              прикладная  программа  вызывает   функцию
                              AnsiToOem  для преобразования ANSI строки
                              в комбинированной  панели  в OEM символы.
                              Этот  тип  в  основном   используется   в
                              комбинированных     блоках    управления,
                              содержащих имена файлов,  и  поддерживает
                              только  комбинированные  блоки управления
                              созданные   с   типами    CBS_SIMPLE    и
                              CBS_DROPDOWN.

         CBS_OWNERDRAWFIXED   Определяет комбинированный           блок
                              управления     рисуемый     пользователем
                              фиксированной  высоты.  Владелец   панели
                              перечня  ответственен  за  рисование  его
                              содержимого;  элементы в  панели  перечня
                              все одинаковой высоты.

         CBS_OWNERDRAWVARIABLE     Определяет   комбинированный    блок
                              управления     рисуемый     пользователем
                              изменяемой    высоты.   Владелец   панели
                              перечня  ответственен  за  рисование  его
                              содержимого;  элементы  в  панели перечня
                              могут иметь различную высоту.

         CBS_SIMPLE           Отображает панель перечня всегда. Текущий
                              выбор  в  панели  перечня  отображается в
                              редактируемом блоке управления.

         CBS_SORT             Сортирует строки   введенные   в   панели
                              перечня.

        ───────────────────────────────────────────────────────────────
         Класс EDIT
        ───────────────────────────────────────────────────────────────

         ES_AUTOHSCROLL       Текст автоматически   прокручивается   на
                              десять     символов     вправо,     когда
                              пользователь   вводит   символ   в  конце
                              строки. Когда    пользователь    нажимает
                              клавишу возврата каретки, блок управления

       Windows 3.0/Ref/2#7                                       = 96 =

                              прокручивает  весь  текст назад к позиции
                              0.

         ES_AUTOVSCROLL       Текст автоматически   прокручивается   на
                              одну страницу вперед,  когда пользователь
                              нажимает   клавишу   возврата    каретки,
                              находясь на последней строке.

         ES_CENTER            Центрирование текста.  Этот  тип допустим
                              толко   в   многострочных   редактируемых
                              блоках.

         ES_LEFT              Выравнивание текста по левой границе.

         ES_LOWERCASE         Нижний регистр    редактируемого    блока
                              управления. Блок  редактирования  с  этим
                              типом  преобразует  все символы в символы
                              нижнего регистра,  когда они  вводятся  в
                              редактируемом блоке.

         ES_MULTILINE         Многострочный редактируемый          блок
                              управления.  (По  умолчанию одна строка.)
                              Если    задан     тип     ES_AUTOVSCROLL,
                              редактируемый  блок управления индицирует
                              столько  строк,   сколько   возможно,   и
                              осуществляет    вертикальную   прокрутку,
                              когда   пользователь   нажимает   клавишу
                              возврата   каретки.(На   самом  деле  это
                              символ  возврата  каретки,  который  блок
                              редактирования  расширяет  до  комбинации
                              возврат каретки/перевод  строки.  Перевод
                              строки  выполняется  не  так  как возврат
                              каретки.)  Если  тип  BS_AUTOVSCROLL   не
                              задан, блок управления индицирует столько
                              строк,   сколько   возможно,   и   подает
                              звуковой сигнал,  если нажимается клавиша
                              возврата каретки, когда уже больше нельзя
                              индицировать следующую строку. Если задан
                              тип    ES_AUTOHSCROLL,    данный     блок
                              управления   автоматически   осуществляет
                              горизонтальную  прокрутку,  когда  символ
                              выходит    за    правую   границу   блока
                              управления.  Для  того,  чтобы  начать  с
                              новой строки,  пользователь должен нажать
                              клавишу    возврата     каретки.     Если
                              ES_AUTOHSCROLL не задан,  блок управления
                              автоматически переносит слово,  когда это
                              необходимо; пользователь может перейти на
                              новую строку и с помощью нажатия  клавиши
                              возврата   каретки.  Позиция,  с  которой
                              переносится слово,  определяется размером
                              окна.   Если   размер   окна  изменяется,
                              изменяется   и   позиция,    с    которой

       Windows 3.0/Ref/2#7                                       = 97 =

                              переносится  слово  и  текст индицируется
                              заново.  Многострочный редактируемый блок
                              управления  может иметь строки прокрутки.
                              Редактируемый блок управления со строками
                              прокрутки  обрабатывает  свои собственные
                              сообщения о прокрутке. Редактируемый блок
                              управления     без     строк    прокрутки
                              осуществляет прокрутку как описано  выше,
                              и    посылает   сообщения   о   прокрутке
                              родительскому окну.

         ES_NOHIDESEL         Обычно редактируемый    блок   управления
                              делает невидимой выборку, когда снимается
                              настройка  на ввод и инвертирует выборку,
                              когда  настраивается  на   ввод   данных.
                              Спецификация  ES_NOHIDESEL  подавляет это
                              действие, принятое по умолчанию.

         ES_OEMCONVERT        Текст, введенный  в  редактируемом  блоке
                              конвертируется из  символьной   установки
                              ANSI  в  символьную установку OEM и затем
                              обратно  в  ANSI.   Этим   обеспечивается
                              правильное преобразование символов, когда
                              прикладная  программа  вызывает   функцию
                              AnsiToOem  для преобразования ANSI строки
                              вкомбинированной панели  в  OEM  символы.
                              Этот   тип   в  основном  используется  в
                              редактируемых     блоках      управления,
                              содержащих имена файлов.

         ES_PASSWORD          Пароль редактируемого  блока  управления.
                              Блок    редактирования   с   этим   типом
                              преобразует   все   символы   в    символ
                              звездочка   (*),  когда  они  вводятся  в
                              редактируемом блоке.Прикладная  программа
                              может        использовать       сообщение
                              EM_SETPASSWORDCHAR     для      изменения
                              символов, которые отображены.

         ES_RIGHT             Выравнивание текста  по  правой  границе.
                              Этот тип допустим толко  в  многострочных
                              редактируемых блоках.

         ES_UPPERCASE         Верхний регистр    редактируемого   блока
                              управления. Блок  редактирования  с  этим
                              типом преобразует все символы  в  символы
                              верхнего  регистра,  когда они вводятся в
                              редактируемом блоке.
        ───────────────────────────────────────────────────────────────
         Класс LISTBOX
        ───────────────────────────────────────────────────────────────
         LBS_EXTENDEDSEL      Пользователь может    выбрать   несколько
                              элементов  используя  "мышь"  с  клавишей

       Windows 3.0/Ref/2#7                                       = 98 =

                              SHIFT   и   (или)  клавишей  CONTROL  или
                              специальную комбинацию клавиш.

         LBS_HASSTRING        Определяет панель    перечня,    рисуемую
                              пользователем,  которая содержит элементы
                              содержащие   строки.    Панель    перечня
                              управления    поддерживает    память    и
                              указатели для строк  таким  образом,  что
                              прикладная  программа  может использовать
                              сообщение  LB_GETTEXT   для   возвращения
                              текста определенному элементу.

         LBS_MULTICOLUMN      Панель перечня     содержит     несколько
                              колонок.     Панель     перечня     может
                              прокручиваться  горизонтально.  Сообщение
                              LB_SETCOLUMNWIDTH  устанавливает   ширину
                              колонок.

         LBS_MULTIPLESEL      Выбор строки происходит каждый раз, когда
                              пользователь нажимает или дважды нажимает
                              кнопку "мыши",  находясь на строке. Может
                              быть выбрано любое количество строк.

        LBS_NOINTEGRALHEIGHT  Размер панели  перечня  точно  определен
                              прикладной программой при создании панели
                              перечня.  Обычно  Windows   устанавливает
                              размеры  панелей перечня так,  что панель
                              перечня не отображает часть элементов.

         LBS_NOREDRAW         Отображение панели       перечня       не
                              корректируется, когда делаются изменения.
                              Этот тип может быть изменен в любое время
                              при     помощи     посылки      сообщения
                              WM_SETREDRAW.

         LBS_NOTIFY           Родительское окно    получает   сообщение
                              ввода  каждый  раз,  когда   пользователь
                              нажимает   или   дважды  нажимает  кнопку
                              "мыши", находясь на строке.

         LBS_OWNERDRAWFIXED   Определяет  панель    перечня    рисуемую
                              пользователем    фиксированной    высоты.
                              Владелец панели перечня  ответственен  за
                              рисование ее  содержимого;   элементы   в
                              панели перечня все одинаковой высоты.

         LBS_OWNERDRAWVARIABLE  Определяет  панель   перечня   рисуемую
                              пользователем изменяемой высоты. Владелец
                              панели перечня ответственен за  рисование
                              ее содержимого; элементы в панели перечня
                              могут иметь различную высоту.

       Windows 3.0/Ref/2#7                                       = 99 =


         LBS_SORT             Строки  в  панели  перечня сортируются по
                              алфавиту.

         LBS_STANDART         Строки в панели перечня  отсортированы  в
                              алфавитном порядке  и  родительское  окно
                              получает     сообщение     ввода    когда
                              пользователь нажимает один или  два  раза
                              кнопку "мыши" находясь на строке.  Панель
                              перечня имеет рамку со всех сторон.

         LBS_USETABSTOPS      Панель перечня   может   распознавать   и
                              расширять    символы   табуляции,   когда
                              отображаются  ее  строки.  По   умолчанию
                              позиции  табуляции устанавливаются каждые
                              32   единицы   панели    диалога.(Единица
                              измерения      панели     диалога     это
                              горизонтальная и вертикальная  дистанция.
                              Одна диалоговая единица равна 1/4 текущей
                              диалоговой  базовой  единицы   измерения.
                              Базовая  единица измерения вычисляется из
                              ширины  и  высоты   текущего   системного
                              шрифта.     Функция    GetDialogBaseUnits
                              возвращает   размер    базовой    единицы
                              измерения в пикселях.)

         LBS_WANTKEYBOARDINPUT  Владелец панели     перечня    получает
                              сообщения WM_VKEYTOITEM или WM_CHARTOITEM
                              всегда,   когда   пользователь   нажимает
                              клавишу,  находясь в панели перечня.  Это
                              позволяет  прикладной программе выполнять
                              специальные   действия   при   вводе    с
                              клавиатуры.

        ───────────────────────────────────────────────────────────────
         Класс SCROLLBAR
        ───────────────────────────────────────────────────────────────

         SBS_BOTTOMALIGN      Используется с  SBS_HORZ.  Нижняя граница
                              строки прокрутки выравнивается по  нижней
                              границе   прямоугольника,   определяемого
                              параметрами X, Y, nWidth, nHeight функции
                              CreateWindow.    Строка    прокрутки   по
                              умолчанию имеет  высоту  системных  строк
                              прокрутки.

         SBS_HORZ             Горизонтальная строка прокрутки.  Если не
                              специфицировано ни        SBS_BOTTOMALIGN
                              SBS_TOPALIGN,  строка   прокрутки   имеет
                              высоту, ширину и расположение, заданные в
                              функции CreateWindow.

         SBS_LEFTALIGN        Используется с  SBS_VERT.  Левая  граница

       Windows 3.0/Ref/2#7                                      = 100 =

                              строки прокрутки выравнивается  по  левой
                              границе   прямоугольника,   определяемого
                              параметрами X, Y, nWidth, nHeight функции
                              CreateWindow.    Строка    прокрутки   по
                              умолчанию имеет  ширину  системных  строк
                              прокрутки.

         SBS_RIGHTALIGN       Используется с  SBS_VERT.  Правая граница
                              строки прокрутки выравнивается по  правой
                              границе   прямоугольника,   определяемого
                              параметрами X, Y, nWidth, nHeight функции
                              CreateWindow.    Строка    прокрутки   по
                              умолчанию имеет  ширину  системных  строк
                              прокрутки.

         SBS_SIZEBOX          Панель размера.  Если  не специфицировано
                              ни    SBS_SIZEBOXBOTTOMRIGHTALIGN,     ни
                              SBS_SIZEBOXTOPLEFTALIGN,  панель  размера
                              имеет  высоту,  ширину  и   расположение,
                              заданные в вызове функции CreateWindow.

         SBS_SIZEBOXBOTTOM-   Используется с SBS_SIZEBOX. Нижний правый
                RIGHTALIGN    угол  панели  размера  выравнивается   по
                              нижнему   правому   углу  прямоугольника,
                              определяемого параметрами X,  Y,  nWidth,
                              nHeight   функции   CreateWindow.  Панель
                              размера   по   умолчанию   имеет   размер
                              системных панелей размера.

         SBS_SIZEBOXTOP-      Используется с SBS_SIZEBOX. Верхний левый
                LEFTALIGN     угол  панели  размера  выравнивается   по
                              верхнему   левому   углу  прямоугольника,
                              определяемого параметрами X,  Y,  nWidth,
                              nHeight   функции   CreateWindow.  Панель
                              размера   по   умолчанию   имеет   размер
                              системных панелей размера.

         SBS_TOPALIGN         Используется с SBS_HORZ.  Верхняя граница
                              строки прокрутки выравнивается по верхней
                              границе   прямоугольника,   определяемого
                              параметрами X, Y, nWidth, nHeight функции
                              CreateWindow.    Строка    прокрутки   по
                              умолчанию имеет  высоту  системных  строк
                              прокрутки.

         SBS_VERT             Вертикальная строка  прокрутки.  Если  не
                              специфицировано  ни  SBS_RIGHTALIGN,   ни
                              SBS_LEFTALIGN,   строка  прокрутки  имеет
                              высоту, ширину и расположение, заданные в
                              функции CreateWindow.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 101 =

         Класс STATIC
        ───────────────────────────────────────────────────────────────

         SS_BLACKFRAME        Панель с рамкой,  рисуемой тем же  цветом
                              что и окно. Этот цвет черный по умолчанию
                              в цветовой схеме Windows.

         SS_BLACKRECT         Прямоугольник, заполненный        цветом,
                              используется  для  рисования  окон.  Этот
                              цвет черный по умолчанию в цветовой схеме
                              Windows.

         SS_CENTER            Простой прямоугольник   с  индицированным
                              центрированным текстом.             Текст
                              форматируется    перед    индицированием.
                              Слова,  которые  выходят за конец строки,
                              автоматически   переносятся   в    начало
                              следующей строки.

         SS_GRAYFRAME         Панель с рамкой,  рисуемой тем же  цветом
                              что  и  фон  экрана.  Этот  цвет серый по
                              умолчанию в цветовой схеме Windows.

         SS_GRAYRECT          Прямоугольник, заполненный        цветом,
                              используется  для фона экрана.  Этот цвет
                              серый  по  умолчанию  в  цветовой   схеме
                              Windows.

         SS_ICON              Икона, индицируемая   в  панели  диалога.
                              Заданный текст - имя  иконы  (но  не  имя
                              файла),  определяемое  в  файле  описания
                              ресурсов.  Для оператора  ICON  параметры
                              nWidth  и  nHeight  функции  CreateWindow
                              игнорируются;  размеры   иконы   задаются
                              автоматически.

         SS_LEFT              Простой прямоугольник   с  индицированным
                              текстом, выравненным  по  левой  границе.
                              Текст форматируется перед индицированием.
                              Слова,  которые выходят за конец  строки,
                              автоматически    переносятся   в   начало
                              следующей строки.

         SS_LEFTNOWORDWRAP    Простой прямоугольник  с   индицированным
                              текстом, выравненным  по  левой  границе.
                              Табуляция есть,  но слова не переносятся.
                              Слова,  которые выходят за конец  строки,
                              отрезаются.

         SS_NOPREFIX          Если этот  тип не определен Windows будет
                              интерпретировать  любой  символ   "&"   в
                              тексте   блока  управления,  как  префикс
                              символа ускорителя.  В этом случае символ
                              "&"   опускается  и  следующий  символ  в

       Windows 3.0/Ref/2#7                                      = 102 =

                              строке подчеркивается.  Если  статический
                              блок  управления содержит текст,  где это
                              не желательно,  то тип SS_NOPREFIX должен
                              быть добавлен.  Этот тип блока управления
                              может быть включен с любыми определенными
                              статическими блоками управления.

                              Вы можете   комбинировать  SS_NOPREFIX  с
                              другими типами  при  помощи   поразрядной
                              операции   OR.   Этот   тип   в  основном
                              используется,  когда  имена  файлов   или
                              другие   строки  могут  содержать  "&"  и
                              должны  быть  отображены  в   статическом
                              блоке управления в панели диалога.

         SS_RIGHT             Простой прямоугольник  с   индицированным
                              текстом, выравненным по  правой  границе.
                              Текст форматируется перед индицированием.
                              Слова,  которые выходят за конец  строки,
                              автоматически    переносятся   в   начало
                              следующей строки.

         SS_SIMPLE            Простой прямоугольник  с  индицированнной
                              одной   строкой  текста,  выравненной  по
                              левой границе.  Строка  текста  не  может
                              укорачиваться  или  изменяться каким-либо
                              способом.   (Родительское   окно    блока
                              управления  или  панель диалога не должна
                              обрабатывать сообщение WM_CTLCOLOR).

         SS_USERITEM          Элемент, определяемый пользователем.

         SS_WHITEFRAME        Панель с рамкой,  рисуемой тем же  цветом
                              что  и  фон  окна.  Этот  цвет  белый  по
                              умолчанию в цветовой схеме Windows.

         SS_WHITERECT         Прямоугольник, заполненный        цветом,
                              используется  для  фона  окна.  Этот цвет
                              белый  по  умолчанию  в  цветовой   схеме
                              Windows.

        ───────────────────────────────────────────────────────────────



        ───────────────────────────────────────────────────────────────
                                CreateWindowEx   [3.0]                         

        Синтаксис

             HWND  CreateWindowEx( dwExStyle, lpClassName,lpWindowName,
                                   dwStyle,      X,      Y,     nWidth,
                                   nHeight,hWndParent,           hMenu,

       Windows 3.0/Ref/2#7                                      = 103 =

                                   hInstance, lpParam)

             Эта функция  создает  перекрывающиеся,   накладываемые   и
        дочерние  окна  с  дополнительным типом.  Во всем остальном она
        схожа с функцией CreateWindow.  Для дополнительной информации о
        сщздании окна и для полного описания других параметров смотрите
        функцию CreateWindow

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             dwExStyle         DWORD Определяет     дополнительный  тип
                               создаваемого окна.    В   таблице   4.5,
                               "Дополнительные  типы  окон",   приведен
                               список дополнительных типов окон.

             lpClassName       LPSTR Указывает на оканчивающуюся  нулем
                               строку символов, именующую  класс  окна.

             lpWindowName      LPSTR Указывает на оканчивающуюся  нулем
                               строку  символов,   представляющую   имя
                               окна.

             dwStyle           DWORD Определяет тип создаваемого  окна.

             X                 int     Определяет        первоначальное
                               расположение окна по оси x.

             Y                 int     Определяет       первоначальное
                               расположение окна по оси y.

             nWidth            int Определяет ширину окна  (в  единицах
                               устройства).

             nHeight           int Определяет высоту окна  (в  единицах
                               устройства).

             hWndParent        HWND  Идентифицирует  родительское  окно
                               для  создаваемого  окна.

             hMenu             HMENU Определяет меню или  идентификатор
                               дочернего окна. Значение зависит от типа
                               окна.

             hInstance         HANDLE Идентифицирует экземпляр  модуля,
                               связанного с окном.

             lpParam           LPSTR  Указывает  на  длинное  значение,
                               которое передается окну  через  параметр
                               lpParam сообщения WM_CREATE.

             ──────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                      = 104 =

             Возвращаемое значение

             Возвращаемое значение  идентифицирует  новое  окно.  Равно
        NULL, если окно не создано.

             Примечание

        Таблица 4.5   Список дополнительных типов окон.
        ───────────────────────────────────────────────────────────────
        Тип                    Значение
        ───────────────────────────────────────────────────────────────

        WS_EX_DLGMODALFRAME    Обозначает окно  с  двойной  окантовкой,
                               которое  по желанию может быть совмещено
                               со   строкой   заголовка,   определенной
                               флагом   типа   WS_CAPTION  в  параметре
                               dwStyle.

        WS_EX_NOPARENTNOTIFY   Определяет, что  дочернее окно созданное
                               с этим типом не будет посылать сообщение
                               WM_PARENTNOTIFY   в  родительское  окно,
                               когда  дочернее   окно   создается   или
                               разрушается.

        ───────────────────────────────────────────────────────────────

             В таблице  4.2,  "Классы  блоков   управления",   показаны
        встроенные классы блоков управления окон;  В таблице 4.3, "Типы
        окон",  показаны типы окон,  а  в  таблице  4.4,  "Типы  блоков
        управления", приведен   список  типов  блоков  управления.  Эти
        таблицы находятся в описании функции CreateWindow.


        ───────────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                      = 105 =

                                                                               
       DebugBreak [3.0]

        Синтаксис

             void DebugBreak ( )

             Эта функция заставляет прервать работу отладчика.

             Эта функция не имеет параметров.


        Возвращаемое значение

             Отсуствует


        ───────────────────────────────────────────────────────────────
                                   DefDlgProc [3.0]                            

        Синтаксис

             LONG DefDlgProc (hDlg,wMsg,wParam,lParam)

             Эта функция  обеспечивает  по  умолчанию  обработку любого
        сообщения Windows,  которое не обрабатывает  панель  диалога  с
        собственным классом окна.

             Все сообщения  окна,  которые не точно обработаны функцией
        окна,  должны быть переданы функции DefDlgProc,  а  не  функции
        DefWindowProc.   Это   гарантирует,   что   все   сообщения  не
        обработанные  их  собсвенной  функцией  окна  будут  обработаны
        надлежащим образом.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDlg              HMWND Определяет панель диалога.

             hMsg              WORD Определяет номер сообщения.

             wParam            WORD Определяет 16  бит  дополнительной,
                               зависящей от сообщения информации.

             lParam            DWORD Определяет 32 бита дополнительной,
                               зависящей от сообщения информации.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   определяет   результат   обработки
        сообщения и зависит от реального, посланного сообщения.

       Windows 3.0/Ref/2#7                                      = 106 =


        Примечание

             Исходный код для функции DefDlgProc  находится  на  дисках
        SDK.

             Прикладная программа  создает  панель  диалога посредством
        вызова одной из следующих функций:

             Функция                Описание
             ──────────────────────────────────────────────────────────

             CreateDialog           Создает немодальную панель диалога.

             CreateDialogIndirect   Создает немодальную панель диалога.

             CreateDialogIndirectParam   Создает   немодальную   панель
                                    диалога и передает ей данные при ее
                                    создании.

             CreateDialogParam      Создает немодальную панель  диалога
                                    и передает   ей   данные   при   ее
                                    создании.

             DialogBox              Создает модальную панель диалога.

             DialogBoxIndirect      Создает модальную панель диалога.

             DialogBoxIndirectParam Создает  модальную панель диалога и
                                    передает ей данные при ее создании.

             DialogBoxParam         Создает  модальную  панель  диалога
                                    и передает   ей   данные   при   ее
                                    создании.


        ───────────────────────────────────────────────────────────────
                                DefferWindowProc [3.0]                         

        Синтаксис

             HANDLE DefferWindowProc(hWinPosInfo,hWnd,hWndInsertAfter,
                                                      x,y,cx,cy,wFlags)

             Эта функция изменяет структуры данных нескольких положений
        окна, определенную    параметром    hWinPosInfo    для    окна,
        определенного параметром    hWnd    и   возвращает   дескриптор
        измененной структуры.  Функция   EndDeferWindowPos   использует
        информацию в  этой  структуре  для изменения позиции и размеров
        некоторого числа окон одновременно.  Функция BegiDeferWindowPos
        создает структуру    данных    нескольких    положений    окна,
        используемуб этой функцией.


       Windows 3.0/Ref/2#7                                      = 107 =

             Параметры x и y определяют новую позицию окна, а параметры
        cx и cy определяют новый размер окна.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWinPosInfo       HANDLE Определяет    структуру    данных
                               нескольких   положений   окна,   которая
                               содержит  информацию о размере и позиции
                               для  одного  или  нескольких  окон.  Эта
                               структура      возвращается     функцией
                               BeginDeferWindowPos   или,  в   основном
                               недавним вызовом функции DeferWindowPos.

             nWhd              HWND Определяет   окно   для    которого
                               измененная    информация   должна   быть
                               сохранена в структуре данных.

             hWndInsertAfter   HWND Определяет окно,  вслед за  которым
                               окно,   определенное   параметром   hWnd
                               должно быть изменено.

             x                 int Определяет   x  координату  верхнего
                               левого угла окна.

             y                 int Определяет   y  координату  верхнего
                               левого угла окна.

             cx                int Определяет новую ширину окна.

             cy                int Определяет новую высоту окна.

             wFlags            WORD Определяет  одно  из  восьми  16  -
                               разрядных значений, которые воздействуют
                               на размер и позицию окна. Это может быть
                               одна из следующих величин:

                               Величина            Значение
                               ────────            ────────

                               SWP_DRAWFRAME       Рисует     окантовку
                                                   (определеную       в
                                                   описании      класса
                                                   окна) вокруг окна.

                               SWP_HIDEWINDOW      Прячет окно.

                               SWP_NOACTIVATE      Не делает       окно
                                                   активным.

                               SWP_NOMOVE          Сохраняет    текущую
                                                   позицию (параметры x

       Windows 3.0/Ref/2#7                                      = 108 =

                                                   и y игнорируются).

                               SWP_NOREDRAW        Не    перерисовывает
                                                   изменения.

                               SWP_NOSIZE          Сохраняет    текущий
                                                   размер (параметры cx
                                                   и cy игнорируются).

                               SWP_NOZORDER        Сохраняет    текущий
                                                   порядок(игнорируется
                                                   параметр
                                                   hWndInsertAfter).

                               SWP_SHOWWINDOW      Отображает окно.


             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  определяет   измененную   структуру
        данных нескольких положений окна.  Дескриптор возвращаемый этой
        функцией может отличаться от дескриптора,  переданного функции,
        как параметр hWinPosInfo.  Новый дескриптор,  возвращаемый этой
        функцией должен  быть  передан  в  последующие  вызовы  функций
        DeferWindowPos или EndDeferWindowPos.

             Возвращаемое значение  NULL,  если  недостаточно системных
        ресурсов  имеется  в  распоряжении  для  успешного   завершения
        функции.


        Примечание

             Если флагSWP_NOZORDER не определен,  то Windows  размещает
        окно, определенное  параметром  hWnd  в  позиции  следующей  за
        окном,  определенным параметром hWndInsertAfter.  Если параметр
        hWndInsertAfter NULL, то Windows располагает окно, определенное
        параметром hWnd, на верху списка. Если параметр hWndInsertAfter
        установлен   в   1,   Windowsрасполагает   окно,   определенное
        параметром hWnd, внизу списка.

             Если установлены флаги SWP_SHOWWINDOW или  SWP_HIDEWINDOW,
        прокрутка    и   перемещение   не   могут   быть   осуществлены
        одновременно.

             Bce координаты для дочернего окна вычисляются относительно
        верхнего левого угла области пользователя родительского окна.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 109 =

                                  DefFrameProc [3.0]                           

        Синтаксис

             LONG DefFrameProc(hWnd,hWndMDIClient,wMsg,Wparam,lParam)

             Эта функция обеспечивает  обработку  по  умолчанию  любого
        сообщения Windows,  которое  не  обрабатывается  функцией  окна
        фрейма интерфейса множества  документов  (MDI).  Все  сообщения
        окна, которые  не  точно  обработаны  функцией окна должны быть
        переданы функции DefFrameProc, а не функции DefWindowProc.



             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND Определяет окно фрейма MDI.

             hWndMDIClient     HWND Определяет окно пользователя MDI.

             hMsg              WORD Определяет номер сообщения.

             wParam            WORD Определяет 16  бит  дополнительной,
                               зависящей от сообщения информации.

             lParam            DWORD Определяет 32 бита дополнительной,
                               зависящей от сообщения информации.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   определяет   результат   обработки
        сообщения и зависит от  того  какое  конкретно  сообщение  было
        послано. Если  параметр  hWndMDIClient  NULL,  то  возвращаемое
        значение такое же как и для функции DefWindowProc.


        Примечание

             Обычно, когда   функция   окна   прикладной  программы  не
        обрабатывает  сообщение,   она   передает   сообщение   функции
        DefWindowProc,  которая обрабатывает его.  Прикладные программы
        MDI используют функции DefFrameProc  и  DefMDIChildProc  вместо
        функции  DefWindowProc  для  обеспечения обработки сообщения по
        умолчанию.  Все сообщения,  которые прикладная программа должна
        обычно    передать    функции   DefWindowProc   (   такие   как
        непользовательские сообщения и WM_SETTEXT) должны быть переданы
        вместо  этого  функции  DefFrameProc.  В  дополнение  к этому ,
        функция DefFrameProc также обрабатывает следующие сообщения:


       Windows 3.0/Ref/2#7                                      = 110 =

             Сообщение         Обрабатывается по умочанию функцией
                                                           DefFrameProc
             ──────────────────────────────────────────────────────────
             WM_COMMAND        Окно фрейма   прикладной  программы  MDI
                               получает   сообщение   WM_COMMAND    для
                               активизации определенного дочернего окна
                               MDI. Идентификатор ID окна, переданный с
                               этим  сообщением будет ID дочернего окна
                               MDI  присвоенный  Windows,   начиная   с
                               первого   ID,  определенного  прикладной
                               программой,   при   создании   ее   окна
                               пользователя  MDI.  Эта величина первого
                               ID не должна пересекаться с ID элементов
                               меню.

             WM_MENUCHAR       Когда нажата клавиша вместе с Alt, будет
                               выбранно   управляющее   меню  активного
                               дочернего окна MDI.

             WM_NEXTMENU       Это сообщение приводит к тому, что будет
                               выбрано   управляющее   меню   активного
                               дочернего окна MDI.

             WM_SETFOCUS       Функция DefFrameProc   передает   захват
                               ввода пользователю MDI, который передает
                               захват ввода активному окну пользователя
                               MDI.

             WM_SIZE           Если процедура окна фрейма передает  это
                               сообщение функции DefFrameProc,  то окно
                               пользователя   MDI,    будет    изменять
                               размеры,   чтобы   поместиться  в  новой
                               области пользователя.  Если функция окна
                               фрейма  определяет  размеры пользователя
                               MDI для различных размеров,  то  она  не
                               должна   передавать   сообщение  функции
                               DefFrameProc.

        ───────────────────────────────────────────────────────────────
                                     DefHookProc                               

        Синтаксис

             DWORD DefHookProc(code,Wparam,lParam,lplpfnNextHook)

             Эта функция  вызывает  следующую функцию в цепочке функций
        ловушек.  Функции ловушек - это функции ,  которые обрабатывают
        события перед  тем,  как они посланы в цикл обработки сообщений
        прикладной программы  в  функции  WinMain.   Когда   прикладная
        программа определяет более  одной  функции  ловушки,  используя
        функцию SetWindowsHook,  Windows создает связанный  список  или
        цепочку ловушек.   Windows   помещает  функции  одного  типа  в
        цепочку.


       Windows 3.0/Ref/2#7                                      = 111 =


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             code              int Определяет     код,     используемый
                               функцией    ловушки    Windows    (также
                               называемой      функцией      фильтрации
                               сообщений)  для  определения  того,  как
                               обрабатывать сообщение.

             wParam            WORD Определяет    параметр    сообщения
                               длиной в  слово,  которое   обрабатывает
                               функция ловушки.

             lParam            DWORD Определяет    параметр   сообщения
                               длинной   в   длинное   слово,   которое
                               обрабатывает функция ловушки.

             lplpfnNextHook    FARPROC FAR  *   Указывает   на   ячейку
                               памяти,  содержащую  структуру  FARPROC,
                               возвращаемую  функцией   SetWindowsHook.
                               Windows  изменяет  значение  этой ячейки
                               после  того,  как  прикладная  программа
                               вызывает функцию UnhookWindowsHook.


             ──────────────────────────────────────────────────────────


        Возвращаемое значение

             Возвращаемое значение    определяет    величину    которая
        полностью зависит от параметра code.

        ───────────────────────────────────────────────────────────────
                               DefineHandleTable [3.0]                         

        Синтаксис

             BOOL DefineHandleTable(wOffset)

             Эта функция  создает  собственную  таблицу  дескрипторов в
        сегменте   данных   прикладной   программы,   используемом   по
        умолчанию. Прикладная  программа  сохраняет  в  таблице  адреса
        сегментов объектов  глобальной  памяти,  возвращаемые  функцией
        GlobalLock.  В реальном режиме, Windows изменяет соотвествующие
        адреса в  собственной  таблице  дескрипторов,  при  перемещении
        объектов глобальной памяти. Когда Windows "сбрасывает" объект с
        соответсвующим  элементом  таблицы,  Windows   заменяет   адрес
        объекта  в  таблице  дескриптором объекта.  Windows не изменяет
        адреса  в  собственной  таблице  дескрипторов  в  защищенном  (
        стандартном или улучшеном 386) режиме.


       Windows 3.0/Ref/2#7                                      = 112 =


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             wOffset           WORD Определяет   смещение   от   начала
                               сегмента  данных  до  начала собственной
                               таблицы дескрипторов. Если wOffset равен
                               нулю,  то  Windows  больше  не  изменяет
                               собственную таблицу дескрипторов.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  не   равно   нулю,   если   функция
        завершена успешно. В противном случае оно равно нулю.


        Примечание

             Собственная таблица дескрипторов имеет следующий формат:

             Count
             Clear_Number
             Entry[0]
             .
             .
             .
             Entry[Count-1]

             Первое WORD  (Count)  в  таблице   определяет   количество
        элементов таблицы.   Второе   WORD   (Cler_Number)   определяет
        количество элементов (  от  начала  таблицы),  которые  Windows
        установит в  ноль,  когда  Windows  изменит  его наиболее давно
        неиспользовавшийся (LRU)  список  памяти.   Остальная   таблица
        содержит массив адресов, возвращаемых функцией GlobalLock.

             Прикладная программа  должна инициализировать поле Count в
        таблице, перед вызовам  функции  DefineHandleTable.  Прикладная
        программа может   изменять   либо   поле   Count,   либо   поле
        Clear_Number в любое время.


        ───────────────────────────────────────────────────────────────
                                DefMDIChildProc [3.0]                          

        Синтаксис

             LONG DefMDIChildProc(hWnd,wMsg,Wparam,lParam)

             Эта функция обеспечивает  по  умолчанию  обработку  любого
        сообщения Windows,  которое  не  обработано  функцией  окна или
        дочерним окном  интерфейса  множества  документов  (MDI).   Все

       Windows 3.0/Ref/2#7                                      = 113 =

        сообщения окна,  которые  не  точно  обработаны  функцией  окна
        должны быть переданы  функции  DefMDIChildProc,  а  не  функции
        DefWindowProc.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND Определяет дочернее окно MDI.

             hMsg              WORD Определяет номер сообщения.

             wParam            WORD Определяет 16  бит  дополнительной,
                               зависящей от сообщения информации.

             lParam            DWORD Определяет 32 бита дополнительной,
                               зависящей от сообщения информации.


             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   определяет   результат   обработки
        сообщения  и  зависит  от  того  какое конкретно сообщение было
        послано.


        Примечание

             Функция полагает,     что    родительское    окно    окна,
        определенного  параметром  hWnd,   было   создано   с   классом
        MDICLIENT.

             Обычно, когда   функция   окна   прикладной  программы  не
        обрабатывает  сообщение,   она   передает   сообщение   функции
        DefWindowProc,  которая обрабатывает его.  Прикладные программы
        MDI используют функции DefFrameProc  и  DefMDIChildProc  вместо
        функции  DefWindowProc  для  обеспечения обработки сообщения по
        умолчанию.  Все сообщения,  которые прикладная программа должна
        обычно    передать    функции   DefWindowProc   (   такие   как
        непользовательские сообщения и WM_SETTEXT) должны быть переданы
        вместо этого  функции  DefMDIChildProc.  В дополнение к этому ,
        функция DefMDIChildProc также обрабатывает следующие сообщения:

             Сообщение         Обрабатывается по умочанию функцией
                                                        DefMDIChildProc
             ──────────────────────────────────────────────────────────

             WM_CHILDACTIVATE  Выполняет обработку  активизации,  когда
                               дочернее    окно    изменяет    размеры,
                               перемещается   или   отображается.   Это
                               сообщение должно быть передано.

       Windows 3.0/Ref/2#7                                      = 114 =



             WM_GETMINMAXINFO  Вычисляет размеры          максимального
                               дочернего  окна  MDI,  на основе текущих
                               размеров окна пользователя MDI.

             WM_MENUCHAR       Посылает клавишу окну фрейма.

             WM_MOVE           Заново вычисляет     строку    прокрутки
                               пользователя MDI, если она существует.

             WM_NEXTMENU       Переносит строку  меню  окна  фрейма или
                               меню управления окна фрейма.

             WM_SETFOCUS       Активизирует дочернее   окно,  если  нет
                               активного дочернего окна MDI.

             WM_SIZE           Выполняет необходимые    операции    при
                               изменении размеров  окна,  особенно  при
                               откладывании  в  икону  и восстановлении
                               дочернего   окна    MDI.    Неправильная
                               передача    этого    сообщения   функции
                               DefMDIChildProc        приведет        к
                               нежелательному результату.

             WM_SYSCOMMAND     Так  же  обрабатывает команду "следующее
                               окно".


        ───────────────────────────────────────────────────────────────
                                    DefWindowProc                              

        Синтаксис

             LONG DefWindowProc(hWnd,wMsg,wParam,lParam)

             Эта функция  обеспечивает  обработку  по  умолчанию   всех
        сообщений среды Windows, которые данная прикладная программа не
        обрабатывает.  Все сообщения окна,  которые  не  обрабатываются
        функцией    класса   окна,   должны   быть   переданы   функции
        DefWindowProc.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND Определяет окно, которое передает
                               сообщение.

             hMsg              WORD Определяет номер сообщения.

             wParam            WORD Определяет 16  бит  дополнительной,
                               зависящей от сообщения информации.


       Windows 3.0/Ref/2#7                                      = 115 =

             lParam            DWORD Определяет 32 бита дополнительной,
                               зависящей от сообщения информации.


             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   определяет   результат   обработки
        сообщения и зависит от фактически посылаемого сообщения.

        Примечание

             Исходный код для функции DefWindowPROC находится на дисках
        SDK.


        ───────────────────────────────────────────────────────────────
                                      DeleteAtom                               

        Синтаксис

             ATOM DeleteAtom(nAtom)

             Эта функция  уничтожает атом и,  если счетчик ссылок атома
        равнен 0, удаляет соответствующую строку из таблицы атомов.

             Счетчик ссылок атома  определяет  число  попыток,  которые
        были предприняты для добавления атома в таблицу атомов. Функция
        AddAtom увеличивает счетчик на 1  при  каждом  вызове;  функция
        DeleteAtom уменьшает счетчик на 1 при каждом вызове. DeleteAtom
        удаляет строку только в том случае,  если счетчик ссылок  атома
        равен 0.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             nAtom             ATOM Идентифицирует  атом  и  символьную
                               строку, которые должны быть удалены.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  определяеся  результатом выполнения
        функции.  Оно равно NULL,  если функция завершена успешно.  Оно
        эквивалентно  параметру nAtom,  если функция не выполнилась,  и
        атом не был уничтожен.


        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 116 =

                                       DeletеDC                                

        Синтаксис

             BOOL DeletеDC(hDC)

             Эта функция удаляет соответствующий  контекст  устройства.
        Если   параметр   hDC  определяет  последний  контекст  данного
        устройства,  то устройство уведомляется об этом, и вся память и
        системные ресурсы, используемые устройством, освобождаются.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDC               HDC Идентифицирует контекст устройства.


             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   определяет   был    ли    контекст
        устройства удален.  Не  равно  нулю,  если  контекст устройства
        успешно удален (вне зависимости от того  является  ли  контекст
        устройства последним для устройства), и равно 0, если произошла
        ошибка.

        Примечание

             Прикладная программа   не    должна    удалять    контекст
        устройства, который  был  получен  посредством  вызова  функции
        GetDC. Вместо  функции  DekeleDC  должна   вызываться   функция
        ReleaseDC для освобождения контекста устройства.

        ───────────────────────────────────────────────────────────────
                                   DeleteMenu [3.0]                            

        Синтаксис

             BOOL DeleteMenu(hMenu,nPosition,wFlags)

             Эта функция удаляет элемент меню  из  меню,  определенного
        параметром  hMenu;  если  элемент  меню  связан с накладываемым
        меню, то функция DkeketMenu разрушает дескриптор накладываемого
        меню и освобождает память, используемую накладываемым меню.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hMenu             HMENU Определяет  меню,  которое  должно
                               быть изменено.


       Windows 3.0/Ref/2#7                                      = 117 =

             nPosition         WORD Определяет  элемент  меню,  который
                               должен быть удален. Если параметр wFlags
                               установлен в MF_BYPOSITION,  то параметр
                               nPosition  определяет  позицию  элемента
                               меню;   первый   элемент  в  меню  имеет
                               позицию   0.   Если   параметр    wFlags
                               установлен  в MF_BYCOMMAND,  то параметр
                               nPosition    определяет    ID    команды
                               существующего элемента меню.

             wFlags            WORD Определяет   как   интерпритируется
                               параметр nPosition.  Это параметр  может
                               быть  установлен  либо  в MF_BYPOSITION,
                               либо в MF_BYCOMMAND ( по умолчанию ).

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение определяется результатом  выполнения
        функции. Оно  равно  TRUE,  если  функция завершена успешно.  В
        противном случае это FALSE.


        Примечание

             Когда бы меню не изменялось ( несмотря на то находится или
        нет меню в  окне,  которое  отображено),  прикладная  программа
        должна вызвать функцию DrawMenuBar.


        ───────────────────────────────────────────────────────────────
                                    DeleteMetaFile                             

        Синтаксис

             BOOL DeleteMetaFile(hMF)

             Эта функция   запрещает  доступ  к  метафайлу,  освобождая
        системные ресурсы,  связанные с  этим  метафайлом.  Функция  не
        уничтожает  метафайл,  но  она портит дескриптор метафайла hMF.
        Метафайл может быть использован вновь  после  получения  нового
        дескриптора посредством функции GetMetaFile.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hMF               HANDLE  Идентифицирует метафайл.


             ──────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                      = 118 =

        Возвращаемое значение

             Возвращаемое значение определяет  испорчен  ли  дескриптор
        метафайла. Оно  не  равно  0,  если  системные ресуры метафайла
        освобождены,  и  равно  0,  если  hMF   является   некорректным
        дескриптором.


        ───────────────────────────────────────────────────────────────
                                     DeleteObject                              

        Синтаксис

             BOOL DeleteObject(hObject)

             Эта функция   удаляет   логическое   перо,  кисть,  шрифт,
        растровую карту,  палитру или область из памяти, освобождая всю
        системную   память,   связанную  с  удаляемым  объектом.  После
        удаления объекта дескриптор hObject более недоступен.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hObject           HANDLE   Идентифицирует       дескриптор
                               логического   пера,    кисти,    шрифта,
                               растровой карты, палитры или области.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  определяет  был   ли   определенный
        объект удален.  Не равно 0, если объект был удален. Равно нулю,
        если параметр hObject  -  недопустимый  дескриптор  или  объект
        выбран как текущий в контексте устройства.


        Примечание

             Удаляемый объект не  должен  быть  выбран  как  текущий  в
        контексте устройства.

             Когда удаляется кисть заданного шаблона,  растровая карта,
        связанная  с  кистью,  не  удаляется.  Растровая  карта  должна
        удаляться отдельно.

             Прикладная программа   не   должна   удалять  выбранный  в
        настоящий момент объект.


        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 119 =

                                     DestroyCaret                              

        Синтаксис

             void DestroyCaret(  )

             Эта функция    разрушает    текущую    форму    системного
        псевдокурсора,  освобождает  псевдокурсор  от окна,  которое им
        владело и удаляет курсор с экрана,  если он был видим.  Функция
        DestroyCaret     проверяет    псевдокурсор    на    монопольное
        использование и разрушает его только,  если им владеет  окно  в
        текущей задаче.

             Если предшествующая  форма  системного  псевдокурсора была
        растровой картой,  то  эта  функция  не  освобождает  растровую
        карту.

             Эта функция не имеет параметров.


        Возвращаемое значение

             Отсутствует.

        Примечание

             Системнй псевдокурсор является разделяемым ресурсом.  Если
        окно  создало  форму псевдокурсора,  то оно разрушает эту форму
        прежде  чем,  оно  теряет  монополию  на  ввод  или  становится
        неактивным.


        ───────────────────────────────────────────────────────────────
                                 DestroyCursor [3.0]                           

        Синтаксис

             BOOL DectroyCursor(hCursor)

             Эта функция  разрушает курсор,  который был предварительно
        создан функцией  CreateCursor  и  освобождает  память,  которую
        занимал курсор.  Она не должна быть использована для разрушения
        любого курсора, который не был создан функцией CreateCursor.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hCursor           HCURSOR Определяет курсор ,который должен
                               быть удален.  Этот  курсор не может быть
                               используемым в текущее время.


             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 120 =


        Возвращаемое значение

             Возвращаемое значение   не   равно   нулю,   если  функция
        завершена успешно. Если имел место сбой, то это ноль.


        ───────────────────────────────────────────────────────────────
                                  DestroyIcon [3.0]                            

        Синтаксис

             BOOL DectroyIcon(hIcon)

             Эта функция  разрушает икону,  которая была предварительно
        создана функцией  CreateIcon  и  освобождает  память,  которую
        занимала икона.  Она не должна быть использована для разрушения
        любой иконы, которая не была создана функцией CreateIcon.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hIcon             HICON  Определяет икону, которая должна
                               быть удалена.  Эта икона не может  быть
                               используема в текущее время.


             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   не   равно   нулю,   если  функция
        завершена успешно. Если имел место сбой, то это ноль.


        ───────────────────────────────────────────────────────────────
                                     DestroyMenu                               

        Синтаксис

             BOOL DestroyMenu(hMenu)

             Эта функция служит для разрушения меню, специфицированного
        параметром hMenu,  и  освобождает  любую  память,  которую  оно
        занимало.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hMenu             HMENU Идентифицирует    меню,    которое
                               должно быть разрушено.
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 121 =


        Возвращаемое значение

             Возвращаемое значение   определяет   было   ли   разрушено
        определенное меню.  Не  равно  нулю,  если  меню  разрушено.  В
        противном случае равно нулю.


        ───────────────────────────────────────────────────────────────
                                    DestroyWindow                              

        Синтаксис

             BOOL DestroyWindow(hWnd)

             Эта функция разрушает указанное окно. Она делает невидимым
        или  закрывает  окно,  посылая  соответствующие  сообщения  для
        приведения его в неактивное состояние и снятия  захвата  ввода.
        Кроме  того,  DestroyWindow  уничтожает  меню  окна и ожидающие
        обработки прерывания,  очищает очередь прикладной  программы  ,
        снимает  право  собственности  на  системный  буфер и прерывает
        цепочку наблюдения  за  системным  буфером,  если  данное  окно
        является  ее  началом.  Эта  функция  посылает  окну  сообщения
        WM_DESTROY и WM_NCDESTROY.

             Если окно,  специфицированное  hWnd,  является   родителем
        каких-либо окон,  то эти окна автоматически разрушаются,  когда
        разрушается родительское  окно.  Причем  функция  DestroyWindow
        сначала разрушает  дочерние  окна,  а  затем  само родительское
        окно.

             DestroyWindow также  уничтожает  бестипные панели диалога,
        созданные функцией CreateWindow.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND Идентифицирует окно, которое должно
                               быть разрушено.


             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   определяет   было   ли  разрушено,
        определенное окно,  или  нет.  Не   равно   нулю,   если   окно
        разрушается. В противном случае равно нулю.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 122 =

                               DeviceCapabilites [3.0]                         

        Синтаксис

             DWORD DeviceCapabilites(lpDeviceName,lpPort,nIndex,
                                                    lpOutput,lpDevMode)

             Эта функция получает характеристики  драйвера  печатающего
        устройства.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpDeviceName      LPSTR Указывает на оканчивающуюся  нулем
                               строку,   содержащую   имя   печатающего
                               устройства, такое как "PCL/HP LaserJet".

             lpPort            LPSTR Указывает на оканчивающуюся  нулем
                               строку, содержащую имя порта,  с которым
                               соединено устройство, такое как LPT:.

             nIndex            WORD Определяет    характеристики    для
                               запроса.   Это   может   быть   одна  из
                               следующих величин:

                               Величина            Значение
                               ────────            ────────

                               DC_BINNAMES         Копирует   структуру
                                                   идентичную   которой
                                                   возвращает
                                                   управляющая
                                                   последовательность
                                                   ENUMPAPERBINS.
                                                   Драйвер принтера  не
                                                   нуждается          в
                                                   поддержке      этого
                                                   индекса,   если   он
                                                   имеет         только
                                                   кассеты,
                                                   соответсвующие
                                                   предопределенным
                                                   индексам,   в   этом
                                                   случае   данные   не
                                                   копируется         и
                                                   возвращаемое
                                                   значение   -   ноль.
                                                   Если          индекс
                                                   поддерживается,
                                                   возвращаемое
                                                   значение - это число

       Windows 3.0/Ref/2#7                                      = 123 =

                                                   скопированных
                                                   кассет.         Если
                                                   параметр    lpOutput
                                                   NULL,   возвращаемое
                                                   значение - это число
                                                   требуемых  элементов
                                                   кассеты.

                               DC_BINS             Получает    перечень
                                                   имеющихся    кассет.
                                                   Функция     копирует
                                                   перечень    lpOutput
                                                   как   массив   WORD.
                                                   Если        параметр
                                                   lpOutput       NULL,
                                                   функция   возвращает
                                                   число поддерживаемых
                                                   кассет,          что
                                                   позволяет прикладной
                                                   программе     удобно
                                                   размещать      буфер
                                                   корректного размера.
                                                   Смотрите    описание
                                                   поля dmDefaultSource
                                                   структуры     данных
                                                   DEVMODE          для
                                                   получения информации
                                                   по  этим  значениям.
                                                   Прикладная программа
                                                   может     определять
                                                   имя,    определенных
                                                   устройством  кассет,
                                                   используя
                                                   управляющую
                                                   последовательность
                                                   ENUMPAPERBINS.

                               DC_DRIVER           Возвращает     номер
                                                   версии      драйвера
                                                   принтера.

                               DC_DUPLEX           Возвращает   уровень
                                                   поддержки  дуплекса.
                                                   Функция   возвращает
                                                   1,   если    принтер
                                                   способен
                                                   осуществлять  печать
                                                   с двух сторон листа.
                                                   В противном  случае,
                                                   возвращает ноль.

                               DC_EXTRA             Возвращает
                                                    количество

       Windows 3.0/Ref/2#7                                      = 124 =

                                                    требуемых    байтов
                                                    для    определяемой
                                                    устройством   части
                                                    структуры    данных
                                                    DEVMODE,        для
                                                    драйвера принтера.

                               DC_FIELDS           Возвращает      поле
                                                   dmFields   структуры
                                                   данных       DEVMODE
                                                   драйвера   принтера.
                                                   Битовое         поле
                                                   dmFields  показывает
                                                   какое   из  полей  в
                                                   аппаратно          -
                                                   независимой    части
                                                   структуры,
                                                   поддерживается
                                                   драйвером.

                               DC_MAXEXTENT        Возвращает
                                                   структуру     данных
                                                   POINT,    содержащую
                                                   максимальный  размер
                                                   бумаги,      который
                                                   могут     определять
                                                   поля mdPaperLength и
                                                   dmPaperWidth
                                                   структуры     данных
                                                   драйвера    принтера
                                                   DEVMODE.

                               DC_MINEXTENT        Возвращает
                                                   структуру     данных
                                                   POINT,    содержащую
                                                   минимальный   размер
                                                   бумаги,      который
                                                   могут     определять
                                                   поля mdPaperLength и
                                                   dmPaperWidth
                                                   структуры     данных
                                                   драйвера    принтера
                                                   DEVMODE.

                               DC_PAPERS           Получает    перечень
                                                   поддерживаемых
                                                   размеров     бумаги.
                                                   Функция     копирует
                                                   перечень    lpOutput
                                                   как  массив  WORD  и
                                                   возвращает
                                                   количество элементов
                                                   массива.        Если

       Windows 3.0/Ref/2#7                                      = 125 =

                                                   параметр    lpOutput
                                                   NULL,        функция
                                                   возвращает     число
                                                   поддерживаемых
                                                   размеров бумаги, что
                                                   позволяет прикладной
                                                   программе     удобно
                                                   размещать      буфер
                                                   корректного размера.
                                                   Смотрите    описание
                                                   поля     dmPaperSize
                                                   структуры     данных
                                                   DEVMODE          для
                                                   получения информации
                                                   по этим значениям.

                               DC_PAPERSIZE        Копирует размерность
                                                   поддерживаемых
                                                   размеров  бумаги   в
                                                   десятые         доли
                                                   миллиметра       для
                                                   массива     структур
                                                   данных    POINT    в
                                                   параметре  lpOutput.
                                                   Это        позволяет
                                                   прикладной программе
                                                   получать  информацию
                                                   о      нестандартных
                                                   размерах бумаги.

                               DC_SIZE             Возвращает      поле
                                                   dmSize     структуры
                                                   данных      драйвера
                                                   принтера DEVMODE.

                               DC_VERSION          Возвращает
                                                   определение  версии,
                                                   которой соотвествует
                                                   драйвер принтера.

             lpOptput          LPSTR Указывает   на   массив    байтов.
                               Реальный   формат   массива  зависит  от
                               установки   параметра    nIndex.    Если
                               установлен      ноль,     то     функция
                               DeviceCapabilities возвращает количество
                               байтов, требуемых для выходных данных.

             lpDevMode         DEVMODE FAR  *  Указывает  на  структуру
                               данных DEVMODE.  Если параметр lpDevMode
                               равен  NULL,  то  эта  функция  получает
                               текущие,  установленные  по   умолчанию,
                               значения инициализации для определенного
                               драйвера принтера.  В  противном  случае

       Windows 3.0/Ref/2#7                                      = 126 =

                               функция получает значения,  содержащиеся
                               в   структуре   на   которую   указывает
                               параметр lpDevMode.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   зависит   от  установки  параметра
        nIndex; смотрите   его   описание   для   получения   детальной
        информации.


        Примечание

             Эта функция предоставляется драйвером принтера. Прикладная
        программа  должна  включить  файл DRIVEINIT.H и вызвать функции
        LoadLibrary   или    GetProcAddress    для    вызова    функции
        DeviceCapabilities.

        ───────────────────────────────────────────────────────────────
                                      DeviceMode                               

        Синтаксис

             void DeviceMode(hWnd,hModule,lpDeviceName,lpOutput)

             Эта функция  устанавливает  текущий   режим   печати   для
        устройства, определенного  параметром  lpDeviceName,  используя
        для запроса этого режима панель диалога.  Прикладная  программа
        вызывает функцию   DeviceMode   для   того,   чтобы   позволить
        пользователю изменять режим печати соответсвующего  устройства.
        Функция копирует информацию о режиме в блок окружения связанный
        с устройством и поддерживаемым GDI.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND Определяет   окно,   которое  будет
                               владельцем панели диалога.

             hModule           HANDLE Определяет    модуль     драйвера
                               принтера.  Прикладная  программа  должна
                               получить  его   дескриптор   посредством
                               вызова   либо  функции  GetModuleHandle,
                               либо функции LoadLibrary.

             lpDeviceName      LPSTR Указывает на оканчивающуюся  нулем
                               строку,     которая    определяет    имя
                               определенного устройства  для  поддержки
                               (например,  Epson FX-80). Имя устройства
                               такое же,  как  и имя переданное функции

       Windows 3.0/Ref/2#7                                      = 127 =

                               CreateDC.

             lpOutput          LPSTR Указывает  на оканчивающуюся нулем
                               строку,  которая определяет файл DOS или
                               имя  устройства  для физической выходной
                               среды (файл или выходной порт). Выходное
                               имя  такое  же,  как  и  имя  переданное
                               функции CreateDC.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсуствует.

        Примечание

             Функция DeviceMode  -  это  действительная  часть драйвера
        печатающего устройства,  и не является частью GDI.  Для  вызова
        этой  функции,  прикладная  программа  должна загрузить драйвер
        печатающего устройства,  посредством вызова функции LoadLibrary
        и  получить  адрес  функции  используя  функцию GetProcAddress.
        Затем прикладная программа может использовать эту  функцию  для
        установки принтера.


        ───────────────────────────────────────────────────────────────
                                      DialogBox                                

        Синтаксис

             int DialogBox(hInstance,lpTemplateName,hWndParent,
                                                      lpDialogFunc)

             Эта функция служит для создания модальной панели  диалога.
        Шаблон  диалога,  заданный lpTemplateName,  определяет атрибуты
        панели диалога,  такие как размеры,  тип  и  блоки  управления.
        Параметр  hWndParent  идентифицирует окно прикладной программы,
        которое владеет панелью диалога.  Функция многократного вызова,
        на   которую   указывает   lpDialogFunc,   обрабатывает   любое
        сообщение, получаемое панелью диалога.

             Функция DialogBox не возвращает  управление  до  тех  пор,
        пока   функция   многократного  вызова  не  закончит  работу  с
        модальной панелью диалога, вызвав функцию EndDialog.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hInstance         HANDLE Идентифицирует  экземпляр модуля,
                               выполняемый   файл   которого   содержит
                               шаблон панели диалога.

       Windows 3.0/Ref/2#7                                      = 128 =


             lpTemplateName    LPSTR Указывает   на   строку  символов,
                               именующую шаблон   панели  диалога.  Это
                               должна    быть    символьная     строка,
                               оканчивающаяся нулем.

             hWndParent        HWND Идентифицирует   окно,    владеющее
                               панелью диалога.

             lpDialogFunc      FARPROC Содержит     адрес    экземпляра
                               функции панели     диалога.     Смотрите
                               нижеследующий     "Комментарий"      для
                               получения детальной информации.


             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  специфицирует  значение   параметра
        nResult функции EndDialog,  которая используется для завершения
        работы панели диалога.  Значение, возвращаемое панелью диалога,
        обрабатывается средой  Windows  и  не  возвращается  прикладной
        программе.  Возвращаемое значение равно  -1,  если  функция  не
        может создать панель диалога.

        Примечание

             Функция DialogBox  вызывает функцию GetDC для того,  чтобы
        получить контекст  отображения.  Если  из  кэша  среды  Windows
        функцией  GetDC  выбраны все контексты отображения,  то функция
        DialogBox не может получить доступ к контексту отображения.

             Панель диалога может содержать до 255 блоков управления.

             Функция многократного    вызова    должна     использовать
        соглашения  по  вызову системы Pascal и быть объявлена как FAR.
        Она имеет следующий вид:

        Функция многократного вызова:

             int FAR PASCAL DialogFunc(hDlg,wMsg,wParam,lParam)
             HWND hDlg;
             WORD wMsg;
             WORD wParam;
             DWORD lParam;

             Здесь DialogFunc  используется   вместо   имени   функции,
        предоставляемой прикладной  программой.  Фактическое имя должно
        быть  экспортировано  посредством  включения  его  в   оператор
        EXPORTS файла определения модуля прикладной программой.


       Windows 3.0/Ref/2#7                                      = 129 =

             Параметр          Описание
             ────────          ────────
             hWnd              Идентифицирует панель  диалога,  которая
                               принимает сообщения.

             wMsg              Определяет номер сообщения.

             wParam            Определяет 16     бит     дополнительной
                               информации, зависящей от сообщения.

             lParam            Определяет 32     бита    дополнительной
                               информации, зависящей от сообщения.


        Возвращаемое значение

             Функция многократного вызова должна  возвратить  значение,
        которое  не  равно  нулю,  если  функция обработала сообщение и
        равно нулю в противоположном случае.

        Примечания

             Хотя функция  многократного  вызова   представляет   собой
        просто   функцию   окна,   она   не   может   вызывать  функцию
        DefWindowProc   для    обработки    "неожидаемых"    сообщений.
        "Неожидаемые"  сообщения  обрабатываются  внутри  функции  окна
        класса диалога.

             Адрес функции   многократного   вызова,  передаваемый  как
        параметр lpDialogFunc,  должен быть создан  с  помощью  функции
        MakeProcInstance.

        ───────────────────────────────────────────────────────────────
                                  DialogBoxIndirect                            

        Синтаксис

             int DialogBoxIndirect(hInstance,hDialogTemplate,
                                               hWndParent,lpDialogFunc)

             Эта функция создает модальную  панель  диалога  прикладной
        программы, которая   имеет  размер,  тип  и  блоки  управления,
        определяемые шаблоном  панели  диалога,  задаваемым  параметром
        hDialogTemplate. Параметр    hWndParent   идентифицирует   окно
        прикладной программы,  которое владеет панелью диалога. Функция
        многократного  вызова,  задаваемая  lpDialogFunc,  обрабатывает
        любые сообщения, посылаемые панелью диалога.

             Функция DialogBoxIndirect не возвращает управление до  тех
        пор,  пока  функция  многократного вызова не завершит модальную
        панель диалога, вызвав функцию EndDialog.


       Windows 3.0/Ref/2#7                                      = 130 =

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hInstance         HANDLE Идентифицирует  экземпляр модуля,
                               выполняемый   файл   которого   содержит
                               шаблон панели диалога.

             hDialogTemplate   HANDLE Идентифицирует  блок   глобальной
                               памяти,   который   содержит   структуру
                               DLGTEMPLATE.

             hWndParent        HWND Идентифицирует   окно    прикладной
                               программы,   которое   владеет   панелью
                               диалога.

             lpDialogFunc      FARPROC Содержит    адрес     экземпляра
                               процедуры   панели   диалога.   Смотрите
                               нижеследующий     "Комментарий"      для
                               получения детальной информации.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  соответствует  значению   параметра
        wResult   в   функции   EndDialog,   которая  используется  для
        завершения работы с  панелью  диалога.  Значения,  возвращаемые
        панелью диалога     прикладной     программы,    обрабатываются
        Windows и не возвращаются в прикладную программу.  Возвращаемое
        значение  равно  -1,  если  функция  не  может  создать  панель
        диалога.

        Примечание

             Панель диалога может содержать до 255 блоков управления.

             Функция многократного    вызова    должна     использовать
        соглашение  по  вызову  системы Паскаль и должна быть объявлена
        как FAR.  Функция многократного вызова должна  иметь  следующую
        форму:

        Функция многократного вызова:

             BOOL FAR PASCAL DialogFunc(hDlg,wMsg,wParam,lParam)
             HWND hDlg;
             WORD wMsg;
             WORD wParam;
             DWORD lParam;

             DialogFunc является   полем  шаблона  для  имени  функции,
        предоставляемой прикладной программы.  Фактическое  имя  должно
        быть  экпортировано  путем  включения  его в оператор EXPORTS в
        файл определения модуля прикладной программы.


       Windows 3.0/Ref/2#7                                      = 131 =

             Параметр          Описание
             ────────          ────────

             hWnd              Идентифицирует панель  диалога,  которая
                               принимает сообщения.

             wMsg              Определяет номер сообщения.

             wParam            Определяет 16     бит     дополнительной
                               информации, зависящей от сообщения.

             lParam            Определяет 32     бита    дополнительной
                               информации, зависящей от сообщения.


        Возвращаемое значение

             Функция многократного вызова должна  возвратить  значение,
        которое  не  равно  нулю,  если  функция обработала сообщение и
        равно нулю в противоположном случае.

        Примечания

             Хотя функция  многократного  вызова  подобна функции окна,
        она не должна  вызывать  функцию  DefWindowProc  для  обработки
        нежелательных сообщений. Нежелательные сообщения обрабатываются
        с помощью функции окна класса диалога.

             Адрес функции  многократного  вызова,   передаваемый   как
        параметр  lpDialogFunc,  должен  быть  создан  с использованием
        функции MakeProcInstance.


        ───────────────────────────────────────────────────────────────
                             DialogBoxIndirectParam [3.0]                      

        Синтаксис

             int DialogBoxIndirectParam(hInstance,hDialogTemplate,
                                   hWndParent,lpDialogFunc,dwInitParam)

             Эта функция  создает  модальную  панель диалога прикладной
        программы, посылает  сообщение  WM_INITDIALOG  функции  диалога
        перед отображением  панели диалога и передает dwInitParam,  как
        сообщение lParam.  Это  сообщение  позволяет  функции   диалога
        инициализировать блоки управления панели диалога.

             Для получения   дополнительной   информации   о   создании
        модальной панели   диалога   прикладной   программы,   смотрите
        описание функции DialogBoxIndirect.



       Windows 3.0/Ref/2#7                                      = 132 =

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hInstance         HANDLE Идентифицирует  экземпляр модуля,
                               выполняемый   файл   которого   содержит
                               шаблон панели диалога.

             hDialogTemplate   HANDLE Идентифицирует  блок   глобальной
                               памяти,   который   содержит   структуру
                               DLGTEMPLATE.

             hWndParent        HWND Идентифицирует   окно    прикладной
                               программы,   которое   владеет   панелью
                               диалога.

             lpDialogFunc      FARPROC Содержит    адрес     экземпляра
                               процедуры панели    диалога.    Смотрите
                               раздел "Комментарий"  в описании функции
                               DialogBoxInderct для получения детальной
                               информации.

             dwInitParam       DWORD Это 32-ух битовое значение,которое
                               функция  DialogBoxInderectParam передает
                               функции диалога при создании  ею  панели
                               диалога.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  соответствует  значению   параметра
        wResult   в   функции   EndDialog,   которая  используется  для
        завершения работы с  панелью  диалога.  Значения,  возвращаемые
        панелью диалога     прикладной     программы,    обрабатываются
        Windows и не возвращаются в прикладную программу.  Возвращаемое
        значение  равно  -1,  если  функция  не  может  создать  панель
        диалога.


        ───────────────────────────────────────────────────────────────
                                 DialogBoxParam [3.0]                          

        Синтаксис

             int DialogBoxParam(hInstance,lpTemplateName,
                                   hWndParent,lpDialogFunc,dwInitParam)

             Эта функция  создает  модальную  панель диалога прикладной
        программы, посылает  сообщение  WM_INITDIALOG  функции  диалога
        перед отображением  панели диалога и передает dwInitParam,  как
        сообщение lParam.  Это  сообщение  позволяет  функции   диалога
        инициализировать блоки управления панели диалога.

             Для получения   дополнительной   информации   о   создании

       Windows 3.0/Ref/2#7                                      = 133 =

        модальной панели   диалога   прикладной   программы,   смотрите
        описание функции DialogBox.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hInstance         HANDLE Идентифицирует  экземпляр модуля,
                               выполняемый   файл   которого   содержит
                               шаблон панели диалога.

             lpTemplateName    LPSTR Указывает   на   строку  символов,
                               именующую шаблон   панели  диалога.  Эта
                               должна    быть    символьная     строка,
                               оканчивающаяся нулем.

             hWndParent        HWND Идентифицирует   окно    прикладной
                               программы,   которое   владеет   панелью
                               диалога.

             lpDialogFunc      FARPROC Содержит    адрес     экземпляра
                               процедуры панели    диалога.    Смотрите
                               раздел "Комментарий"  в описании функции
                               DialogBox   для   получения    детальной
                               информации.

             dwInitParam       DWORD Это 32-ух битовое значение,которое
                               функция DialogBoxParam передает  функции
                               диалога при создании ею панели диалога.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  соответствует  значению   параметра
        wResult   в   функции   EndDialog,   которая  используется  для
        завершения работы с  панелью  диалога.  Значения,  возвращаемые
        панелью диалога     прикладной     программы,    обрабатываются
        Windows и не возвращаются в прикладную программу.  Возвращаемое
        значение  равно  -1,  если  функция  не  может  создать  панель
        диалога.


        ───────────────────────────────────────────────────────────────
                                   DispatchMessage                             

        Синтаксис

             LONG DispatchMessage(lpMsg)

             Эта функция передает сообщение в структуре MSG, на которую
        указывает параметр lpMsg, функции специфицированного окна.


       Windows 3.0/Ref/2#7                                      = 134 =


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             lpMsg
                               LPMSG Указывает на структуру данных MSG,
                               которая содержит информацию  из  очереди
                               прикладной программы Windows.

                               Структура должна   содержать  допустимые
                               значения сообщений. Если lpMsg указывает
                               на сообщение  WM_TIMER и параметр lParam
                               сообщения WM_TIMER  не  равен  NULL,  то
                               параметр    lParam    является   адресом
                               функции,которая    вызывается     вместо
                               функции окна.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение специфицирует значение, возвращаемое
        функцией окна.  Оно  зависит  от  передаваемого  сообщения,  но
        обычно оно игнорируется.

        ───────────────────────────────────────────────────────────────
                                      DlgDirList                               

        Синтаксис

             int DlgDirList(hDlg,lpPathSpec,nIDListBox,
                                          nIDStaticPath,wFiletype)

             Эта функция   создает  блок  управления  панелью  перечня,
        который позволяет выводить список  файлов  или  каталогов.  Она
        заполняет  панель перечня,  определенную параметром nIDListBox,
        именами  файлов  имеющими  одинаковый,   маршрут   определяемый
        параметром lpPathSpec.

             Функция DlgDirList  показывает  подкаталоги заключенными в
        квадратные скобки ([]);  устройства указываются в  виде  [-x-],
        где x - буква устройства.

             Параметр lpPathSpec имеет следующую форму:

             [drive:][[\]directory[\directory]...\][filename]

             В этом   примере  drive  -  имя  устройства,  directory  -
        корректное имя каталога и  filename  -  корректное  имя  файла,
        которое  должно  содержать  по  крайней мере один универсальный
        символ.  Универсальные  символы  -  это   знак   вопроса   (?),
        соответствующий    любому    символу,    и    звездочка    (*),
        соответствующая любому количеству символов.

       Windows 3.0/Ref/2#7                                      = 135 =


             Если параметр lpPathSpec включает спецификацию  устройства
        и/или  каталога,  то текущие устройство и каталог изменяются на
        указанные  устройство  и  каталог  перед   заполнением   панели
        перечня.   Текстовые  средства  управления,  идентифицированные
        параметром nIDStaticPath, также корректируются в соответствии с
        новой спецификацией устройства и/или каталога.

             После заполнения  панели перечня lpPathSpec корректируется
        с помощью удаления из спецификации  маршрута  устройства  и/или
        части каталога.

             Функция DlgDirList посылает в панель перечня  сообщения
        LB_RESETCONTENT и LB_DIR.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDlg              HWND Идентифицирует   панель    диалога,
                               содержащую панель перечня.

             lpPathSpec        LPSTR Указывает   на  символьную  строку
                               спецификации маршрута.  Она должна  быть
                               символьной строкой оканчивающейся нулем.

             nIDListBox        int Определяет    идентификатор    блока
                               управления панелью  перечня.  Если  этот
                               параметр    равен   нулю,   то   функция
                               DlgDirList  предполагает,   что   панели
                               перечня   не  существует,  и  не  делает
                               попытки заполнить ее.

             nIDStaticPath     int Определяет             идентификатор
                               статического       текстового      блока
                               управления, используемого для  индикации
                               текущего  устройства  и  каталога.  Если
                               nIDStaticPath  равен  нулю,  то  функция
                               DlgDirList   предполагает,   что   такое
                               текстовое      средство       управления
                               отсутствует.

             wFiletype         WORD Определяет значение,  биты которого
                               специфицируют атрибуты  файла  DOS.  Это
                               параметр        получает       значения,
                               представленные в таблице  4.6  "Атрибуты
                               файла DOS".        Значения        могут
                               комбинироваться     с     использованием
                               оператора OR.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение


       Windows 3.0/Ref/2#7                                      = 136 =

             Возвращаемое значение  определяет  результат  функции.  Не
        равно нулю даже при пустом перечне, если он был образован. Если
        входная  строка не содержит допустимой спецификации поиска,  то
        возвращается нулевое значение.


        Примечание

             Параметр wFiletype определяет атрибуты файлов DOS, которые
        должны быть  представлены  в  панели   перечня.   Таблица   4.6
        описывает эти атрибуты.


             Таблица 4.6  Атрибуты файлов DOS
             ──────────────────────────────────────────────────────────
             Величина атрибута      Значение
             ──────────────────────────────────────────────────────────

             0x0000                 Чтение/запись  файлов данных без
                                    каких-либо добавочных атрибутов

             0x0001                 Файлы только чтения

             0x0002                 Скрытые файлы

             0x0004                 Системные файлы

             0x0010                 Подкаталоги

             0x0200                 Архивы

             0x2000                 Флаг LB_DIR  (1)

             0x4000                 Устройства

             0x8000                 Исключающий бит  (2)

             ──────────────────────────────────────────────────────────

            (1) Если   установлен   флаг   LB_DIR,   Windows   помещает
        сообщения,   вырабатываемые   функцией  DlgDirList,  в  очередь
        прикладной программы;  в противном случае, они посылаются прямо
        в функцию диалога.

            (2) Если  установлен  "Исключающий  бит",  то перечисляются
        только файлы специфицированного типа.  В противном случае файлы
        специфицированного  типа  перечисляются дополнительно к обычным
        файлам.

        ───────────────────────────────────────────────────────────────
                               DlgDirListComboBox [3.0]                        

        Синтаксис

       Windows 3.0/Ref/2#7                                      = 137 =


             int DlgDirListComboBox(hDlg,lpPathSpec,nIDComboBox,
                                               nIDStaticPath,wFiletype)

             Эта функция  создает   комбинированный   блок   управления
        панелью  перечня,  который позволяет выводить список файлов или
        каталогов. Она заполняет панель перечня комбинированой  панели,
        определенную параметром   nIDComboBox,   именами   всех  файлов
        имеющими   одинаковый,    маршрут    определяемый    параметром
        lpPathSpec.

             Функция DlgDirListComboBox      показывает     подкаталоги
        заключенными в квадратные скобки ([]); устройства указываются в
        виде [-x-], где x - буква устройства.

             Параметр lpPathSpec имеет следующую форму:

             [drive:][[\]directory[\directory]...\][filename]

             В этом   примере  drive  -  имя  устройства,  directory  -
        корректное имя каталога и  filename  -  корректное  имя  файла,
        которое  должно  содержать  по  крайней мере один универсальный
        символ.  Универсальные  символы  -  это   знак   вопроса   (?),
        соответствующий    любому    символу,    и    звездочка    (*),
        соответствующая любому количеству символов.

             Если параметр lpPathSpec включает спецификацию  устройства
        и/или  каталога,  то текущие устройство и каталог изменяются на
        указанные  устройство  и  каталог  перед   заполнением   панели
        перечня.   Текстовые  средства  управления,  идентифицированные
        параметром nIDStaticPath, также корректируются в соответствии с
        новой спецификацией устройства и/или каталога.

             После заполнения комбинированной панели перечня lpPathSpec
        корректируется с  помощью  удаления  из  спецификации  маршрута
        устройства и/или части каталога.

             Функция DlgDirList  посылает  в  панель  перечня сообщения
        CB_RESETCONTENT и CB_DIR.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDlg              HWND Идентифицирует   панель    диалога,
                               содержащую панель перечня.

             lpPathSpec        LPSTR Указывает   на  символьную  строку
                               спецификации маршрута.  Она должна  быть
                               символьной строкой оканчивающейся нулем.

             nIDComboBox       int Определяет    идентификатор    блока
                               управления панелью  перечня.  Если  этот

       Windows 3.0/Ref/2#7                                      = 138 =

                               параметр    равен   нулю,   то   функция
                               DlgDirListComboBox предполагает,     что
                               панели   перечня  не  существует,  и  не
                               делает попытки заполнить ее.

             nIDStaticPath     int Определяет             идентификатор
                               статического       текстового      блока
                               управления, используемого для  индикации
                               текущего  устройства  и  каталога.  Если
                               nIDStaticPath  равен  нулю,  то  функция
                               DlgDirListComboBox предполагает,     что
                               такое  текстовое   средство   управления
                               отсутствует.

             wFiletype         WORD Определяет значение,  биты которого
                               специфицируют атрибуты  файла  DOS.  Это
                               параметр        получает       значения,
                               представленные в таблице  4.6  "Атрибуты
                               файла DOS".  Смотрите  описание  функции
                               DlgDirList для получения  этой  таблицы.
                               Значения    могут    комбинироваться   с
                               использованием оператора OR.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  определяет  результат  функции.  Не
        равно нулю даже при пустом перечне, если он был образован. Если
        входная  строка не содержит допустимой спецификации поиска,  то
        возвращается нулевое значение.


        ───────────────────────────────────────────────────────────────
                                     DlgDirSelect                              

        Синтаксис

             BOOL DlgDirSelect(hDlg,lpString,nIDListBox)

             Эта функция возвращает текущую выборку из панели  перечня.
        Предполагается,   что   панель   перечня   заполнена   функцией
        DlgDirList,  и что эта выборка содержит имя  устройства,  файла
        или каталога.

             Функция DlgDirSelect  копирует  выборку в буфер,  заданный
        параметром lpString.  Если текущая выборка - это  имя  каталога
        или  устройства,  то  функция  DlgDirSelect  удаляет окружающие
        квадратные скобки (и дефисы для имен драйверов)  так,  что  имя
        может  быть  вставлено  в  новую  спецификацию  маршрута.  Если
        выборка остуствует, то параметр lpString не изменяется.

             Функция DlgDirSelect  посылает  панели  перечня  сообщения

       Windows 3.0/Ref/2#7                                      = 139 =

        LB_GETCURSEL и LB_GETTEXT.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDlg              HWND Идентифицирует    панель   диалога,
                               содержащую панель перечня.

             lpString          LPSTR Указывает        на         буфер,
                               предназначенный для получения выбранного
                               маршрута.

             nIDListBox        int  Определяет целый ID блока управления
                               панелью перечня в панели диалога.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   определяет    состояние    текущей
        выборки.  Не  равно нулю,  если текущая выборка является именем
        каталога. В противном случае равно нулю.

        Примечание

             Функция DlgDirSelect не допускает, чтобы из панели перечня
        возвращалось более одного имени файла.

             Панель перечня   не   может   быть   панелью   перечня   с
        множественной выборкой.  Если это так,  функция DlgDirSelect не
        возвратит  нулевое  значение,  и  параметр  lpString  останется
        неизмененным.


        ───────────────────────────────────────────────────────────────
                              DlgDirSelectComboBox [3.0]                       

        Синтаксис

             BOOL DlgDirSelectComboBox(hDlg,lpString,nIDComboBox)

             Эта функция возвращает текущую выборку из  панели  перечня
        комбинированной  панели.  Предполагается,  что  панель  перечня
        заполнена  функцией  DlgDirListComboBox,  и  что  эта   выборка
        содержит имя устройства, файла или каталога.

          Функция DlgDirSelectComboBox   копирует   выборку   в  буфер,
        заданный параметром lpString.  Если текущая выборка -  это  имя
        каталога или   устройства,   то   функция  DlgDirSelectComboBox
        удаляет  окружающие  квадратные  скобки  (и  дефисы  для   имен
        драйверов)   так,   что   имя  может  быть  вставлено  в  новую
        спецификацию маршрута.  Если выборка  остуствует,  то  параметр
        lpString не изменяется.

       Windows 3.0/Ref/2#7                                      = 140 =


             Функция DlgDirSelectComboBox   посылает   панели   перечня
        сообщения CB_GETCURSEL и CB_GETLBTEXT.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDlg              HWND Идентифицирует    панель   диалога,
                               содержащую комбинированную панель.

             lpString          LPSTR Указывает        на         буфер,
                               предназначенный для получения выбранного
                               маршрута.

             nIDComboBox       int Определяет целый ID комбинированного
                               блока управления   панелью   перечня   в
                               панели диалога.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   определяет    состояние    текущей
        выборки комбинированной  панели.  Не  равно нулю,  если текущая
        выборка является именем  каталога.  В  противном  случае  равно
        нулю.

        Примечание

             Функция DlgDirSelectComboBox   не   допускает,   чтобы  из
        комбинированной панели возвращалось более одного имени файла.


        ───────────────────────────────────────────────────────────────
                                    DOS3Call [3.0]                             

             Эта функция  позволяет   прикладной   программе   выдавать
        функциональный запрос 21H прерывания DOS.  Прикладная программа
        может использовать  эту  функцию  вместо   прямого   кода   21H
        пррывания DOS.  Функция  DOS3Call выполняется несколько быстрее
        чем эквивалентное программное обеспечение  прерывания  DOS  21H
        под Windows.

             Прикладная программа  может  вызвать эту функцию только из
        подпрограммы на языке ассемблера.  Она экспортируется из  файла
        KERNEL.EXE и не определена во всех включаемых файлах Windows.

             Для использования    вызова   этой   функции,   прикладная
        программа должна объявить ее в программе на  языке  ассемблера,
        как показано ниже:

             extern    DOS3Call       :far


       Windows 3.0/Ref/2#7                                      = 141 =

             Если прикладная   программа   включает  файл  CMACROS.INC,
        прикладная программа объявляет ее следующим образом:

             externFP  DOS3Call

             Перед вызовом функции DOS3Call,  все регистры должны  быть
        установлены как для реального прерывания 21H.  Все регистры при
        выходе из функции такие же как для соответсвующей  функции  INT
        21H.

             Эта функция  не имеет параметров и возвращает регистры DOS
        функций.

             Ниже показан пример использования функции DOS3Call:

             extern    DOS3Call       :far
                        .
                        .
                        .
             ; установка регистров
             mov        ah,DOSFUNC
             cCall   DOS3Call


        ───────────────────────────────────────────────────────────────
                                        DPtoLP                                 

        Синтаксис

             BOOL DPtoLP(hDC,lpPoints,nCount)

             Эта функция преобразует координаты устройства в логические
        координаты. Функция   отображает   координаты   каждой   точки,
        определенной параметром   lpPoints   из    системы    координат
        устройства в  систему логических координат GDI.  Преобразование
        зависит от текущего режима отображения и установленных начал  и
        протяженностей окна и области просмотра.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDC               HDC Определяет контекст устройства.

             lpPoints          LPPOINT Указывает   на   массив   точек.
                               Каждая  точка  должна представлять собой
                               структуру данных POINT.

             nCount            int Определяет количество точек в
                               массиве.

             ──────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                      = 142 =

        Возвращаемое значение

             Возвращаемое значение   определяет    имело    ли    место
        преобразование. Оно    не    равно   нулю,   если   все   точки
        преобразованы. В противном случае это ноль.


        ───────────────────────────────────────────────────────────────
                                 DrawFocusRect [3.0]                           

        Синтаксис

             void DrawFocusRect(hDC,lpRect)

             Эта функция рисует прямоугольник для индикации ввода.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDC               HDC Определяет контекст устройства.

             lpRect            LPRECT Указывает   на  структуру  данных
                               RECT,  которая   определяет   координаты
                               прямоугольника,   который   должен  бать
                               нарисован.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсуствует.

        Примечание

             Так как это  XOR функция,  вызов этой функции второй раз с
        тем же прямоугольником, удаляет прямоугольник с экрана.

             Прямоугольник, нарисованный этой функцией,  не может  быть
        прокручен. Для  прокрутки  области,  содержащей  прямоугольник,
        нарисованный этой функцией, вызывается функция DrawFocusRectдля
        удаления прямоугольника  с  экрана,  прокручивается область,  и
        затем вызывается   функция    DrawFocusRect    для    рисования
        прямоугольника в новой позиции.


        ───────────────────────────────────────────────────────────────
                                       DrawIcon                                

        Синтаксис

             BOOL DrawIcon(hDC,X,Y,hIcon)


       Windows 3.0/Ref/2#7                                      = 143 =

             Эта функция выводит икону на заданное устройство.  Функция
        DrawIcon выводит икону размещая  левый  верхний  угол  иконы  в
        точке  с  координатами  X,  Y.  Расположение  иконы  зависит от
        текущего режима отображения контекста устройства.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hDC               HDC Идентифицирует контекст устройства.

             X                 int Определяют  логическую  x-координату
                               верхнего левого угла иконы.

             Y                 int Определяют  логическую  y-координату
                               верхнего левого угла иконы.

             hIcon             HICON  Идентифицирует выводимую икону.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   определяет   результат  выполнения
        функции.  Не равно нулю,  если функция выполнилась  успешно.  В
        противном случае равно нулю.

        Примечание

             Ресурс иконы    должен    быть   предварительно   загружен
        посредством функции LoadIcon.  Перед тем,  как использовать эту
        функцию, должен быть установлен режим отображения MM_TEXT.


        ───────────────────────────────────────────────────────────────
                                     DrawMenuBar                               

        Синтаксис

             void DrawMenuBar(hWnd)

             Эта функция  перерисовывает меню-строку.  Если меню-строка
        изменилась после того,  как система Windows создала  окно,  эта
        функция   должна   быть  вызвана  для  того,  чтобы  нарисовать
        изменившуюся меню-строку.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────

             hWnd              HWND Идентифицирует окно,  меню которого
                               необходимо перерисовать.

             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 144 =


        Возвращаемое значение

             Отсутствует.


        ───────────────────────────────────────────────────────────────
                                       DrawТеxt                                

        Синтаксис

             int DrawТеxt(hDC,lpString,nCount,lpRect,wFormat)

             Эта функция выводит форматированный текст в прямоугольник,
        определяемый параметром lpRect. Она форматирует текст, вставляя
        пробелы  в  соответствующие  места,  выравнивает  текст  влево,
        вправо или по центру заданного прямоугольника и разбивает текст
        на  строки,  заполняя данный прямоугольник.  Тип форматирования
        определяется параметром wFormat.

             Для вывода текста функция  DrawText  использует  выбранные
        цвета текста и фона в контексте устройства.  До тех пор пока не
        используется формат DT_NOCLIP функция DrawText  отсекает  текст
        таким образом,  что  он  не  выводится  в данный прямоугольник.
        Любое  форматирование,  если  не  задан  формат  DT_SINGLELINE,
        предполагает наличие более одной строки.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC Идентифицирует контекст устройства.

             lpString          LPSTR Указывает на выводимую  символьную
                               строку.  Если  параметр nCount равен -1,
                               то строка должна завершаться нулем.

             nCount            int Определяет  число символов в строке.
                               Если nCount равен -1, то предполагается,
                               что параметр  lpString  является длинным
                               указателем   на   оканчивающуюся   нулем
                               строку    и    DrawText    автоматически
                               вычисляет количество символов.

             lpRect            LPRECT Указывает  на  структуру   данных
                               типа RECT,  определящую прямоугольник (в
                               логических координатах), в котором будет
                               форматироваться текст.

             wFormat           WORD Определяет   метод   форматирования
                               текста.  Он может быть любой комбинацией
                               значений, приведенных   в   таблице  4.7
                               "Форматы DrawText".
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 145 =


        Возвращаемое значение

             Возвращаемое значение определяет высоту текста.

        Примечание

             Если текущий   шрифт    слишком    велик    для    данного
        прямоугольника,  то  функция  не будет пытаться заменить его на
        меньший.

             Таблица 4.7   дает   перечень   значений   для   параметра
        wFormat. Эти   значения   могут   комбинироваться   посредством
        оператора  OR.  Следует  помнить,  что  значения   DT_CALCRECT,
        DT_EXTERNALLEADING, DC_INTERNAL,  DT_NOCLIP  и  DT_NOPREFIX  не
        могут быть использованы со значением DT_TABSTOP.


             Таблица 4.7  Форматы DrawText
             ──────────────────────────────────────────────────────────
             Величина          Значение
             ──────────────────────────────────────────────────────────


             DT_BOTTOM         Определяет выравнивание   текста  по
                               нижней границе. Это значение должно быть
                               скомбинировано с DT_SINGLELINE.

             DT_CALCRECT       Определяет ширину        и        высоту
                               прямоугольника. Если имеется более одной
                               строки   текста,   то   DrawText   будет
                               использовать ширину прямомоугольника, на
                               которую  указывает  параметр  lpRect,  и
                               устанавливать   базу  прямоугольника  на
                               границу последней  строки  текста.  Если
                               имеется  только  одна строка текста,  то
                               DrawText будет изменять  правую  сторону
                               прямоугольника,   так   что   она  будет
                               являться границей для последнего символа
                               в строке.   В   других  случаях  функция
                               DrawText        возвращает        высоту
                               сформатированного текста.

            DT_CENTER          Центрирование текста по горизонтали.

            DT_EXPANDTABS      Увеличение числа   позиций,  на  которое
                               перемещается курсор при нажатии  клавиши
                               табуляции. По умолчанию - 8 знакомест.

            DT_EXTERNALLEADING    Включение внешнего разрыва шрифта   в

       Windows 3.0/Ref/2#7                                      = 146 =

                               высоту строки.  Обычно внешний разрыв не
                               включается в высоту строки текста.

            DT_LEFT            Выравнивание по левой границе.

            DT_NOCLIP          Вывод без отсечения. DrawText работает
                               несколько быстрее,   когда   применяется
                               DT_NOCLIP.

            DT_NOPREFIX        Выключает обработку предшествущих
                               символов. Обычно DrawText интерпретирует
                               предшествующий  символ "&" как директиву
                               подчеркнуть следующий     символ,      и
                               мнемонические   предшествующие   символы
                               "&&",  как директиву вывести один символ
                               "&".   При   указании  DT_NOPREFIX,  эта
                               обработка выключается

            DT_RIGHT           Выравнивание по правой границе.

            DT_SINGLELINE      Вывод  одной  строки; возврат каретки  и
                               перевод строки не разрывают строку.

            DT_TABSTOP         Установка   табуляции.      Старший байт
                               параметра wFormat     содержит     число
                               символов   для   каждой   табуляции.  По
                               умолчанию оно равно 8.

            DT_TOP             Выравнивание по  верхней границе (только
                               одна строка).

            DT_VCENTER         Вертикальное центрирование (только  одна
                               строка).

            DT_WORDBREAK       Пословное     разделение.         Строки
                               автоматически разделяются между словами,
                               если   слово    заходит    за    границу
                               прямоугольника, опрелеляемого параметром
                               lpRect.  Нажатие  клавиши  ENTER   также
                               вызывает разрыв строки

             ──────────────────────────────────────────────────────────


        ───────────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                      = 147 =

                                       Ellipse                                 

        Синтаксис

             BOOL Ellipse(hDC, X1, Y1, X2, X2)

             Эта  функция рисует эллипс. Центром эллипса является центр
        ограничивающего прямоугольника, определяемого  параметрами  X1,
        Y1,  X2  и  Y2.  Граница  эллипса  рисуется  текущим  пером,  а
        внутрення область заливается текущей кистью.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Идентифицирует контекст устройства.

             X1                int  Определяет логическую координату x
                               верхнего левого угла ограничивающего
                               прямоугольника.

             Y1                int  Определяет логическую координату y
                               верхнего левого угла ограничивающего
                               прямоугольника.

             X2                int  Определяет логическую координату x
                               нижнего правого угла ограничивающего
                               прямоугольника.

             Y2                int  Определяет логическую координату y
                               нижнего правого угла ограничивающего
                               прямоугольника.

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение специфицирует, нарисован ли  эллипс.
             Оно не равно 0, если эллипс нарисован. В противном  случае
             возвращаемое значение равно 0.

        Примечания

             Ширина прямоугольника, равная абсолютному значению  (X2  -
             X1),  не  должна  превышать 32,767 единиц. Это ограничение
             применяется также и для высоты прямоугольника.

             Функция не использует и не корректирует текущую позицию.

        ───────────────────────────────────────────────────────────────
                                    EmptyClipboard                             

        Синтаксис

             BOOL EmptyClipboard( )

       Windows 3.0/Ref/2#7                                      = 148 =


             Эта  функция  очищает  системный   буфер   и   освобождает
             дескрипторы данных в системном буфере. Затем она назначает
             владельцем   системного   буфера  окно,  которое  имело  в
             настоящий момент системный буфер открытым.

             Эта функция не имеет параметров.

        Возвращаемое значение

             Возвращаемое значение специфицирует  состояние  системного
             буфера.  Оно не равно нулю, если системный буфер очищен, и
             равно нулю, если произошла ошибка.

        Примечания

             Системный  буфер  должен  быть  открыт,  когда  вызывается
             функция EmptyClipboard.

        ───────────────────────────────────────────────────────────────
                                 EnableHardwareInput                           

        Синтаксис

             BOOL EnableHardwareInput(fEnableInput)

             Эта  функция  запрещает  ввод от "мыши" и клавиатуры. Ввод
             сохраняется, если  параметр  fEnableInput  равен  TRUE,  и
             сбрасывается, если он равен FALSE.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             fEnableInput      BOOL  Определяет, что функция должна
                               сохранить ввод, если параметр
                               fEnableInput установлен в ненулевое
                               значение; специфицирует, что функция
                               должна сбросить ввод,  если  параметр
                               fEnableInput установлен в нуль.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое  значение  определяет,  запрещен  ли  ввод от
             "мыши" и клавиатуры. Оно не  равно  нулю,  если  ввод  был
             предварительно  разрешен.  В  противном  случае  оно равно
             нулю. Возвращаемое значение по  умолчанию  не  равно  нулю
             (TRUE).

        ───────────────────────────────────────────────────────────────
                                    EnableMenuItem                             

        Синтаксис


       Windows 3.0/Ref/2#7                                      = 149 =

             BOOL EnableMenuItem(hMenu, wIDEnableItem, wEnable)

             Эта функция делает элемент меню доступным, недоступным или
             серого цвета.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hMenu             HMENU  Идентифицирует меню.

             wIDEnableItem     WORD  Определяет элемент  меню,  который
                               должен  быть  проконтролирован. Параметр
                               wIDEnableItem может специфицировать и
                               элемент накладываемого меню.

             wEnable           WORD  Определяет действие, которое
                               должно быть предпринято. Оно может быть
                               комбинацией флага MF_DISABLED,
                               MF_ENABLED или MF_GRAYED с флагом
                               MF_BYCOMMAND или MF_BYPOSITION. Эти
                               значения должны комбинироваться с
                               использованием поразрядного оператора OR.
                               Эти флаги имеют следующие значения:

                               Значение               Описание
                               ────────────────────────────────────────
                               MF_BYCOMMAND   Определяет, что параметр
                                              wIDEnableItem задает ID
                                              элемента меню
                                              (используется по
                                              умолчанию).

                               MF_BYPOSITION  Определяет, что параметр
                                              wIDEnable задает позицию
                                              элемента меню (первый
                                              элемент - в нулевой
                                              позиции).

                                MF_DISABLED   Элемент меню делается
                                              недоступным.

                                MF_ENABLED    Элемент меню делается
                                              доступным.

                                MF_GRAYED     Элемент меню сереет.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое   значение  определяет  предыдущее  состояние
             элемента меню. Оно равно нулю, если данного элемента  меню
             не существует.

        Примечания

       Windows 3.0/Ref/2#7                                      = 150 =


             Для  разрешения  или запрещения ввода в меню-строку смотри
             сообщение WM_SYSCOMMAND.

        ───────────────────────────────────────────────────────────────
                                     EnableWindow                              

        Синтаксис

             BOOL EnableWindow(hWnd, bEnable)

             Эта  функция  делает  доступным   или   недоступным   ввод
             информации  в специфицированное окно или блок управления с
             помощью "мыши"  или  клавиатуры.  Когда  ввод  недоступен,
             вводимая  информация,  такая  как нажатие на кнопку "мыши"
             или клавиши на клавиатуре, окном игнорируется. Когда  ввод
             доступен, вся вводимая информация обрабатывается.
             Функция  EnableWindow  делает ввод с клавиатуры или "мыши"
             доступным для окна, если параметр bEnable не равен нулю, и
             недоступным, если bEnable равно нулю.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hWnd              HWND  Идентифицирует окно, ввод в
                               которое разрешается или запрещается.

             bEnable           BOOL  Определяет, будет ли данное окно
                               доступно или недоступно для ввода.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое  значение  специфицирует результат выполнения
             функции. Оно не равно нулю, если окно стало  доступно  или
             недоступно (в соответствии с указанием параметра bEnable),
             и равно нулю, если произошла ошибка.

        Примечания

             Окно   должно   быть   доступным  прежде,  чем  оно  будет
             активизировано.  Например,   если   прикладная   программа
             индицирует  безтипную  панель  диалога и имеет недоступным
             свое основное окно, то последнее  должно  стать  доступным
             прежде, чем панель диалога разрушится. В противном  случае
             другое  окно  захватит  ввод  и будет активизировано. Если
             дочернее окно недоступно, то оно игнорируется, когда среда
             Windows пытается определить, какое  окно  должно  получить
             сообщения от "мыши".

             Первоначально  все  окна  доступны по умолчанию. Для того,
             чтобы   сделать   окно   недоступным   явно,    необходимо
             использовать функцию EnableWindow.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 151 =

                               EndDeferWindowPos [3.0]                         

        Синтаксис

             void EndDeferWindowPos(hWinPosInfo)

             Эта   функция  одновременно  корректирует  расположение  и
             размер одного или более окон за один цикл обновления окна.
             Параметр  hWinPosInfo  идентифицирует  структуру   данных,
             содержащую   информацию  о  позициях  нескольких  окон,  в
             которой находится корректировочная  информация  для  окон.
             Функция    DeferWindowPos    сохраняет    корректировочную
             информацию в структуре данных; функция BeginDeferWindowPos
             создает   первоначальную  структуру  данных,  используемую
             этими функциями.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hWinPos           HANDLE  Идентифицирует структуру данных,
                               позиций нескольких окон, в которой
                               находится информация о размере и позиции
                               для одного или нескольких окон. Эта
                               структура возвращается функцией
                               BeginDefWindowpos или самым последним
                               вызовом функции DeferWindowPos.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсутствует.

        ───────────────────────────────────────────────────────────────
                                      EndDialog                                

        Синтаксис

             void EndDialog(nDlg, nResult)

             Эта функция заканчивает работу с модальной панелью диалога
             и возвращает данный результат функции  DialogBox,  которая
             создала  панель  диалога.  Функция EndDialog требуется для
             завершения работы каждый раз, когда для создания модальной
             панели диалога используется функция DialogBox. Эта функция
             должна использоваться в функции диалога  модальной  панели
             диалога  и  не должна использоваться для каких-либо других
             целей.
             Функция диалога может вызвать функцию  EndDialog  в  любое
             время,  даже  во  время обработки сообщения WM_INITDIALOG.
             Если  она   вызвана   в   процессе   обработки   сообщения
             WM_INITDIALOG,  то  панель диалога закрывается прежде, чем
             она станет  видимой,  или  прежде,  чем  будет  установлен
             захват ввода.

       Windows 3.0/Ref/2#7                                      = 152 =

             Функция  EndDialog  не  заканчивает  работу панели диалога
             немедленно.   Вместо   этого   она   устанавливает   флаг,
             указывающий панели диалога, что надо закончить работу, как
             только   завершится  функция  диалога.  Функция  EndDialog
             осуществляет возврат в функцию диалога, а тогда  последняя
             должна возвратить управление среде Windows.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDlg              HWND  Идентифицирует панель диалога,
                               которая должна быть разрушена.

             nResult           int  Определяет значение, возвращаемое
                               панелью диалога в функцию DialogBox,
                               создавшую эту панель.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсутствует.

        ───────────────────────────────────────────────────────────────
                                       EndPaint                                

        Синтаксис

             void EndPaint(hWnd, lpPaint)

             Эта функция отмечает  завершение  операции  перерисовки  в
             данном   окне.  Вызов  функции  EndPaint  необходим  после
             каждого вызова функции BeginPaint, но только  после  того,
             как перерисовка завершена.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hWnd              HWND  Идентифицирует окно, которое
                               перерисовывается.

             lpPaint           LPPAINTSTRUCT  Указывает на структуру
                               данных PAINTSTRUCT, которая содержит
                               информацию о рисовании,  возвращаемую
                               функцией BeginPaint.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсутствует.

        Примечания

             Если    псевдокурсор   был   сделан   невидимым   функцией
             BeginPaint, то функция  EndPaint  восстанавливает  его  на
             экране.
        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 153 =

                                   EnumChildWindows                            

        Синтаксис

             BOOL EnumChildWindows(hWndParent, lpEnumFunc, lParam)

             Эта функция перечисляет окна дочернего типа, принадлежащие
             специфицированному     родительскому    окну,    передавая
             дескриптор  каждого  дочернего  окна  по  очереди  функции
             многократного     вызова,    предоставляемой    прикладной
             программой, на которую указывает параметр lpEnumFunc.
             Функция EnumChildWindows продолжает  перечислять  окна  до
             тех пор, пока вызванная функция не возвратит нуль, либо не
             будет перечислено последнее окно дочернего типа.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hWndParent        HWND  Идентифицирует  родительского
                               окно, дочерние окна которого должны быть
                               перечислены.

             lpEnumFunc        FARPROC  Является адресом экземпляра
                               функции многократного вызова.

             lParam            LONG  Содержит значение,  передаваемое
                               функции многократного вызова для
                               использования прикладной программой.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение не равно нулю, если были перечислены
             все дочерние окна. В противном случае равно нулю.

        Примечания

             Эта  функция  не  перечисляет  окна  накладываемого  типа,
             принадлежащие параметру hWndParent.

             Адрес, передаваемый как параметр lpEnumFunc,  должен  быть
             создан с помощью функции MakeProcInstance.

             Функция    многократного    вызова   должна   использовать
             соглашения по вызову системы Pascal и быть  объявлена  как
             FAR.

        Функция многократного вызова

             BOOL FAR PASCAL EnumFunc(hWnd, lParam)
             HWND hWnd;
             LONG lParam;

       Windows 3.0/Ref/2#7                                      = 154 =


             Имя    EnumFunc   используется   вместо   имени   функции,
             предоставляемой  прикладной  программой.  Фактическое  имя
             должно  быть  экспортировано  посредством  включения его в
             оператор  EXPORTS  файла  определения  модуля   прикладной
             программы.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             hWnd              Идентифицирует дескриптор окна.

             lParam            Определяет длинный аргумент   параметра,
                               передаваемый   функции EnumChildWindows.
             ──────────────────────────────────────────────────────────


        Возвращаемое значение

             Функция многократного вызова должна  возвращать  ненулевое
             значение,  если  необходимо  продолжить  перечисление. Для
             завершения перечисления она должна возвратить нуль.

        ───────────────────────────────────────────────────────────────
                                EnumClipboardsFormats                          

        Синтаксис

             WORD EnumClipboardFormats(wFormat)

             Эта  функция  перечисляет  форматы,  найденные  в   списке
             доступных  форматов,  принадлежащих системному буферу. При
             каждом вызове этой функции параметр wFormat  специфицирует
             известный  доступный  формат, и функция возвращает формат,
             который является  следующим  в  списке.  Первый  формат  в
             списке может быть получен установкой wFormat в 0.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             wFormat           WORD  Определяет известный формат.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое  значение соответствует следующему известному
             формату  данных  системного  буфера.  Оно  равно  0,  если
             wFormat  специфицирует последний формат в списке доступных
             форматов, или если системный буфер пуст.

        Примечания

             Перед тем,  как  перечислять  форматы,  используя  функцию
             EnumClipboardFormats,  прикладная программа должна открыть
             системный буфер при помощи функции OpenClipboard.

       Windows 3.0/Ref/2#7                                      = 155 =


             Порядок,  который  прикладная  программа  использует   для
             размещения  альтернативных  форматов  для  одних  и тех же
             данных  в  системном  буфере  подобен   порядку,   который
             производящая   перечисление   программа   использует   при
             возвращении  их  во  вставляющую   прикладную   программу.
             Вставляющая   прикладная   программа  должна  использовать
             первый перечисленный формат, которым она может  управлять.
             Это  дает  отдающей  программе  возможность  рекомендовать
             форматы, которые обеспечивают наименьшую потерю данных.

        ───────────────────────────────────────────────────────────────
                                      EnumFonts                                

        Синтаксис

             EnumFonts(hDC, lpFacename, lpFontFunc, lpData)

             Эта  функция  перечисляет  шрифты, реализованные на данном
             устройстве. Для каждого шрифта,  имя  начертания  которого
             задается    параметром   lpFacename,   функция   EnumFonts
             возвращает информацию о  шрифте  и  передает  ее  функции,
             указанной      посредством      параметра      lpFontFunc.
             Предоставляемая     прикладной     программой      функция
             многократного   вызова  может  обрабатывать  информацию  о
             шрифте так, как требовалось. Перечисление продолжается  до
             тех   пор,   пока   шрифтов   не  останется,  или  функция
             многократного вызова не возвратит 0.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Идентифицирует контекст устройства.

             lpFacename        LPSTR  Указывает на оканчивающуюся
                               нулем строку символов, которая содержит
                               имя начертания требуемых шрифтов.  Если
                               параметр lpFacename равен NULL,
                               EnumFonts произвольно  выбирает и
                               перечисляет по одному шрифту каждого
                               реализованного начертания.

             lpFontFunc        FARPROC  Содержит адрес экземпляра
                               функции многократного вызова. Для
                               получения более подробной информации
                               смотри "Примечания".

             lpData            LPSTR  Указывает на данные,
                               предоставляемые прикладной программой.
                               Эти данные передаются функции
                               многократного вызова одновременно с
                               информацией о шрифте.
             ──────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                      = 156 =

        Возвращаемое значение

             Возвращаемое    значение    равно   последнему   значению,
             возвращенному функцией  многократного  вызова.  Его  смысл
             определяется пользователем.

        Примечания

             Адрес,  передаваемый  как параметр lpFontFunc, должен быть
             создан с помощью функции MakeProcInstance.

             Функция   многократного   вызова    должна    использовать
             соглашения  по вызову языка Pascal и должна быть объявлена
             FAR.

        Функция многократного вызова

             short FAR PASCAL FontFunc(lpLogFont, lpTextMetrics,
                                       FontType, lpData)
             LPLOGFONT lpLogFont;
             LPTEXTMETRICS lpTextMetrics;
             short FontType;
             LPSTR lpData;

             FontFunc    является    шаблоном    для   имени   функции,
             предоставляемой  прикладной  программой.  Фактическое  имя
             должно  быть  экспортировано  включением  его  в  оператор
             EXPORTS в файле определения модуля прикладной программы.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             lpLogFont         Указывает на структуру данных типа
                               LOGFONT, содержащую информацию о
                               логических атрибутах шрифта.

             lpTextMetrics     Указывает на структуру данных типа
                               TEXTMETRIC, содержащую информацию о
                               физических  атрибутах шрифта.

             FontType          Определяет тип шрифта.

             lpData            Указывает на данные, предоставляемые
                               прикладной программой и переданные
                               функцией EnumFonts.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение может быть любым целым числом.

        Примечания

             Для определения типа шрифта с константами  RASTER_FONTTYPE

       Windows 3.0/Ref/2#7                                      = 157 =

             и  DEVICE_FONTTYPE  может  быть применен оператор AND (&).
             Бит   RASTER_FONTTYPE   параметра   FontType   определяет,
             является  ли шрифт растровым или векторным. Если бит равен
             1,  то  шрифт  растровый,  если  0  -  то  векторный.  Бит
             DEVICE_FONTTYPE параметра FontType определяет, является ли
             шрифт  основным шрифтом GDI или устройства. Если бит равен
             1, то шрифт является основным шрифтом устройства, если 0 -
             то GDI.

             Если   устройство    способно    осуществлять    текстовые
             преобразования   (масштабирование,   поддержку  курсива  и
             т.д.),   будет   перечислен   только    основной    шрифт.
             Пользователь    должен    поинтересоваться   возможностями
             преобразования  текста  на  устройстве  для  того,   чтобы
             определить,    какие    дополнительные   шрифты   доступны
             непосредственно  для   данного   устройства.   GDI   может
             эмулировать  такие  атрибуты,  как  жирный  шрифт, курсив,
             подчеркивание и зачеркивание для любого  основного  шрифта
             GDI.

             EnumFonts перечисляет шрифты только из внутренней  таблицы
             GDI.   Туда   не   включаются  шрифты,  которые  создаются
             устройством, т.е. шрифты, являющиеся модификацией  шрифтов
             из внутренней таблицы. GetDeviceCaps может быть  применена
             для   определения   типов  преобразования,  которые  может
             выполнить  устройство.   Эта   информация   доступна   при
             использовании индекса TEXTCAPS.

             GDI может масштабировать свои растровые шрифты от 1  до  5
             по  горизонтали  и  от 1 до 8 по вертикали, если только не
             используется режим PROOF_QUALITY.

        ───────────────────────────────────────────────────────────────
                                     EnumMetaFile                              

        Синтаксис

             EnunMetaFile(hDC, hMF, lpCallbackFunc, lpClientData)

             Эта  функция  перечисляет  вызовы  GDI  внутри  метафайла,
             заданного  параметром  hMF.  Функция EnumMetaFile получает
             каждый вызов GDI  из  метафайла  и  передает  ее  функции,
             указанной  параметром  lpCallbackFunc. Эта предоставляемая
             прикладной  программой  функция многократного вызова может
             обрабатывать   каждый   вызов   GDI   требуемым   образом.
             Перечисление продолжается до тех пор, пока не останется ни
             одного  вызова  GDI,  или  функция многократного вызова не
             вернет 0.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Идентифицирует контекст устройства,
                               связанный с метафайлом.

       Windows 3.0/Ref/2#7                                      = 158 =


             hMF               LOCALHANDLE  Идентифицирует метафайл.

             lpCallbackFunc    FARPROC  Является адресом экземпляра
                               процедуры функции многократного вызова.
                               Для получения более подробной информации
                               смотри "Примечания".

             lpClientData      BYTE FAR *  Указывает на данные функции
                               многократного вызова.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое   значение   представляет   собой   результат
             выполнения  функции.  Оно не   равно   0,   если   функция
             многократного   вызова   перечислела   все  вызовы  GDI  в
             метафайле; в противном случае оно равно 0.

        Примечания

             Функция    многократного    вызова   должна   использовать
             соглашения по вызову системы Pascal и быть  объявлена  как
             FAR.

        Функция многократного вызова

             BOOL FAR PASCAL EnumFunc(hDC, lpHTable, lpMFR, nObj,
                                      lpClientData)
             HDC hDC;
             LPHANDLETABLE lpHTable;
             LPMETARECORD lpMFR;
             int nObj;
             BYTE FAR *lpClientData;

             Имя    EnumFunc   используется   вместо   имени   функции,
             предоставляемой  прикладной  программой.  Фактическое  имя
             должно  быть  экспортировано  посредством  включения его в
             оператор  EXPORTS  файла  определения  модуля   прикладной
             программы.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             hDC               Идентифицирует специальный контекст
                               устройства, который содержит метафайл.

             lpHTable          Указывает на таблицу дескрипторов,
                               связанных с объектами (перьями, кистями
                               и т.п.) в метафайле.

             lpMFR             Указывает на запись, содержащуюся в
                               метафайле.


       Windows 3.0/Ref/2#7                                      = 159 =

             nObj              Определяет число объектов со связанными
                               дескрипторами из таблицы дескрипторов.

             lpClientData      Указывает на данные, предоставляемые
                               прикладной программой.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Функция может выполнять любую требуемую задачу. Она должна
             вернуть  ненулевое  значение,  если  необходимо продолжить
             перечисление.  Для  завершения  перечисления  она   должна
             возвратить нуль.

        ───────────────────────────────────────────────────────────────
                                     EnumObjects                               

        Синтаксис

             int EnumObjects(hDC, nObjectType, lpObjectFunc, lpData)

             Эта функция  перечисляет  перья  и  кисти,  допустимые  на
             данном  устройстве.  Для  каждого  объекта, принадлежащего
             соответствующему типу,  вызывается  функция  многократного
             вызова   с   информацией   для  данного  объекта.  Функция
             многократного вызова  вызывается,  пока  не  останется  ни
             одного  объекта,  или пока функция многократного вызова не
             возвратит 0.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Идентифицирует контекст устройства.

             nObjectType       int  Идентифицирует тип объекта. Оно
                               может иметь одно из следующих значений:

                               OBJ_PEN
                               OBJ_BRUSH

             lpObjectFunc      FARPROC  Адрес экземпляра процедуры
                               предоставляемой прикладной программой
                               функции многократного вызова. Для
                               получения более подробной информации
                               смотри "Примечания".

             lpData            LPSTR  Указатель на данные,
                               предоставляемые прикладной программой.
                               Данные передаются функции многократного
                               вызова  одновременно с информацией об
                               объекте.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

       Windows 3.0/Ref/2#7                                      = 160 =


             Возвращаемое    значение    равно   последнему   значению,
             возвращенному функцией  многократного  вызова.  Его  смысл
             определяется пользователем.

        Примечания

             Адрес,   передаваемый  как  параметр  lpFontFunc  функции,
             должен быть создан при помощи функции MakeProcInstance.

             Функция   многократного   вызова    должна    использовать
             соглашения  по  вызову языка Pascal и быть объявленной как
             FAR.


        Функция многократного вызова

             int FAR PASCAL ObjectFunc(lpLogObject, lpData)
             char FAR * lpLogFunc;
             char FAR * lpData;

             ObjectFunc   является   шаблоном   для   имени    функции,
             предоставляемой  прикладной  программой.  Фактическое  имя
             должно  быть  экспортировано  включением  его  в  оператор
             EXPORTS в файле определения модуля прикладной программы.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             lpLogObject       Указывает на структуру данных типа
                               LOGPEN или LOGBRUSH,  содержащих
                               информацию о логических атрибутах
                               объекта.

             lpData            Указывает на данные, предоставляемые
                               прикладной программой для передачи в
                               функцию EnumObjects.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                      EnumProps                                

        Синтаксис

             int EnumProps(hWnd, lpEnumFunc)

             Эта  функция  перечисляет все элементы из перечня свойства
             специфицированного   окна.   Она   перечисляет   элементы,
             передавая  их  друг  за  другом  в  функцию  многократного
             вызова,  заданную  параметром   lpEnumFunc.   Перечисление
             продолжается  до тех пор, пока не будет передано последнее
             свойство или функция  многократного  вызова  не  возвратит
             нуль.


       Windows 3.0/Ref/2#7                                      = 161 =

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hWnd              HWND  Идентифицирует окно, свойства
                               которого должны быть перечислены.

             lpEnumFunc        FARPROC  Адрес экземпляра процедуры
                               функции многократного вызова. Для
                               получения более подробной информации
                               сиотри "Примечания".
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение равно последнему значению,  которое
             возвратила  функция  многократного  вызова.  Оно равно -1,
             если функция не нашла ни одного свойства для перечисления.

        Примечания

             Прикладная программа может удалить только  добавленные  ею
             свойства.  Она  не  должна  удалять  свойства, добавленные
             другими прикладными программами или самой средой Windows.

             На функцию многократного  вызова  накладываются  следующие
             ограничения:

             1.  Функция  многократного  вызова  не  должна  передавать
             управление  или  выполнять  какие-либо  действия,  которые
             могут привести к передаче управление другой задаче.

             2.  Функция  многократного  вызова  может вызывать функцию
             RemoveProp.  Однако,  функция  RemoveProp  может   удалять
             только  свойство,  переданное функции многократного вызова
             через ее параметры.

             3.  Функция  многократного  вызова  не   должна   пытаться
             добавить свойства.

             Адрес,  передаваемый  в  параметре lpEnumFunc, должен быть
             определен с помощью функции MakeProcInstance.

        Фиксированные сегменты данных

             Функция   многократного   вызова    должна    использовать
             соглашения  по  вызову системы Pascal и быть объявлена как
             FAR. В прикладных программах и динамических библиотеках  с
             фиксированными   сегментами   данных   и   в  динамических
             библиотеках с перемещаемыми сегментами данных, которые  не
             содержат  стек,  функция многократного вызова должна иметь
             следующий вид:

        Функция многократного вызова


       Windows 3.0/Ref/2#7                                      = 162 =

             int FAR PASCAL EnumFunc(hWnd, lpString, hData)
             HWND hWnd;
             LPSTR lpString;
             HANDLE hData;

             EnumFunc    является    шаблоном    для   имени   функции,
             предоставляемой  прикладной  программой.  Фактическое  имя
             должно  быть экспортировано путем включения его в оператор
             EXPORTS в файл определения модуля прикладной программы.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             hWnd              Идентифицирует  дескриптор окна,
                               которое содержит перечень свойств.

             lpString          Указывает на оканчивающуюся нулем
                               символьную строку, связанную с
                               дескриптором данных, когда прикладная
                               программа вызывает функцию SetProp для
                               установки свойства. Если вместо строки
                               прикладная программа передает функции
                               SetProp атом, параметр lpString содержит
                               этот атом в младшем слове, а старшее
                               слово равно 0.

             hData             Идентифицирует дескриптор данных.
             ──────────────────────────────────────────────────────────

        Возвращаемое  значение

             Функция может выполнить любую требуемую задачу. Она должна
             возвратить    ненулевое    значение    для     продолжения
             перечисления, или нуль - для прекращения перечисления.

        Перемещаемые сегменты данных

             Функция    многократного    вызова   должна   использовать
             соглашения  по  вызову  системы  Pascal  и   должна   быть
             объявлена как FAR. В прикладных программах с перемещаемыми
             сегментами  данных и в динамических библиотеках, в которых
             перемещаемые сегменты данных также содержат стек,  функция
             многократного вызова должна иметь следующий вид:

        Функция многократного вызова

             int FAR PASCAL EnumFunc(hWnd, nDummy, lpString, hData)
             HWND hWnd;
             WORD nDummy;
             PSTR pString;
             HANDLE hData;

             EnumFunc    является    шаблоном    для   имени   функции,
             предоставляемой  прикладной  программой.  Фактическое  имя

       Windows 3.0/Ref/2#7                                      = 163 =

             должно  быть экспортировано путем включения его в оператор
             EXPORTS в файл определения модуля прикладной программы.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             hWnd              Идентифицирует  дескриптор окна,
                               которое содержит перечень свойств.

             nDummy            Специфицирует фиктивный параметр.

             lpString          Указывает на оканчивающуюся нулем
                               символьную строку, связанную с
                               дескриптором данных, когда прикладная
                               программа вызывает функцию SetProp для
                               установки свойства. Если вместо строки
                               прикладная программа передает функции
                               SetProp атом, параметр lpString содержит
                               этот атом в младшем слове, а старшее
                               слово равно 0.

             hData             Идентифицирует дескриптор данных.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Функция может выполнить любую требуемую задачу. Она должна
             возвратить    ненулевое    значение    для     продолжения
             перечисления, или нуль - для прекращения перечисления.

        Примечания

             Альтернативная  форма,  представленная  выше,  необходима,
             поскольку перемещение данных будет делать недействительным
             любой длинный указатель на  переменную  стека,  такую  как
             параметр  lpString.  Сегмент  данных  обычно перемещается,
             если  функция  многократного   вызова   требует   большего
             пространства в локальной динамической памяти, чем доступно
             в данный момент.

        ───────────────────────────────────────────────────────────────
                                   EnumTaskWindows                             

        Синтаксис

             BOOL EnumTaskWindows(hTask, lpEnumFunc, lParam)

             Эта функция перечисляет все окна, связанные  с  параметром
             hTask,   который   возвращается  функцией  GetCurrentTask.
             (Задача - это любая  программа,  которая  выполняется  как
             независимая  единица. Все прикладные программы выполняются
             как  задачи,  и  каждый  экземпляр  прикладной   программы
             является  задачей). Перечисление завершается, если функция
             многократного  вызова,  указанная  параметром  lpEnumFunc,

       Windows 3.0/Ref/2#7                                      = 164 =

             возвращает FALSE.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hTask             HANDLE  Определяет специфицированную
                               задачу. Этот дескриптор возвращает
                               функция GetCurrentTask.

             lpEnumFunc        FARPROC  Адрес экземпляра процедуры
                               функции многократного вызова окна.

             lParam            LONG  Задает 32-битовое значение,
                               которое содержит дополнительные
                               параметры, передаваемые функции
                               многократного вызова, указанной
                               посредством lpEnumFunc.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое   значение  определяет  результат  выполнения
             функции. Оно не равно нулю,  если  перечислены  все  окна,
             связанные с отдельной задачей. В противном случае равно 0.

        Примечания

             Функция    многократного    вызова   должна   использовать
             соглашение  по  вызову  системы  Pascal  и   должна   быть
             объявлена  как  FAR.  Функция  многократного вызова должна
             иметь следующую форму:

             BOOL EnumFunc(hWnd, lParam)
             HWND hWnd;
             LONG lParam;

             EnumFunc   является   шаблоном    для    имени    функции,
             предоставляемой  прикладной  программой.  Фактическое  имя
             должно быть экпортировано путем включения его  в  оператор
             EXPORTS в файл определения модуля прикладной программы.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             hWnd              Идентифицирует окно, связанное с текущей
                               задачей.

             lParam            Содержит тот же самый аргумент, что был
                               передан функции EnumTaskWindows.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Функция  многократного  вызова   может   выполнить   любую
             требуемую задачу. Она должна возвратить ненулевое значение

       Windows 3.0/Ref/2#7                                      = 165 =

             для  продолжения  перечисления  или нулевое значение - для
             его завершения.

        ───────────────────────────────────────────────────────────────
                                     EnumWindows                               

        Синтаксис

             BOOL EnumWindows(lpEnumFunc, lParam)

             Эта  функция  перечисляет все родительские окна на экране,
             передавая  по  очереди  дескриптор  каждого  окна  функции
             многократного  вызова,  на  которую  указывает lpEnumFunc.
             Дочерние окна не перечисляются.
             Функция EnumWindows продолжает  перечислять  окна  до  тех
             пор, пока вызванная функция не  возвратит  нуль,  либо  не
             будет перечислено последнее окно.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             lpEnumFunc        FARPROC  Адрес экземпляра  процедуры
                               функции многократного вызова. Для
                               получения более подробной информации
                               смотри "Примечания".

             lParam            LONG  Определяет значение, которое
                               передается функции многократного вызова
                               для использования прикладной программой.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое   значение  определяет  результат  выполнения
             функции.  Оно  не  равно  нулю,   если   все   окна   были
             перечислены. В противном случае оно равно нулю.

        Примечания

             Адрес,  передаваемый  как параметр lpEnumFunc, должен быть
             создан с помощью функции MakeProcInstance.

             Функция   многократного   ваызова   должна    использовать
             соглашения   по   вызову  системы  Pascal  и  должна  быть
             объявлена как FAR. Ее вид должен быть следующим:

             BOOL FAR PASCAL EnumFunc(hWnd, lParam)
             HWND hWnd;
             LONG lParam;

             Здесь  EnumFunc   используется   вместо   имени   функции,
             предоставляемой  прикладной  программой.  Фактическое  имя
             должно быть экспортировано  посредством  включения  его  в
             оператор   EXPORTS  файла  определения  модуля  прикладной

       Windows 3.0/Ref/2#7                                      = 166 =

             программы.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             hWnd              Идентифицирует дескриптор окна.

             lParam            Определяет 32-битовый аргумент функции
                               EnumWindows.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Функция должна вернуть ненулевое значение, если необходимо
             продолжить перечисление, или нуль - для его окончания.

        ───────────────────────────────────────────────────────────────
                                      EqualRect                                

        Синтаксис

             BOOL EqualRect(lpRect1, lpRect2)

             Эта    функция    определяет,    эквивалентны    ли    два
             прямоугольника, сравнивая координаты их верхнего левого  и
             нижнего правого углов. Если значения этих координат равны,
             EqualRect   возвращает  ненулевое  значение;  в  противном
             случае функция возвращает 0.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             lpRect1           LPRECT  Указывает на структуру данных
                               типа RECT, которая содержит координаты
                               верхнего левого и нижнего правого углов
                               первого прямоугольника.

             lpRect2           LPRECT  Указывает на структуру данных
                               типа RECT, которая содержит координаты
                               верхнего левого и нижнего правого углов
                               второго прямоугольника.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое   значение   определяет,  равны  ли  заданные
             прямоугольники. Оно не равно нулю, если два прямоугольника
             идентичны. В противном случае оно равно 0.

        ───────────────────────────────────────────────────────────────
                                                                               
       EqualRgn

        Синтаксис

             BOOL EqualRgn(hSrcRgn1, hSrcRgn2)

       Windows 3.0/Ref/2#7                                      = 167 =


             Эта   функция   проверяет   две  заданные  области  на  их
             идентичность.


             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hSrcRgn1          HRGN  Идентифицирует  область.

             hSrcRgn2          HRGN  Идентифицирует область.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое  значение  определяет,  равны ли две заданные
             области. Оно  не  равно  0,  если  две  области  равны.  В
             противном случае оно равно 0.

        ───────────────────────────────────────────────────────────────
                                        Escape                                 

        Синтаксис

             short Escape(hDC, nEscape, nCount, lpInData, lpOutData)

             Эта  функция позволяет прикладной программе иметь доступ к
             тем возможностям отдельного устройства, которые недоступны
             непосредственно  через  GDI.   Escape-функции,   вызванные
             прикладной программой, преобразуются и передаются драйверу
             устройства.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Определяет контекст устройства.

             nEscape           int  Задает тип выполняемой управляющей
                               функции. Для того, чтобы просмотреть
                               полный список управляющих функций,
                               смотри Главу 12, "Управление печатью", в
                               Справочном руководстве, Том 2.

             nCount            int  Специфицирует число байтов данных,
                               указанных параметром lpInData.

             lpInData          LPSTR  Указывает на структуру вводимых
                               данных, требуемую для данной управляющей
                               функции.

             lpOutData         LPSTR  Указывает на структуру данных,
                               получающую информацию, выдаваемую данной
                               escape-функцией. Параметр lpOutData
                               должен быть равен NULL, если возврат
                               данных не производится.
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 168 =


        Возвращаемое значение

             Возвращаемое   значение  определяет  результат  выполнения
             функции.  Оно  положительно,  если   функция   завершилась
             успешно,  исключая  управляющую  функцию  QUERYESCSUPPORT,
             которая только проверяет выполнение. Возвращаемое значение
             равно нулю, если  данная  escape-функция  не  выполнилась.
             Отрицательное  значение  означает  ошибку.  Ниже  приведен
             список, содержащий общие значения ошибок:

             Значение                        Описание
             ──────────────────────────────────────────────────────────
             SP_ERROR              Общая ошибка.

             SP_OUTOFDISK          Недостаточно дискового пространства
                                   для буферизации, и нет надежды на
                                   получение какого-либо доступного
                                   пространства.

             SP_OUTOFMEMORY        Доступной памяти недостаточно для
                                   буферизации.

             SP_USERABORT          Пользователь прервал задание через
                                   служебную программу управления
                                   печатью.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                  EscapeCommFunction                           

        Синтаксис

             int EscapeCommFunction(nCid, nFunc)

             Эта   функция  побуждает  устройство  связи,  определяемое
             параметром nCid, выполненить расширенную функцию, заданную
             параметром nFunc.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             nCid              int  Определяет устройство связи,
                               которое должно выполнить расширенную
                               функцию. Это значение воэвращает функция
                               OpenComm.

             nFunc             int  Специфицирует код расширенной
                               функции. Он может принимать одно из
                               следующих значений:


       Windows 3.0/Ref/2#7                                      = 169 =

                               Значение    Описание
                               ────────────────────────────────────────
                               CLRDTR      Сбрасывает сигнал "Готовность
                                           данных терминала" (DTR).

                               CLRRTS      Сбрасывает сигнал "Запрос
                                           передачи" (RTS).

                               RESETDEV    Инициализирует устройство,
                                           если это возможно.

                               SETDTR      Посылает сигнал "Готовность
                                           данных терминала" (DTR).

                               SETRTS       Посылает сигнал "Запрос
                                            передачи" (RTS).

                               SETXOFF      Передача осуществляется
                                            аналогично передаче при
                                            получении символа XOFF.

                               SETXON       Передача осуществляется
                                            аналогично передаче при
                                            получении символа XON.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое  значение  специфицирует результат выполнения
             функции. Оно равно 0, если функция была завершена успешно.
             Оно   отрицательно,   если   параметр    nFunc    содержит
             некорректный код функции.

        ───────────────────────────────────────────────────────────────
                                   ExcludeClipRect                             

        Синтаксис

             int ExcludeClipRect(hDC, X1, Y1, X2, Y2)

             Эта  функция  создает новую область отсечения удалением из
             существующей области отсечения указанного прямоугольника.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Идентифицирует контекст устройства.

             X1                int  Определяет логическую координату x
                               верхнего левого угла прямоугольника.

             Y1                int  Определяет логическую координату y
                               верхнего левого угла прямоугольника.

             X2                int  Определяет логическую координату x
                               нижнего правого угла прямоугольника.

       Windows 3.0/Ref/2#7                                      = 170 =


             Y2                int  Определяет логическую координату y
                               нижнего правого угла прямоугольника.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое   значение   определяет   новый  тип  области
             отсечения. Оно может принимать одно из следующих значений:

             Значение             Описание
             ──────────────────────────────────────────────────────────
             COMPLEXREGION        Область имеет перекрывающиеся границы.

             ERROR                Область не создана.

             NULLREGION           Область пуста.

             SIMPLEREGION         Область не имеет перекрывающихся
                                  границ.

        Примечания

             Ширина прямоугольника, определяемая  абсолютным  значением
             (X2  -  Х1),  не  должны превышать 32,767 единиц. Такое же
             ограничение налагается и на высоту прямоугольника.

        ───────────────────────────────────────────────────────────────
                                   ExcludeUpdateRgn                            

        Синтаксис

             int ExcludeUpdateRgn(hDC, hWnd)

             Эта  функция  препятствует  выводу  в некорректные области
             окна  путем  исключения  корректируемой  области  окна  из
             области отсечения.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HANDLE  Идентифицирует контекст
                               устройства, соответствующий области
                               отсечения.

             hWnd              HWND  Определяет корректируемое окно.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое  значение   определяет   тип   результирующей
             области. Оно может принимать одно из следующих значений:


       Windows 3.0/Ref/2#7                                      = 171 =

             Значение             Описание
             ──────────────────────────────────────────────────────────
             COMPLEXREGION        Область имеет перекрывающиеся границы.

             ERROR                Область не создана.

             NULLREGION           Область пуста.

             SIMPLEREGION         Область не имеет перекрывающихся
                                  границ.

        ───────────────────────────────────────────────────────────────
                                  ExitWindows [3.0]                            

        Синтаксис

             BOOL ExitWindows(dwReserved, wReturnCode)

             Эта  функция инициализирует стандартную процедуру закрытия
             системы Windows. Если все прикладные программы согласны  с
             завершением,   сеанс   Windows  завершается, и  происходит
             передача  управления  DOS.  Windows   посылает   сообщение
             WM_QUERYENDSESSION   для   уведомления   всех   прикладных
             программ, что был сделан запрос на закрытие среды Windows.
             Если все  прикладные  программы  согласны  с  завершением,
             Windows  посылает  перед закрытием сообщение WM_ENDSESSION
             всем прикладным программам.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             dwReserved        DWORD  Является резервным, и должен быть
                               установлен в 0.

             wReturnCode       WORD  Определяет возвращаемое значение,
                               передаваемое DOS при закрытии Windows.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  равно  FALSE,  если  хотя  бы  одна
             прикладная   программа  отказалась  закончить  выполнение.
             Функция не возвращается,  если  все  прикладные  программы
             согласны с завершением.

        ───────────────────────────────────────────────────────────────
                                 ExtDeviceMode [3.0]                           

        Синтаксис

             int ExtDeviceMode(hWnd, hDriver, lpDevModeOutput,
                               lpDeviceName, lpPort, lpDevModeInput,
                               lpProfile, wMode)

             Эта функция получает или изменяет информацию инициализации

       Windows 3.0/Ref/2#7                                      = 172 =

             устройства для заданного драйвера принтера  или отображает
             на экране панель диалога драйвера для  настройки  драйвера
             принтера.    Драйверы   принтера,   которые   поддерживают
             инициализацию устройства при помощи прикладной  программы,
             экспортируют эту функцию ExtDeviceMode, так что прикладная
             программа может ее вызвать.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hWnd              HWND  Идентифицирует окно. Если
                               прикладная программа вызвала функцию
                               ExtDeviceMode для индицирования панели
                               диалога, то задаваемое окно является
                               родительским окном панели диалога.

             hDriver           HANDLE  Определяет модуль драйвера
                               устройства. Дескриптор модуля возвращает
                               функция GetModuleHandle или функция
                               LoadLibrary.

             lpDevModeOutput   DEVMODE FAR *  Указывает на структуру
                               данных DEVMODE. В эту структуру драйвер
                               записывает информацию инициализации,
                               задаваемую параметром lpDevModeOutput.

             lpDeviceName      LPSTR  Указывает на оканчивающуюся нулем
                               строку символов, содержащую имя
                               устройства печати, например, "PCL\HP
                               LaserJet".

             lpPort            LPSTR  Указывает на оканчивающуюся нулем
                               строку символов, содержащую имя порта, к
                               которому подключено устройство, например,
                               LPT1:.

             lpDevModeInput    DEVMODE FAR *  Указывает на структуру
                               данных DEVMODE, в которой находится
                               информация инициализации для драйвера
                               принтера.

             lpProfile         LPSTR Указывает на оканчивающуюся нулем
                               строку, содержащую имя файла
                               инициализации, в который записывается и
                               из которого считывается  информация
                               инициализации. Если этот параметр равен
                               NULL, то по умолчанию берется файл
                               WIN.INI.

             wMode             WORD  Задает маску значений,
                               определяющих тип операций, которые будет
                               выполнять функция. Если wMode равен 0,
                               функция ExtDevMode возвращает число
                               байтов, требуемых для структуре данных

       Windows 3.0/Ref/2#7                                      = 173 =

                               DEVMODE драйвера устройства печати. В
                               противном случае wMode должен принимать
                               одно или несколько следующих значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               DM_COPY      Записывает в структуру
                                            данных DEVMODE, заданную
                                            параметром lpDevModeOutput,
                                            текущие установки драйвера
                                            принтера. Вызывающая
                                            прикладная программа должна
                                            выделить достаточного
                                            размера буфер для хранения
                                            этой информации. Если этот
                                            бит чист, то lpDevModeOutput
                                            должен быть равен NULL.

                               DM_MODIFY    Изменяет текущие установки
                                            драйвера принтера в
                                            соответствии с некоторыми
                                            данными инициализации из
                                            структуры данных DEVMODE,
                                            определяемой параметром
                                            lpDevModeInput, перед
                                            подсказкой, копированием
                                            или коррекцией.

                               DM_PROMPT    Представляет панель диалога
                                            "Установки для печати"
                                            драйвера принтера и, затем,
                                            изменяет текущие установки
                                            для печати в соответствии с
                                            пожеланиями пользователя.

                               DM_UPDATE    Записывает текущие
                                            установки драйвера принтера
                                            в окружение принтера и в
                                            файл инициализации WIN.INI.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Если  параметр  wMode  равен  0,  то возвращаемое значение
             представляет  собой  размер  структуры   данных   DEVMODE,
             требуемой   для  хранения  данных  инициализации  драйвера
             принтера.   Если   функция   индицирует   панель   диалога
             инициализации,  возвращаемое  значение  равно или IDOK или
             IDCANCEL,  в  зависимости  от  мягкой  клавиши,  выбранной
             пользователем.   Если   функция  выполнилась  успешно,  не
             индицируя  панель  диалога,  возвращаемое  значение  равно
             IDOK.  Если  произошла  ошибка,  то  возвращаемое значение
             меньше нуля.

       Windows 3.0/Ref/2#7                                      = 174 =


        Примечания

             Функция ExtDeviceMode фактически является частью  драйвера
             устройства  печати,  а  не  частью  GDI.  Для  того, чтобы
             вызвать эту функцию, прикладная программа должна  включить
             файл  DRIVINT.H,  загрузить  драйвер  устройства  печати и
             получить   адрес   этой   функции,    используя    функцию
             GetProcAddress.    Прикладная    программа   затем   может
             использовать этот адрес для настройки принтера.

             Прикладная программа может  установить  параметр  wMode  в
             значение   DM_COPY   для  получения  данных  инициализации
             драйвера принтера из структуры данных DEVMODE.  Прикладная
             программа   может  затем  передать  эту  структуру  данных
             функции CreateDC  для  установки  частного  окружения  для
             контекста устройства печати.
        ───────────────────────────────────────────────────────────────
                                  ExtFloodFill [3.0]                           

        Синтаксис

             BOOL ExtFloodFill(hDC, X, Y, crColor, wFillType)

             Эта  функция  заливает  область  на экране дисплея текущей
             кистью.
             Если   параметр   wFillType    установлен    в    значение
             FLOODFILLBORDER,  то предполагается, что область полностью
             ограничена  цветом,   определяемым   параметром   crColor.
             Функция  ExtFloodFill   начинает   с   точки,   задаваемой
             параметрами   X  и  Y,  и  осуществляет  заливку  во  всех
             направлениях до границы цвета.
             Если    параметр    wFillType    установлен   в   значение
             FLOODFILLSURFACE,  то  функция  ExtFloodFill  начинает   с
             точки,  задаваемой  параметрами X и Y, и продолжает работу
             во  всех  направлениях,  заливая  все  соседние   области,
             содержащие цвет, специфицированный параметром crColor.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Определяет контекст устройства.

             X                 int  Задает логическую координату x
                               точки начала заливки.

             Y                 int  Задает логическую координату y
                               точки начала заливки.

             crColor           COLORREF  Определяет цвет границы
                               заливаемой области. Интерпретация
                               параметра crColor зависит от значения
                               параметра wFillType.


       Windows 3.0/Ref/2#7                                      = 175 =

             wFillType         WORD  Задает тип выполняемой заливки. Он
                               может принимать одно из следующих
                               значений:

                               Значение          Описание
                               ────────────────────────────────────────
                               FLOODFILLBORDER   Заливаемая область
                                                 ограничена цветом,
                                                 задаваемым параметром
                                                 crColor. Этот тип
                                                 идентичен заливке,
                                                 выполняемой функцией
                                                 FloodFill.

                               FLOODFILLSURFACE  Заливаемая область
                                                 определяется цветом,
                                                 задаваемым параметром
                                                 crColor. Заливка
                                                 происходит снаружи во
                                                 всех направлениях,
                                                 пока встречается этот
                                                 цвет. Этот тип полезен
                                                 при заливке областей с
                                                 многоцветными
                                                 границами.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение специфицирует  результат  выполнения
             функции. Оно не равно 0, если функция выполнилась успешно.
             Оно равно 0, если:

             Заливка не была завершена

             Заданная точка имеет цвет, определяемый параметром crColor
             (если затребован тип FLOODFILLBORDER)

             Заданная  точка  не  имеет  цвет,  определяемый параметром
             crColor (если затребован тип FLOODFILLSURFACE)

             Точка находится за границей области отсечения

        Примечания

             Функцию   ExtFloodFill   поддерживают   только   контексты
             устройства   памяти   или  контексты  устройста  растровых
             дисплеев. Для получения более подробной информации  смотри
             растровый   параметр   RC_BITBLT   функции  GetDeviceCaps,
             описанной ниже в данной главе.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 176 =

                                      ExtTextOut                               

        Синтаксис

             BOOL ExtТеxtOut(hDC, X, Y, wOptions, lpRect, lpString,
                             nCount, lpDx)

             Эта функция  выводит  символьную  строку  в  прямоугольную
             область  на  заданном дисплее, используя текущий выбранный
             шрифт.  Прямоугольная  область  может  быть   непрозрачной
             (заполненной текущим фоновым цветом) и может быть областью
             отсечения.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Идентифицирует контекст устройства.

             X                 int  Определяет логическую координату x
                               начала знакоместа для первого символа в
                               заданной строке.

             Y                 int  Определяет логическую координату y
                               начала знакоместа для первого символа в
                               заданной строке.

             wOptions          WORD  Определяет тип прямоугольника. Он
                               может быть одним из двух приведенных
                               ниже значений или ни тем ни другим:

                               ETO_CLIPPED
                               ETO_OPAQUE

                               Значение ETO_CLIPPED означает, что
                               Windows будет отсекать текст в
                               прямоугольнике. Значение ETO_OPAQUE
                               означает, что прямоугольник заполнен
                               текущим фоновым цветом.

             lpRect            LPRECT  Указывает на структуру данных
                               RECT. Параметр lpRect может быть равен
                               0.

             lpString          LPSTR  Указывает на выводимую символьную
                               строку.

             nCount            int  Определяет число символов в строке.

             lpDx              LPINT  Указывает на массив значений,
                               который определяет расстояние между
                               началами соседних знакомест. Например,
                               логические единицы lpDx[i] будут
                               отделять начала знакоместа i и
                               знакоместа i + 1.
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 177 =


        Возвращаемое значение

             Возвращаемое значение определяет, была ли выведена строка.
             Оно не равно 0, если вывод строки осуществлен. В противном
             случае оно равно 0.

        Примечания

             Если lpDx  равен  NULL,  функция  использует  значение  по
             умолчанию межсимвольного промежутка.

             Начала   знакомест   и   содержимое  массива,  на  который
             указывает параметр lpDx, задается в  логических  единицах.
             Начало знакоместа соответствует его верхнему левому углу.

             По  умолчанию  эта функция не использует текущую позиции и
             не изменяет ее. Однако, прикладная программа может вызвать
             функцию SetTextAlign с параметром wFlags, установленным  в
             значение  TA_UPDATECP, для разрешения Windows использовать
             и изменять текущую позицию всякий  раз,  когда  прикладная
             программа   вызывает   функцию   ExtTextOut   для  данного
             контекста устройства. Если этот флаг  установлен,  Windows
             игнорирует  параметры  X и Y в последующих вызовах функции
             ExtTextOut.

        ───────────────────────────────────────────────────────────────


       Windows 3.0/Ref/2#7                                      = 178 =

                                  FatalAppExit [3.0]                           

        Синтаксис

             VOID FatalAppExit(wAction, lpMessageText)

             Эта  функция  индицирует  сообщение,   содержащее   текст,
             заданный  параметром  lpMessageText,  и  завершает  работу
             прикладной программы при закрытии панели сообщения.  Когда
             вызов  происходит  в  отладочной  версии  Windows,  панель
             сообщения предоставляет пользователю  удобную  возможность
             завершить  прикладную  программу  или  вернуться  к  месту
             вызова.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             wAction           WORD  Зарезервирован и должен быть
                               установлен в 0.

             lpMessageText     LPSTR  Указывает на строку символов,
                               которая отображается в панели сообщения.
                               Сообщение представляет собой на экране
                               одну строку текста. Для того, чтобы
                               соответствовать дисплеям с низкой
                               разрешающей способностью, длина строки
                               не должна превышать 35 символов.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсутствует.

        Примечания

             Прикладная программа, которая встретила  непредусмотренную
             ошибку,   должна   завершить   выполнение,  освободив  всю
             занимаемую ею память  и  вернувшись  из  своего  основного
             цикла  обработки  сообщений.  Она  должна вызывать функцию
             FatalAppExit   только   в   том  случае,  если  невозможно
             завершить   работу   никаким   другим   образом.   Функция
             FatalAppExit не всегда может освободить память, занимаемую
             прикладной программой, или закрыть принадлежащие ей файлы,
             что может привести к серьезной ошибке среды Windows.

        ───────────────────────────────────────────────────────────────
                                      FatalExit                                

        Синтаксис

             void FatalExit(Code)

             Эта функция отображает текущее состояние среды Windows  на
             отладочном   мониторе   и   запрашивает   инструкции   для

       Windows 3.0/Ref/2#7                                      = 179 =

             продолжения  работу.  Отображение  включает  код   ошибки,
             параметр  Code,  представленный  в виде символьного стека,
             показывающего поток выполнения до точки вызова.
             Прикладная программа должна вызывать эту функцию только  в
             отладочных  целях;  ей  не  следует вызывать эту функцию в
             стандартной  версии  прикладной  программы.   Вызов   этой
             функции   в  стандартоной  версии  приведет  к  завершению
             прикладной программы.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             Code int           Определяет код ошибки, которая должна
                                быть отображена.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсутствует.

        Примечания

             Функция FatalExit побуждает  пользователя  дать  ответ  на
             сообщение   "Завершить,   Прервать,   или   Игнорировать".
             FatalExit обрабатывает этот ответ следующим образом:

             Ответ               Описание
             ──────────────────────────────────────────────────────────
             A (Abort)           Завершает работу Windows.

             B (Break)            Имитирует немаскированное прерывание
                                  (NMI) для входа в отладчик.

             I (Ignore)            Осуществляет возврат в точку вызова.
             ──────────────────────────────────────────────────────────

             Функция FatalExit используется только для отладки.

             Прикладная  программа  должна  вызывать эту функцию каждый
             раз, когда прикладная программа обнаруживает ошибку.  Весь
             ввод    и    вывод    принимается   и   передается   через
             последовательный порт (AUX) или через  отладчик,  если  он
             инсталлирован.

        ───────────────────────────────────────────────────────────────
                                       FillRect                                

        Синтаксис

             int FillRect(hDC, lpRect, hBrush)

             Эта  функция  заливает  заданный  прямоугольник  выбранной
             кистью.  Функция  FillRect  заливает  весь  прямоугольник,
             включая его левую и верхнюю границы, но не заливает правую

       Windows 3.0/Ref/2#7                                      = 180 =

             и нижнюю границы.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Идентифицирует контекст устройства.

             lpRect            LPRECT  Указывает на структуру данных
                               типа RECT, которая содержит логические
                               координаты заливаемого прямоугольника.

             hBrush            HBRUSH  Определяет кисть, используемую
                               для заливки прямоугольника.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Хотя  тип возвращаемого значения функции FillRect и указан
             как целый, но это значение  не  используется  и  не  имеет
             смысла.

        Примечания

             Кисть  должна  быть предварительно создана с помощью одной
             из    функций    CreateHatchBrush,     CreatePatternBrush,
             CreateSolidBrush    или    получена,   используя   функцию
             GetStockObject.

             При заливке указанного прямоугольника функция FillRect  не
             включает  правую  и  нижнюю  стороны  прямоугольника.  GDI
             заливает прямоугольник вплоть до границы, но  не  включает
             правый  столбец  и  нижнюю  строку, независимо от текущего
             режима отображения.

             Функция FillRect проверяет  значения  полей  top,  bottom,
             left   и  right  специфицированного  прямоугольника.  Если
             bottom меньше или равно top или,  если  right  меньше  или
             равно left, то прямоугольник не рисуется.

        ───────────────────────────────────────────────────────────────
                                       FillRgn                                 

        Синтаксис

             BOOL FillRgn(hDC, hRgn, hBrush)

             Эта  функция  заливает  область,  определяемую  параметром
             hRgn, кистью, задаваемой параметром hBrush.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Идентифицирует контекст устройства.

             hRgn              HRGN  Идентифицирует область заливки.

       Windows 3.0/Ref/2#7                                      = 181 =

                               Координаты данной области задаются в
                               единицах устройства.

             hBrush            HBRUSH  Определяет кисть, используемую
                               для заливки области.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое   значение  определяет  результат  выполнения
             функции. Оно не равно 0, если функция выполнилась успешно.
             В противном случае оно равно 0.

        ───────────────────────────────────────────────────────────────
                                                                               
       FindAtom

        Синтаксис

             ATOM FindAtom(lpString)

             Эта функция ищет в таблице атомов  символьную  строку,  на
             которую  указывает  параметр  lpString, и возвращает атом,
             соответствующий этой строке.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             lpString          LPSTR  Указывает на символьную строку,
                               которая должна быть найдена. Строка
                               должна оканчиваться  нулем.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое  значение  идентифицирует  атом,  связанный с
             данной строкой. Оно равно NULL, если  этой  строки  нет  в
             таблице.

        ───────────────────────────────────────────────────────────────
                                     FindResource                              

        Синтаксис

             HANDLE FindResource(hInstance, lpName, lpType)

             Эта  функция  определяет  расположение ресурса в указанном
             файле ресурсов. Параметры lpName и lpType определяют имя и
             тип ресурса соответственно.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hInstance         HANDLE  Идентифицирует экземпляр модуля,
                               выполняемый файл которого содержит
                               ресурс.

       Windows 3.0/Ref/2#7                                      = 182 =


             lpName            LPSTR  Указывает на оканчивающуюся нулем
                               строку символов, представляющую имя
                               ресурса.

             lpType            LPSTR  Указывает на оканчивающуюся нулем
                               символьную строку, представляющую имя
                               типа ресурса. Для предварительно
                               определенных типов ресурсов параметр
                               lpType должен принимать одно из
                               следующих значений:

                               Значение        Описание
                               ────────────────────────────────────────
                               RT_ACCELERATOR  Таблица ускорителей

                               RT_BITMAP       Ресурс растровой карты

                               RT_CURSOR       Ресурс курсора

                               RT_DIALOG       Ресурс панели диалога

                               RT_FONT         Ресурс шрифта

                               RT_ICON         Ресурс иконы

                               RT_MENU         Ресурс меню

                               RT_RCDATA       Ресурс, определяемый
                                               пользователем (исходные
                                               данные)
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение идентифицирует указанный ресурс. Оно
             равно NULL, если требуемый ресурс не может быть найден.

        Примечания

             Прикладная   программа   не   должна   вызывать    функции
             FindResource и LoadResource для загрузки ресурсов курсора,
             иконы  и  строки.  Вместо  этого  она должна загружать эти
             ресурсы при помощи вызовов следующих функций:

             LoadCursor
             LoadIcon
             LoadString

             Прикладная  программа может вызвать функции FindResource и
             LoadResource для загрузки  других  предопределенных  типов
             ресурсов.    Однако,   рекомендуется,   чтобы   прикладная
             программа загружала  соответствующие  ресурсы  при  помощи

       Windows 3.0/Ref/2#7                                      = 183 =

             вызовов следующих функций:

             LoadAccelerator
             LoadBitmap
             LoadMenu

             Если  старшее  слово  параметров  lpName  или lpType равно
             нулю, то младшее слово определяет целочисленный  ID  имени
             или типа заданного ресурса. В противном случае параметры -
             длинные   указатели  на  оканчивающиеся  нулем  символьные
             строки. Если первым символом строки является  символ  "#",
             то   остальные   символы  представляют  десятичное  число,
             которое  определяет  целочисленный  ID  имени   или   типа
             ресурса.  Например, строка "#258" определяет целочисленный
             ID, равный 258.

             Для уменьшения количества памяти, требуемой для  ресурсов,
             используемых  прикладной  программой, прикладная программа
             должна ссылаться на ресурсы по  целочисленному  ID  вместо
             имени.

        ───────────────────────────────────────────────────────────────
                                      FindWindow                               

        Синтаксис

             HWND FindWindow(lpClassName, lpWindowName)

             Эта  функция  возвращает  дескриптор  окна,  класс  и  имя
             (заголовок)  которого  заданы  параметрами  lpClassName  и
             lpWindowName соответственно.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             lpClassName       LPSTR  Указывает на заканчивающуюся
                               нулем строку символов, задающую имя
                               класса окна. Если lpClassNane равен NULL,
                               просматриваются все имена классов.

             lpWindowName      LPSTR  Указывает на заканчивающуюся
                               нулем строку символов,  специфицирующую
                               имя окна (текстовый заголовок окна).
                               Если lpWindowName равен NULL,
                               просматриваются все имена окон.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое   значение   идентифицирует   окно,   имеющее
             заданные имена класса и окна. Оно равно NULL,  если  такое
             окно не найдено.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 184 =

                                     FlashWindow                               

        Синтаксис

             BOOL FlashWindow(hWnd, bInvert)

             Эта  функция  заставляет "мигнуть" один раз заданное окно.
             Мигание окна означает изменение внешнего вида  его  строки
             заголовка, как если бы окно было переведено из неактивного
             в  активное  состояние  или  наоборот.  (Неактивная строка
             заголовка  изменяется   на   активную;   активная   строка
             заголовка изменяется на неактивную).
             Окно  обычно  мигает для того, чтобы указать пользователю,
             что оно требует внимания,  но  ввод  в  данный  момент  не
             захватило.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hWnd              HWND  Идентифицирует окно, которое
                               должно "мигать". Окно может быть или
                               открыто или в виде иконы.

             bInvert           BOOL  Определяет, должно ли окно мигать
                               или вернуться в свое первоначальное
                               состояние. Окно должно мигать, если
                               параметр bInvert не равен нулю. Если
                               параметр bInvert равен нулю, окно
                               возвращается в свое первоначальное
                               состояние (активное или неактивное).
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое  значение  определяет  состояние  окна  перед
             вызовом функции FlashWindow. Оно не равно нулю, если  окно
             было активным перед вызовом. В противном случае оно  равно
             нулю.

        Примечания

             Функция FlashWindow приводит только к однократному миганию
             окна;  для  периодического  мигания  прикладная  программа
             должна создать системный таймер.

             Параметр  bInvert  должен быть нулевым только тогда, когда
             окно получило ввод и не должно больше мигать;  оно  должно
             быть  не  нулевым  в  последовательных  вызовах, пока окно
             ожидает фокусировку ввода.

             Эта функция всегда возвращает ненулевое значение для  окон
             в  виде иконы. Если окно в виде иконы, функция FlashWindow
             будет просто приводить к миганию иконы;  параметр  bInvert
             игнорируется для окон в виде икон.
        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/2#7                                      = 185 =

                                      FloodFill                                

        Синтаксис

             BOOL FloodFill(hDC, X, Y, crColor)

             Эта функция заливает область  на  экране  дисплея  текущей
             кистью.  Предполагается,  что  эта  область имеет границу,
             задаваемую   параметром   rgbColor.   Функция   FloodFillа
             начинает  заливку  с  точки,  имеющей  координаты  X, Y, и
             распространяется  во  все   стороны   до   соответствующей
             цветовой границы.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Идентифицирует контекст устройства.

             X                 int  Определяет логическую координату x
                               точки начала заливки.

             Y                 int  Определяет логическую координату y
                               точки начала заливки.

             crColor           COLORREF  Задает цвет границы.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое   значение  определяет  результат  выполнения
             функции. Оно не равно 0, если функция выполнилась успешно.
             Оно равно 0, если  заполнение  не  было  завершено:  точка
             находится  вне  области  отсечения или имеет цвет границы,
             определенный параметром crColor.

        Примечания

             Функцию FloodFill поддерживают только контексты устройства
             памяти или контексты  устройста  растровых  дисплеев.  Для
             получения  более  подробной  информации  смотри  растровый
             параметр RC_BITBLT функции GetDeviceCaps, описанной ниже в
             данной главе.

        ───────────────────────────────────────────────────────────────
                                      FlushComm                                

        Синтаксис

             int FlushComm(nCid, nQueue)

             Эта функция сбрасывает все символы из очередей приема  или
             передачи  устройства связи, определяемого параметром nCid.

       Windows 3.0/Ref/2#7                                      = 186 =

             Параметр  nQueue  специфицирует,   какая   очередь   будет
             сброшена.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             nCid              int  Определяет устройство связи, на
                               котором будет произведен сброс. Это
                               значение возвращает функция OpenComm.

             nQueue            int  Специфицирует, какая очередь будет
                               сброшена. Если nQueue равен нулю, то
                               сбрасывается очередь передачи; если
                               nQueue равен 1, то сбрасывается очередь
                               приема.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое   значение  определяет  результат  выполнения
             функции. Оно равно 0, если функция была завершена успешно.
             Оно   отрицательно,   если   параметр   nCid    определяет
             некорректное    устройство,    или   параметр   nQueue   -
             некорректную очередь.

        ───────────────────────────────────────────────────────────────
                                      FrameRect                                

        Синтаксис

             int FrameRect(hDC, lpRect, hBrush)

             Эта   функция   рисует   рамку   вокруг    прямоугольника,
             специфицированного  параметром  lpRect.  Для  вывода рамки
             функция FrameRect  использует  заданную  кисть.  Ширина  и
             высота рамки всегда равна одной логической единице.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Идентифицирует контекст устройства.

             lpRect            LPRECT  Указывает на структуру данных
                               типа RECT, которая содержит логические
                               координаты верхнего левого и нижнего
                               правого углов прямоугольника.

             hBrush            HBRUSH  Идентифицирует кисть, которая
                               будет использована для рисования рамки.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Хотя  возвращаемое  значение существует и имеет целый тип,
             его содержимое игнорируется.

       Windows 3.0/Ref/2#7                                      = 187 =


        Примечания

             Кисть, идентифицируемая  параметром  hBrush,  должна  быть
             предварительно   создана   с   помощью  одной  из  функций
             CreateHatchBrush, CreatePatternBrush или CreateSolidBrush.

             Если поле bottom меньше или равно полю top, или поле right
             меньше или равно полю left, то прямоугольник не рисуется.

        ───────────────────────────────────────────────────────────────
                                       FrameRgn                                

        Синтаксис

             BOOL FrameRgn(hDC, hRgn, hBrush, nWidth, nHeight)

             Эта функция  рисует  рамку  вокруг  области,  определяемой
             параметром  hRgn,  используя  кисть,  заданную  параметром
             hBrush. Параметр nWidth задает ширину рамки,  определяемую
             вертикальными   мазками  кисти;  параметр  nHeight  задает
             высоту рамки, определяемую горизонтальными мазками кисти.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hDC               HDC  Идентифицирует контекст устройства.

             hRgn              HANDLE  Идентифицирует область, для
                               которой рисуется рамка. Координаты
                               области задаются в единицах устройства.

             hBrush            HBRUSH  Идентифицирует кисть,
                               используемую для вывода рамки.

             nWidth            int  Определяет ширину рамки в
                               вертикальных мазках кисти (в логических
                               единицах).

             nHeight           int  Определяет высоту рамки в
                               горизонтальных мазках кисти (в
                               логических единицах).
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое  значение  специфицирует   результат   работы
             функции. Оно не равно 0, если функция выполнилась успешно.
             В противном случае оно равно 0.

        ───────────────────────────────────────────────────────────────
                                                                               
       FreeLibrary

        Синтаксис

       Windows 3.0/Ref/2#7                                      = 188 =


             void FreeLibrary(hLibModule)

             Эта  функция  уменьшает на 1 счетчик ссылок на загруженный
             модуль  библиотеки.  Когда  счетчик  ссылок  достигнет  0,
             доступная модулю память освобождается.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hLibModule        HANDLE  Идентифицирует загруженный
                               модуль библиотеки.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсутствует.

        ───────────────────────────────────────────────────────────────
                                                                               
       FreeModule [3.0]

        Синтаксис

             void FreeModule(hModule)

             Эта функция уменьшает на 1 счетчик ссылок  на  загруженный
             модуль. Когда счетчик ссылок достигнет 0, доступная модулю
             память освобождается.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hModule           HANDLE  Определяет загруженный модуль.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсутствует.

        ───────────────────────────────────────────────────────────────
                                   FreeProcInstance                            

        Синтаксис

             void FreeProcInstance(lpProc)

             Эта  функция  освобождает функцию, определяемую параметром
             lpProc, от сегмента  данных,  связанного  с  ней  функцией
             MakeProcInstance.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             lpProc            FARPROC  Определяет адрес экземпляра
                               процедуры освобождаемой функции. Адрес
                               должен быть предварительно  создан с

       Windows 3.0/Ref/2#7                                      = 189 =

                               помощью функции MakeProcInstance.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Отсутствует.

        Примечания

             После освобождения экземпляра  процедуры  попытка  вызвать
             функцию,   используя   адрес   освобожденного   экземпляра
             процедуры, приведет к непредсказуемой ошибке.

        ───────────────────────────────────────────────────────────────
                                     FreeResource                              

        Синтаксис

             BOOL FreeResource(hResData)

             Эта  функция  удаляет  загруженный   ресурс   из   памяти,
             освобождая выделенную память, занятую этим ресурсом.
             Функция  FreeResource  фактически не освобождает ресурс до
             тех пор, пока счетчик ссылок не станет равным  нулю  (т.е.
             число  вызовов  функции  не  станет равным числу обращений
             прикладной программы к функции  LoadResource  для  данного
             ресурса).  Это  гарантирует,  что данные остаются в памяти
             для их использования прикладной программой.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             hResData           HANDLE  Идентифицирует  данные,
                                связанные с ресурсом. Предполагается,
                                что этот дескриптор был  создан  с
                                помощью функции LoadResource.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение определяет результат работы функции.
             Оно не равно нулю, если произошла ошибка, и ресурс не  был
             освобожден. Возвращаемое значение равно нулю, если функция
             завершена успешно.

        ───────────────────────────────────────────────────────────────
                                  FreeSelector [3.0]                           

        Синтаксис

             WORD FreeSelector(wSelector)

             Эта функция освобождает селектор, первоначально выделенный
             функциями      AllocSelector,     AllocCStoDSAlias     или

       Windows 3.0/Ref/2#7                                      = 190 =

             AllocDStoCSAlias. После  того,  как  прикладная  программа
             вызвала эту функцию, селектор становится некорректным и не
             должен использоваться.

             Параметры         Тип/Описание
             ──────────────────────────────────────────────────────────
             wSelector         WORD  Задает освобождаемый селектор.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое  значение равно NULL, если выполнение функции
             закончилось  успешно.  В противном случае оно представляет
             собой селектор, определяемый параметром wSelector.

        Примечания

             Прикладная программа не должна использовать эту функцию до
             тех   пор,   пока   это  не  будет  абсолютно  необходимо.
             Использование этой функции нарушает  предпочитаемый  стиль
             программирования в среде Windows.

