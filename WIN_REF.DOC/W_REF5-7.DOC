                                   Оглавление                                  
       Windows 3.0/Ref/5#7                                        = 1 =

       Глава 5.  Обзор сообщений......................................6
       5.1  Сообщения управления окнами...............................7
       5.2  Сообщения инициализации..................................10
       5.3  Сообщения о вводе........................................11
       5.4. Системные сообщения......................................13
       5.5  Сообщения системного буфера..............................14
       5.6  Системные информационные сообщения.......................15
       5.7 Сообщения блоков управления...............................16
       5.7.1  Сообщения клавишного блока управления..................16
       5.7.2  Сообщения редактируемого блока управления..............17
       5.7.3  Сообщения панели перечня...............................19
       5.7.4  Сообщения комбинированного блока управления............21
       5.7.5  Сообщения блоков управления рисуемых владельцем........22
       5.8  Уведомляющие сообщения...................................24
       5.8.1  Коды уведомления клавишных блоков управления...........24
       5.8.2  Коды уведомления редактируемого блока управления.......24
       5.8.3  Коды уведомления панели перечня........................25
       5.8.4  Коды уведомления комбинированного блока управления.....25
       5.9  Сообщения строки прокрутки...............................27
       5.10  Сообщения области, не принадлежащей пользователю........28
       5.11  Сообщения интерфейса множества документов...............30
       5.12  Заключение..............................................31
       Глава 6. Список сообщений.....................................32
       BM_SETCHECK...................................................34
       BM_SETSTATE...................................................34
       BM_SETSTYLE...................................................34
       BN_CLICKED....................................................36
       BN_DOUBLECLICKED..............................................37
       CB_ADDSTRING  [3.0]...........................................38
       CB_DELETESTRING  [3.0]........................................38
       CB_DIR  [3.0].................................................39
       CB_FINDSTRING [3.0]...........................................39
       CB_GETCOUNT  [3.0]............................................40
       CB_GETCURSEL [3.0]............................................40
       CB_GETEDITSEL [3.0]...........................................41
       CB_GETITEMDATA [3.0]..........................................41
       CB_GETLBTEXT [3.0]............................................42
       CB_GETTEXTLEN [3.0]...........................................42
       LB_INSERTSTRING...............................................43
       CB_LIMITTEXT  [3.0]...........................................43
       CB_RESETCONTENT [3.0].........................................44
       CB_SELECTSTRING [3.0].........................................44
       CB_SETCURSEL [3.0]............................................45
       CB_SETEDITSEL [3.0]...........................................45
       CB_SETITEMDATA [3.0]..........................................46
       CB_SHOWDROPDOWN [3.0].........................................46
       CBN_DBLCLK [3.0]..............................................46
       CBN_DROPDOWN  [3.0]...........................................47
       CBN_EDITCHANGE [3.0]..........................................47
       CBN_EDITUPDATE [3.0]..........................................48
       CBN_ERRSPACE [3.0]............................................48
       CBN_KILLFOCUS [3.0]...........................................48
       CBN_SELCHANGE [3.0]...........................................49

       Windows 3.0/Ref/5#7                                        = 2 =

       CBN_SETFOCUS [3.0]............................................49
       DM_GETDEFID...................................................50
       DM_SETDEFID...................................................50
       EM_CANUNDO....................................................51
       EM_EMPTYUNDOBUFFER  [3.0].....................................51
       EM_FMTLINES...................................................51
       EM_GETHANDLE..................................................52
       EM_GETLINE....................................................52
       EM_GETLINECOUNT...............................................53
       EM_GETMODIFY..................................................53
       EM_GETRECT....................................................54
       EM_GETSEL.....................................................54
       EM_LIMITTEXT..................................................54
       EM_LINEFROMCHAR...............................................55
       EM_LINEINDEX..................................................55
       EM_LINELENGTH.................................................56
       EM_LINESCROLL.................................................56
       EM_REPLACESEL.................................................57
       EM_SETHANDLE..................................................57
       EM_SETMODIFY..................................................58
       EM_SETPASSWORDCHAR [3.0]......................................58
       EM_SETRECT....................................................58
       EM_SETRECTNP..................................................59
       EM_SETSEL.....................................................59
       EM_SETTABSTOPS [3.0]..........................................60
       EM_SETWORDBREAK...............................................60
       EM_UNDO.......................................................62
       EN_CHANGE.....................................................62
       EN_ERRSPACE...................................................62
       EN_HSCROLL....................................................63
       EN_KILLFOCUS..................................................63
       EN_MAXTEXT [3.0]..............................................64
       EN_SETFOCUS...................................................64
       EN_UPDATE.....................................................64
       EN_VSCROLL....................................................65
       LB_ADDSTRING..................................................66
       LB_DELETESTRING...............................................66
       LB_DIR........................................................67
       LB_FINDSTRING  [3.0]..........................................67
       LB_GETCOUNT...................................................68
       LB_GETCURSEL..................................................68
       LB_GETHORISONTALEXTENT [3.0]..................................69
       LB_GETITEMDATA [3.0]..........................................69
       LB_GETITEMRECT  [3.0].........................................70
       LB_GETSEL.....................................................70
       LB_GETSELCOUNT  [3.0].........................................70
       LB_GETSELITEMS [3.0]..........................................71
       LB_GETTEXT....................................................71
       LB_GETTEXTLEN [3.0]...........................................72
       LB_GETTOPINDEX [3.0]..........................................72
       LB_INSERTSTRING...............................................72
       LB_RESETCONTENT...............................................73
       LB_SELECTSTRING...............................................73

       Windows 3.0/Ref/5#7                                        = 3 =

       LB_SETITEMRANGE [3.0].........................................74
       LB_SETCOLUMNWIDTH  [3.0]......................................75
       LB_SETCURSEL..................................................75
       LB_SETHORISONTALEXTENT [3.0]..................................76
       LB_SETITEMDATA [3.0]..........................................76
       LB_SETSEL.....................................................76
       LB_SETTABSTOPS [3.0]..........................................77
       LB_SETTOPINDEX [3.0]..........................................78
       LBN_DBLCLK [3.0]..............................................78
       LBN_ERRSPACE [3.0]............................................79
       LBN_KILLFOCUS [3.0]...........................................79
       LBN_SELCHANGE.................................................79
       LBN_SETFOCUS [3.0]............................................80
       WM_ACTIVATE...................................................81
       WM_ACTIVATEAPP................................................81
       WM_ASKCBFORMATNAME............................................82
       WM_CANCELMODE.................................................82
       WM_CHANGECBCHAIN..............................................83
       WM_CHAR.......................................................83
       WM_CHARTOITEM [3.0]...........................................85
       WM_CHILDACTIVATE..............................................85
       WM_CLEAR......................................................85
       WM_CLOSE......................................................86
       WM_COMMAND....................................................86
       WM_COMPACTING  [3.0]..........................................87
       WM_COMPAREITEM [3.0]..........................................87
       WM_COPY.......................................................88
       WM_CREATE.....................................................88
       WM_CTLCOLOR...................................................89
       WM_CUT........................................................90
       WM_DEADCHAR...................................................90
       WM_DELETEITEM  [3.0]..........................................92
       WM_DESTROY....................................................92
       WM_DESTROYCLIPBOARD...........................................92
       WM_DEVMODECHANGE..............................................93
       WM_DRAWCLIPBOARD..............................................93
       WM_DRAWITEM  [3.0]............................................93
       WM_ENABLE.....................................................94
       WM_ENDSESSION.................................................94
       WM_ENTERIDLE..................................................95
       WM_ERASEBKGND.................................................96
       WM_FONTCHANGE.................................................96
       WM_GETDLGCODE.................................................97
       WM_GETFONT  [3.0].............................................98
       WM_GETMINMAXINFO..............................................98
       WM_GETTEXT....................................................99
       WM_GETTEXTLENGTH.............................................100
       WM_HSCROLL...................................................100
       WM_HSCROLLCLIPBOARD..........................................101
       WM_ICONERASEBKGND [3.0]......................................103
       WM_INITDIALOG................................................103
       WM_INITMENU..................................................104
       WM_INITMENUPOPUP.............................................104

       Windows 3.0/Ref/5#7                                        = 4 =

       WM_KEYDOWN...................................................105
       WM_KEYUP.....................................................106
       WM_KILLFOCUS.................................................107
       WM_LBUTTONDBLCLK.............................................108
       WM_LBUTTONDOWN...............................................109
       WM_LBUTTONUP.................................................109
       WM_MBUTTONDBLCLK.............................................110
       WM_LBUTTONDOWN...............................................111
       WM_MBUTTONUP.................................................111
       WM_MDIACTIVATE [3.0].........................................112
       WM_MDICASCADE  [3.0].........................................113
       WM_MDICREATE [3.0]...........................................113
       WM_MDIDESTROY [3.0]..........................................114
       WM_MDIGETACTIVE [3.0]........................................114
       WM_MDIICONARRANGE [3.0]......................................115
       WM_MDIMAXIMAZE [3.0].........................................115
       WM_MDINEXT [3.0].............................................115
       WM_MDIRESTORE [3.0]..........................................116
       WM_MDIRESTORE [3.0]..........................................116
       WM_MDITILE [3.0].............................................117
       WM_MEASUREITEM [3.0].........................................117
       WM_MENUCHAR..................................................118
       WM_MENUSELECT................................................118
       WM_MOUSEACTIVATE.............................................119
       WM_MOUSEMOVE.................................................120
       WM_MOVE......................................................121
       WM_NCACTIVATE................................................121
       WM_NCCALCSIZE................................................122
       WM_NCCREATE..................................................122
       WM_NCDESTROY.................................................123
       WM_NCHITTEST.................................................123
       WM_NCLBUTTONDBLCLK...........................................125
       WM_NCLBUTTONDOWN.............................................125
       WM_NCLBUTTONUP...............................................126
       WM_NCMBUTTONDBLCLK...........................................126
       WM_NCMBUTTONDOWN.............................................126
       WM_NCMBUTTONUP...............................................127
       WM_NCMOUSEMOVE...............................................127
       WM_NCPAINT...................................................128
       WM_NCRBUTTONDBLCLK...........................................128
       WM_NCRBUTTONDOWN.............................................128
       WM_NCRBUTTONUP...............................................129
       WM_NEXTDLGCTL................................................129
       WM_PAINT.....................................................130
       WM_PAINTCLIPBOARD............................................130
       WM_PAINTICON [3.0]...........................................131
       WM_PALETTECHANGED [3.0]......................................131
       WM_PARENTNOTIFY [3.0]........................................132
       WM_PASTE.....................................................133
       WM_QUERYDRAGICON [3.0].......................................133
       WM_QUERYENDSESSION...........................................133
       WM_QUERYNEWPALETTE [3.0].....................................134
       WM_QUERYOPEN.................................................134

       Windows 3.0/Ref/5#7                                        = 5 =

       WM_QUIT......................................................135
       WM_RBUTTONDBLCLK.............................................135
       WM_RBUTTONDOWN...............................................136
       WM_RBUTTONUP.................................................137
       WM_RENDERALLFORMATS..........................................137
       WM_RENDERFORMAT..............................................138
       WM_SETCURSOR.................................................138
       WM_SETFOCUS..................................................139
       WM_SETFONT [3.0].............................................139
       WM_SETREDRAW.................................................140
       WM_SETTEXT...................................................141
       WM_SHOWWINDOW................................................141
       WM_SIZE......................................................142
       WM_SIZECLIPBOARD.............................................143
       WM_SPOOLERSTATUS [3.0].......................................144
       WM_SYSCHAR...................................................144
       WM_SYSCOMMAND................................................145
       WM_SYSDEADCHAR...............................................147
       WM_SYSKEYDOWN................................................147
       WM_KEYUP.....................................................149
       WM_TIMECHANGE................................................151
       WM_TIMER.....................................................151
       WM_UNDO......................................................152
       WM_VKEYTOITEM................................................152
       WM_VSCROLL...................................................152
       WM_VSCROLLCLIPBOARD..........................................154
       WM_WININICHANGE..............................................155

       Windows 3.0/Ref/5#7                                        = 6 =

                                       Глава 5.  Обзор сообщений.              
       ----------------------------------------------------------------

             В данной   главе   описаны   группы   связанных  сообщений
        Microsoft Windows.  Каждый раздел содержит  список  и  описание
        одной группы   сообщений.   Некоторые   из   разделов  содержат
        дополнительную информацию.  Описание процесса посылки и  приема
        сообщений вы найдете в главе 1, "Функции интерфейса графических
        устройств.

             В данной главе описаны следующие группы сообщений:

             1. Сообщения управления окнами.

             2. Сообщения инициализации.

             3. Сообщения ввода.

             4. Системные сообщения.

             5. Сообщения системного буфера.

             6. Системные информационные сообщения.

             7. Сообщения блоков управления.

             8. Уведомляющие сообщения.

             9. Сообщения строки прокрутки.

             10. Сообщения области не принадлежащей пользователю.

             11. Сообщения интерфейса множества документов.



       Windows 3.0/Ref/5#7                                        = 7 =

                                  5.1  Сообщения управления окнами.            

             В этом подразделе  описываются  сообщения,  которые  среда
        Windows посылает  прикладной  программе при изменении состояния
        окна. Ниже приведен их список с кратким описанием:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        WM_ACTIVATE       Это сообщение    посылается,    когда    окно
                          становится активным или неактивным.

        WM_ACTIVATEAPP    Это сообщение посылается в том случае,  когда
                          активизируемое окно,  в отличие  от  текущего
                          активного,   принадлежит   другой  прикладной
                          программе.

        WM_CANCELMOD      Сообщение отменяет   любой   из   режимов,  в
                          котором находится прикладная программа, такой
                          как отслеживание  мыши в строке прокрутки или
                          перемещение  окна.  Среда  Windows   посылает
                          сообщение   WM_CANCELMODE,  когда  прикладная
                          программа отображает панель сообщений.

        WM_CHILDACTIVATE  Это сообщение посылается родительскому  окну,
                          когда  функция  SetWindowPos  перемещает  его
                          дочернее окно.

        WM_CLOSE          Это сообщение выдается при закрытии окна.

        WM_CREATE         Это сообщение посылается при вызове функции
                          CreateWindow.

        WM_CTLCOLOR       Это сообщение посылается  родительскому  окну
                          встроенного   блока   управления  или  панели
                          сообщения при их отображении.

        WM_DESTROY        Посылается при вызове функции DestroyWindow,
                          после удаления окна с экрана.

        WM_ENABLE         Это сообщение посылается после того, как окно
                          было сделано доступным или недоступным.

        WM_ENDSESSION     Это сообщение  посылается  для  того,   чтобы
                          сообщить   прикладной   программе,   что   на
                          сообщение  WM_QUERYENDSESSION   был   получен
                          ненулевой ответ.

        WM_ENTERIDLE      Информирует окно, что отображенная панель
                          диалога или  меню ожидает действий  от
                          пользователя.

        WM_ERASEBKGND     Это сообщение  посылается,  когда  необходимо
                          стереть фон окна.

       Windows 3.0/Ref/5#7                                        = 8 =


        WM_GETDLGCODE     Посылается процедуре ввода, связанной с блоком
                          управления.

        WM_GETMINMAXINFO  Это сообщение посылается окну,  когда Windows
                          необходимо  знать  максимальный  размер окна,
                          максимальный или минимальный  размер  контура
                          окна.

        WM_GETTEXT        Это сообщение  используется  для  копирования
                          текста соответствующего окна.

        WM_GETTEXTLENGTH  Это сообщение   используется  для  нахождения
                          длины текста (в байтах), связанного с окном.

        WM_ICONERASEBKGND Это сообщение посылается окну в виде иконы с
                          классом иконы,  когда необходимо очистить фон
                          иконы.

        WM_KILLFOCUS      Это сообщение   посылается    непосредственно
                          перед тем, как окно теряет захват ввода.

        WM_MENUCHAR       Это сообщение посылается,  когда пользователь
                          нажимает на клавишу символа ускорителя  меню,
                          не     соответствующего    ни    одному    из
                          предопределенных ускорителей в текущем  меню.
                          Оно посылается в окно, владеющее меню.

        WM_MENUSELECT     Это сообщение  уведомляет  окно  о  том,  что
                          пользователь выбирает элемент меню.

        WM_MOVE           Это сообщение   посылается   при  перемещении
                          окна.

        WM_PAINT          Это сообщение  выдается  каждый  раз,   когда
                          среда Windows или прикладная программа делает
                          запрос  на  перерисовку части окна прикладной
                          программы.

        WM_PAINTICON      Это сообщение  выдается  каждый  раз,   когда
                          среда Windows или прикладная программа делает
                          запрос на перерисовку части минимизированного
                          окна (окна в виде иконы).

        WM_PARENTNOTIFY   Это сообщение посылается  родительскому  окну
                          дочерним, при    создании    или   разрушении
                          дочернего окна.

        WM_QUERYDRAGICON  Это сообщение посылается  когда  пользователь
                          тащит минимизированное   окно  (окно  в  виде
                          иконы).

        WM_QUERYENDSESSION Это  сообщение выдается,  когда пользователь

       Windows 3.0/Ref/5#7                                        = 9 =

                          вызывает команду "Конец сеанса работы".

        WM_QUERYNEWPALETTE Это сообщение посылается когда окно получает
                          захват ввода, чтобы позволить ему реализовать
                          его логическую палитру.

        WM_QUERYOPEN      Это сообщение   посылается    иконе,    когда
                          пользователь требует преобразовать ее в окно.

        WM_QUIT           Это сообщение    является    требованием   на
                          окончание работы прикладной программы.

        WM_SETFOCUS       Это сообщение посылается после того, как окно
                          захватит ввод.

        WM_SETFONT        Изменяет шрифт, используемый блоком управления
                          для вывода текста.

        WM_SETREDRAW      Это сообщение      посылается      прикладной
                          программой окну для того, чтобы позволить или
                          запретить  перерисовку  окна,  которое   было
                          изменено.

        WM_SETTEXT        Это сообщение  используется  для того,  чтобы
                          установить текст окна.

        WM_SHOWWINDOW     Это сообщение посылается  каждый  раз,  когда
                          окно   должно   быть  сделано  невидимым  или
                          видимым.

        WM_SIZE           Это сообщение выдается после того,  как  были
                          изменены размеры окна.



       Windows 3.0/Ref/5#7                                       = 10 =

                                                                               
                                 5.2  Сообщения инициализации.

             В этом  подразделе описываются сообщения окон,  посылаемые
        средой Windows,  в том случае, когда впервые создаются меню или
        панель диалога. Ниже приведен их список с кратким описанием:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        WM_INITDIALOG     Это сообщение    посылается   непосредственно
                          перед тем, как панель диалога отображается на
                          экране.

        WM_INITMENU       Это сообщение     является     запросом    на
                          инициализацию меню.

        WM_INITMENUPOPUP  Это сообщение   посылается    непосредственно
                          перед  тем,  как  индицируется  накладываемое
                          меню.



       Windows 3.0/Ref/5#7                                       = 11 =

                                          5.3  Сообщения о вводе.              

             Сообщения данного подраздела посылаются,  когда прикладная
        программа получает вводимые данные от мыши,  клавиатуры,  строк
        прокрутки или системного таймера.  Ниже приведен  их  список  с
        кратким описанием:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        WM_CHAR           Это сообщение является результатом трансляции
                          сообщений WM_KEYUP и WM_KEYDOWN.

        WM_CHARTOITEM     Это сообщение посылается панелью перечня типа
                          LBS_WANTKEYBOARDINPUT владельцу  в  ответ  на
                          сообщение WM_CHAR.

        WM_COMMAND        Это сообщение  выдается,  когда  пользователь
                          выбирает элемент меню,  когда блок управления
                          передает сообщение его родительскому окну или
                          когда транслируется клавиша ускорения.

        WM_DEADCHAR       Это сообщение является результатом трансляции
                          сообщений WM_KEYUP и WM_KEYDOWN.

        WM_HSCROLL        Это сообщение посылается,  когда пользователь
                          нажимает на  кнопку  мыши  на  горизонтальной
                          строке прокрутки.

        WM_KEYDOWN        Это сообщение  посылается,  когда  нажимается
                          несистемная клавиша.

        WM_KEYUP          Это сообщение посылается, когда освобождается
                          несистемная клавиша.

        WM_LBUTTONDBLCLK  Это сообщение  выдается,  когда  пользователь
                          нажимает два раза левую кнопку мыши.

        WM_LBUTTONDOWN    Это сообщение  выдается,  когда  пользователь
                          нажимает левую кнопку мыши.

        WM_LBUTTONUP      Это сообщение  выдается,  когда  пользователь
                          освобождает левую кнопку мыши.

        WM_MBUTTONDBLCLK  Это сообщение  выдается,  когда  пользователь
                          нажимает два раза среднюю кнопку мыши.

        WM_MBUTTONDOWN    Это сообщение  выдается,  когда  пользователь
                          нажимает среднюю кнопку мыши.

        WM_MBUTTONUP      Это сообщение  выдается,  когда  пользователь
                          освобождает среднюю кнопку мыши.

        WM_MOUSEACTIVATE  Это сообщение   появляется,   когда    курсор

       Windows 3.0/Ref/5#7                                       = 12 =

                          находится в неактивном окне, и нажата клавиша
                          мыши.

        WM_MOUSEMOVE      Это сообщение  выдается,  когда  пользователь
                          перемещает мышь.

        WM_RBUTTONDBLCLK  Это сообщение  выдается,  когда  пользователь
                          нажимает два раза правую кнопку мыши.

        WM_RBUTTONDOWN    Это сообщение  выдается,  когда  пользователь
                          нажимает правую кнопку мыши.

        WM_RBUTTONUP      Это сообщение  выдается,  когда  пользователь
                          освобождает правую кнопку мыши.

        WM_SETCURSOR      Это сообщение посылается,  если  не  ввод  от
                          мыши    не   захвачен,   и   системная   мышь
                          осуществляет перемещение курсора внутри окна.

        WM_TIMER          Это сообщение  выдается,  когда   достигается
                          событие, установленное для данного таймера.

        WM_VKEYTOITEM     Это сообщение посылается панелью перечня типа
                          LBS_WANTKEYBOARDINPUT владельцу  в  ответ  на
                          сообщение WM_CHAR.

        WM_VSCROLL        Это сообщение  выдается,  когда  пользователь
                          нажимает   кнопку   мыши    для    управления
                          вертикальной строкой прокрутки.



       Windows 3.0/Ref/5#7                                       = 13 =

                                        5.4. Системные сообщения               

             В этом  подразделе  описываются  сообщения,  которые среда
        Windows  посылает  прикладной  программе,  когда   пользователь
        осуществляет  доступ  к системному меню,  строкам прокрутки или
        панели размера.  Хотя прикладная программа может обработать эти
        сообщения,   если  пожелает,  большинство  прикладных  программ
        передает их функции DefWindowProc для обработки  по  умолчанию.
        Ниже приведен их список с кратким описанием:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        WM_SYSCHAR        Это сообщение является результатом трансляции
                          сообщений WM_SYSKEYUP или WM_SYSKEYDOWN.

        WM_SYSCOMMAND     Это сообщение  выдается,  когда  пользователь
                          выбирает команду из системного меню.

        WM_SYSDEADCHAR    Это сообщение является результатом трансляции
                          сообщений WM_SYSKEYUP или WM_SYSKEYDOWN.

        WM_SYSKEYDOWN     Это сообщение  выдается,  когда  пользователь
                          при   нажатой  клавише  Alt  нажимает  другую
                          клавишу.

        WM_SYSKEYUP       Это сообщение  выдается,  когда  пользователь
                          освобождает клавишу,  которая была нажата при
                          нажатой клавише Alt.




       Windows 3.0/Ref/5#7                                       = 14 =

                                  5.5  Сообщения системного буфера             

             В этом  подразделе  описываются  сообщения,  которые может
        получить прикладная программа от  других  прикладных  программ,
        получая доступ  к  системному буферу Windows.  Ниже приведен их
        список с кратким описанием:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        WM_ASKCBFORMATNAME Это сообщение посылается,  когда   системный
                          буфер  содержит дескриптор данных для формата
                          CF_OWNERDISPLAY.

        WM_CHANGECBCHAIN  Это сообщение  уведомляет  окна   в   цепочке
                          наблюдения  за  системным буфером о том,  что
                          цепочка изменилась.

        WM_DESTROYCLIPBOARD Это сообщение посылается владельцу
                          системного буфера,  когда  буфер  очищается с
                          помощью функции EmptyClipboard.

        WM_DRAWCLIPBOARD  Это сообщение  используется  для  уведомления
                          прикладной программы, что она должна сообщить
                          следующей программе в цепочке  наблюдения  за
                          системным  буфером  об  изменении  системного
                          буфера.

        WM_HSCROLLCLIPBOARD Это сообщение посылается, когда необходимо
                          осуществить прокрутку       для       формата
                          CF_OWNERDISPLAY.

        WM_PAINTCLIPBOARD  Это сообщение информирует, что необходимо
                          нарисовать информацию имеющую тип
                          CF_OWNERDISPLAY.

        WM_RENDERALLFORMATS  Это сообщение посылается прикладной
                          программе -   владельцу   системного  буфера,
                          и говорит о том, что необходимо преобразовать
                          данные системного  буфера  во  все  возможные
                          форматы.

        WM_RENDERFORMAT   Это сообщение  является  запросом   владельцу
                          системного буфера на форматирование последних
                          данных, скопированных в системный буфер.

        WM_SIZECLIPBOARD  Это сообщение посылается владельцу системного
                          буфера о  том,  что  был  изменен размер окна
                          программы системного буфера.

        WM_VSCROLLCLIPBOARD Это сообщение посылается, когда необходимо
                          осуществить прокрутку формата CF_OWNERDISPLAY.



       Windows 3.0/Ref/5#7                                       = 15 =

                            5.6  Системные информационные сообщения.           

             Сообщения, описываемые  в  данном подразделе,  посылаются,
        когда прикладная программа  или  пользователь  делают  обширные
        системные изменения,  которые  могут  воздействовать  на другие
        прикладные  программы.  Ниже  приведен  их  список  с   кратким
        описанием:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        WM_COMPACTING     Это сообщение посылается всем окнам высокого
                          уровня, когда среде Windows требуется слишком
                          много системного  времени для переорганизации
                          памяти, что говорит  о  недостатке  системной
                          памяти.

        WM_DEVMODECHANGE  Это сообщение  посылается всем окнам верхнего
                          уровня   всякий   раз,   когда   пользователь
                          изменяет установки режима устройства.

        WM_FONTCHANGE     Это сообщение выдается,  когда изменяется пул
                          ресурсов шрифта.

        WM_PALETTECHANGED Это  сообщение   уведомляет   все   окна   об
                          изменении системной палитры.

        WM_SPOOLERSTATUS  Это сообщение посылается Print Manager, когда
                          в очередь   добавляется   или   из    очереди
                          удаляется задание.

        WM_SYSCOLORCHANGE Это сообщение  посылается всем окнам верхнего
                          уровня,  когда делаются изменения в установке
                          системных цветов.

        WM_TIMECHANGE     Это сообщение   выдается,   когда  прикладная
                          программа   вносит   изменение    (или    ряд
                          изменений) в системное время.

        WM_WININICHANGE   Это сообщение выдается, когда изменяется файл
                          инициализации Windows (WIN.INI).



       Windows 3.0/Ref/5#7                                       = 16 =

                                  5.7 Сообщения блоков управления.             

             Сообщения блока    управления     являются     встроенными
        сообщениями,   которые  воздействуют  на  блок  управления  для
        выполнения специфицированной   задачи.   Прикладные   программы
        посылают   сообщения   блоку   управления,   используя  функцию
        SendMessage. Блок управления выполняет специфицированную задачу
        и возвращает значение, указывающее результат.

             Следующие сообщения применяются ко всем блокам управления:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        WM_NEXTDLGCTL     Это сообщение посылается функции управления
                          панелью диалога для изменения захвата ввода.

        WM_GETFONT        Возвращает текущий шрифт, используемый блоком
                          управления для вывода текста.

        WM_SETFONT        Изменяет шрифт, используемый блоком управления
                          для вывода текста.

             В разделах c 5.7.1  по  5.7.5  коротко  описаны  сообщения
        блоков управления для каждого класса.
                         5.7.1  Сообщения клавишного блока управления.         

             В этом  пункте  описываются сообщения,  которые прикладная
        программа может  посылать  клавишному  блоку  управления.  Ниже
        приведен их список с кратким описанием:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        BM_GETCHECK       Это сообщение определяет,  выбрана ли клавиша
                          установки или панель контроля.

        BM_GETSTATE       Возаращает ненулевое   значение  если,  когда
                          пользователь нажимает кнопку мыши или клавишу
                          пробела, курсор находится на клавише.

        BM_SETCHECK       Это сообщение  помечает (или снимает отметку)
                          с клавиши установки или панели контроля.

        BM_SETSTATE       Это сообщение подсвечивает мягкую клавишу или
                          панель контроля.

        BM_SETSTYLE       Это сообщение изменяет типы мягких клавиш.

        DM_GETDEFID       Эта сообщение возвращает ID блока  управления
                          альтернативной   клавиши   по  умолчанию  для
                          панели диалога.

        DM_SETDEFID       Это сообщение     используется     прикладной

       Windows 3.0/Ref/5#7                                       = 17 =

                          программой  для изменения ID блока управления
                          альтернативной клавишей  по   умолчанию   для
                          панели диалога.
                      5.7.2  Сообщения редактируемого блока управления.        

             В этом  пункте  описываются сообщения,  которые прикладная
        программа  может  посылать  редактируемому  блоку   управления.
        Дополнительно  к сообщениям,  описанным ниже,  могут также быть
        использованы    сообщения    окон    WM_ENABLE,     WM_GETTEXT,
        WM_GETTEXTLENGHT,  WM_KILLFOCUS,  WM_SETFOCUS,  WM_SETREDRAW  и
        WM_SETTEXT. Ниже приведен их список с кратким описанием:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        EM_CANUNDO        Это сообщение    определяет,     может     ли
                          редактируемый   блок   управления   правильно
                          отреагировать на сообщение EM_UNDO.

        EM_EMPTYUNDOBUFFER  Отключает возможность редактируемого блока
                          управления восстановить    состояние    после
                          последнего изменения.

        EM_FMTLINES       Это сообщение заставляет  редактируемый  блок
                          управления  добавлять  (или  удалять)  символ
                          конца строки к (из) автоматически переносимым
                          текстовым строкам.

        EM_GETHANDLE      Это сообщение  возвращает  дескриптор  данных
                          буфера,    используемого     для     хранения
                          содержимого окна блока управления.

        EM_GETLINE        Это сообщение      копирует     строку     из
                          редактируемого блока управления.

        EM_GETLINECOUNT   Это сообщение возвращает число строк текста в
                          редактирумом блоке управления.

        EM_GETMODIFY      Это сообщение   возвращает  текущее  значение
                          флага модификации для данного  редактируемого
                          блока управления.  Этот флаг устанавливается,
                          если  пользователь  ввел  или   модифицировал
                          текст внутри блока управления.

        EM_GETRECT        Это сообщение     возвращает    форматирующий
                          прямоугольник блока управления.

        EM_GETSEL         Это сообщение возвращает начальную и конечную
                          знаковые позиции текущей выборки.

        EM_LIMITTEXT      Это сообщение  ограничивает  длину (в байтах)
                          текста, который может вводить пользователь.


       Windows 3.0/Ref/5#7                                       = 18 =

        EM_LINEFROMCHAR   Это сообщение   возвращает   номер    строки,
                          содержащей     символ,    позиция    которого
                          (отсчитываемая  с  начала   текста)   указана
                          посредством параметра wParam.

        EM_LINEINDEX      Это сообщение   возвращает   число   знаковых
                          позиций, которые предшествуют первому символу
                          данной строки.

        EM_LINELENGTH     Это сообщение   возвращает  длину  строки  (в
                          байтах)  в  текстовом  буфере  редактируемого
                          блока управления.

        EM_LINESCROLL     Это сообщение  прокручивает  содержимое блока
                          управления на заданное число строк.

        EM_REPLACESEL     Это сообщение заменяет текущую выборку  новым
                          текстом.

        EM_SETHANDLE      Это сообщение   создает   текстовый    буфер,
                          используемый  для  хранения  содержимого окна
                          блока управления.

        EM_SETMODIFY      Это сообщение  устанавливает флаг модификации
                          для данного редактируемого блока управления.

        EM_SETPASSWORDCHAR  Изменяет символы пароля для редактируемого
                          блока управления с типом ES_PASSWORD.

        EM_SETRECT        Это сообщение   устанавливает   прямоугольник
                          формирования для блока управления.

        EM_SETRECTNP      Это сообщение аналогично сообщению EM_SETRECT
                          за  исключением того,  что блок управления не
                          перерисовывается.

        EM_SETSEL         Это сообщение выбирает все символы в  текущем
                          тексте,  которые  находятся внутри диапазона,
                          отмеченного  начальной  и  конечной  знаковой
                          позициями, заданными параметром lParam.

        EM_SETTABSTOPS    Это сообщение устанавливает позиции табуляции
                          в многострочном      редактируемом      блоке
                          управления.

        EM_SETWORDBREAK   Это сообщение   посылается   в  многострочный
                          редактируемый блок управления, информируя его
                          о  том,  что Windows заменил функцию переноса
                          по умолчанию собственной функцией  прикладной
                          программы.

        EM_UNDO           Это сообщение        отменяет       последнее
                          редактирование блока управления.

       Windows 3.0/Ref/5#7                                       = 19 =


        WM_CLEAR          Это сообщение удаляет текущую выборку.

        WM_COPY           Это сообщение  посылает   системному   буферу
                          текущую выборку в формате CF_TEXT.

        WM_CUT            Это сообщение   посылает   системному  буферу
                          текущую выборку в формате  CF_TEXT,  а  затем
                          удаляет выборку из окна блока управления.

        WM_PASTE          Это сообщение  вставляет данные из системного
                          буфера в окно  блока  управления,  начиная  с
                          текущей позиции курсора.

        WM_UNDO           Это сообщение отменяет предыдущее действие.
                                  5.7.3  Сообщения панели перечня.             

             Эти сообщения   посылаются  прикладной  программой  панели
        перечня. Ниже приведен их список с кратким описанием:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        LB_ADDSTRING      Это сообщение  добавляет  строку   в   панель
                          перечня.

        LB_DELETESTRING   Это сообщение   удаляет   строку   из  панели
                          перечня.

        LB_DIR            Это сообщение добавляет  перечень  файлов  из
                          текущего каталога к панели перечня.

        LB_FINDSTRING     Это сообщение ищет первую совпадающую с данной
                          строку в панели перечня.

        LB_GETCOUNT       Это сообщение возвращает  число  элементов  в
                          панели перечня.

        LB_GETCURSEL      Это сообщение   возвращает   индекс  текущего
                          выбранного элемента, если он существует.

        LB_GETHORISONTALEXTENT  Это сообщение получает ширину, на
                          которую панель  перечня может быть прокручена
                          по горизонтали.

        LB_GETITEMDATA    Это сообщение получает 32-битовое значение,
                          связанное с   элементов   в  панели  перечня,
                          рисуемой владельцем.

        LB_GETITEMRECT    Это сообщение      возвращает      координаты
                          прямоугольника, который ограничивает  элемент
                          панели перечня.


       Windows 3.0/Ref/5#7                                       = 20 =

        LB_GETSEL         Это сообщение  возвращает  состояние  выборки
                          элемента.

        LB_GETSELCOUNT    Это сообщение    возвращает    общее    число
                          выбранных   элементов  в  панели  перечня  со
                          множественной выборкой.

        LB_GETSELITEMS    Это сообщение  возвращает  индексы  выбранных
                          элементов  в  панели перечня со множественной
                          выборкой.

        LB_GETTEXT        Это сообщение  копирует  строку  из перечня в
                          буфер.

        LB_GETTEXTLEN     Это сообщение  возвращает  длину   строки   в
                          панели перечня.

        LB_GETTOPINDEX    Возвращает индекс первого видимого элемента в
                          панели перечня.

        LB_INSERTSTRING   Это сообщение  вставляет  строку   в   панель
                          перечня.

        LB_RESETCONTENT   Это сообщение  удаляет  все  строки из панели
                          перечня   и   освобождает    любую    память,
                          выделенную для этих строк.

        LB_SELECTSTRING   Это сообщение  заменяет  текущую  выборку  на
                          первую строку, имеющую указанный префикс.

        LB_SELITEMRANGE   Выбирает одну или несколько последовательных
                          элементов в панели перечня.

        LB_SETCURSEL      Это сообщение  выбирает строку и прокручивает
                          ее для просмотра, если это необходимо.

        LB_SETHORISONTALEXTENT  Это сообщение устанавливает ширину, на
                          которую панель  перечня может быть прокручена
                          по горизонтали.

        LB_SETITEMDATA    Это сообщение   устанавливает   32-битовое
                          значение, которое   должно  быть  связанно  с
                          элементом в    панели    перечня,    рисуемой
                          владельцем.

        LB_SETSEL         Это сообщение  определяет  состояние  выборки
                          элемента в панели перечня.

        LB_SETTABSTOPS    Это сообщение определяет позиции табуляции
                          для панели перечня.

        LB_GETTOPINDEX    Это сообщение  устанавливает  индекс  первого
                          видимого элемента в панели перечня.

       Windows 3.0/Ref/5#7                                       = 21 =


                    5.7.4  Сообщения комбинированного блока управления.        

             Эти сообщения     посылаются     прикладной     программой
        комбинированному блоку управления.  Ниже приведен их  список  с
        кратким описанием:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        CB_ADDSTRING      Это сообщение  добавляет  строку   в   панель
                          перечня комбинированного блока управления.

        CB_DELETESTRING   Это сообщение   удаляет   строку   из  панели
                          перечня комбинированного блока управления.

        CB_DIR            Это сообщение добавляет  перечень  файлов  из
                          текущего каталога  к  комбинированному  блоку
                          управления.

        CB_FINDSTRING     Это сообщение ищет первую совпадающую с данной
                          строку в  панели   перечня   комбинированного
                          блока управления.

        CB_GETCOUNT       Это сообщение возвращает  число  элементов  в
                          панели перечня     комбинированного     блока
                          управления.

        CB_GETCURSEL      Это сообщение   возвращает   индекс  текущего
                          выбранного элемента, если он существует.

        CB_GETEDITSEL     Это сообщение возвращает начальную и конечную
                          позицию выборки     в     текстовом     блоке
                          комбинированного блока управления.

        CB_SETITEMDATA    Это сообщение   устанавливает   32-битовое
                          значение, которое   должно  быть  связанно  с
                          элементом в комбинированном блоке управления,
                          рисуемом владельцем.

        CB_GETLBTEXT
                          Это сообщение  копирует  строку   из   панели
                          перечня комбинированного  блока  управления в
                          буфер.

        CB_GETLBTEXTLEN   Это сообщение  возвращает  длину   строки   в
                          панели перечня     комбинированного     блока
                          управления.

        CB_INSERTSTRING   Это сообщение  вставляет  строку   в   панель
                          перечня комбинированного блока управления.

        CB_LIMITTEXT      Ограничивает длину      текста,       который

       Windows 3.0/Ref/5#7                                       = 22 =

                          пользователь может   вводит  в  редактируемый
                          блок комбинированного блока управления.

        CB_RESETCONTENT   Это сообщение   удаляет   все    строки    из
                          комбинированного блока      управления      и
                          освобождает любую память, выделенную для этих
                          строк.

        CB_SELECTSTRING   Это сообщение  заменяет  текущую  выборку  на
                          первую строку,   имеющую  указанный  префикс.
                          Текст редактируемого  блока  изменяется   для
                          отражения данного изменения.

        CB_SETCURSEL      Это сообщение  выбирает строку и прокручивает
                          ее для просмотра, если это необходимо.

        CB_GETEDITSEL     Это сообщение   устанавливает   начальную   и
                          конечную позицию выборки  в  текстовом  блоке
                          комбинированного блока управления.

        CB_SETITEMDATA    Это сообщение   устанавливает   32-битовое
                          значение, которое   должно  быть  связанно  с
                          элементом в комбинированном блоке  управления
                          рисуемым владельцем.

        CB_SHOWDROPDOWN   Это сообщение   показывает    или    скрывает
                          выпадающую панель   перечня  комбинированного
                          блока управления.



       Windows 3.0/Ref/5#7                                       = 23 =

                 5.7.5  Сообщения блоков управления рисуемых владельцем.       

             Эти сообщения  уведомляют  владельца   блока   управления,
        созданного с  типом  OWNERDRAW,  что блок управления необходимо
        нарисовать или необходимо передать  информацию,  требуемую  для
        вывода. Ниже приведен их список с кратким описанием:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        WM_COMPAREITEM    Это сообщение  определяет,  какой   из   двух
                          элементов больше   другого   в   сортируемом,
                          рисуемом владельцем комбинированном блоке или
                          панели перечня.

        WM_DELETEITEM     Сообщает, что    данный    элемент   рисуемой
                          владельцем панели         перечня         или
                          комбинированного блока был удален.

        WM_DRAWITEM       Сообщает, что   данный  элемент  должен  быть
                          перерисован.

        WM_MEASHUREITEM   Требует размеры рисуемой пользователем панели
                          перечня, комбинированного   блока  управления
                          или элемента меню.



       Windows 3.0/Ref/5#7                                       = 24 =

                                                                               
                        5.8  Уведомляющие сообщения.

             Уведомляющие сообщения    информируют    владельца   блока
        управления об  изменениях,  произошедших  в  блоке  управления.
        Разделы с 5.8.1 по 5.8.4 содержат краткое описание уведомляющих
        сообщений для каждого класса блоков управления.

             Клавишные и  редактируемые  блоки  управления   используют
        сообщение  WM_COMMAND  для  уведомления  родительского  окна  о
        действиях,  которые  произошли  в  блоке  управления.  Параметр
        wParam  сообщения  WM_COMMAND  содержит  ID  блока  управления,
        младшее слово lParam содержит  дескриптор  окна  редактируемого
        блока   управления,   а   старшее  слово  lParam  содержит  код
        уведомления блока управления.
                                                                               
            5.8.1  Коды уведомления клавишных блоков управления.

             Приведенные ниже коды уведомления  относятся  к  клавишным
        блокам управления:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        BN_CLICKED        Этот код показывает,  что пользователь  нажал
                          клавишу.

        BN_DOUBLECLICKED  Этот код  означает,  что  пользователь дважды
                          нажал клавишу установки или клавишу, рисуемую
                          владельцем.
                5.8.2  Коды уведомления редактируемого блока управления.       

             Приведенные ниже    коды    уведомления    относятся     к
        редактируемым блокам управления:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        EN_CHANGE         Этот код     сообщает,    что    пользователь
                          предпринял   некоторые   действия,   которые,
                          возможно, изменили содержимое текста.

        EN_ERRSPACE       Этот код указывает,  что редактируемому блоку
                          управления не хватает места.

        EN_HSCROLL        Этот код указывает, что пользователь нажал на
                          кнопку мыши, находясь в горизонтальной строке
                          прокрутки редактируемого блока управления.

        EN_KILLFOCUS      Этот код  сообщает,  что  редактируемый  блок
                          управления утратил захват ввода.

        EN_MAXTEXT        Этот код сообщает,  что при  текущей  вставке
                          превышено максимально     допустимое    число
                          символов в редактируемом блоке управления.

       Windows 3.0/Ref/5#7                                       = 25 =


        EN_SETFOCUS       Этот код  показывает,  что редактируемый блок
                          управления получил захват ввода.

        EN_UPDATE         Этот код показывает,  что редактируемый  блок
                          управления   будет   индицировать  измененный
                          текст.

        EN_VSCROLL        Этот код  специфицирует,   что   пользователь
                          нажал на кнопку мыши, находясь в вертикальной
                          строке   прокрутки    редактируемого    блока
                          управления.

                                                                               
                   5.8.3  Коды уведомления панели перечня.

             Приведенные ниже  коды  уведомления  применимы  только   к
        панелям перечня, имеющих тип LBS_NOTIFY:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        LBN_DBLCLK        Этот код  сообщает,  что  пользователь дважды
                          нажал кнопку мыши, находясь на строке.

        LBN_ERRSPACE      Этот код  сообщает,  что  панели  перечня  не
                          хватает памяти.

        LBN_KILLFOCUS     Этот код   сообщает,   что   панель   перечня
                          потеряла захват ввода.

        LBN_SELCHANGE     Этот код сообщает об изменении выборки.

        LBN_SETFOCUS      Этот код   сообщает,   что   панель   перечня
                          получила захват ввода.
               5.8.4  Коды уведомления комбинированного блока управления.      

             Ниже приведены    коды    уведомления,    применяемые    к
        комбинированным блокам управления.

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        CBN_DBLCLK        Этот код посылается когда пользователь дважды
                          нажмет кнопку мыши находясь на строке.

        CBN_DROPDOWN      Информирует владельца комбинированного блока,
                          что панель перечня показана.

        CBN_EDITCHANGE    Этот код     сообщает,    что    пользователь
                          изменил текст    в    редактируемом     блоке
                          управления.

        CBN_EDITUPDATE    Этот код показывает,  что редактируемый  блок

       Windows 3.0/Ref/5#7                                       = 26 =

                          управления   будет   индицировать  измененный
                          текст.

        LBN_ERRSPACE      Этот код  сообщает,  что  не хватает памяти.

        LBN_KILLFOCUS     Этот код  сообщает,  что комбинированный блок
                          управления потерял захват ввода.

        LBN_SELCHANGE     Этот код сообщает об изменении выборки.

        LBN_SETFOCUS      Этот код сообщает,  что комбинированный  блок
                          управления получил захват ввода.




       Windows 3.0/Ref/5#7                                       = 27 =

                                                                               
                      5.9  Сообщения строки прокрутки.

             Блоки управления   строкой  прокрутки  посылают  сообщения
        WM_VSCROLL и  WM_HSCROLL  своим  родителям  каждый  раз,  когда
        пользователь   нажимает   кнопку  на  мыши,  находясь  в  блоке
        управления.  Параметр wParam содержит те же  значения,  которые
        определены для сообщений прокрутки в стандартном окне.  Старшее
        слово lParam содержит дескриптор окна блока управления  строкой
        прокрутки.



       Windows 3.0/Ref/5#7                                       = 28 =

                 5.10  Сообщения области, не принадлежащей пользователю.       

             В этом  подразделе  описываются  сообщения,  которые среда
        Windows посылает для создания и обслуживания области  окна,  не
        принадлежащей пользователю.   Обычно  прикладные  программы  не
        обрабатывают эти сообщения, а посылают их функции DefWindowProc
        для обработки.

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        WM_NCACTIVATE     Это сообщение    посылается    окну,    когда
                          необходимо    изменить    не    принадлежащую
                          пользователю  область для индикации активного
                          или неактивного состояния.

        WM_NCCALCSIZE     Это сообщение  посылается,  когда  необходимо
                          вычислить размер области пользователя окна.

        WM_NCCREATE       Это сообщение   посылается  перед  сообщением
                          WM_CREATE, когда окно создается впервые.

        WM_NCDESTROY      Это сообщение посылается окну после сообщения
                          WM_DESTROY.

        WM_NCHITTEST      Это сообщение  посылается  окну,  содержащему
                          курсор мыши (если только окно захватило мышь)
                          каждый раз, когда мышь перемещается.

        WM_NCLBUTTONDBLCLK Это сообщение  посылается окну, когда дважды
                          нажимается левая кнопка мыши в то время,  как
                          мышь    находится    в   области   окна,   не
                          принадлежащей пользователю.

        WM_NCLBUTTONDOWN  Это сообщение    посылается    окну,    когда
                          нажимается левая кнопка мыши в то время,  как
                          мышь   находится   в   области    окна,    не
                          принадлежащей пользователю.

        WM_NCLBUTTONUP    Это сообщение    посылается    окну,    когда
                          освобождается левая кнопка мыши в  то  время,
                          как   мышь   находится  в  области  окна,  не
                          принадлежащей пользователю.

        WM_NCMBUTTONDBLCLK Это сообщение посылается окну, когда  дважды
                          нажимается средняя  кнопка  мыши  в то время,
                          как  мышь  находится  в  области   окна,   не
                          принадлежащей пользователю.

        WM_NCMBUTTONDOWN  Это сообщение    посылается    окну,    когда
                          нажимается средняя кнопка мыши  в  то  время,
                          как   мышь   находится  в  области  окна,  не
                          принадлежащей пользователю.


       Windows 3.0/Ref/5#7                                       = 29 =

        WM_NCMBUTTONUP    Это сообщение    посылается    окну,    когда
                          освобождается средняя кнопка мыши в то время,
                          как  мышь  находится  в  области   окна,   не
                          принадлежащей пользователю.

        WM_NCMOUSEMOVE    Это сообщение  посылается окну,  когда курсор
                          мыши  перемещается   в   области   окна,   не
                          принадлежащей пользователю.

        WM_NCPAINT        Это сообщение    посылается    окну,    когда
                          необходимо перерисовать его рамку.

        WM_NCRBUTTONDBLCLK Это сообщение  посылается окну, когда дважды
                          нажимается правая кнопка мыши в то время, как
                          мышь    находится    в   области   окна,   не
                          принадлежащей пользователю.

        WM_NCRBUTTONDOWN  Это сообщение    посылается    окну,    когда
                          нажимается правая кнопка мыши в то время, как
                          мышь    находится    в   области   окна,   не
                          принадлежащей пользователю.

        WM_NCRBUTTONUP    Это сообщение    посылается    окну,    когда
                          освобождается  правая кнопка мыши в то время,
                          как  мышь  находится  в  области   окна,   не
                          принадлежащей пользователю.




       Windows 3.0/Ref/5#7                                       = 30 =

                      5.11  Сообщения интерфейса множества документов.         

             Интерфейс множества     документов     Windows      (MDI),
        предоставляет прикладным  программам  стандартный интерфейс для
        отображения нескольких   документов   в    одного    экземпялра
        прикладной программы. Программы, использующие MDI, создают окно
        фрейма, которое содержит окно клиент  в  области  пользователя.
        Прикладная программа создает окно клиента MDI с помощью функции
        CreateWindow, указывая класс MDICLIENT, и передавая в параметре
        lParam структуру  CLIENTCREATESTRUCT.  Это  окно  клиент в свою
        очередь может  владеть  множеством  дочерних  окон,  каждое  из
        которых отображает отдельный документ.  Программы, использующие
        MDI управляют этими дочерними окнами,  посылая  сообщения  окну
        клиенту. Ниже коротко описаны эти сообщения:

        Сообщение         Описание
        ───────────────────────────────────────────────────────────────
        WM_MDIACTIVATE    Это сообщение активизирует дочернее окно.

        WM_MDICASCADE     Это сообщение   расставляет   дочерние   окна
                          каскадом.

        WM_MDICREATE      Это сообщение создает дочернее окно.

        WM_MDIDESTROY     Это сообщение закрывает дочернее окно.

        WM_MDIGETACTIVE   Это сообщение возвращает текущее активное
                          дочернее окно MDI.

        WM_MDIICONARRANGE Расставляет все иконы дочерних окон.

        WM_MDIMAXIMIZE    Максимизирует дочернее окно MDI.

        WM_MDIRESTORE     Восстанавливает предыдущее          состояние
                          максимизированного    или   минимизированного
                          окна.

        WM_MDISETMENU     Заменяет меню окна фрейма MDI, накладываемого
                          меню Window или оба.

        WM_MDITILE        Расставляет дочерние окна MDI встык.




       Windows 3.0/Ref/5#7                                       = 31 =

                                              5.12  Заключение.                

             Сообщения Windows  представляют собой средство связи между
        прикладной программой и  средой  Windows,  другими  прикладными
        программами, в многозадачной среде.  Дополнительную информацию,
        связанную с  сообщениями  Windows  вы   найдете   в   следующих
        разделах:

        Раздел               Руководство
        ───────────────────────────────────────────────────────────────
        Функции обработки    Справочное руководство, том 1: глава 1,
        сообщений            "Функции интерфейса графических устройств".

        Описание функций     Справочное руководство, том 1: глава 4,
                             "Список функций".

        Описание сообщений   Справочное руководство, том 1: глава 6,
                             "Список сообщений".

        Типы и структуры     Справочное руководство, том 2: глава 7,
        данных Windows       "Типы и структуры данных".

        Динамический обмен   Справочное руководство, том 2: глава 15,
        данными              "Определение протокола Windows DDE".

                             Руководство программиста: глава 22,
                             "Динамический обмен данными".

        Основная информация  Руководство программиста: глава 1, "Обзор
        о программировании   среды Windows".
        в среде Windows




       Windows 3.0/Ref/5#7                                       = 32 =

                                       Глава 6. Список сообщений.              
       ----------------------------------------------------------------

             Среда Microsoft   Windows  взаимодействует  с  прикладными
        программами через  форматированные  сообщения  окон.  Сообщения
        для обработки посылаются функциям окон прикладных программ.

             Некоторые сообщения    возвращают   значения,   содержащие
        информацию об успешном завершении или другие данные,  требуемые
        прикладной программе.   Для  получения  возвращаемого  значения
        прикладная программа    для    передачи    сообщения     должна
        воспользоваться функцией SendMessage. Эта функция не возвращает
        управления до тех пор, пока сообщение не будет обработано. Если
        возвращаемое значение прикладной программе не требуется, то для
        посылки сообщений можно воспользоватться функцией  PostMessage.
        Эта функция помещает сообщение в очередь прикладной программы и
        сразу же  возвращает  управление.  Если  сообщение   не   имеет
        возвращаемого значения,  то  прикладная  программа  для посылки
        сообщений может  использовать  обе  функции,  если  в  описании
        сообщения не сказано обратное.

             Сообщение состоит   из   трех  частей:  номера  сообщения,
        параметра wParam (слово) и параметра  lParam  (двойное  слово).
        Номера  сообщений идентифицируются предварительно определенными
        именами сообщений.  Имена начинаются с "WM_" и  отражают  смысл
        или   источник   сообщения.   Короткие   и  длинные  параметры,
        поименованные  wParam  и  lParam,  содержат  значения,  которые
        зависят от номера сообщения.

             Параметр lParam   часто   содержит   более   одного  блока
        информации.  Например, старшее слово может содержать дескриптор
        окна, а младшее слово - целое значение. Для извлечения старшего
        или младшего слова из  lParam  может  могут  быть  использованы
        вспомогательные макроопределения HIWORD и LOWORD. Для доступа к
        любым байтам наряду с HIWORD и LOWORD могут  быть  использованы
        вспомогательные макроопределения HIBYTE и LOBYTE.

             Имеется четыре диапазона номеров сообщений:

             Диапазон           Описание
             ──────────────────────────────────────────────────────────
             0 - WM_USER-1      Резервируется для использования средой
                                Windows.

             WM_USER - 0х7FFF   Целые сообщения для использования
                                прикладной программой.

             0x8000 - 0xBFFF    Резервируется для  использования средой
                                Windows.

             0xС000 - 0xFFFF    Cтроковые сообщения для использования
                                прикладными программами.
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 33 =


             Номера соощений  в  первом  диапазоне  (0   -   WM_USER-1)
        определяются средой Windows и обсуждаются в данной главе позже.
        Значения  из  этого  диапазона,  которые  явно  не  определены,
        резервируются для будущего использования средой Windows.

             Номера сообщений  во  втором  диапазоне  (WM_USER  - 7FFF)
        могут определяться и использоваться прикладной  программой  для
        посылки  сообщений в рамках самой прикладной программы.  Однако
        эти  сообщения   не   должны   посылаться   другим   прикладным
        программам,   если   только   прикладные   программы  не  имеют
        соглашений об  обмене  сообщениями  и  не  присваивают  номерам
        сообщений один и тот же смысл.

             Номера сообщений   в   третьем  диапазоне  (8000  -  BFFF)
        резервируются для будущего использования средой Windows.

             Номера сообщений  в  четвертом  диапазоне  (C000  -  FFFF)
        определяются,   когда  прикладная  программа  вызывает  функцию
        RegisterWindowMessage с целью получения  номера  сообщения  для
        строки.   Все   прикладные   программы,   которые  регистрируют
        идентичные  строки,  могут  использовать  ассоциативные  номера
        сообщений   для   обмена   сообщениями   между  собой.  Однако,
        фактический  номер   сообщения   не   является   константой   и
        предполагается,  что  он не может быть тем же самым в различных
        сеансах работы с окном.

             В этой главе приводится описание сообщений,  расположенных
        в алфавитном порядке. Дополнительную информацию о сообщениях вы
        найдете в главе 5, "Обзор сообщений".

        ───────────────────────────────────────────────────────────────


       Windows 3.0/Ref/5#7                                       = 34 =

                                     BM_SETCHECK                               

             Это сообщение  помечает  или  снимает  отметку  с  клавиши
             уставноки или панели.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет, помещается или снимается
                               контрольная отметка с клавиши или панели.
                               Если этот параметр не равен нулю,
                               контрольная отметка помещается, если он
                               равен нулю, контрольная отметка (если она
                               существует) удаляется. Для трехпозиционных
                               клавиш: если wParam равен 1, контрольная
                               отметка  размещается внутри клавиши,
                               если wParam равен 2, клавиша сереет,
                               если  wParam  равен 0, клавиша
                               возвращается к своему нормальному
                               состоянию (без контрольной отметки или
                               "серения").

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение не действует на альтернативные клавиши.

        ───────────────────────────────────────────────────────────────
                                                                               
       BM_SETSTATE

             Это сообщение  отображает  мягкую   клавишу   или   панель
             контроля.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет, используется ли  подсветка.
                               Если он не равен нулю, мягкая клавиша
                               подсвечивается (внутренность клавиши
                               инверсируется). Если  wParam равен нулю,
                               мягкая клавиша отображается без подсветки.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Альтернативные клавиши не могут подсвечиваться.

        ───────────────────────────────────────────────────────────────
                                     BM_SETSTYLE                               

             Это сообщение  изменяет  типы  мягких  клавиш.  Если  тип,

       Windows 3.0/Ref/5#7                                       = 35 =

             содержащийся в  параметре  wParam,  отличен  от  текущего,
             мягкая  клавиша  перерисовывается  в  соответствии с новым
             типом.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет значение типа. Полное описание
                               возможных типов мягких клавиш приведено в
                               табл. 6.1, "Типы мягких клавиш".

             lParam            Определяет, должна ли клавиша перери-
                               совывается. Если lParam равен 0, клавиша
                               не должна перерисовываться. Если lParam
                               не равен 0, то клавиша перерисовывается.
             ──────────────────────────────────────────────────────────

        Примечание

             Таблица 6.1  содержит возможные типы мягких клавиш:

             Таблица 6.1, "Типы мягких клавиш".
             ──────────────────────────────────────────────────────────
             Тип                Описание
             ──────────────────────────────────────────────────────────
             BS_AUTOCHECKBOX    Идентично BS_CHECKBOX   за  исключением
                                того,  что мягкая клавиша автоматически
                                переключает   свое   состояние,   когда
                                пользователь нажимает на нее.

             BS_AUTORADIOBUTTON Идентично BS_RADIOBUTTON за исключением
                                того, что   когда  клавиша  помечается,
                                прикладная      программа      получает
                                уведомляющее сообщение BN_CLICKED, и со
                                всех клавиш  установки  из даной группы
                                удаляются контрольные отметки.

             BS_AUTO3STATE      Идентично BS_3STATE,   за   исключением
                                того,  что мягкая клавиша автоматически
                                переключает  свое состояние каждый раз,
                                когда пользователь нажимает ее.

             BS_CHECKBOX        Небольшая прямоугольная мягкая клавиша,
                                которая  может  помечаться.  Ее граница
                                становится  толще,  когда  пользователь
                                "нажимает"   ее.   Справа   от  клавиши
                                располагается некоторый текст.

             BS_DEFPUSHBUTTON   Небольшая мягкая клавиша  с  утолщенной
                                границей   (альтернативная  клавиша  по
                                умолчанию).  Эта  клавиша  представляет
                                ответ пользователя по умолчанию. Внутри
                                клавиши индицируется  некоторый  текст.
                                Windows        посылает       сообщение

       Windows 3.0/Ref/5#7                                       = 36 =

                                родительскому окну,  когда пользователь
                                нажимает на клавишу.

             BS_GROUPBOX        Прямоугольник, в  котором сгруппированы
                                некоторые  мягкие  клавиши.   В   левом
                                верхнем углу  прямоугольника  выводится
                                текст.

             BS_LEFTTEXT        Текст располагается  на  левой  стороне
                                клавиши установки или панели  контроля.
                                Этот   тип   используется  совместно  с
                                типами BS_CHECKBOX,  BS_RADIOBATTON или
                                BS_3STATE.

             BS_OWNERDRAW       Клавиша      рисуемая       владельцем.
                                Родительское  окно  получает  сообщения
                                при  нажатии  на  клавишу.  Уведомление
                                включает в  себя  также  требование  на
                                перерисовку,      инвертирование      и
                                запрещение клавиши.

             BS_PUSHBUTTON      Небольшая клавиша,  содержащая заданный
                                текст  (альтернативная  клавиша).  Блок
                                управления      посылает      сообщение
                                родительскому  окну  всякий раз,  когда
                                пользователь намает клавишу.

             BS_RADIOBATTON     Небольшая мягкая клавиша круглой  формы
                                (клавиша    установки),   чья   граница
                                утолщается, когда пользователь нажимает
                                ее. Обычно они используются в группе из
                                двух и более клавиш  для  представления
                                исключительного выбора,  т.е.  когда  в
                                группе можно   выбрать   только    одну
                                клавишу.

             BS_3STATE          Идентично BS_CHECKBOX,  за  исключением
                                того,  что мягкая клавиша может сереть,
                                помечаться или   не  помечаться.  Серый
                                цвет  обычно  используется  для   того,
                                чтобы  показать,  что  панель  контроля
                                запрещена.

        ───────────────────────────────────────────────────────────────
                                                                               
       BN_CLICKED

             Этот код   показывает,  что  пользователь  нажал  клавишу.
             Родительское  окно  получает  этот  код  через   сообщение
             WM_COMMAND клавишного блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

       Windows 3.0/Ref/5#7                                       = 37 =


             lParam            Младшее слово lParam содержит дескриптор
                               идентифицирующий клавишный          блок
                               управления, а старшее слово содержит код
                               уведомления BN_CLICKED.
             ──────────────────────────────────────────────────────────

        Примечание

             Запрещенные мягкие клавиши не могут посылать родительскому
             окну уведомляющее сообщение BN_CLICKED.

        ───────────────────────────────────────────────────────────────
                                   BN_DOUBLECLICKED                            

             Этот код   показывает,   что   пользователь  дважды  нажал
             клавишу кнопку мыши находясь на клавише. Родительское окно
             получает  этот  код  через сообщение WM_COMMAND клавишного
             блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее слово lParam содержит дескриптор,
                               идентифицирующий клавишный          блок
                               управления, а старшее слово содержит код
                               BN_DOUBLECLICKED.
             ──────────────────────────────────────────────────────────

        Примечание

             Этот код может использоваться только с клавишами, имеющими
             тип BS_RADIOBUTTON и BS_OWNERDRAW.

        ───────────────────────────────────────────────────────────────


       Windows 3.0/Ref/5#7                                       = 38 =

                                 CB_ADDSTRING  [3.0]                           

             Это сообщение   добавляет   строку   в   панель    перечня
             комбинированного блока  управления.  Если в панели перечня
             не предусмотрена сортировка,  строка добавляется  в  конец
             перечня.  В  противном  случае  она вставляется в перечень
             после сортировки.

             Это сообщение удаляет в панели перечня любую выборку.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Длинный указатель на добавляемую строку,
                               завершаемую нулевым символом. Если
                               комбинированный блок управления создан с
                               типом CBS_OWNERDRAW но без указания
                               флага CBS_HASSTRING, lParam содержит
                               32-битовое значение, которое пользо-
                               ватель использует для идентификации
                               элемента и которое сохраняется вместо
                               указателя на строку.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Определяет индекс строки в панели перечня.  Если произошла
             ошибка,  возвращается CB_ERR;  если для запоминания  новой
             строки   недостаточно   места   в   памяти,   возвращается
             CB_ERRSPACE.

        Примечание

             Если комбинированный блок управления был  создан  с  типом
             CBS_SORT но     без    типа    CBS_HASSTRING,    владельцу
             комбинированного блока один или несколько  раз  посылается
             сообщение WM_COMPAREITEM,  чтобы  корректно вставить новый
             элемент в панель перечня.

        ───────────────────────────────────────────────────────────────
                                CB_DELETESTRING  [3.0]                         

             Это сообщение удаляет строку из панели перечня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс удаляемой строки.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

       Windows 3.0/Ref/5#7                                       = 39 =


             Возвращаемое значение -  это  число  строк,  оставшихся  в
             панели   перечня.   Если   указан   некорректный   индекс,
             возвращается LB_ERR.

        Примечание

             Если комбинированный блок управления был  создан  с  типом
             CBS_OWNERDRAW но без указания флага CBS_HASSTRING,  то при
             удалении строки    владельцу    комбинированного     блока
             управления посылается  сообщение WM_DELETEITEM,  для того,
             чтобы прикладная программа могла освободить дополнительные
             данные, связанные   с  этим  элементом  (передается  через
             параметр lParam сообщений CB_ADDSTRING и CB_INSERTSTRING).

        ───────────────────────────────────────────────────────────────
                                    CB_DIR  [3.0]                              

             Это сообщение   добавляет   перечень  файлов  из  текущего
             каталога к панели  перечня.  Добавляются  только  файлы  с
             атрибутами,     определяемыми    параметром    wParam    и
             отождествленные со спецификацией файла, заданной lParam.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение атрибута DOS. Список
                               атрибутов вы  найдете в описании функции
                               DlgDirList в главе 4, "Список функций".

             lParam            Указывает на строку спецификации файла.
                               Строка может содержать универсальные
                               символы (например, *.*).
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  -  это число отображаемых на экране
             элементов.  Если произошла  ошибка,  возвращается  CB_ERR;
             если  для  запоминания  новых  строк  недостаточно места в
             памяти, возвращается CB_ERRSPACE.

        Примечание

             Возвращаемое значение   сообщения   CB_DIR   меньше,   чем
             возвращаемое значение сообщения CB_GETCOUNT.

        ───────────────────────────────────────────────────────────────
                                 CB_FINDSTRING [3.0]                           

             Это сообщение  ищет  в  панели  перечня   первую   строку,
             совпадающую с данным префиксом.


       Windows 3.0/Ref/5#7                                       = 40 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс элемента после которого
                               необходимо производить поиск. Когда при
                               поиске достигается конец панели перечня
                               поиск продолжается с начала до элемента,
                               определяемого параметром wParam. Если
                               wParam содержит -1б то поиск выполняется
                               во всей панели перечня с начала до конца.

             lParam            Указывает на строку префикса. Строка
                               должна завершаться нулевым символом.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращается индекс совпадающей строки,  или,  если строка
             не найдена CB_ERR.

        Примечание

             Если комбинированный блок управления был  создан  с  типом
             CBS_OWNERDRAW но без указания флага CBS_HASSTRING,  то это
             сообщение возвращает индекс элемента, чье длинное значение
             (передается через параметр lParam сообщений CB_ADDSTRING и
             CB_INSERTSTRING) совпадает со значением передаваемым через
             параметр lParam сообщения CB_FINDSTRING.

        ───────────────────────────────────────────────────────────────
                                                                               
       CB_GETCOUNT  [3.0]

             Это сообщение возвращает число элементов в панели  перечня
             комбинированного блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  равно  числу  элементов  в   панели
             перечня комбинированного блока управления.

        ───────────────────────────────────────────────────────────────
                                                                               
       CB_GETCURSEL [3.0]

             Это сообщение  возвращает   индекс   текущего   выбранного
             элемента, если    он    существует,   в   панели   перечня
             комбинированного блока управления.


       Windows 3.0/Ref/5#7                                       = 41 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Это сообщение   возвращает   индекс   текущего  выбранного
             элемента.  Оно возвращает CB_ERR, если если нет выбранного
             элемента.

        ───────────────────────────────────────────────────────────────
                                                                               
       CB_GETEDITSEL [3.0]

             Это сообщение  возвращает  начальную  и  конечную  позиции
             выбранного текста  в  редактируемом блоке комбинированного
             блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение это длинное целое,  которое содержит
             в младшем слове  начальную  позицию,  и  в  старшем  слове
             конечную позицию.   Если   это   сообщение   посылается  в
             комбинированный блок управления не имеющий  редактируемого
             блока, возвращается значение CB_ERR.

        ───────────────────────────────────────────────────────────────
                                                                               
       CB_GETITEMDATA [3.0]

             Это сообщение позволяет  получить  связанное  с  элементом
             32-битовое значение,  передаваемое  прикладной программой.
             Если рисуемый владельцем комбинированный  блок  управления
             создан без    использования   флага   CBS_HASSTRING,   это
             32-битовое  значение  передается  через  параметр   lParam
             сообщений  CB_ADDSTRING  и  CB_INSERTSTRING.  В  противном
             случае  это  значение   определяемое   параметром   lParam
             сообщения CB_SETITEMDATA.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс элемента.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────


       Windows 3.0/Ref/5#7                                       = 42 =

        Возвращаемое значение

             Возвращаемое значение это 32-битовое значение, связанное с
             элементом, или CB_ERR в случае ошибок.

        ───────────────────────────────────────────────────────────────
                                  CB_GETLBTEXT [3.0]                           

             Это сообщение копирует в буфер строку  из  панели  перечня
             комбинированного блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс копируемой строки.

             lParam            Указывает на буфер, в который копируется
                               строка. Буфер должен быть достаточно
                               большим, чтобы в него поместилась строка.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение определяет длину  строки  в  байтах,
             включая завершающий  нулевой символ.  Если wParam содержит
             некорректный индекс, то возвращается значение CB_ERR.

        Примечание

             Если комбинированный блок управления был  создан  с  типом
             CBS_OWNERDRAW но без указания флага CBS_HASSTRING,  то это
             сообщение поместит в буфер, указываемый параметром lParam,
             32-битовое значение,   которое   пользователь   связал   с
             элементом  (передается  через  параметр  lParam  сообщений
             CB_ADDSTRING и CB_INSERTSTRING).

        ───────────────────────────────────────────────────────────────
                                                                               
       CB_GETTEXTLEN [3.0]

             Это сообщение возвращает длину  строки  в  панели  перечня
             комбинированного блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс строки.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Определяет длину строки в байтах,  за исключением признака
             конца. Если произошла ошибка, то возвращается CB_ERR.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 43 =

                                   LB_INSERTSTRING                             

             Это сообщение   вставляет   строку   в   панель    перечня
             комбинированного блока     управления.    Сортировка    не
             выполняется.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Индекс позиции, с которой вставляется
                               строка. Если  wParam  равен  -1,  строка
                               добавляется в конец перечня.

             lParam            Указывает на завершаемую нулем вставляе-
                               мую строку.  Если  комбинированный блок
                               управления создан с типом  CBS_OWNERDRAW
                               но  без  указания  флага  CBS_HASSTRING,
                               lParam содержит   32-битовое   значение,
                               которое   пользователь   использует  для
                               идентификации   элемента    и    которое
                               сохраняется вместо указателя на строку.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Содержит индекс позиции,  с  которой  вставляется  строка.
             Если  произошла ошибка,  то возвращается CB_ERR;  если для
             запоминания новой  строки  недостаточно  места  в  памяти,
             возвращается CB_ERRSPACE.

        ───────────────────────────────────────────────────────────────
                                                                               
       CB_LIMITTEXT  [3.0]

             Это сообщение  ограничивает  длину  (в   байтах)   текста,
             который пользователь  может  ввести  в  редактируемый блок
             комбинированного блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет максимальное число байт,
                               которое может ввести пользователь.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Если сообщение  успешно  выполнено  возвращается  TRUE,  в
             противном случае  возвращается  FALSE.  Если это сообщение
             было  послано  комбинированному   блоку   управления,   не
             имеющему редактируемого блока, то возвращается CB_ERR.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 44 =

                                                                               
       CB_RESETCONTENT [3.0]

             Это сообщение  удаляет  все  строки  из   панели   перечня
             комбинированного блока   управления  и  освобождает  любую
             память, выделенную для этих строк.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Если комбинированный блок управления был  создан  с  типом
             CBS_OWNERDRAW но без указания флага CBS_HASSTRING,  то при
             удалении каждой  строки  владельцу  комбинированного блока
             управления посылается сообщение WM_DELETEITEM.

        ───────────────────────────────────────────────────────────────
                                CB_SELECTSTRING [3.0]                          

             Это сообщение   выбирает   первую  строку  панели  перечня
             комбинированного блока управления совпадающую с  указанным
             префиксом.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс начальной точки поиска.
                               Когда при поиске достигается конец
                               перечня, то  поиск продолжается с начала
                               до определяемого параметром wParam
                               элемента. Если wParam равен -1, поиск
                               строки осуществляется с начала по всему
                               перечню.

             lParam            Указывает на префиксную строку. Строка
                               должна завершаться нулевым символом.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  -  это  индекс выбранного элемента.
             Если произошла  ошибка,  возвращается  LB_ERR,  и  текущая
             выборка не изменяется.

        Примечание

             Строка выбирается  только в том случае,  если ее начальные
             знаки (с начальной точки)  отождествляются  со  знаками  в
             префиксной строке.


       Windows 3.0/Ref/5#7                                       = 45 =

             Если комбинированный блок управления был  создан  с  типом
             CBS_OWNERDRAW но без указания флага CBS_HASSTRING,  то это
             сообщение возвращает индекс элемента, чье длинное значение
             (передается через параметр lParam сообщений CB_ADDSTRING и
             CB_INSERTSTRING) совпадает со значением передаваемым через
             параметр lParam сообщения CB_SELECTSTRING.

        ───────────────────────────────────────────────────────────────
                                  CB_SETCURSEL [3.0]                           

             Это сообщение    выбирает    строку   в   панели   перечня
             комбинированного блока управления и  прокручивает  ее  для
             просмотра, если  это  необходимо.  Текст в статическом или
             редактируемом блоке комбинированного блока изменяется  для
             отражения новой  выборки.  Когда  выбирается новая строка,
             панель перечня удаляет подсветку с ранее выбранной строки.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс строки, которая должна
                               быть выбрана. Если wParam равен -1,
                               устанавливается, что панель перечня не
                               имеет выборки.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Если указан некорректный индекс,  то возвращается значение
             CB_ERR и текущая выборка не изменется.

        ───────────────────────────────────────────────────────────────
                                                                               
       CB_SETEDITSEL [3.0]

             Это сообщение выбирает все символы в  редактируемом  блоке
             комбинированного блока управления, находящиеся в указанном
             с использованием параметра lParam диапазоне.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Определяет начальную позицию в младшем
                               слове и конечную в старшем.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  равно  TRUE  в  случает   успешного
             завершения, в  противном случае оно равно FALSE.  Если это
             сообщение посылается в комбинированный блок управления  не
             имеющий   редактируемого   блока,   возвращается  значение

       Windows 3.0/Ref/5#7                                       = 46 =

             CB_ERR.

        ───────────────────────────────────────────────────────────────
                                                                               
       CB_SETITEMDATA [3.0]

             Это сообщение позволяет связать с элементом панели перечня
             комбинированного блока  управления  32-битовое   значение.
             Если  рисуемый  владельцем комбинированный блок управления
             создан без   использования   флага   CBS_HASSTRING,    это
             32-битовое значение  заменяет 32-битовое значение,  котоое
             было передано через параметр lParam сообщений CB_ADDSTRING
             и CB_INSERTSTRING.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс элемента.

             lParam            Содержит новое значение, которое
                               связывается с элементом.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             При возникновении ошибки возвращается значение CB_ERR.

        ───────────────────────────────────────────────────────────────
                                                                               
       CB_SHOWDROPDOWN [3.0]

             Это сообщение  выводит  или  скрывает  выпадающую   панель
             перечня комбинированного  блока  управления,  имеющего тип
             CBS_DROPDOWN или CBS_DROPDOWNLIST.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Если равен TRUE, то панель перечня
                               отображается. Если равен FALSE, то
                               панель перечня скрывается.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                   CBN_DBLCLK [3.0]                            

             Этот код показывает,  что пользователь дважды нажал кнопку
             мыши, находясь  на  строке панели перечня комбинированного
             блока управления.  Родительское  окно  получает  этот  код
             через сообщение WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.


       Windows 3.0/Ref/5#7                                       = 47 =

             lParam            Младшее  слово lParam содержит дескриптор
                               окна комбинированного блока  управления,
                               старшее слово    lParam   содержит   код
                               уведомления CBN_DBLCLK.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение  может генерироваться только комбинированным
             блоком управления,  имеющим   постоянно   видимую   панель
             перечня. В  комбинированных блоках управления с выпадающей
             панелью перечня  одно  нажатие  кнопки  мыши  приводит   к
             закрытию панели   перечня,   и   поэтому  двойное  нажатие
             возникнуть в нем не может.

        ───────────────────────────────────────────────────────────────
                                                                               
       CBN_DROPDOWN  [3.0]

             Этот код  сообщает  что  была  отображена  панель  перечня
             комбинированного блока   управления.   Родительское   окно
             получает этот   код   через   сообщение  WM_COMMAND  блока
             управления.
             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор
                               окна комбинированного блока  управления,
                               старшее слово    lParam   содержит   код
                               уведомления CBN_DROPDOWN.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение   не  может  генерироваться  комбинированным
             блоком управления не имеющим выпадающую панель перечня.

        ───────────────────────────────────────────────────────────────
                                 CBN_EDITCHANGE [3.0]                          

             Этот код показывает, что пользователь предпринял некоторые
             действия, которые,    возможно,    изменили     содержимое
             редактируемого блока комбинированного блока управления. Он
             посылается после  того,   когда   Windows   откорректирует
             изображение (в    отличие    от    кода   CBN_EDITUPDATE).
             Родительское окно  получает  этот  код   через   сообщение
             WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор

       Windows 3.0/Ref/5#7                                       = 48 =

                               окна комбинированного блока  управления,
                               старшее слово    lParam   содержит   код
                               уведомления CBN_EDITCHANGE
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение   не  может  генерироваться  комбинированным
             блоком управления не имеющим редактируемого блока.

        ───────────────────────────────────────────────────────────────
                                                                               
       CBN_EDITUPDATE [3.0]

             Этот код  показывает,  редактируемый блок комбинированного
             блока управления содержит измененный  текст.  Родительское
             окно  получает  этот  код через сообщение WM_COMMAND блока
             управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор
                               окна комбинированного блока  управления,
                               старшее слово    lParam   содержит   код
                               уведомления CBN_EDITUPDATE.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение   не  может  генерироваться  комбинированным
             блоком управления не имеющим редактируемого блока.

        ───────────────────────────────────────────────────────────────
                                                                               
       CBN_ERRSPACE [3.0]

             Этот код показывает, панели перечня комбинированного блока
             управления не  хватает  памяти  для  выполнения указанного
             запроса. Родительское  окно  получает   этот   код   через
             сообщение WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор
                               окна комбинированного блока  управления,
                               старшее слово    lParam   содержит   код
                               уведомления CBN_ERRSPACE
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 49 =

                                                                               
       CBN_KILLFOCUS [3.0]

             Этот код посылается,  когда  комбинированный  блок  теряет
             захват ввода.  Родительское  окно  получает этот код через
             сообщение WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор
                               окна комбинированного блока  управления,
                               старшее слово    lParam   содержит   код
                               уведомления CBN_KILLFOCUS.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       CBN_SELCHANGE [3.0]

             Этот код   показывает,   что   выборка  в  панели  перечня
             комбинированного блока управления была изменена либо когда
             пользователь нажал  клавишу мышки или если он ввел текст в
             редактируемом блоке.  Родительское окно получает этот  код
             через сообщение WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор
                               окна комбинированного блока  управления,
                               старшее слово    lParam   содержит   код
                               уведомления CBN_SELCHANGE.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       CBN_SETFOCUS [3.0]

             Этот код посылается,  когда комбинированный блок  получает
             захват  ввода.  Родительское  окно получает этот код через
             сообщение WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор
                               окна комбинированного блока  управления,
                               старшее слово    lParam   содержит   код
                               уведомления CBN_SETFOCUS.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────


       Windows 3.0/Ref/5#7                                       = 50 =

                                                                               
       DM_GETDEFID

             Эта сообщение     возвращает     ID    блока    управления
             альтернативной клавиши по умолчанию для панели диалога.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  это  32-битовое  значение.  Старшее
             слово содержит DC_HASDEFID, если существует мягкая клавиша
             по умолчанию, иначе оно равно нулю. Младшее слово содержит
             ID  мягкой  клавиши  по  умолчанию,  если  старшее   слово
             содержит DC_HASDEFID, в противном случае оно равно нулю.

        ───────────────────────────────────────────────────────────────
                                                                               
       DM_SETDEFID

             Это сообщение  используется  прикладной   программой   для
             изменения  ID  блока управления альтернативной клавишей по
             умолчанию для панели диалога.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит ID новой альтернативной клавиши
                               по умолчанию.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ──────────────────────────────────────────────────────────────


       Windows 3.0/Ref/5#7                                       = 51 =

                                                                               
       EM_CANUNDO

             Это сообщение  определяет,  может  ли  редактируемый  блок
             управления правильно отреагировать на сообщение EM_UNDO.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  не  равно нулю,  если редактируемый
             блок  управления  может  корректно  обработать   сообщение
             EM_UNDO.  В  противном  случае возвращаемое значение равно
             нулю.

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_EMPTYUNDOBUFFER  [3.0]

             Это сообщение  заставляет  редактируемый  блок  управления
             очистить буфер   восстановления.   Этим   вы    запрещаете
             возможность восстановления последнего редактирования.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Буфер восстановления автоматически очищается при получении
             сообщения WM_SETTEXT и WM_SETHANDLE.

        ───────────────────────────────────────────────────────────────
                                     EM_FMTLINES                               

             Это сообщение заставляет редактируемый многострочный  блок
             управления добавлять  или  удалять  символ  конца строки к
             (из) автоматически переносимым текстовым строкам.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Указывает, располагать символы конца
                               строки или нет. Если он не равен нулю,
                               символы CR CR LF (шестнадцатиричные
                               значения 0D 0D 0A) размещаются в конце
                               автоматически переносимых строк. Если
                               wParam равен нулю, символы конца строки

       Windows 3.0/Ref/5#7                                       = 52 =

                               удаляется из текста.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  не  равно  нулю,  если  имело место
             форматирование. В противном случае оно равно нулю.

        Примечание

             Строки, которые заканчиваются  "принудительным"  возвратом
             (т.е.  возврат  каретки вводится пользователем),  содержат
             только знаки CR LF в конце строки. На эти строки сообщение
             EM_FMTLINES не оказывает влияния.

             При обработке этого сообщения размеры текста изменяются.

        ───────────────────────────────────────────────────────────────
                                     EM_GETHANDLE                              

             Это сообщение   возвращает   дескриптор   данных   буфера,
             используемого   для   хранения   содержимого   окна  блока
             управления.  Дескриптор  всегда  является  локальным   при
             размещении в сегменте данных прикладной программы.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение     это      дескриптор      данных,
             идентифицирующий   буфер,   использующийся   для  хранения
             содержимого редактируемого блока управления.

        Примечание

             Это сообщение можно использовать только в том случае, если
             к оператору STYLE панели диалога в файле описания ресурсов
             добавлен тип DS_LOCALEDIT.

        ───────────────────────────────────────────────────────────────
                                      EM_GETLINE                               

             Это сообщение  копирует  строку  из  редактируемого  блока
             управления.


       Windows 3.0/Ref/5#7                                       = 53 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит номер строки в блоке управления
                               (номер первой строки равен 0).

             lParam            Содержит длинный указатель на буфер, где
                               будет хранится строка. Первое слово
                               буфера определяет максимальное число байт,
                               которые могут быть скопированы в буфер.
                               Копируемая строка не содержит
                               завершающего нулевого символа.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение - это число фактически скопированных
             байтов. Это  сообщение  не   обрабатывается   однострочным
             редактируемым блоком управления.

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_GETLINECOUNT

             Это сообщение возвращает число строк текста в редактирумом
             блоке управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             EM_GETLINECOUNT возвращает  число  строк  текста  в  блоке
             управления.

        Примечание

             Это сообщение  не обрабатывается однострочным редактирумым
             блоком управления.

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_GETMODIFY

             Это сообщение    возвращает    текущее    значение   флага
             модификации для данного редактируемого  блока  управления.
             Этот  флаг  устанавливается,  если  пользователь  ввел или
             модифицировал текст внутри блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.


       Windows 3.0/Ref/5#7                                       = 54 =

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращается текущее   состояние   флага  модификации  для
             данного редактируемого блока управления.

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_GETRECT

             Это сообщение возвращает форматирующий прямоугольник блока
             управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит указатель на структуру данных
                               RECT. Блок управления копирует размеры в
                               эту структуру.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_GETSEL

             Это сообщение возвращает  начальную  и  конечную  знаковые
             позиции текущей выборки.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение это длинное целое,  которое содержит
             начальную позицию в  младшем  слове,  а  в  старшем  слове
             содержит позицию   первого  невыбранного  символа  идущего
             после выборки.

        ───────────────────────────────────────────────────────────────
                                     EM_LIMITTEXT                              

             Это сообщение   ограничивает   длину  (в  байтах)  текста,
             который может ввести пользователь.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет максимальное число байт,
                               которые может ввести. Если пользователь
                               пытается ввести большее число символов,
                               редактируемый блок управления выдает
                               звуковой сигнал и больше символов не

       Windows 3.0/Ref/5#7                                       = 55 =

                               принимает. Если wParam равен 0, на
                               размеры текста не накладывается
                               ограничений (до тех пор, пока память не
                               будет исчерпана).

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Сообщение EM_LIMITTEXT    не    воздействует   на   текст,
             установленный  с  помощью   WM_SETTEXT   или   на   буфер,
             установленный с помощью EM_SETHANDLE.

        ───────────────────────────────────────────────────────────────
                                   EM_LINEFROMCHAR                             

             Это сообщение возвращает номер строки,  содержащей символ,
             позиция   которого   (отсчитываемая   с   начала   текста)
             определена параметром wParam.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс заданного символа текста
                               редактируемого блока управления (индекс
                               первого символа равен 0) или -1.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  представляет  собой  номер  строки.
             Если  wParam  равен   -1,   возвращается   номер   строки,
             содержащей  первый  символ  выборки;  в  противном  случае
             wParam содержит индекс (позицию) заданного символа  текста
             редактируемого блока управления,  и возвращается номер той
             строки, которая содержит этот символ.

        ───────────────────────────────────────────────────────────────
                                     EM_LINEINDEX                              

             Это сообщение  возвращает  смещение  в  буфере  (в байтах)
             первого символа данной строки.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет номер заданной строки (номер
                               первой строки равен 0). Если wParam
                               равен -1, используется текущая строка
                               (строка, содержащая псевдокурсор).

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 56 =


        Возвращаемое значение

             Возвращаемое значение  -  это  число   знаковых   позиций,
             которые предшествуют первому символу заданной строки.

        Примечание

             Это сообщение не обрабатывается однострочным редактируемым
             блоком управления.

        ───────────────────────────────────────────────────────────────
                                    EM_LINELENGTH                              

             Это сообщение   возвращает   длину  строки  (в  байтах)  в
             текстовом буфере редактируемого блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет индекс символа в заданной
                               строке (номер первой строки равен 0).
                               Если wParam равен -1, возвращается длина
                               текущей строки (строки, содержащей
                               псевдокурсор), не включая длину всего
                               выбранного текста. Если текущая выборка
                               содержит более одной строки, возвращается
                               общая длина строк минус длина выбранного
                               текста.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Для получения   индекса   символа  строки  данного  номера
             используется сообщение  EM_LINEINDEX.  Этот  индекс  может
             быть использован с сообщением EM_LINELENGTH.

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_LINESCROLL

             Это сообщение прокручивает содержимое блока управления  на
             заданное число строк.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит число строк и число позиций,
                               определяющие прокрутку. Старшее слово
                               lParam содержит число строк для
                               вертикальной прокрутки, а младшее слово

       Windows 3.0/Ref/5#7                                       = 57 =

                               - число позиций для горизонтальной
                               прокрутки.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение не обрабатывается однострочным редактируемым
             блоком управления.

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_REPLACESEL

             Это сообщение заменяет текущую выборку новым текстом.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит длинный указатель на заменяющую
                               строку, содержащую завершающий нулевой
                               символ.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                     EM_SETHANDLE                              

             Это сообщение  создает  текстовый буфер,  используемый для
             хранения содержимого окна блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор буфера. Дескриптор
                               должен быть локальным для размещения в
                               сегменте данных прикладной программы.
                               Редактируемый блок управления использует
                               этот буфер для хранения отображаемого в
                               настоящий момент текста вместо того,
                               чтобы отвести свой собственный буфер.
                               Если необходимо, блок управления
                               перераспределяет этот буфер.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение не обрабатывается однострочным редактируемым
             блоком управления.

             Если сообщение  EM_SETHANDLE  применяется  для   изменения
             текстового   буфера,  используемого  редактируемым  блоком
             управления,  предыдущий текстовый буфер не разрушается. На
             прикладную     программу    возлагается    ответственность

       Windows 3.0/Ref/5#7                                       = 58 =

             отыскивать  дескриптор  старого  буфера  перед  установкой
             нового  дескриптора  и  освобождать  старый  дескриптор  с
             помощью функции LocalFree.

             Редактируемый блок        управления         автоматически
             перераспределяет данный буфер каждый раз, когда необходимо
             дополнительное место для текста,  или удаляет часть текста
             так, что не требуется дополнительного места. Это сообщение
             можно использовать только в том случае,  если к  оператору
             STYLE  панели  диалога  в файле описания ресурсов добавлен
             тип DS_LOCALEDIT.

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_SETMODIFY

             Это сообщение  устанавливает  флаг модификации для данного
             редактируемого блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет новое значение флага
                               модификации.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_SETPASSWORDCHAR [3.0]

             Это сообщение   устанавливает   символ,   отображаемый   в
             редактируемом блоке   управления,   созданном   с    типом
             ES_PASSWORD. По  умолчанию  используется  символ звездочка
             ("*").

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет символ, отображаемый вместо
                               текста вводимого пользователем. Если
                               wParam равен NULL, то отображается текст
                               вводимый пользователем.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_SETRECT

             Это сообщение устанавливает прямоугольник формирования для
             блока    управления.     Текст     переформатируется     и
             переиндицируется  для  того,  чтобы  отразить  изменения в
             прямоугольном блоке.


       Windows 3.0/Ref/5#7                                       = 59 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит длинный указатель на структуру
                               данных RECT, определяющую новые размеры
                               прямоугольника.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение не обрабатывается однострочным редактируемым
             блоком управления.

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_SETRECTNP

             Это сообщение    аналогично    сообщению   EM_SETRECT   за
             исключением того, что блок управления не перерисовывается.
             Каждое   последующее   изменение   требует,   чтобы   блок
             управления     перерисовывался,     отражая      изменения
             прямоугольника  формирования.  Это сообщение используется,
             когда поля должны быть перерисованы позже.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит длинный указатель на структуру
                               данных RECT, определяющую новые размеры
                               прямоугольника.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение не обрабатывается однострочным редактируемым
             блоком управления.

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_SETSEL

             Это сообщение  выбирает  все  символы  в  текущем  тексте,
             которые находятся внутри диапазона,  отмеченного начальной
             и конечной позициями, заданными параметром lParam.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит начальную позицию в младшем
                               слове и конечную позицию в старшем слове.
                               Значения позиций от 0 до 32767 определяют
                               выборку всей строки.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 60 =

                                 EM_SETTABSTOPS [3.0]                          

             Это сообщение    определяет    позиции    табуляции    для
             многострочного редактируемого блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Это целое значение, которое определяет
                               число позиций табуляции в редактируемом
                               блоке управления.

             lParam            Это дальний указатель на первый элемент
                               массива целых, содержащих позиции
                               табуляции в единицах диалога. (Единицы
                               диалога определяют размеры по горизон-
                               тали и вертикали. Одна горизонтальная
                               единица диалога равна 1/4 текущей
                               базовой единицы диалога. Базовая единица
                               диалога вычисляется на основе вызоты и
                               ширины системного шрифта. Базовую
                               единицу можно определить с помощью
                               функции GetDialogBaseUnits. Эта функция
                               возвращает базовую единицу в пикселях.
                               Позиции табуляции должны быть отсорти-
                               рованы в возростающем порядке. Обратная
                               табуляция не допускается.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Если позиции табуляции установлены  возвращается  TRUE.  В
             противном случае возвращается FALSE.

        Примечание

             Если параметры wParam и lParam равны NULL, то по умолчанию
             позиции табуляции расставляются через  каждые  32  единицы
             диалога.

             Если wParam  равен  1,  то позиции табуляции расставляются
             через указанное параметром lParam расстояние.

             Если lParam указывает больше  чем  на  одно  значение,  то
             позиции табуляции   устанавливаются   для  числа  позиций,
             определяемого параметром wParam.

        ───────────────────────────────────────────────────────────────
                                   EM_SETWORDBREAK                             

             Это сообщение  посылается  в  многострочный  редактируемый
             блок управления, информируя его о том, что Windows заменил

       Windows 3.0/Ref/5#7                                       = 61 =

             функцию   переноса   по   умолчанию  собственной  функцией
             прикладной  программы.  Функция   переноса   просматривает
             текстовый   буфер,   находя   первое   слово,  которое  не
             помещается в текущей отображаемой строке,  и переносит это
             слово в  начало  следующей  отображаемой  строки.  Функция
             переноса определяет,  с какой  точки  необходимо  прервать
             строку   текста   в   многострочном   редактируемом  блоке
             управления (обычно,  это пробел,  разделяющий два  слова).
             Функция  переноса  по  умолчанию прерывает строку текста с
             символа пробела.  Собственная функция прикладной программы
             может  определить  в  качестве  разделяющего символа черту
             переноса или любой другой символ, отличный от пробела.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.
             lParam            Определяет адрес экземпляра процедуры.
             ──────────────────────────────────────────────────────────

        Примечание

             Функция многократного    вызова    должна     использовать
             соглашения   по  вызову  системы  Паскаль  и  должна  быть
             объявлена как FAR. Эта функция должна иметь следующий вид:

             LPSTR FAR PASCAL WordBreakFunc(lpchEditText,
                                        ichCurrentWord, cchEditText)
             LPSTR lpchEditText;
             short ichCurrentWord;
             short cchEditText;

             Функция WordBreakFunc    здесь     используется     вместо
             фактического   имени   функции   в  прикладной  программе.
             Действительное  имя  должно  быть  экспортируемым,  т.  е.
             описанным  оператором  EXPORTS  в файле определения модуля
             прикладной программы.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             lpchEditText      Указатель на текст редактируемого блока
                               управления.

             ichCurrentWord    Определяет индекс для слова в буфере,
                               которое определяет, с какой точки
                               функция должна начать контроль на
                               прерывание слова.

             cchEditText       Определяет количество байт в
                               редактируемом тексте.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение


       Windows 3.0/Ref/5#7                                       = 62 =

             Возвращаемое значение  представляет  собой  указатель   на
             первый  байт  следующего слова текста редактируемого блока
             управления.  Если текущее слово - последнее слово  текста,
             возвращаемое  значение  указывает на первый байт,  который
             следует за последним словом.

        ───────────────────────────────────────────────────────────────
                                                                               
       EM_UNDO

             Это сообщение   отменяет  последнее  редактирование  блока
             управления.  Когда пользователь модифицирует редактируемый
             блок управления, последнее изменение запоминается в буфере
             отмены,  который динамически растет по необходимости. Если
             для  буфера  остается  мало места,  операция отмены выдает
             ошибку и редактируемый блок управления не изменяется.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Сообщение возвращает  ненулевое  значение,  если  операция
             отмены прошла успешно.  Оно возвращает нуль, если операция
             неудачна.

        ───────────────────────────────────────────────────────────────
                                                                               
       EN_CHANGE

             Этот код определяет, что пользователь предпринял некоторые
             действия,  которые,  возможно, изменили содержимое текста.
             Он посылается  после  того,  как  Windows  откорректировал
             изображение (в  отличие  от кода EN_UPDATE).  Родительское
             окно получает этот код через  сообщение  WM_COMMAND  блока
             управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит параметр wParam сообщения
                               WM_COMMAND и определяет ID блока
                               управления.

             lParam            Младшее слово lParam содержит дескриптор,
                               идентифицирующий редактируемый блок
                               управления. Старшее слово lParam содержит
                               код EN_CHANGE.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 63 =

                                                                               
       EN_ERRSPACE

             Этот код определяет,  что редактируемому блоку  управления
             не хватает  места.  Родительское  окно  получает  этот код
             через сообщение WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит параметр wParam сообщения
                               WM_COMMAND и определяет ID блока
                               управления.

             lParam            Младшее слово lParam содержит дескриптор,
                               идентифицирующий редактируемый блок
                               управления. Старшее слово lParam содержит
                               код EN_ERRSAPCE.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       EN_HSCROLL

             Этот код  показывает,  что  пользователь  нажал  на кнопку
             мыши, находясь   в   горизонтальной    строке    прокрутки
             редактируемого   блока   управления.   Родительское   окно
             получает  этот  код  через  сообщение   WM_COMMAND   блока
             управления.   Перед   корректировкой  экрана  уведомляется
             родительское окно.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит параметр wParam сообщения
                               WM_COMMAND и определяет ID блока
                               управления.

             lParam            Младшее слово lParam содержит дескриптор,
                               идентифицирующий редактируемый блок
                               управления. Старшее слово lParam содержит
                               код EN_HSCROLL.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       EN_KILLFOCUS

             Этот код  определяет,  что  редактируемый  блок управления
             утратил захват ввода.  Родительское окно получает этот код
             через сообщение WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит параметр wParam сообщения
                               WM_COMMAND и определяет ID блока
                               управления.

             lParam            Младшее слово lParam содержит дескриптор,

       Windows 3.0/Ref/5#7                                       = 64 =

                               идентифицирующий редактируемый блок
                               управления. Старшее слово lParam содержит
                               код EN_KILLFOCUS.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       EN_MAXTEXT [3.0]

             Этот код определяет что при текущей вставке был  превышено
             максимально возможное число символов в редактируемом блоке
             управления. Вставка обрезается.  Это сообщение  посылается
             также в том случае,  если редактируемый блок не имеет типа
             ES_AUTOHSCROLL и  вставляемое  число  символов   превышает
             ширину блока.  Родительское  окно  получает этот код через
             сообщение WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит параметр wParam сообщения
                               WM_COMMAND и определяет ID блока
                               управления.

             lParam            Младшее слово lParam содержит дескриптор,
                               идентифицирующий редактируемый блок
                               управления. Старшее слово lParam содержит
                               код EN_MAXTEXT.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       EN_SETFOCUS

             Этот код  показывает,  что  редактируемый  блок управления
             получил захват ввода.  Родительское окно получает этот код
             через сообщение WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит параметр wParam сообщения
                               WM_COMMAND и определяет ID блока
                               управления.

             lParam            Младшее слово lParam содержит дескриптор,
                               идентифицирующий редактируемый блок
                               управления. Старшее слово lParam содержит
                               код EN_SETFOCUS.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       EN_UPDATE

             Этот код показывает,  что  редактируемый  блок  управления
             будет  индицировать  измененный  текст.  Родительское окно
             получает этот  код  через   сообщение   WM_COMMAND   блока

       Windows 3.0/Ref/5#7                                       = 65 =

             управления. Родительское окно уведомляется после того, как
             блок управления сформатировал текст,  но  перед  тем,  как
             этот  текст  отобразится на экране.  Это дает возможность,
             если необходимо, изменить размер окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит параметр wParam сообщения
                               WM_COMMAND и определяет ID блока
                               управления.

             lParam            Младшее слово lParam содержит дескриптор,
                               идентифицирующий редактируемый блок
                               управления. Старшее слово lParam содержит
                               код EN_SETFOCUS.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                      EN_VSCROLL                               

             Этот код  определяет,  что  пользователь  нажал  на кнопку
             мыши, находясь    в    вертикальной    строке    прокрутки
             редактируемого   блока   управления.   Родительское   окно
             получает  этот  код  через  сообщение   WM_COMMAND   блока
             управления.   Перед   корректировкой  экрана  уведомляется
             родительское окно.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит параметр wParam сообщения
                               WM_COMMAND и определяет ID блока
                               управления.

             lParam            Младшее слово lParam содержит дескриптор,
                               идентифицирующий редактируемый блок
                               управления. Старшее слово lParam содержит
                               код EN_SETFOCUS.
             ──────────────────────────────────────────────────────────


        ───────────────────────────────────────────────────────────────


       Windows 3.0/Ref/5#7                                       = 66 =

                                     LB_ADDSTRING                              

             Это сообщение  добавляет  строку в панель перечня.  Если в
             панели  перечня  не   предусмотрена   сортировка,   строка
             добавляется  в  конец  перечня.  В  противном  случае  она
             вставляется в перечень после сортировки.

             Это сообщение удаляет в панели перечня любую выборку.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Длинный указатель на добавляемую строку,
                               завершаемую нулевым символом. Если
                               комбинированный блок управления создан с
                               типом LBS_OWNERDRAW но без указания
                               флага LBS_HASSTRING, lParam содержит
                               32-битовое значение, которое пользо-
                               ватель использует для идентификации
                               элемента и которое сохраняется вместо
                               указателя на строку.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Определяет индекс строки в панели перечня.  Если произошла
             ошибка,  возвращается LB_ERR;  если для запоминания  новой
             строки   недостаточно   места   в   памяти,   возвращается
             LB_ERRSPACE.

        Примечание

             Если комбинированный блок управления был  создан  с  типом
             LBS_SORT но     без    типа    LBS_HASSTRING,    владельцу
             комбинированного блока один или несколько  раз  посылается
             сообщение WM_COMPAREITEM,  чтобы  корректно вставить новый
             элемент в панель перечня.

        ───────────────────────────────────────────────────────────────
                                   LB_DELETESTRING                             

             Это сообщение удаляет строку из панели перечня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс удаляемой строки.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение


       Windows 3.0/Ref/5#7                                       = 67 =

             Возвращаемое значение -  это  число  строк,  оставшихся  в
             панели   перечня.   Если   указан   некорректный   индекс,
             возвращается LB_ERR.

        Примечание

             Если панель перечня была создана с типом LBS_OWNERDRAW  но
             без  указания флага LBS_HASSTRING,  то при удалении строки
             владельцу панели     перечня     посылается      сообщение
             WM_DELETEITEM,  для того, чтобы прикладная программа могла
             освободить  дополнительные  данные,   связанные   с   этим
             элементом  (передается  через  параметр  lParam  сообщений
             LB_ADDSTRING и LB_INSERTSTRING).

        ───────────────────────────────────────────────────────────────
                                        LB_DIR                                 

             Это сообщение   добавляет   перечень  файлов  из  текущего
             каталога к панели  перечня.  Добавляются  только  файлы  с
             атрибутами,     определяемыми    параметром    wParam    и
             отождествленные со спецификацией файла, заданной lParam.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение атрибута DOS. Список
                               атрибутов вы  найдете в описании функции
                               DlgDirList в главе 4, "Список функций".

             lParam            Указывает на строку спецификации файла.
                               Строка может содержать универсальные
                               символы (например, *.*).
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  -  это число отображаемых на экране
             элементов.  Если произошла  ошибка,  возвращается  LB_ERR;
             если  для  запоминания  новых  строк  недостаточно места в
             памяти, возвращается LB_ERRSPACE.

        Примечание

             Возвращаемое значение   сообщения   LB_DIR   меньше,   чем
             возвращаемое значение сообщения LB_GETCOUNT.

        ───────────────────────────────────────────────────────────────
                                 LB_FINDSTRING  [3.0]                          

             Это сообщение  ищет  в  панели  перечня   первую   строку,
             совпадающую с данным префиксом.


       Windows 3.0/Ref/5#7                                       = 68 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс элемента после которого
                               необходимо производить поиск. Когда при
                               поиске достигается конец панели перечня
                               поиск продолжается с начала до элемента,
                               определяемого параметром wParam. Если
                               wParam содержит -1б то поиск выполняется
                               во всей панели перечня с начала до конца.

             lParam            Указывает на строку префикса. Строка
                               должна завершаться нулевым символом.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращается индекс совпадающей строки,  или,  если строка
             не найдена LB_ERR.

        Примечание

             Если панель перечня была создана с типом LBS_OWNERDRAW  но
             без   указания   флага  LBS_HASSTRING,  то  это  сообщение
             возвращает   индекс   элемента,   чье   длинное   значение
             (передается через параметр lParam сообщений LB_ADDSTRING и
             LB_INSERTSTRING) совпадает со значением передаваемым через
             параметр lParam сообщения LB_FINDSTRING.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_GETCOUNT

             Это сообщение возвращает число элементов в панели перечня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   равно  числу  элементов  в  панели
             перечня. При возникновении  ошибки  возвращается  значение
             LB_ERR.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_GETCURSEL

             Это сообщение  возвращает   индекс   текущего   выбранного
             элемента, если он существует, в панели перечня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

       Windows 3.0/Ref/5#7                                       = 69 =


             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Это сообщение   возвращает   индекс   текущего  выбранного
             элемента.  Оно возвращает LB_ERR, если если нет выбранного
             элемента, или  если  панель  перечня  имеет  множественную
             выборку.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_GETHORISONTALEXTENT [3.0]

             Это сообщение возвращает ширину  в  пикселях,  на  сколько
             можно прокрутить   панель  перечня  по  горизонтали,  если
             панель перечня имеет горизонтальную строку прокрутки.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение равно ширине в пикселях,  на которую
             можно прокрутить панель перечня.

        Примечание

             Чтобы панель перечня могла реагировать на данное сообщение
             она должна быть создана  с типом WS_HSCROLL.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_GETITEMDATA [3.0]

             Это сообщение позволяет  получить  связанное  с  элементом
             32-битовое  значение,  передаваемое прикладной программой.
             Если  рисуемая  владельцем  панель  перечня  создана   без
             использования флага LBS_HASSTRING, это 32-битовое значение
             передается через параметр lParam сообщений LB_ADDSTRING  и
             LB_INSERTSTRING.   В   противном   случае   это   значение
             определяемое параметром lParam сообщения LB_SETITEMDATA.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс элемента.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────


       Windows 3.0/Ref/5#7                                       = 70 =

        Возвращаемое значение

             Возвращаемое значение это 32-битовое значение, связанное с
             элементом, или LB_ERR в случае ошибок.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_GETITEMRECT  [3.0]

             Это сообщение позволяет получить  размеры  прямоугольника,
             ограничивающего элемент     панели     перечня,    который
             отображается в окне панели перечня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс элемента.

             lParam            Содержит дальний указатель на структуру
                               данных типа RECT, в которую заносятся
                               размеры элемента в координатах области
                               пользователя.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             В случае возникновения ошибки возвращается LB_ERR.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_GETSEL

             Это сообщение возвращает состояние выборки элемента.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Индекс элемента.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Это сообщение   возвращает   положительное   число,   если
             элементы   выбраны,   и  нуль  в  противном  случае.  Если
             произошла ошибка, то возвращается LB_ERR.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_GETSELCOUNT  [3.0]

             Это сообщение возвращает общее число выбранных элементов в
             панели перечня с множественной выборкой.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

       Windows 3.0/Ref/5#7                                       = 71 =


             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   равно  числу  выбранных  в  панели
             перечня элементов.   Если   панель   перечня   не    имеет
             множественной выборки, возвращается значение LB_ERR.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_GETSELITEMS [3.0]

             Это значение  заполняет  буфер   массивом   целых   чисел,
             определяющих номера   выбранных   в   панели   перечня   с
             множественной выборкой элементов.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет максимальное число элементов,
                               которое можно поместить в буфер.

             lParam            Содержит дальний указатель на буфер,
                               который должен быть достаточно велик для
                               размещения массива целых чисел, размер
                               которого определяется параметром wParam.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   равно  число  помещенных  в  буфер
             элементов.  Если панель  перечня  не  имеет  множественной
             выборки, возвращается значение LB_ERR.

        ───────────────────────────────────────────────────────────────
                                      LB_GETTEXT                               

             Это сообщение копирует в буфер строку из панели перечня.


             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс копируемой строки.

             lParam            Указывает на буфер, в который копируется
                               строка. Буфер должен быть достаточно
                               большим, чтобы в него поместилась строка
                               с завершающим нулевым символом.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение определяет длину  строки  в  байтах,

       Windows 3.0/Ref/5#7                                       = 72 =

             включая завершающий  нулевой символ.  Если wParam содержит
             некорректный индекс, то возвращается значение LB_ERR.

        Примечание

             Если панель  перечня была создана с типом LBS_OWNERDRAW но
             без  указания  флага  LBS_HASSTRING,  то   это   сообщение
             поместит в   буфер,   указываемый    параметром    lParam,
             32-битовое   значение,   которое   пользователь  связал  с
             элементом  (передается  через  параметр  lParam  сообщений
             LB_ADDSTRING и LB_INSERTSTRING).

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_GETTEXTLEN [3.0]

             Это сообщение возвращает длину строки в панели перечня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс строки.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Определяет длину строки в байтах,  за исключением признака
             конца. Если произошла ошибка, то возвращается LB_ERR.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_GETTOPINDEX [3.0]

             Это сообщение возвращает индекс первой  видимой  строки  в
             панели перечня.   В   исходном  положении  первым  видимым
             элементом является элемент  с  индексом  0,  однако  после
             прокрутки панели перечня верхним может стать другой.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  равно  индексу   первого   видимого
             элемента.

        ───────────────────────────────────────────────────────────────
                                   LB_INSERTSTRING                             

             Это сообщение   вставляет   строку   в   панель   перечня.

       Windows 3.0/Ref/5#7                                       = 73 =

             Сортировка не выполняется.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Индекс позиции, с которой вставляется
                               строка. Если  wParam  равен  -1,  строка
                               добавляется в конец перечня.

             lParam            Указывает на завершаемую нулем вставляе-
                               мую строку.  Если  панель перечня создана
                               с типом  LBS_OWNERDRAW  но  без указания
                               флага  LBS_HASSTRING,  lParam   содержит
                               32-битовое значение,             которое
                               пользователь        использует       для
                               идентификации   элемента    и    которое
                               сохраняется вместо указателя на строку.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Содержит индекс позиции,  с  которой  вставляется  строка.
             Если  произошла ошибка,  то возвращается LB_ERR;  если для
             запоминания новой  строки  недостаточно  места  в  памяти,
             возвращается LB_ERRSPACE.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_RESETCONTENT

             Это сообщение  удаляет  все  строки  из  панели  перечня и
             освобождает любую память, выделенную для этих строк.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Если панель  перечня была создана с типом LBS_OWNERDRAW но
             без указания флага LBS_HASSTRING,  то при удалении  каждой
             строки   владельцу   комбинированного   блока   управления
             посылается сообщение WM_DELETEITEM.

        ───────────────────────────────────────────────────────────────
                                   LB_SELECTSTRING                             

             Это сообщение   выбирает   первую  строку  панели  перечня
             совпадающую с указанным префиксом.


       Windows 3.0/Ref/5#7                                       = 74 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс начальной точки поиска.
                               Когда при поиске достигается конец
                               перечня, то  поиск продолжается с начала
                               до определяемого параметром wParam
                               элемента. Если wParam равен -1, поиск
                               строки осуществляется с начала по всему
                               перечню.

             lParam            Указывает на префиксную строку. Строка
                               должна завершаться нулевым символом.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  -  это  индекс выбранного элемента.
             Если произошла  ошибка,  возвращается  LB_ERR,  и  текущая
             выборка не изменяется.

        Примечание

             Это сообщение не может быть использовано с панелью перечня
             имеющую множественную выборку.

             Строка выбирается  только в том случае,  если ее начальные
             знаки (с начальной точки)  отождествляются  со  знаками  в
             префиксной строке.

             Если панель  перечня была создана с типом LBS_OWNERDRAW но
             без  указания  флага  LBS_HASSTRING,  то   это   сообщение
             возвращает   индекс   элемента,   чье   длинное   значение
             (передается через параметр lParam сообщений LB_ADDSTRING и
             LB_INSERTSTRING) совпадает со значением передаваемым через
             параметр lParam сообщения LB_SELECTSTRING.

        ───────────────────────────────────────────────────────────────
                                LB_SETITEMRANGE [3.0]                          

             Это сообщение  выбирает один или несколько последовательно
             расположенных элементов   в   панели   перечня,    имеющей
             множественную выборку.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет каким образом устанавливать
                               выборку. Если wParam не равен 0,
                               выбранные строки подсвечиваются, если
                               wParam равен 0, выборка  и подсветка
                               удаляются, и строка становится
                               невыбранной.

             lParam            Младшее слово lParam содержит индекс
                               первого выбираемого элемента, а старшее
                               слово индекс последнего выбираемого
                               элемента.
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 75 =


        Возвращаемое значение

             В случае возникновения ошибки возвращается LB_ERR.

        Примечание

             Это сообщение  может  использоваться  только  с   панелями
             перечня имеющими множественную выборку.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_SETCOLUMNWIDTH  [3.0]

             Это сообщение посылается  многоколоночной  панели  перечня
             (имеющей тип   LBS_MULTICOLUMN),  и  определяет  ширину  в
             пикселях всех колонок панели перечня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ширину всех колонок в
                               пикселях.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                     LB_SETCURSEL                              

             Это сообщение   выбирает   строку   в   панели  перечня  и
             прокручивает ее для просмотра,  если это необходимо. Когда
             выбирается новая строка,  панель перечня удаляет подсветку
             с ранее выбранной строки.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс строки, которая должна
                               быть выбрана. Если wParam равен -1,
                               устанавливается, что панель перечня не
                               имеет выборки.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Если указан некорректный индекс,  то возвращается значение
             LB_ERR.

        Примечание

             Это сообщение можно использовать только с панелями перечня

       Windows 3.0/Ref/5#7                                       = 76 =

             не имеющими множественной выборки.

        ───────────────────────────────────────────────────────────────
                             LB_SETHORISONTALEXTENT [3.0]                      

             Это сообщение устанавливает ширину в пикселях,  на сколько
             можно  прокрутить  панель  перечня  по  горизонтали,  если
             панель перечня имеет горизонтальную строку прокрутки. Если
             размер панели  перечня   по   горизонтали   меньше   этого
             значения, то  горизонтальная  строка  прокрутки  позволяет
             прокрутить элементы панели перечня  по  горизонтали.  Если
             размер панели перечня больше или равно этому значению,  то
             горизонтальная строка прокрутки отключается.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет число пикселей, на которое
                               можно прокрутить панель перечня по
                               горизонтали.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Чтобы панель перечня могла реагировать на данное сообщение
             она должна быть создана  с типом WS_HSCROLL.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_SETITEMDATA [3.0]

             Это сообщение позволяет связать с элементом панели перечня
             32-битовое значение.   Если   рисуемая  владельцем  панель
             перечня создана без использования флага LBS_HASSTRING, это
             32-битовое значение  заменяет 32-битовое значение,  котоое
             было передано через параметр lParam сообщений LB_ADDSTRING
             и LB_INSERTSTRING.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит индекс элемента.

             lParam            Содержит новое значение, которое
                               связывается с элементом.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             При возникновении ошибки возвращается значение LB_ERR.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 77 =

                                      LB_SETSEL                                

             Это сообщение   выбирает  строку  в  панели  перечня  типа
             множественной выборки.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет способ установки выборки.Если
                               wParam не равен нулю, строка выбирается и
                               подсвечивается; если равен нулю, выборка
                               и подсветка удаляются.

             lParam            Младшее слово lParam - это индекс,
                               определяющий, какая строка должна быть
                               установлена. Если lParam равен -1,
                               выборка устанавливается или снимается со
                               всех строк в перечне, в зависимости от
                               параметра wParam.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Если произошла ошибка, возвращается LB_ERR.

        Примечание

             Это сообщение  должно  использоваться  только  с   панелью
             перечня типа множественной выборки.

        ───────────────────────────────────────────────────────────────
                                 LB_SETTABSTOPS [3.0]                          

             Это сообщение  определяет  позиции  табуляции  для  панели
             перечня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Это целое значение, которое определяет
                               число позиций табуляции в панели перечня.

             lParam            Это дальний указатель на первый элемент
                               массива целых, содержащих позиции
                               табуляции в единицах диалога. (Единицы
                               диалога определяют размеры по горизон-
                               тали и вертикали. Одна горизонтальная
                               единица диалога равна 1/4 текущей
                               базовой единицы диалога. Базовая единица
                               диалога вычисляется на основе вызоты и
                               ширины системного шрифта. Базовую
                               единицу можно определить с помощью
                               функции GetDialogBaseUnits. Эта функция
                               возвращает базовую единицу в пикселях.
                               Позиции табуляции должны быть отсорти-
                               рованы в возростающем порядке. Обратная
                               табуляция не допускается.

       Windows 3.0/Ref/5#7                                       = 78 =

             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Если позиции табуляции установлены  возвращается  TRUE.  В
             противном случае возвращается FALSE.

        Примечание

             Если параметры wParam и lParam равны NULL, то по умолчанию
             позиции табуляции расставляются  через  каждые  2  единицы
             диалога.

             Если wParam  равен  1,  то позиции табуляции расставляются
             через указанное параметром lParam расстояние.

             Если lParam указывает больше  чем  на  одно  значение,  то
             позиции табуляции   устанавливаются   для  числа  позиций,
             определяемого параметром wParam.

             Чтобы панель перечня могла использовать  данное  сообщение
             она должна быть создана с типом LBS_USETABSTOPS.

        ───────────────────────────────────────────────────────────────
                                                                               
       LB_SETTOPINDEX [3.0]

             Это сообщение устанавливает индекс первой видимой строки в
             панели   перечня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет индекс элемента.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             В случае  ошибки возвращается значение LB_ERR.

        ───────────────────────────────────────────────────────────────
                                                                               
       LBN_DBLCLK [3.0]

             Этот код показывает,  что пользователь дважды нажал кнопку
             мыши, находясь на строке панели перечня. Родительское окно
             получает   этот   код  через  сообщение  WM_COMMAND  блока
             управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор

       Windows 3.0/Ref/5#7                                       = 79 =

                               окна редактируемого блока  управления,
                               старшее слово    lParam   содержит   код
                               уведомления LBN_DBLCLK.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение может генерироваться только панелью перечня,
             имеющей тип LBS_NOTIFY.

        ───────────────────────────────────────────────────────────────
                                                                               
       LBN_ERRSPACE [3.0]

             Этот код показывает,  панели перечня не хватает памяти для
             выполнения указанного запроса.  Родительское окно получает
             этот код через сообщение WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор
                               окна панели   перечня,   старшее   слово
                               lParam    содержит    код    уведомления
                               LBN_ERRSPACE.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение может генерироваться только панелью перечня,
             имеющей тип LBS_NOTIFY.

        ───────────────────────────────────────────────────────────────
                                                                               
       LBN_KILLFOCUS [3.0]

             Этот код посылается,  когда панель перечня  теряет  захват
             ввода. Родительское окно получает этот код через сообщение
             WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор
                               окна панели   перечня,   старшее   слово
                               lParam    содержит    код    уведомления
                               LBN_KILLFOCUS.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       LBN_SELCHANGE

             Этот код  показывает,  что  выборка  в панели перечня была

       Windows 3.0/Ref/5#7                                       = 80 =

             изменена. Родительское  окно  получает  этот   код   через
             сообщение WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор
                               окна панели   перечня,   старшее   слово
                               lParam    содержит    код    уведомления
                               LBN_SELCHANGE.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       LBN_SETFOCUS [3.0]

             Этот код посылается,  когда панель перечня получает захват
             ввода. Родительское окно получает этот код через сообщение
             WM_COMMAND блока управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет ID блока управления.

             lParam            Младшее  слово lParam содержит дескриптор
                               окна панели   перечня,   старшее   слово
                               lParam    содержит    код    уведомления
                               LBN_SETFOCUS.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────


       Windows 3.0/Ref/5#7                                       = 81 =

                                     WM_ACTIVATE                               

             Это сообщение  посылается,  когда окно становится активным
             или неактивным.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет новое состояние окна. Он
                               равен нулю, если окно является неактивным.
                               Ниже приводятся ненулевые значения этого
                               параметра, если окно становится активным.

                               Значение  Описание
                               ────────────────────────────────────────
                               1         Окно становится активным при
                                         помощи любого метода, за
                                         исключением нажатия кнопки мыши
                                         (например, с помощью вызова
                                         функции SetActiveWindow или
                                         выборки окна пользователем
                                         через интерфейс клавиатуры).

                               2         Окно становится активным при
                                         помощи нажатия кнопки мыши
                                         пользователем. Может быть
                                         нажата любая кнопка мыши:
                                         правая, левая или средняя.
                               ────────────────────────────────────────

             lParam            Идентифицирует окно и определяет его
                               состояние. Старшее слово параметра lParam
                               не равно нулю, если окно представлено в
                               виде иконы. В противном случае оно равно
                               нулю. Значение младшего слова lParam
                               зависит от значения параметра wParam.
                               Если wParam равен нулю, младшее слово
                               параметра lParam - это дескриптор окна,
                               которое становится активным. Если wParam
                               не равен нулю, то младшее слово параметра
                               lParam - это дескриптор окна, которое
                               становится неактивным (этот дескриптор
                               может быть NULL).
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Если окно,  не являющееся иконой,  становится активным, то
             функция DefWindowProc захватывает для этого окна ввод.

        ───────────────────────────────────────────────────────────────
                                    WM_ACTIVATEAPP                             

             Это сообщение    посылается    в    том    случае,   когда

       Windows 3.0/Ref/5#7                                       = 82 =

             активизируемое окно,  в  отличие  от  текущего  активного,
             принадлежит   другой   прикладной   программе.   Сообщение
             посылается    прикладной    программе,    окно     которой
             активизируется,   и  прикладной  программе,  окно  которой
             переводится в неактивное состояние.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет сделано ли окно активным или
                               неактивным. Ненулевое значение означает,
                               что Windows сделал окно активным; нуль
                               означает, что Windows сделал окно
                               неактивным.

             lParam            Содержит дескриптор задачи прикладной
                               программы. Если параметр wParam равен
                               нулю, младшее слово lParam содержит
                               дескриптор задачи прикладной программы,
                               окно которой переводится в неактивное
                               состояние. Если wParam не равен нулю,
                               младшее слово параметра lParam содержит
                               дескриптор задачи прикладной программы,
                               окно которой становится активным.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_ASKCBFORMATNAME

             Это сообщение посылается,  когда системный буфер  содержит
             дескриптор  данных  для  формата  CF_OWNERDISPLAY (т.  е.,
             владелец  системного  буфера   должен   индицировать   его
             содержимое), и требуется копия имени формата.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет максимальное число копируемых
                               байт.

             lParam            Указывает на буфер, где должна быть
                               сохранена копия имени формата.
             ──────────────────────────────────────────────────────────

        Примечание

             Владелец системного буфера должен скопировать имя  формата
             CF_OWNERDISPLAY  в  заданный  буфер,  не  превышая размера
             буфера.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_CANCELMODE

             Сообщение отменяет  любой из режимов,  в котором находится
             прикладная программа,  например,  такой  как  отслеживание

       Windows 3.0/Ref/5#7                                       = 83 =

             мыши  в  строке  прокрутки  или  перемещение  окна.  Среда
             Windows посылает сообщение WM_CANCELMODE, когда прикладная
             программа отображает панель сообщений.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                   WM_CHANGECBCHAIN                            

             Это сообщение  уведомляет первое окно в цепочке наблюдения
             за системным буфером о том, что окно удаляется из цепочки.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор окна, удаляемого из
                               цепочки наблюдения за системным буфером.

             lParam            Содержит в младшем слове дескриптор окна,
                               следующего за окном, удаляемым из
                               цепочки наблюдения за системным буфером.
             ──────────────────────────────────────────────────────────

        Примечание

             Каждое окно, получившее сообщение WM_CHANGECBCHAIN, должно
             вызвать   функцию   SendMessage   для  передачи  сообщения
             следующему окну в цепочке наблюдения за системным буфером.
             Если следующим окном в цепочке является удаляемое окно, то
             им становится окно,  определяемое младшим словом lParam, и
             сообщение системного буфера должно быть передано ему.

        ───────────────────────────────────────────────────────────────
                                       WM_CHAR                                 

             Это сообщение является  результатом  трансляции  сообщений
             WM_KEYUP  и WM_KEYDOWN.  Оно содержит значение нажатой или
             освобожденной клавиши клавиатуры.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение клавиши.

             lParam            Содержит число повторений, код
                               сканирования, код перехода клавиши,
                               предшествующее состояние клавиши, и код
                               контекста, как показано ниже:


       Windows 3.0/Ref/5#7                                       = 84 =

                               Бит     Описание
                               ────────────────────────────────────────
                               0-15    Число повторений (число нажатий
                                       на клавишу, являющееся
                                       результатом удерживания
                                       пользователем клавиши в нажатом
                                       состоянии).

                               16-23   Код сканирования (значение,
                                       зависящее от OEM).

                               24      Расширенная клавиша, такая как
                                       функциональная или клавиши
                                       числовой клавиатуры (1 - если
                                       расширенная клавиша).

                               25-26   Не используются.

                               27-28   Используется Windows.

                               29      Код контекста (1, если клавиша
                                       Alt удерживается нажатой в то
                                       время, как нажата другая клавиша,
                                       и 0, в противном случае).

                               30      Предыдущее состояние клавиши (1,
                                       если клавиша была нажата перед
                                       тем, как было послано сообщение,
                                       и 0, если клавиша была отпущена).

                               31      Состояние перехода (1, если
                                       клавиша освобождается, и 0, если
                                       клавиша нажимается).
             ──────────────────────────────────────────────────────────

        Примечание

             Поскольку не является необходимым однозначное соответствие
             между   нажатыми  клавишами  и  генерируемыми  символьными
             сообщениями,  информация в старшем слове параметра lParam,
             как  правило,  не  столь полезна для прикладной программы.
             Информация  в  старшем  слове  применима  только  к  самым
             последним  сообщениям  WM_KEYUP  или WM_KEYDOWN перед тем,
             как было послано символьное сообщение.

             В расширенной клавиатуры  IBM  со  101  и  102  клавишами,
             имеются дополнительные   клавиши:  правый  ALT,  и  правый
             CONTROL на  основном  блоке  клавиатуры,  INSERT,  DELETE,
             HOME, PAGEUP, PAGEDOWN и клавиши управления курсором слева
             от числовой клавиатуры,  и клавиши деления (/) и ENTER  на
             числовой клавиатуре.    Бит   расширенных   клавиш   могут
             поддерживать также некоторые другие клавиши.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 85 =

                                 WM_CHARTOITEM [3.0]                           

             Это сообщение посылается владельцу панелью перечня с типом
             LBS_WANTKEYBOARDINPUT, в ответ на сообщение WM_CHAR.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение нажатой пользователем
                               клавиши.

             lParam            В старшем слове содержит позицию псевдо-
                               курсора, а в младшем слове дескриптор
                               окна панели перечня.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   определяет    действие,    которое
             прикладная программа   выполняет  в  ответ  на  сообщение.
             Возвращаемое значение равное -2,  говорит  что  прикладная
             программа  обрабатывает  все аспекты выбранного элемента и
             не  ожидает  дальнейших  действий   от   панели   перечня.
             Возвращаемое значение  равное -1,  показывает,  что панель
             перечня в  ответ  на  нажатие  клавиши  должна   выполнить
             действия по  умолчанию.  Возвращаемое значение равное нулю
             или положительному числу определяет индекс  элемента,  для
             которого панель   перечня  должна  выполнить  действия  по
             умолчанию.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_CHILDACTIVATE

             Это сообщение посылается родительскому окну, когда функция
             SetWindowPos перемещает его дочернее окно.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_CLEAR

             Это сообщение удаляет текущую выборку.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 86 =

                                                                               
       WM_CLOSE

             Это сообщение выдается каждый раз, когда окно закрывается.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Функция DefWindowProc  вызывает  функцию DestroyWindow для
             разрушения окна.

        Примечание

             Прежде чем  разрушить  окно,  прикладная  программа  может
             запросить у    пользователя    подтверждение,    обработав
             сообщение WM_CLOSE и вызвав функцию DestroyWindow только в
             том случае, когда пользователь подтверждает выбор.

        ───────────────────────────────────────────────────────────────
                                      WM_COMMAND                               

             Это сообщение  выдается,   когда   пользователь   выбирает
             элемент меню, когда блок управления передает сообщение его
             родительскому  окну  или   когда   транслируется   клавиша
             ускорения.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит элемент меню, ID блока
                               управления или ID ускорителя.

             lParam            Определяет, откуда пришло сообщение: из
                               меню, от ускорителя или из блока
                               управления. Младшее  слово  содержит 0,
                               если сообщение из меню. Если сообщение
                               от ускорителя, то старшее слово lParam
                               равно 1. Если сообщение из блока
                               управления, то старшее слово lParam
                               содержит код уведомления. Младшее слово
                               содержит дескриптор окна блока
                               управления, посылающего сообщение.
             ──────────────────────────────────────────────────────────

        Примечание

             Клавиши ускорения,   которые   определены   для    выборки

       Windows 3.0/Ref/5#7                                       = 87 =

             элементов  из  системного меню,  транслируются в сообщения
             WM_SYSCOMMAND.

             Если клавиша  ускорения,  соответствующая  элементу  меню,
             нажимается,  когда окно,  имеющее меню,  существует в виде
             иконы,  сообщение WM_COMMAND не посылается.  Однако,  если
             происходит   нажатие   клавиши   ускорения,   которая   не
             соответствует  ни  одному  из  элементов  меню  окна   или
             системного меню,  то сообщение WM_COMMAND посылается, даже
             если окно существует в виде иконы.

        ───────────────────────────────────────────────────────────────
                                 WM_COMPACTING  [3.0]                          

             Это сообщение посылается всем окнам высокого уровня, когда
             Windows определяет,  что за последние 30  или  60  секунд,
             больше чем   12.5   процентов   системного   времени  было
             затрачено на сжатие с уплотнением  системной  памяти.  Это
             сообщение говорит о недостатке системной памяти.

             Когда прикладная  программа  получает  это сообщение,  она
             должна освободить  максимально  возможный  объем   памяти,
             принимая во    внимание   текущее   состояние   активности
             прикладной программы и общее  число  прикладных  программ,
             работающих под  Windows.  Для определения числа работающих
             прикладных программ     можно     использовать     функцию
             GetNumTasks.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет сколько времени центральный
                               процессор тратит  на  сжатие   системной
                               памяти. Например 8000Н представляет 50%.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                 WM_COMPAREITEM [3.0]                          

             Это сообщение  определяет  относительное  положение нового
             элемента в сортируемой панели перечня или  комбинированном
             блоке управления.

             Когда прикладная   программа  добавляет  элемент,  Windows
             посылает это сообщение  владельцу  комбинированного  блока
             управления или  панели перечня (созданным с типом CBS_SORT
             или LBS_SORT).  Параметр lParam этого  сообщения  содержит
             дальний указатель на структуру COMPAREITEMSTRUCT,  которая
             содержит идентификаторы и поставляемые владельцем  данные,
             для двух   элементов  комбинированного  блока  или  панели
             перечня. Когда владелец получает это сообщение,  он должен
             вернуть значение,   которое   определит   какой   из  этих

       Windows 3.0/Ref/5#7                                       = 88 =

             элементов должен  идти  раньше  другого.  Обычно   Windows
             посылает это  сообщение  несколько раз,  пока не определит
             позицию нового элемента.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит дальний указатель на структуру
                               COMPAREITEMSTRUCT, которая содержит
                               идентификаторы и предоставляемые
                               владельцем данные для двух элементов
                               комбинированного блока или панели
                               перечня.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение определяет  позицию  двух  элементов
             относительно друг друга:

             Значение          Описание
             ──────────────────────────────────────────────────────────
             -1                Элемент 1 идет раньше элемента 2.

             0                 Элемент 1 равен элементу 2.

             1                 Элемент 1 идет после элемента 2.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_COPY

             Это сообщение посылает системному буферу текущую выборку в
             формате CF_TEXT.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_CREATE

             Это сообщение  информирует  функцию  окна,  что  она может
             теперь  выполнить  инициализацию.   Функция   CreateWindow
             посылает  это сообщение перед тем,  как осуществить из нее
             возврат и открыть окно.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

       Windows 3.0/Ref/5#7                                       = 89 =


             lParam            Указывает на структуру данных
                               CREATESTRUCT, содержащую копии
                               параметров, передаваемых в функцию
                               CreateWindow.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                     WM_CTLCOLOR                               

             Это сообщение  посылается  родительскому  окну встроенного
             блока управления или панели сообщения при их  отображении.
             Отвечая   на   это   сообщение,  родительское  окно  может
             установить цвета текста и фона дочернего  окна,  используя
             дескриптор   контекста  отображения,  заданный  параметром
             wParam.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор контекста
                               отображения для дочернего окна.

             lParam            Младшее слово параметра lParam содержит
                               дескриптор дочернего окна. Старшее слово
                               может содержать одно из приведенных ниже
                               значений, определяющих тип блока
                               управления:

                    Значение         Блок управления
                    ───────────────────────────────────────────────────
                    CTLCOLOR_BTN     Клавишный блок управления.

                    CTLCOLOR_DLG     Панель диалога.

                    CTLCOLOR_EDIT    Редактируемый блок управления.

                    CTLCOLOR_LISTBOX Блок управления панелью перечня.

                    CTLCOLOR_MSGBOX  Панель сообщения.

                    CTLCOLOR_SCROLLBAR Блок управления строкой
                                     прокрутки.

                    CTLCOLOR_STATIC  Статический блок управления.
             ──────────────────────────────────────────────────────────

        Действие  по  умолчанию.

             Функция DefWindowProc    выбирает   системные   цвета   по
             умолчанию.

        Примечание


       Windows 3.0/Ref/5#7                                       = 90 =

             При обработке сообщения WM_CTLCOLOR  прикладная  программа
             должна настроить начальный адрес кисти на координаты окна,
             вызвав сначала функцию UnrealizeObject для данной кисти, и
             затем  выбрав  в  качестве начального адреса кисти верхний
             левый угол окна.

             Если прикладная    программа    обрабатывает     сообщение
             WM_CTLCOLOR,   она  должна  возвратить  дескриптор  кисти,
             которая будет  использоваться  для  рисования  фона  блока
             управления.  Следует  помнить,  что  неудача  при возврате
             допустимого дескриптора  кисти  приведет  к  неустойчивому
             состоянию среды.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_CUT

             Это сообщение посылает системному буферу текущую выборку в
             формате  CF_TEXT,  а  затем  удаляет выборку из окна блока
             управления.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                     WM_DEADCHAR                               

             Это сообщение является  результатом  трансляции  сообщений
             WM_KEYUP и  WM_KEYDOWN.  Оно  содержит  значение "мертвой"
             клавиши. Мертвая клавиша,  это такая клавиша (как например
             две точки),   которая   комбинируется   с   другими,   для
             формирования символа.  Например символ О с  двумя  точками
             формируется нажатием клавиши с двумя точками и буквы О.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение "мертвой"клавиши.

             lParam            Содержит число повторений, код
                               сканирования, код перехода клавиши,
                               предшествующее состояние клавиши, и код
                               контекста, как показано ниже:

                               Бит     Описание
                               ────────────────────────────────────────
                               0-15    Число повторений (число нажатий
                                       на клавишу, являющееся
                                       результатом удерживания
                                       пользователем клавиши в нажатом
                                       состоянии).

       Windows 3.0/Ref/5#7                                       = 91 =


                               16-23   Код сканирования (значение,
                                       зависящее от OEM).

                               24      Расширенная клавиша, такая как
                                       функциональная или клавиши
                                       числовой клавиатуры (1 - если
                                       расширенная клавиша).

                               25-26   Не используются.

                               27-28   Используется Windows.

                               29      Код контекста (1, если клавиша
                                       Alt удерживается нажатой в то
                                       время, как нажата другая клавиша,
                                       и 0, в противном случае).

                               30      Предыдущее состояние клавиши (1,
                                       если клавиша была нажата перед
                                       тем, как было послано сообщение,
                                       и 0, если клавиша была отпущена).

                               31      Состояние перехода (1, если
                                       клавиша освобождается, и 0, если
                                       клавиша нажимается).
             ──────────────────────────────────────────────────────────

        Примечание

             Сообщение WM_DEADCHAR   обычно   используется  прикладными
             программами для того,  чтобы дать пользователю возможность
             перемещаться обратно    по   каждой   введенной   клавише.
             Например, прикладная программа может выводить  ударение  в
             текущей позиции символа, без смещения псевдокурсора.

             Поскольку не является необходимым однозначное соответствие
             между   нажатыми  клавишами  и  генерируемыми  символьными
             сообщениями,  информация в старшем слове параметра lParam,
             как  правило,  не  столь полезна для прикладной программы.
             Информация  в  старшем  слове  применима  только  к  самым
             последним  сообщениям  WM_KEYUP  или WM_KEYDOWN перед тем,
             как было послано символьное сообщение.

             В расширенной клавиатуры  IBM  со  101  и  102  клавишами,
             имеются дополнительные   клавиши:  правый  ALT,  и  правый
             CONTROL на  основном  блоке  клавиатуры,  INSERT,  DELETE,
             HOME, PAGEUP, PAGEDOWN и клавиши управления курсором слева
             от числовой клавиатуры,  и клавиши деления (/) и ENTER  на
             числовой клавиатуре.    Бит   расширенных   клавиш   могут
             поддерживать также некоторые другие клавиши.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 92 =

                                                                               
       WM_DELETEITEM  [3.0]

             Это сообщение  информирует   владельца   рисуемой   панели
             перечня или  комбинированного блока управления о том,  что
             удаляется элемент панели перечня. Это сообщение посылается
             когда разрушается  панель перечня или комбинированный блок
             управления, или  когда  удаляется  элемент  в   ответ   на
             сообщение LB_DELETEITEM     и     LB_RESETCONTENT,     или
             CB_DELETEITEM и CB_RESETCONTENT.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит дальний указатель на структуру
                               данных DELETEITEMSTRUCT, которая содержит
                               информацию об удаляемом элементе панели
                               перечня.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                      WM_DESTROY                               

             Это сообщение  информирует  окно  о  том,  что  оно  будет
             разрушено.  Функция   DestroyWindow   посылает   сообщение
             WM_DESTROY  окну  после  удаления его с экрана.  Сообщение
             WM_DESTROY посылается родительскому окну, прежде чем будут
             разрушены любые из его дочерних окон.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Если окно,  подлежащее разрущению, является частью цепочки
             наблюдения за системным буфером (устанавливается с помощью
             функции SetClipboardViewer),  оно должно удалить  себя  из
             этой цепочки с помощью вызова функции ChangeClipboardChain
             перед   возвратом   из   процедуры   обработки   сообщения
             WM_DESTROY.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_DESTROYCLIPBOARD

             Это сообщение  посылается  владельцу  системного   буфера,
             когда буфер очищается с помощью функции EmptyClipboard.


       Windows 3.0/Ref/5#7                                       = 93 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_DEVMODECHANGE

             Это сообщение посылается всем окнам верхнего уровня всякий
             раз,  когда   пользователь   изменяет   установки   режима
             устройства.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.
             lParam            Содержит длинный указатель на имя
                               устройства, определенное в файле WIN.INI.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                   WM_DRAWCLIPBOARD                            

             Это сообщение посылается первому окну в цепочке наблюдения
             за  системным  буфером  каждый   раз,   когда   содержимое
             системного буфера изменяется.  В обработке этого сообщения
             нуждаются  только   те   прикладные   программы,   которые
             присоединены  к  цепочке наблюдения за системным буфером с
             помощью функции SetClipboardViewer.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Каждое окно, получившее сообщение WM_DRAWCLIPBOARD, должно
             вызвать  функцию  SendMessage   для   передачи   сообщения
             следующему окну в цепочке наблюдения за системным буфером.
             Дескриптор   следующего   окна    возвращается    функцией
             SetClipboardViewer; он может быть модифицирован в ответ на
             сообщение WM_CHANGECBCHAIN.


        ───────────────────────────────────────────────────────────────
                                  WM_DRAWITEM  [3.0]                           

             Это сообщение  информирует  рисуемую  владельцем  клавишу,
             комбинированный блок  управления,   панель   перечня   или
             элемент меню,   что  изменилось  визуальное  представление
             блока управления. Поле itemAction структуры DRAWITEMSTRUCT

       Windows 3.0/Ref/5#7                                       = 94 =

             определяет выполняемую   операцию.   Это   поле  позволяет
             владельцу блока управления определить  какие  действия  по
             выводу необходимо предпринять.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит дальний указатель на структуру
                               DRAWITEMSTRUCT, которая содержит инфор-
                               мацию о рисуемом элементе и тип необхо-
                               димой операции вывода.
             ──────────────────────────────────────────────────────────

        Примечание

             Перед возвратом управления после обработки этого сообщения
             прикладная программа  должна  восстановить  все   объекты,
             выбранные в контексте устройства,  передаваемом через поле
             hDC структуры DRAWITEMSTRUCT.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_ENABLE

             Это сообщение посылается после того, как окно было сделано
             доступным или недоступным.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет было ли сделано окно
                               доступным или недоступным. Параметр не
                               равен нулю, если окно было сделано
                               доступным и равен нулю, если недоступным.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                    WM_ENDSESSION                              

             Это сообщение   посылается   для   того,   чтобы  сообщить
             прикладной программе,  что на сообщение WM_QUERYENDSESSION
             (действительно  ли заканчивается сеанс работы) был получен
             ненулевой ответ.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет закончился ли сеанс работы.
                               Он не равен нулю, если сеанс закончился.
                               В противном случае он равен нулю.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 95 =


        Примечание

             Если параметр   wParam   не   равен  нулю,  Windows  может
             завершить выполнение в любой момент,  после того,  как все
             прикладные программы  вернули  управление  после обработки
             этого сообщения.  Следовательно прикладные  программы  при
             получении этого сообщения должны выполнить все необходимые
             для завершения операции.

             Прикладной программе нет  необходимости  вызывать  функцию
             DestroyWindow или PostQuitMessage, если сеанс закончился.

        ───────────────────────────────────────────────────────────────
                                     WM_ENTERIDLE                              

             Это сообщение  информирует  функцию  обработки   сообщений
             основного окна  прикладной  программы что модельная панель
             диалога или меню вошли  в  состояние  ожидания.  Модальная
             панель диалога  или меню входят в состояние ожидания когда
             после обработки нескольких сообщений больше нет сообщений,
             ожидающих в очереди.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет кто явился причиной данного
                               сообщения: панель диалога или меню. Он
                               может принимать следующие значения:

                               Значение       Описание
                               ────────────────────────────────────────
                               MSGF_DIALOGBOX Система находится в
                                              состоянии ожидания из-за
                                              панели диалога.

                               MSGF_MENU      Система находится в
                                              состоянии ожидания из-за
                                              меню.
                               ────────────────────────────────────────

             lParam            Содержит в младшем слове дескриптор
                               панели диалога (если wParam равен
                               MSGF_DIALOGBOX), или окна, содержащего
                               отображаемое меню (если параметр wParam
                               равен MSGF_MENU). Старшее слово не
                               используется.
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Функция DefWindowProc возвращает ноль.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                       = 96 =

                                    WM_ERASEBKGND                              

             Это сообщение  посылается,  когда  необходимо  стереть фон
             окна  (например,  когда  изменяются  размеры  окна).   Оно
             посылается   при   подготовке   к  рисованию  некорректной
             области.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Cодержит дескриптор контекста устройства.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Не равно нулю,  если фон стирается. В противном случае оно
             равно  нулю.  Если   прикладная   программа   обрабатывает
             сообщение    WM_ERASEBKGND,    она    должна    возвратить
             соответствующее значение.

        Действие по умолчанию

             Фон стирается,  причем  используется  кисть  фона  класса,
             определяемая полем hbrbackground в структуре класса.

        Примечания

             Если hbrbackground равно NULL, прикладная программа должна
             обработать сообщение WM_ERASEBKGND и  стереть  цвет  фона.
             При обработке сообщения WM_ERASEBKGND прикладная программа
             должна настроить начальный адрес кисти на координаты окна,
             вызвав  сначала UnrealizeObject для данной кисти,  и затем
             выбрать кисть.

             Windows предполагает,  что   фон   установлен   в   режиме
             отображения  MM_TEXT.  Если контекст устройства использует
             какой-либо другой режим отображения,  то стираемая область
             может оказаться вне видимой части области пользователя.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_FONTCHANGE

             Это сообщение  выдается,  когда  изменяется  пул  ресурсов
             шрифта.  Любая прикладная программа, которая добавляет или
             удаляет шрифты из системы  (например,  с  помощью  функций
             AddFontResource  или  RemoveFontResource),  должна послать
             это сообщение всем окнам верхнего уровня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.


       Windows 3.0/Ref/5#7                                       = 97 =

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Для того, чтобы послать сообщение WM_FONTCHANGE всем окнам
             верхнего  уровня,  прикладная  программа   может   вызвать
             функцию  SendMessage  с  параметром hWnd,  установленным в
             шестнадцатиричное значение 0xFFFF.

        ───────────────────────────────────────────────────────────────
                                    WM_GETDLGCODE                              

             Это сообщение посылается подсистемой ведения диалога среды
             Windows  блоку  управления.  Обычно   подсистема   ведения
             диалога  управляет  всеми  клавишами  стрелок  и  клавишей
             табуляции,  служащими для ввода в блок управления. Отвечая
             на  сообщение  WM_GETDLGCODE,  прикладная  программа может
             взять управление над отдельным типом  ввода  и  обработать
             вводимые данные сама.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             При обработке сообщения WM_GETDLGCODE прикладная программа
             должна возвратить одно из следующих значений,  указывающих
             какой тип ввода она будет обрабатывать сама:

             Параметры           Описание
             ──────────────────────────────────────────────────────────
             DLGC_DEFPUSHBUTTON  Альтернативная клавиша по умолчанию.

             DLGC_HASSETSEL      Сообщения EM_SETSEL.

             DLGC_PUSHBUTTON     Альтернативная клавиша.

             DLGC_RADIOBATTON    Клавиша установки.

             DLGC_WANTALLKEYS    Весь ввод с клавиатуры.

             DLGC_WANTARROWS     Клавиши стрелок.

             DLGC_WANTCHARS      Сообщения WM_CHAR.

             DLGC_WANTMESSAGE    Весь ввод с клавиатуры (прикладная
                                 программа передает это сообщение в
                                 блок управления).

       Windows 3.0/Ref/5#7                                       = 98 =


             DLGC_WANTTAB        Клавиша табуляции.
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Функция DefWindowProc возвращает нуль.

        Примечание

             Несмотря на   то,   что   функция   DefWindowProc   всегда
             возвращает  нуль  в  ответ  на  сообщение   WM_GETDLGCODE,
             функции  окон  для  встроенных  классов  блоков управления
             возвращают код, соответствующий каждому классу.

             Сообщение WM_GETDLGCODE и  возвращаемые  значения  полезны
             для    блоков    управления    диалогом,   предоставляемых
             пользователем,  или  для  стандартных  блоков  управления,
             модифицируемых при задании подкласса.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_GETFONT  [3.0]

             Это сообщение  получает  шрифт  который  блок   управления
             использует для вывода текста.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Это дескриптор шрифта, используемого блоком управления или
             NULL, если блок управления использует системный шрифт.

        ───────────────────────────────────────────────────────────────
                                   WM_GETMINMAXINFO                            

             Это сообщение посылается  окну,  когда  Windows  требуется
             знать   максимальный   размер   окна,   максимальный   или
             минимальный размер контура окна.  Максимальный размер окна
             - это размер окна,  когда его границы полностью расширены.
             Максимальный размер контура окна - это  наибольший  размер
             окна,   который  может  быть  достигнут  с  использованием
             границ.  Минимальный размер контура окна - это  наименьший
             размер окна, который может быть достигнут с использованием
             границ.


       Windows 3.0/Ref/5#7                                       = 99 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Указывает на массив из пяти точек,
                               содержащих следующую информацию:

                     Точка     Описание
                     ──────────────────────────────────────────────────
                     rgpt[0]   Используется для внутренних целей
                               Windows.

                     rgpt[1]   Максимальный размер, которым по
                               умолчанию является весь экран.
                               ширина = (SM_CXSCREEN + (2 *
                               SM_CXFRAME)). Высота = (SM_CYSCREEN +
                               (2 * SM_CYFRAME)).

                     rgpt[2]   Максимальная позиция верхнего  левого
                               угла окна (в координатах экрана). По
                               умолчанию значение  x  =  SM_CXFRAME,
                               значение  y  =  SM_CYFRAME.

                     rgpt[3]   Минимальный размер контура, которым по
                               умолчанию является размер иконы.
                               ширина = SM_CXMINTRACK;
                               высота = SM_CYMINTRACK;

                     rgpt[4]   Максимальный размер контура, который
                               меньше, чем размер экрана по умолчанию.
                               Ширина = (SM_CXSCREEN + (2 * SM_CXFRAME)).
                               Высота = (SM_CYSCREEN + (2 * SM_CYFRAME)).
             ──────────────────────────────────────────────────────────

        Примечание

             Массив содержит значения по  умолчанию  для  каждой  точки
             перед     тем,     как    Windows    посылает    сообщение
             WM_GETMINMAXINFO.  Это сообщение предоставляет  прикладной
             программе возможность для изменения значений по умолчанию.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_GETTEXT

             Это сообщение   используется   для   копирования    текста
             соответствующего окна. Для редактируемых блоков управления
             копируемый текст - это содержимое  блока  управления.  Для
             клавишных   блоков  управления  текст  -  это  имя  мягкой
             клавиши. Для других окон текст - это заголовок окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет максимальное число копируемых
                               байт, включая нулевой завершающий символ.


       Windows 3.0/Ref/5#7                                      = 100 =

             lParam            Указывает на буфер, принимающий текст.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Это сообщение возвращает  число  скопированных  байт.  Оно
             равно LB_ERR,   если  не  было  выбранных  элементов,  или
             CB_ERR, если  комбинированный  блок  управления  не  имеет
             редактируемого блока.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_GETTEXTLENGTH

             Это сообщение используется для нахождения длины текста  (в
             байтах),  связанного  с  окном.  Длина не включает нулевой
             завершающий символ.  Для редактируемых  блоков  управления
             текст  -  это  содержимое блока управления.  Для клавишных
             блоков управления текст -  это  имя  мягкой  клавиши.  Для
             других окон текст - это заголовок окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение возвращает длину данного текста.

        ───────────────────────────────────────────────────────────────
                                      WM_HSCROLL                               

             Это сообщение   посылается,  когда  пользователь  нажимает
             кнопку мыши на горизонтальной строке прокрутки.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код строки прокрутки, который
                               определяет запрос пользователя на
                               прокрутку. Он может быть одним из
                               следующих:

                               Значение       Описание
                               ────────────────────────────────────────
                               SB_BOTTOM      Прокрутка до конца вправо.

                               SB_ENDSCROLL   Конец прокрутки.

                               SB_LINEDOWN    Прокрутка на одну строку
                                              вниз.


       Windows 3.0/Ref/5#7                                      = 101 =

                               SB_LINEUP      Прокрутка на одну строку
                                              вверх.

                               SB_PAGEDOWN    Прокрутка на одну страницу
                                              вниз.

                               SB_PAGEUP      Прокрутка на одну страницу
                                              вверх.

                               SB_THUMBPOSITION Прокрутка к абсолютной
                                              позиции. Текущая позиция
                                              содержится в младшем слове
                                              lParam.

                               SB_THUMBTRACK  Бегунок перемещается в
                                              заданную позицию. Текущая
                                              позиция содержится в
                                              младшем слове lParam.

                               SB_TOP         Прокрутка до конца влево.
                               ────────────────────────────────────────

             lParam            Определяет дескриптор окна блока
                               управления. Если сообщение посылается
                               блоку управления строки прокрутки, то
                               старшее слово параметра содержит
                               дескриптор окна блока управления. Если
                               сообщение посылается как результат
                               управления пользователем строкой
                               прокрутки в накладываемом окне, то
                               старшее слово параметра не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Сообщение SB_THUMBTRACK  обычно  используется  прикладными
             программами для того,  чтобы обеспечить некоторую обратную
             связь во время перемещения бегунка.

             Если прикладная  программа  прокручивает  документ в окне,
             она должна также восстановить позицию  бегунка  с  помощью
             функции SetScrollPos.

        ───────────────────────────────────────────────────────────────
                                 WM_HSCROLLCLIPBOARD                           

             Это сообщение посылается,  когда системный буфер  содержит
             дескриптор  данных  для  формата  CF_OWNERDISPLAY (т.  е.,
             владелец  системного  буфера   должен   индицировать   его
             содержимое),  и  произошло событие в горизонтальной строке
             прокрутки  прикладной  программы  -  владельца  системного
             буфера.


       Windows 3.0/Ref/5#7                                      = 102 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор окна прикладной
                               программы - владельца системного буфера.

             lParam            Младшее слово lParam содержит один из
                               следующих кодов строки прокрутки:

                               Значение       Описание
                               ────────────────────────────────────────
                               SB_BOTTOM      Прокрутка до конца вправо.

                               SB_ENDSCROLL   Конец прокрутки.

                               SB_LINEDOWN    Прокрутка на одну строку
                                              вниз.

                               SB_LINEUP      Прокрутка на одну строку
                                              вверх.

                               SB_PAGEDOWN    Прокрутка на одну страницу
                                              вниз.

                               SB_PAGEUP      Прокрутка на одну страницу
                                              вверх.

                               SB_THUMBPOSITION Прокрутка к абсолютной
                                              позиции. Текущая позиция
                                              содержится в младшем слове
                                              lParam.

                               SB_THUMBTRACK  Бегунок перемещается в
                                              заданную позицию. Текущая
                                              позиция содержится в
                                              младшем слове lParam.

                               SB_TOP         Прокрутка до конца влево.
                               ────────────────────────────────────────

                               Старшее слово параметра lParam содержит
                               положение бегунка строки прокрутки, если
                               код равен SB_THUMBPOSITION. В противном
                               случае старшее слово не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Владелец системного  буфера  должен  использовать  функцию
             InvalidateRect   или,   при   необходимости,   осуществить
             перерисовку.  Также  должна  быть  восстановлена   позиция
             строки прокрутки.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                      = 103 =

                                                                               
       WM_ICONERASEBKGND [3.0]

             Это сообщение посылается минимизированному  окну  (окну  в
             виде иконы),  когда  фон иконы должен быть нарисован перед
             выводом иконы. Окно получает это сообщение только если для
             его класса   определена  икона  класса.  Иначе  посылается
             сообщение WM_ERASEBKGND.  Передача этого сообщения функции
             DefWindowProc разрешает   Windows   заполнить  фон  иконы,
             используя кисть фона родительского окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор контекста устройства
                               иконы.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                    WM_INITDIALOG                              

             Это сообщение  посылается  непосредственно перед тем,  как
             панель диалога отображается  на  экране.  Обработка  этого
             сообщения   позволяет   прикладной   программе   выполнить
             необходимую инициализацию перед тем,  как  панель  диалога
             будет сделана видимой.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Идентифицирует первый элемент блока
                               управления в панели диалога, который
                               захватит ввод. Обычно, это первый
                               элемент в панели диалога имеющий тип
                               WS_TABSTOP.

             lParam            Является значением, посланным в качестве
                               параметра dwInitParam функции, если
                               панель диалога создана с помощью одной
                               из следующих функций:

                               - CreateDialogIndirectParam

                               - CreateDialogParam

                               - DialogBoxIndirect

                               - DialogBoxParam

                               Иначе lParam не используется.
             ──────────────────────────────────────────────────────────

        Примечание


       Windows 3.0/Ref/5#7                                      = 104 =

             Если прикладная  программа возвращает ненулевое значение в
             ответ   на   сообщение   WM_INITDIALOG,   среда    Windows
             устанавливает монополию  на  ввод для элемента,  заданного
             wParam. Прикладная программа может возвратить FALSE только
             тогда,  когда  она  устанавливает  монополию  на  ввод для
             одного из блоков управления панели диалога.

        ───────────────────────────────────────────────────────────────
                                     WM_INITMENU                               

             Это сообщение является запросом на инициализацию меню. Оно
             выдается, когда пользователь  перемещает  курсор  мыши  на
             строку меню  и  нажимает  кнопку мыши или нажимает клавишу
             меню.  Среда Windows посылает сообщение перед отображением
             меню  на экране.  Это позволяет прикладной программе перед
             индикацией меню изменять состояние элементов меню.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор меню, которое должно
                               быть инициализировано.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Сообщение WM_INITMENU посылается только в том случае, если
             обращение  к  меню  осуществляется  впервые  и для каждого
             обращения  к  меню  генерируется  только  одно   указанное
             сообщение.  Это  означает,  например,  что при перемещении
             курсора мыши по нескольким элементам  меню  при  постоянно
             нажатой  кнопке  не  будет генерироваться новых сообщений.
             Это сообщение не дает информации об элементах меню.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_INITMENUPOPUP

             Это сообщение  посылается  непосредственно перед тем,  как
             индицируется накладываемое меню. Обработка этого сообщения
             позволяет    прикладной   программе   изменить   состояние
             элементов накладываемого меню перед тем,  как  оно  станет
             видимым без изменения состояния всего меню.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор накладываемого меню.

             lParam            Определяет индекс накладываемого меню.
                               Младшее слово параметра содержит индекс
                               накладываемого меню в основном меню.
                               Старшее слово не равно нулю, если
                               накладываемое меню является системным

       Windows 3.0/Ref/5#7                                      = 105 =

                               меню. В противном случае оно равно нулю.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                      WM_KEYDOWN                               

             Это сообщение  посылается,  когда  нажимается  несистемная
             клавиша.  Несистемная  клавиша  -  это клавиша клавиатуры,
             которая нажата,  когда ненажата клавиша Alt или когда окно
             захватило ввод.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код виртуальной клавиши.

             lParam            Содержит число повторений, код
                               сканирования, код перехода клавиши,
                               предшествующее состояние клавиши, и код
                               контекста, как показано ниже:

                               Бит     Описание
                               ────────────────────────────────────────
                               0-15    Число повторений (число нажатий
                                       на клавишу, являющееся
                                       результатом удерживания
                                       пользователем клавиши в нажатом
                                       состоянии).

                               16-23   Код сканирования (значение,
                                       зависящее от OEM).

                               24      Расширенная клавиша, такая как
                                       функциональная или клавиши
                                       числовой клавиатуры (1 - если
                                       расширенная клавиша).

                               25-26   Не используются.

                               27-28   Используется Windows.

                               29      Код контекста (1, если клавиша
                                       Alt удерживается нажатой в то
                                       время, как нажата другая клавиша,
                                       и 0, в противном случае).

                               30      Предыдущее состояние клавиши (1,
                                       если клавиша была нажата перед
                                       тем, как было послано сообщение,
                                       и 0, если клавиша была отпущена).

                               31      Состояние перехода (1, если
                                       клавиша освобождается, и 0, если
                                       клавиша нажимается).

       Windows 3.0/Ref/5#7                                      = 106 =


                               Для сообщения WM_KEYDOWN код перехода
                               (бит 31) и код контекста (бит 29) равны
                               0.
             ──────────────────────────────────────────────────────────

        Примечание

             Из-за автоповтора  может выдаваться более одного сообщения
             WM_KEYDOWN  прежде,  чем  посылается  сообщение  WM_KEYUP.
             Предыдущее   состояние   клавиши  (30-й  бит)  может  быть
             использовано для определения того,  указывает ли сообщение
             WM_KEYDOWN   переход   в  нажатое  состояние  впервые  или
             повторно.

             В расширенной клавиатуры  IBM  со  101  и  102  клавишами,
             имеются дополнительные   клавиши:  правый  ALT,  и  правый
             CONTROL на  основном  блоке  клавиатуры,  INSERT,  DELETE,
             HOME, PAGEUP, PAGEDOWN и клавиши управления курсором слева
             от числовой клавиатуры,  и клавиши деления (/) и ENTER  на
             числовой клавиатуре.    Бит   расширенных   клавиш   могут
             поддерживать также некоторые другие клавиши.

        ───────────────────────────────────────────────────────────────
                                       WM_KEYUP                                

             Это сообщение посылается,  когда освобождается несистемная
             клавиша.  Несистемная клавиша -  это  клавиша  клавиатуры,
             которая  нажата,  когда  отжата клавиша Alt или когда окно
             захватило ввод.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код виртуальной клавиши.

             lParam            Содержит число повторений, код
                               сканирования, код перехода клавиши,
                               предшествующее состояние клавиши, и код
                               контекста, как показано ниже:

                               Бит     Описание
                               ────────────────────────────────────────
                               0-15    Число повторений (число нажатий
                                       на клавишу, являющееся
                                       результатом удерживания
                                       пользователем клавиши в нажатом
                                       состоянии).

                               16-23   Код сканирования (значение,
                                       зависящее от OEM).

                               24      Расширенная клавиша, такая как
                                       функциональная или клавиши

       Windows 3.0/Ref/5#7                                      = 107 =

                                       числовой клавиатуры (1 - если
                                       расширенная клавиша).

                               25-26   Не используются.

                               27-28   Используется Windows.

                               29      Код контекста (1, если клавиша
                                       Alt удерживается нажатой в то
                                       время, как нажата другая клавиша,
                                       и 0, в противном случае).

                               30      Предыдущее состояние клавиши (1,
                                       если клавиша была нажата перед
                                       тем, как было послано сообщение,
                                       и 0, если клавиша была отпущена).

                               31      Состояние перехода (1, если
                                       клавиша освобождается, и 0, если
                                       клавиша нажимается).

                               Для сообщения WM_KEYUP код перехода
                               (бит 31) равен 1 и код контекста (бит 29)
                               равен 0.
             ──────────────────────────────────────────────────────────

        Примечание

             В расширенной клавиатуры  IBM  со  101  и  102  клавишами,
             имеются дополнительные   клавиши:  правый  ALT,  и  правый
             CONTROL на  основном  блоке  клавиатуры,  INSERT,  DELETE,
             HOME, PAGEUP, PAGEDOWN и клавиши управления курсором слева
             от числовой клавиатуры,  и клавиши деления (/) и ENTER  на
             числовой клавиатуре.    Бит   расширенных   клавиш   могут
             поддерживать также некоторые другие клавиши.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_KILLFOCUS

             Это сообщение  посылается  непосредственно перед тем,  как
             окно теряет захват ввода.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор окна, захватывающего
                               ввод (может быть NULL).

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Если прикладная программа индицировала псевдокурсор,  то в

       Windows 3.0/Ref/5#7                                      = 108 =

             данном месте он должен быть разрушен.

        ───────────────────────────────────────────────────────────────
                                   WM_LBUTTONDBLCLK                            

             Это сообщение выдается,  когда пользователь  нажимает  два
             раза левую кнопку мыши.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение, указывающее нажаты ли
                               различные виртуальные клавиши. Параметр
                               может быть любой  комбинацией следующих
                               значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               MK_CONTROL   Устанавливается, если
                                            нажата клавиша CONTROL.

                               MK_LBUTTON   Устанавливается, если
                                            нажата левая кнопка.

                               MK_MBUTTON   Устанавливается, если
                                            нажата средняя кнопка.

                               MK_RBUTTON   Устанавливается, если
                                            нажата правая кнопка.

                               MK_SHIFT     Устанавливается, если
                                            нажата клавиша SHIFT.
                               ────────────────────────────────────────

             lParam            Содержит координаты x и y курсора мыши.
                               Координата x находится в младшем слове;
                               координата y - в старшем слове. Эти
                               координаты всегда устанавливаются
                               относительно левого верхнего угла окна.
             ──────────────────────────────────────────────────────────

        Примечание

             Сообщения о  двойном  нажатии  на  клавишу  могут получить
             только окна,  класс которых имеет  тип  CS_DBLCLKS.  Среда
             Windows  генерирует сообщение о двойном нажатии на клавишу
             каждый раз, когда пользователь нажимает, отпускает и затем
             снова  нажимает кнопку мыши за время,  отведенное системой
             на двойное нажатие.  Двойное нажатие фактически генерирует
             четыре   сообщения:   сообщение  о  нажатии,  сообщение  о
             освобождении,  сообщение о вторичном нажатии и сообщение о
             последующем освобождении.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                      = 109 =

                                    WM_LBUTTONDOWN                             

             Это сообщение выдается,  когда пользователь нажимает левую
             кнопку мыши.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение, указывающее нажаты ли
                               различные виртуальные клавиши. Параметр
                               может быть любой  комбинацией следующих
                               значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               MK_CONTROL   Устанавливается, если
                                            нажата клавиша CONTROL.

                               MK_MBUTTON   Устанавливается, если
                                            нажата средняя кнопка.

                               MK_RBUTTON   Устанавливается, если
                                            нажата правая кнопка.

                               MK_SHIFT     Устанавливается, если
                                            нажата клавиша SHIFT.
                               ────────────────────────────────────────

             lParam            Содержит координаты x и y курсора мыши.
                               Координата x находится в младшем слове;
                               координата y - в старшем слове. Эти
                               координаты всегда устанавливаются
                               относительно левого верхнего угла окна.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                     WM_LBUTTONUP                              

             Это сообщение  выдается,  когда  пользователь  освобождает
             левую кнопку мыши.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение, указывающее нажаты ли
                               различные виртуальные клавиши. Параметр
                               может быть любой  комбинацией следующих
                               значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               MK_CONTROL   Устанавливается, если
                                            нажата клавиша CONTROL.

                               MK_MBUTTON   Устанавливается, если

       Windows 3.0/Ref/5#7                                      = 110 =

                                            нажата средняя кнопка.

                               MK_RBUTTON   Устанавливается, если
                                            нажата правая кнопка.

                               MK_SHIFT     Устанавливается, если
                                            нажата клавиша SHIFT.
                               ────────────────────────────────────────

             lParam            Содержит координаты x и y курсора мыши.
                               Координата x находится в младшем слове;
                               координата y - в старшем слове. Эти
                               координаты всегда устанавливаются
                               относительно левого верхнего угла окна.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                   WM_MBUTTONDBLCLK                            

             Это сообщение выдается,  когда пользователь  нажимает  два
             раза среднюю кнопку мыши.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение, указывающее нажаты ли
                               различные виртуальные клавиши. Параметр
                               может быть любой  комбинацией следующих
                               значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               MK_CONTROL   Устанавливается, если
                                            нажата клавиша CONTROL.

                               MK_LBUTTON   Устанавливается, если
                                            нажата левая кнопка.

                               MK_MBUTTON   Устанавливается, если
                                            нажата средняя кнопка.

                               MK_RBUTTON   Устанавливается, если
                                            нажата правая кнопка.

                               MK_SHIFT     Устанавливается, если
                                            нажата клавиша SHIFT.
                               ────────────────────────────────────────

             lParam            Содержит координаты x и y курсора мыши.
                               Координата x находится в младшем слове;
                               координата y - в старшем слове. Эти
                               координаты всегда устанавливаются
                               относительно левого верхнего угла окна.
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                      = 111 =


        Примечание

             Сообщения о  двойном  нажатии  на  клавишу  могут получить
             только окна,  класс которых имеет  тип  CS_DBLCLKS.  Среда
             Windows  генерирует сообщение о двойном нажатии на клавишу
             каждый раз, когда пользователь нажимает, отпускает и затем
             снова  нажимает кнопку мыши за время,  отведенное системой
             на двойное нажатие.  Двойное нажатие фактически генерирует
             четыре   сообщения:   сообщение  о  нажатии,  сообщение  о
             освобождении,  сообщение о вторичном нажатии и сообщение о
             последующем освобождении.

        ───────────────────────────────────────────────────────────────
                                    WM_LBUTTONDOWN                             

             Это сообщение  выдается,   когда   пользователь   нажимает
             среднюю кнопку мыши.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение, указывающее нажаты ли
                               различные виртуальные клавиши. Параметр
                               может быть любой  комбинацией следующих
                               значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               MK_CONTROL   Устанавливается, если
                                            нажата клавиша CONTROL.

                               MK_LBUTTON   Устанавливается, если
                                            нажата левая кнопка.

                               MK_RBUTTON   Устанавливается, если
                                            нажата правая кнопка.

                               MK_SHIFT     Устанавливается, если
                                            нажата клавиша SHIFT.
                               ────────────────────────────────────────

             lParam            Содержит координаты x и y курсора мыши.
                               Координата x находится в младшем слове;
                               координата y - в старшем слове. Эти
                               координаты всегда устанавливаются
                               относительно левого верхнего угла окна.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                     WM_MBUTTONUP                              

             Это сообщение  выдается,  когда  пользователь  освобождает
             среднюю кнопку мыши.

       Windows 3.0/Ref/5#7                                      = 112 =


             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение, указывающее нажаты ли
                               различные виртуальные клавиши. Параметр
                               может быть любой  комбинацией следующих
                               значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               MK_CONTROL   Устанавливается, если
                                            нажата клавиша CONTROL.

                               MK_LBUTTON   Устанавливается, если
                                            нажата левая кнопка.

                               MK_RBUTTON   Устанавливается, если
                                            нажата правая кнопка.

                               MK_SHIFT     Устанавливается, если
                                            нажата клавиша SHIFT.
                               ────────────────────────────────────────

             lParam            Содержит координаты x и y курсора мыши.
                               Координата x находится в младшем слове;
                               координата y - в старшем слове. Эти
                               координаты всегда устанавливаются
                               относительно левого верхнего угла окна.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                 WM_MDIACTIVATE [3.0]                          

             Прикладная программа посылает это сообщение  окну  клиенту
             MDI, чтобы  побудить окно клиента активизировать различные
             дочерние окна MDI.  Обрабатывая это сообщение окно  клиент
             MDI посылает    сообщение    WM_MDIACTIVATE   активным   и
             неактивным дочерним окнам.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Когда прикладная программа посылает
                               сообщение WM_MDIACTIVATE, wParam содержит
                               дескриптор дочернего окна, которое нужно
                               активизировать. Когда окно клиент MDI
                               посылает это сообщение дочернему окну,
                               то параметр wParam содержит TRUE для
                               активизируемого окна и FALSE для
                               деактивизируемого.

             lParam            Когда дочернее окно получает это
                               сообщение параметр lParam в старшем слове
                               содержит дескриптор деактивизируемого

       Windows 3.0/Ref/5#7                                      = 113 =

                               окна а в младшем дескриптор активизируе-
                               мого. Когда прикладная программа посылает
                               это сообщение окну клиенту MDI, lParam
                               должен быть NULL.
             ──────────────────────────────────────────────────────────

        Примечание

             Дочерние окна MDI активизируются независимо от окна фрейма
             MDI. Когда  окно фрейма становится активным,  оно посылает
             дочерним окнам,  которые будут впоследствии активизированы
             сообщение WM_NCACTIVATE,  чтобы нарисовать активное окно и
             строку заголовка, но не посылает сообщения WM_MDIACTIVATE.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_MDICASCADE  [3.0]

             Это сообщение расставляет дочерние окна окна клиента MDI,
             каскадом.
             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                  WM_MDICREATE [3.0]                           

             Это сообщение заставляет окно клиента MDI создать дочернее
             окно.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит дальний указатель на структуру
                               данных MDICREATESTRUCT.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение    содержит    в    младшем    слове
             идентификатор дочернего окна а в старшем слове 0.

        Примечания

             Дочернее окно создается с типом WS_CHILD, WS_CLIPSIBLINGS,
             WS_CLIPCHILDREN, WS_SYSMENU,  WS_CAPTION,   WS_THICKFRAME,
             WS_MINIMAZEBOX и WS_MAXIMAZEBOX и плюс дополнительные биты
             типа в структуре  MDICREATESTRUCT,  на  которую  указывает
             параметр lParam.  Windows  добавляет  заголовок  дочернего
             окна к меню окна фрейма.  Все дочерние окна MDI прикладная

       Windows 3.0/Ref/5#7                                      = 114 =

             программа должна создавать с помощью этого сообщения.

             Если окно клиент MDI получает любое сообщение,  изменяющее
             состояние активизации  дочерних  окон,  и   если   текущее
             активное дочернее   окно   MDI   максимизировано,  Windows
             восстанавливает предыдущее  состояние  текущего  активного
             окна и максимизирует новое активное окно.

             При создании  дочернего  окна  MDI,  Windows  посылает ему
             сообщение WM_CREATE.  Параметр  lParam   этого   сообщения
             содержит указатель  на  структуру  CREATESTRUCT.  Параметр
             lpCreateParams этой  структуры   содержит   указатель   на
             структуру MDICREATESTRUCT, которая передается в сообщениии
             WM_MDICREATE при создании дочернего окна.

             Прикладная программа не должна посылать  второе  сообщение
             WM_MDICREATE до тех пор,  пока не будет обработано первое.
             Например вы не  должны  посылать  сообщение  WM_MDICREATE,
             пока дочернее окно MDI обрабатывает сообщение WM_CREATE.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_MDIDESTROY [3.0]

             Это сообщение посылается  окну  клиенту  MDI,  и  вызывает
             закрытие дочернего окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             lParam            Содержит дескриптор дочернего окна.

             wParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение удаляет заголовок  дочернего  окна  из  окна
             фрейма и  деактивизирует дочернее окно.  Все дочерние окна
             прикладная программа  должна  закрывать  с  помощью  этого
             сообщения.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_MDIGETACTIVE [3.0]

             Это сообщение возвращает текущее  активное  дочернее  окно
             MDI, а также флаг,  говорящий о том,  максимизировано окно
             или нет.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                      = 115 =


        Возвращаемое значение

             Возвращаемое значение  содержит в младшем байте дескриптор
             активного дочернего окна MDI.  Если  окно  максимизировано
             старшее слово содержит 1, иначе ноль.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_MDIICONARRANGE [3.0]

             Это сообщение посылается окну клиенту MDI для того,  чтобы
             оно расставило  минимизированные дочерние окна документов.
             Оно не влияет на не минимизированные дочерние окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                 WM_MDIMAXIMAZE [3.0]                          

             Это сообщение заставляет окно клиента MDI  максимизировать
             дочернее окно MDI. При максимизации дочернего окна Windows
             делает так, что оно занимает всю область пользователя окна
             клиента MDI.  Windows  помещает  системное  меню дочернего
             окна в строку меню окна клиента  MDI,  чтобы  пользователь
             мог его  восстановить  или  закрыть  и добавляет заголовок
             дочернего окна к заголовку окна фрейма.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит идентификатор дочернего окна.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Если окно клиент MDI получает любое сообщение,  изменяющее
             состояние активизации  дочерних  окон,  и   если   текущее
             активное дочернее   окно   MDI   максимизировано,  Windows
             восстанавливает предыдущее  состояние  текущего  активного
             окна и максимизирует новое активное окно.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_MDINEXT [3.0]

             Это сообщение активизирует следующее  дочернее  окно  MDI,
             лежащее сразу  под  текущим  активным  окном,  и  помещает
             текущее активное окно под все дочерние окна.

       Windows 3.0/Ref/5#7                                      = 116 =


             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Если окно клиент MDI получает любое сообщение,  изменяющее
             состояние активизации  дочерних  окон,  и   если   текущее
             активное дочернее   окно   MDI   максимизировано,  Windows
             восстанавливает предыдущее  состояние  текущего  активного
             окна и максимизирует новое активное окно.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_MDIRESTORE [3.0]

             Это сообщение восстанавливает состояние дочернее окно MDI,
             к его  предыдущему  состоянию,  после  того,  как оно было
             максимизировано или минимизировано.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             lParam            Содержит идентификатор дочернего окна.

             wParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                 WM_MDIRESTORE [3.0]                           

             Это сообщение заменяет меню окна фрейма MDI, накладываемое
             меню Window или оба.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит в младшем слове дескриптор
                               нового меню окна фрейма, а в старшем
                               слове дескриптор нового накладываемого
                               меню Window. Если одно из слов равно
                               нулю, то соответствующее меню не
                               изменяется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   содержит   дескриптор   меню  окна
             фрейма, замененного на новое этим сообщением.


       Windows 3.0/Ref/5#7                                      = 117 =

        Примечание

             После посылки этого сообщения прикладная программа  должна
             вызвать функцию  DrawMenuBar,  чтобы  перерисовать  строку
             меню.

             Если это сообщение  заменяет  накладываемое  меню  Window,
             элементы дочерних  окон  MDI удаляются из предыдущего меню
             Window, и добавляются к новому меню.

             Если дочернее  окно  MDI  было   максимизировано   и   это
             сообщение заменяет меню окна фрейма MDI, то системное меню
             и блоки   управления    восстановлением    удаляются    из
             предыдущего меню и добавляются к новому.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_MDITILE [3.0]

             Это сообщение  заставляет  окно  клиента  MDI   расставить
             дочерние окна встык.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                 WM_MEASUREITEM [3.0]                          

             Это сообщение   посылается   владельцу  рисуемой  клавиши,
             комбинированного блока управления, панели перечня или меню
             при создании   блока   управления.   При  получении  этого
             сообщения владелец заполняет структуру данных MEASUREITEM,
             указатель на  которую  содержится  в  параметре lParam,  и
             возвращает управление.  Таким образом вы сообщаете Windows
             размеры блока   управления.   Если   панель   перечня  или
             комбинированный блок  управления  были  созданы  с   типом
             LBS_OWNERDRAWVARIABLE или    CBS_OWNERDRAWVARIABLE,    это
             сообщение посылается владельцу для каждого элемента. Иначе
             это сообщение посылается только один раз.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит дальний указатель на структуру
                               MEASUREITEMSTRUCT, которая содержит
                               размеры рисуемого блока управления.
             ──────────────────────────────────────────────────────────

        Примечание

       Windows 3.0/Ref/5#7                                      = 118 =


             Windows посылает сообщение WM_MEASUREITEM владельцу  блока
             управления перед посылкой сообщения WM_INITDIALOG.

        ───────────────────────────────────────────────────────────────
                                     WM_MENUCHAR                               

             Это сообщение посылается,  когда пользователь нажимает  на
             клавишу  символа  ускорителя меню,  не соответствующего ни
             одному из предопределенных ускорителей в текущем меню. Оно
             посылается в окно, владеющее меню.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение в коде ASCII нажатого
                               пользователем символа.

             lParam            Содержит дополнительную информацию.
                               Старшее слово содержит дескриптор
                               выбранного меню. Младшее слово содержит
                               флаг MF_POPUP, если меню накладываемого
                               типа. Оно содержит флаг MF_SYSMENU, если
                               меню является системным.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Старшее слово содержит один из следующих кодов команд:

             Код               Описание
             ──────────────────────────────────────────────────────────
             0                 Информирует Windows, что нужно сбросить
                               символ, который пользователь нажал; и
                               выдает короткий сигнал на системном
                               громкоговорителе.

             1                 Информирует Windows, что нужно закрыть
                               текущее меню.

             2                 Информирует Windows, что младшее слово
                               возвращаемого значения содержит номер
                               заданного элемента меню. Этот элемент
                               выбран Windows.
             ──────────────────────────────────────────────────────────

             Младшее слово игнорируется,  если старшее слово содержит 0
             или   1.  Прикладные  программы  должны  обрабатывать  это
             сообщение,  когда  ускорители  используются  для   выборки
             растров, расположенных в меню.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                      = 119 =

                                    WM_MENUSELECT                              

             Это сообщение  появляется,  когда  пользователь   выбирает
             элемент меню.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Идентифицирует выбранный элемент. Если
                               это элемент меню, wParam содержит
                               идентификатор элемента меню. Если это
                               накладываемое меню, wParam содержит
                               дескриптор накладываемого меню.

             lParam            Младшее слово содержит комбинацию
                               следующих флагов меню:

                               Значение     Описание
                               ────────────────────────────────────────
                               MF_BITMAP    Злементом является растр.

                               MF_CHECKED   Злемент выбран.

                               MF_DISABLED  Элемент запрещен.

                               MF_GRAYED    Элемент серого цвета.

                               MF_MOUSESELECT Элемент был выбран с
                                            помощью мыши.

                               MF_OWNERDRAW Элемент рисуемый владельцем.

                               MF_POPUP     Элемент содержит
                                            накладываеме меню.

                               MF_SYSMENU   Элемент содержит системное
                                            меню. Старшее слово
                                            идентифицирует меню,
                                            связанное с этим сообщением.
             ──────────────────────────────────────────────────────────

        Примечание

             Если младшее слово параметра lParam содержит -1  а  wParam
             содержит 0, Windows закрывает меню, поскольку пользователь
             нажал Esc или клавишу мыши вне меню.

        ───────────────────────────────────────────────────────────────
                                   WM_MOUSEACTIVATE                            

             Это сообщение   появляется,   когда   курсор  находится  в
             неактивном окне,  и нажата клавиша мыши. Родительское окно
             получает это сообщение,  только если дочернее передаст его
             функции DefWindowProc.


       Windows 3.0/Ref/5#7                                      = 120 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор самого верхнего
                               родительского окна, которое будет
                               активизировано.

             lParam            Содержит код области тестирования на
                               совпадение в младшем слове и номер
                               сообщения мыши в старшем слове.
                               Тестирование на совпадение - это
                               тестирование, определяющее положение
                               курсора.
             ──────────────────────────────────────────────────────────

        Примечание

             Функция DefWindowProc передает это сообщение родительскому
             окну,  когда  доступна любая обработка.  Если родительское
             окно возвращает TRUE, обработка останавливается.

             Перечень кодов области тестирования на совпадение приведен
             в описании  сообщения  WM_NCHITTEST,  таблице  6.2,  "Коды
             области тестирования".

        ───────────────────────────────────────────────────────────────
                                     WM_MOUSEMOVE                              

             Это сообщение   выдается,  когда  пользователь  перемещает
             мышь.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение, указывающее нажаты ли
                               различные виртуальные клавиши. Параметр
                               может быть любой  комбинацией следующих
                               значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               MK_CONTROL   Устанавливается, если
                                            нажата клавиша CONTROL.

                               MK_LBUTTON   Устанавливается, если
                                            нажата левая кнопка.

                               MK_MBUTTON   Устанавливается, если
                                            нажата средняя кнопка.

                               MK_RBUTTON   Устанавливается, если
                                            нажата правая кнопка.

                               MK_SHIFT     Устанавливается, если
                                            нажата клавиша SHIFT.
                               ────────────────────────────────────────

       Windows 3.0/Ref/5#7                                      = 121 =


             lParam            Содержит координаты x и y курсора мыши.
                               Координата x находится в младшем слове;
                               координата y - в старшем слове. Эти
                               координаты всегда устанавливаются
                               относительно левого верхнего угла окна.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

        Примечание

             Для преобразования  параметра  lParam  в  структуру  POINT
             может быть использована макрокоманда MAKEPOINT.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_MOVE

             Это сообщение посылается, при перемещении окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит новое положение верхнего левого
                               угла области пользователя в окне. Новое
                               положение дается в координатах экрана
                               для перекрываемых и накладываемых окон и
                               в координатах области пользователя
                               родительского окна для дочерних окон.
                               Координата x находится в младшем слове, а
                               координата y - в старшем слове.
             ──────────────────────────────────────────────────────────


        ───────────────────────────────────────────────────────────────
                                    WM_NCACTIVATE                              

             Это сообщение  посылается окну,  когда необходимо изменить
             не  принадлежащую  пользователю  область   для   индикации
             активного или неактивного состояния.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет, когда строка заголовка или
                               икона нуждаются в изменении для
                               индикации активного/неактивного
                               состояния. Он не равен нулю, если должны
                               быть нарисованы активные заголовок или
                               икона и равен нулю для неактивных
                               заголовка или иконы.

             lParam            Не используется.

       Windows 3.0/Ref/5#7                                      = 122 =

             ──────────────────────────────────────────────────────────

        Действие по  умолчанию

             Функция DefWindowProc рисует серую  строку  заголовка  для
             неактивного  окна  и черную строку заголовка для активного
             окна.

        ───────────────────────────────────────────────────────────────
                                    WM_NCCALCSIZE                              

             Это сообщение   посылается,   когда  необходимо  вычислить
             размер области пользователя окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Длинный указатель на структуру данных
                               типа RECT, содержащую координаты
                               прямоугольника окна (включая область
                               пользователя, окантовку, заголовок,
                               строки прокрутки и т.д.) в координатах
                               экрана.
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Функция DefWindowProc    вычисляет     размеры     области
             пользователя, основываясь на характеристиках окна (наличие
             строк прокрутки,  меню и  т.д.)  и  помещает  результат  в
             структуру данных типа RECT.

        ───────────────────────────────────────────────────────────────
                                     WM_NCCREATE                               

             Это сообщение посылается перед сообщением WM_CREATE, когда
             окно создается впервые.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Дескриптор создаваемого окна.

             lParam            Длинный указатель на структуру данных
                               типа CREATESTRUCT для этого окна.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Это сообщение    возвращает   ненулевое   значение,   если
             создается  не  принадлежащая  пользователю  область.  Если
             происходит  ошибка,  возвращаемое  значение равно нулю;  в
             этом случае функция CreateWindow возвратит NULL.

       Windows 3.0/Ref/5#7                                      = 123 =


        Действие по умолчанию

             Инициализируются строки   прокрутки   (устанавливается  ее
             позиция  и  диапазон)  и   устанавливается   текст   окна.
             Отводится  локальная  память  для  создания и обслуживания
             окна.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_NCDESTROY

             Это сообщение информирует окно о том, что не принадлежащая
             пользователю  область  разрушается.  Оно  посылается  окну
             функцией   DestroyWindow   после   сообщения   WM_DESTROY.
             Сообщение  используется  для  разрушения отведенного блока
             памяти, связанного с окном.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Действие по умолчанию.

             Освобождается память, выделенная окну.

        ───────────────────────────────────────────────────────────────
                                     WM_NCHITTEST                              

             Это сообщение посылается  окну,  содержащему  курсор  мыши
             (если только  окно  захватило  ввод  от  мыши) каждый раз,
             при каждом перемещении мыши.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Содержит координаты x и y курсора мыши.
                               Координата x располагается в младшем
                               слове; координата y - в старшем слове.
                               Эти координаты всегда являются
                               координатами экрана.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  функции  DefWindowProc  -  одно  из
             приведенных в таблице 6.2  значений,  указывающих  позицию
             курсора мыши.


       Windows 3.0/Ref/5#7                                      = 124 =

             Таблица 6.2, "Коды области тестирования".
             ──────────────────────────────────────────────────────────
             Значение          Описание
             ──────────────────────────────────────────────────────────
             HTBOTTOM          На нижней горизонтальной границе окна.

             HTBOTTOMLEFT      В левом нижнем углу границы окна.

             HTBOTTOMRIGHT     В правом нижнем углу границы окна.

             HTCAPTION         В области заголовка.

             HTCLIENT          В области пользователя.

             HTERROR           То же, что и HTNOWHERE за исключением
                               того, что функция DefWindowProc выдает
                               системный  звуковой  сигнал для указания
                               ошибки.

             HTGROWBOX         В панели размера.

             HTHSCROLL         На горизонатальной строке прокрутки.

             HTLEFT            На левой границе окна.

             HTMENU            В области меню.

             HTNOWHERE         На фоне экрана или на разделительной
                               линии между окнами.

             HTREDUCE          В панели минимизации.

             HTRIGHT           На правой границе окна.

             HTSIZE            То же, что и HTGROWBOX.

             HTSYSMENU         В  панели системного меню (панель
                               закрытия в дочерних окнах).

             HTTOP             На верхней горизонтальной границе окна.

             HTTOPLEFT         В верхнем левом углу границы окна.

             HTTOPRIGHT        В верхнем правом углу границы окна.

             HTTRANSPARENT     В окне, в настоящее время перекрытом
                               другим окном.

             HTVSCROLL         На вертикальной строке прокрутки.

             HTZOOM            В панели максимизации.
             ──────────────────────────────────────────────────────────

        Примечание

       Windows 3.0/Ref/5#7                                      = 125 =


             Для преобразования параметра lParam в структуру типа POINT
             может быть использована макрокоманда MAKEPOINT.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_NCLBUTTONDBLCLK

             Это сообщение посылается  окну,  когда  дважды  нажимается
             левая  кнопка  мыши  в то время,  когда курсор находится в
             области окна, не принадлежащей пользователю.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код, возвращаемый  сообщением
                               WM_NCHITTEST (смотрите описание этого
                               сообщения).

             lParam            Указатель на структуру данных типа
                               POINT, которая содержит координаты x и y
                               положения курсора. Эти координаты всегда
                               даются относительно верхнего левого угла
                               экрана.
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Если это нужно, посылается сообщение WM_SYSCOMMAND.

        ───────────────────────────────────────────────────────────────
                                   WM_NCLBUTTONDOWN                            

             Это сообщение  посылается  окну,  когда  нажимается  левая
             кнопка  мыши в то время,  когда курсор находится в области
             окна, не принадлежащей пользователю.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код, возвращаемый  сообщением
                               WM_NCHITTEST (смотрите описание этого
                               сообщения).

             lParam            Указатель на структуру данных типа
                               POINT, которая содержит координаты x и y
                               положения курсора. Эти координаты всегда
                               даются относительно верхнего левого угла
                               экрана.
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Если это нужно, посылается сообщение WM_SYSCOMMAND.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                      = 126 =

                                                                               
       WM_NCLBUTTONUP

             Это сообщение посылается окну,  когда  левая  кнопка  мыши
             отпускается в тот момент, когда курсор находится в области
             окна, не принадлежащей пользователю.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код, возвращаемый  сообщением
                               WM_NCHITTEST (смотрите описание этого
                               сообщения).

             lParam            Указатель на структуру данных типа
                               POINT, которая содержит координаты x и y
                               положения курсора. Эти координаты всегда
                               даются относительно верхнего левого угла
                               экрана.
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Если это нужно, посылается сообщение WM_SYSCOMMAND.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_NCMBUTTONDBLCLK

             Это сообщение посылается  окну,  когда  дважды  нажимается
             средняя  кнопка мыши в то время,  когда курсор находится в
             области окна, не принадлежащей пользователю.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код, возвращаемый  сообщением
                               WM_NCHITTEST (смотрите описание этого
                               сообщения).

             lParam            Указатель на структуру данных типа
                               POINT, которая содержит координаты x и y
                               положения курсора. Эти координаты всегда
                               даются относительно верхнего левого угла
                               экрана.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_NCMBUTTONDOWN

             Это сообщение посылается окну,  когда  нажимается  средняя
             кнопка  мыши в то время,  когда курсор находится в области
             окна, не принадлежащей пользователю.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код, возвращаемый  сообщением

       Windows 3.0/Ref/5#7                                      = 127 =

                               WM_NCHITTEST (смотрите описание этого
                               сообщения).

             lParam            Указатель на структуру данных типа
                               POINT, которая содержит координаты x и y
                               положения курсора. Эти координаты всегда
                               даются относительно верхнего левого угла
                               экрана.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_NCMBUTTONUP

             Это сообщение посылается окну,  когда средняя кнопка  мыши
             отпускается в тот момент, когда курсор находится в области
             окна, не принадлежащей пользователю.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код, возвращаемый  сообщением
                               WM_NCHITTEST (смотрите описание этого
                               сообщения).

             lParam            Указатель на структуру данных типа
                               POINT, которая содержит координаты x и y
                               положения курсора. Эти координаты всегда
                               даются относительно верхнего левого угла
                               экрана.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                    WM_NCMOUSEMOVE                             

             Это сообщение   посылается   окну,   когда   курсор   мыши
             перемещается    в    области    окна,   не   принадлежащей
             пользователю.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код, возвращаемый  сообщением
                               WM_NCHITTEST (смотрите описание этого
                               сообщения).

             lParam            Указатель на структуру данных типа
                               POINT, которая содержит координаты x и y
                               положения курсора. Эти координаты всегда
                               даются относительно верхнего левого угла
                               экрана.
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Если это нужно, посылается сообщение WM_SYSCOMMAND.

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                      = 128 =

                                                                               
       WM_NCPAINT

             Это сообщение   посылается    окну,    когда    необходимо
             перерисовать его рамку.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Функция DefWindowProc рисует рамку окна.

        Примечание

             Прикладная программа  может  перехватить  это  сообщение и
             нарисовать свою собственную заказную рамку  окна.  Однако,
             необходимо  помнить,  что  область  отсечения  окна всегда
             является прямоугольной, даже если форма рамки изменяется.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_NCRBUTTONDBLCLK

             Это сообщение посылается  окну,  когда  дважды  нажимается
             правая  кнопка  мыши в то время,  когда курсор находится в
             области окна, не принадлежащей пользователю.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код, возвращаемый  сообщением
                               WM_NCHITTEST (смотрите описание этого
                               сообщения).

             lParam            Указатель на структуру данных типа
                               POINT, которая содержит координаты x и y
                               положения курсора. Эти координаты всегда
                               даются относительно верхнего левого угла
                               экрана.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_NCRBUTTONDOWN

             Это сообщение посылается  окну,  когда  нажимается  правая
             кнопка  мыши в то время,  когда курсор находится в области
             окна, не принадлежащей пользователю.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код, возвращаемый  сообщением
                               WM_NCHITTEST (смотрите описание этого

       Windows 3.0/Ref/5#7                                      = 129 =

                               сообщения).

             lParam            Указатель на структуру данных типа
                               POINT, которая содержит координаты x и y
                               положения курсора. Эти координаты всегда
                               даются относительно верхнего левого угла
                               экрана.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_NCRBUTTONUP

             Это сообщение посылается окну,  когда правая  кнопка  мыши
             отпускается в тот момент, когда курсор находится в области
             окна, не принадлежащей пользователю.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код, возвращаемый  сообщением
                               WM_NCHITTEST (смотрите описание этого
                               сообщения).

             lParam            Указатель на структуру данных типа
                               POINT, которая содержит координаты x и y
                               положения курсора. Эти координаты всегда
                               даются относительно верхнего левого угла
                               экрана.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                    WM_NEXTDLGCTL                              

             Это сообщение посылается функции окна панели диалога смене
             захвата  ввода  блоком управления.  Эффект этого сообщения
             отличается  от  действия  сообщения,  которое   посылается
             функцией SetFocus, т.к. WM_NEXTDLGCTL модифицирует границы
             вокруг клавиши по умолчанию.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Если параметр lParam не равен нулю, то
                               параметр wParam идентифицирует блок
                               управления, получающий захват ввода. Если
                               параметр lParam равен нулю, то wParam
                               содержит флаг, который определяет,
                               следующий или предыдущий блок управления
                               типа WS_TABSTOP получает захват ввода.
                               Если параметр wParam равен нулю,то
                               захватит ввод следующий блок управления;
                               в противном случае, предшествующий блок
                               упраления получит захват ввода.

             lParam            Содержит флаг, который определяет, как

       Windows 3.0/Ref/5#7                                      = 130 =

                               Windows использует параметр wParam. Если
                               lParam не равен нулю, параметр wParam
                               содержит дескриптор соответствующего
                               блока управления, который получит захват
                               ввода; в противном случае wParam содержит
                               флаг, который определяет, что захватил
                               ввод следующий или предыдущий блок
                               управления типа WS_TABSTOP.
             ──────────────────────────────────────────────────────────

        Примечание

             Не используйте  функцию  SendMessage для посылки сообщения
             WM_NEXTDLGCTL, если прикладная программа будет параллельно
             обрабатывать  другие сообщения,  которые захватывают ввод.
             Вместо этого используйте функцию PostMessage.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_PAINT

             Это сообщение выдается каждый раз, когда среда Windows или
             прикладная программа делает запрос  на  перерисовку  части
             окна прикладной программы. Сообщение посылается при вызове
             функции UpdateWindow или функцией  DispatchMessage,  когда
             программа получает  сообщение WM_PAINT,  используя функцию
             GetMessage или PeekMessage.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                  WM_PAINTCLIPBOARD                            

             Это сообщение  посылается,  когда системный буфер содержит
             дескриптор данных  для  формата  CF_OWNERDISPLAY  (т.  е.,
             владелец   системного   буфера   должен  индицировать  его
             содержимое), и область пользователя программы Clipboard  -
             нуждается в   перерисовке.   Сообщение   WM_PAINTCLIPBOARD
             посылается  владельцу  системного   буфера   для   запроса
             перерисовки  всей  или  только  части области пользователя
             программы Clipboard

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содкржит дескриптор окна программы
                               Clipboard.

             lParam            Младшее слово параметра lParam
                               идентифицирует структуру данных

       Windows 3.0/Ref/5#7                                      = 131 =

                               PAINTSTRUCT, определяющую, какая часть
                               области пользователя должна быть
                               перерисована. Старшее слово не
                               используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Для определения   того,   перерисовывать  ли  всю  область
             пользователя или  только  ее  часть,  владелец  системного
             буфера должен сравнить размеры области рисования, заданные
             полем  rcpaint   структуры   PAINTSTRUCT,   с   размерами,
             заданными последним сообщением WM_SIZECLIPBOARD.

             Прикладная программа     должна    использовать    функцию
             GlobalLock для  блокировки  памяти,  содержащей  структуру
             данных    PAINTSTRUCT,    и   функцию   GlobalUnlock   для
             разблокировки этой памяти перед завершением  своей  работы
             или передачей управления.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_PAINTICON [3.0]

             Это сообщение посылается минимизированному  окну  (окну  в
             виде иконы),  когда  должна быть перерисована икона.  Окно
             получить это сообщение только  если  для  него  определена
             икона класса.  В  противном  случае  посылается  сообщение
             WM_PAINT. Передача этого сообщения  функции  DefWindowProc
             вызовет вывод иконы класса.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_PALETTECHANGED [3.0]

             Это сообщение  информирует  все  окна,  что  окно  имеющее
             захват ввода  реализовало  свою  логическую  палитру,  что
             привело таким  образом к изменению системной палитры.  Это
             сообщение позволяет окнам,  не  имеющим  захват  ввода  но
             использующим палитры реализовать свои логические палитры и
             модифицировать их области пользователя.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор окна, которое
                               изменяет системную палитру.

             lParam            Не используется.

       Windows 3.0/Ref/5#7                                      = 132 =

             ──────────────────────────────────────────────────────────

        Примечание

             Чтобы исключить  возникновение  бесконечного  цикла,  окно
             перед реализацией  палитры  должно  проверить,  не  его ли
             дескриптор содержится в параметре lParam.

        ───────────────────────────────────────────────────────────────
                                WM_PARENTNOTIFY [3.0]                          

             Это сообщение  посылается  родительскому окну при создании
        или разрушении дочернего окна,  или когда пользователь нажимает
        клавишу мыши,  когда  курсор  находится  в  дочернем окне.  При
        создании дочернего    окна,    Windows    посылает    сообщение
        WM_PARENTNOTIFY перед   тем,  когда  функции  CreateWindow  или
        CreateWindowExt вернут  управление  после  создания  окна.  При
        разрушении дочернего  окна  Windows  посылает  сообщение  перед
        любой обработкой, которая имеет место при разрушении окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет событие о котором уведомляется
                               дочернее окно. Это может быть одно из
                               следующих значений:

                               Значение       Описание
                               ────────────────────────────────────────
                               WM_CREATE      Создается дочернее окно.

                               WM_DESTROY     Разрушается дочернее окно.

                               WM_LBUTTONDOWN Пользователь нажал
                               WM_MBUTTONDOWN клавишу мыши в дочернем
                               WM_RBUTTONDOWN окне.
                               ────────────────────────────────────────

             lParam            Содержит дескриптор дочернего окна в
                               младшем слове и идентификатор дочернего
                               окна в старшем слове.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение также посылается  всем  родителям  дочернего
             окна, включая окно верхнего уровня.

             Это сообщение  посылается  родителю  всех  дочерних  окон,
             кроме тех случаев,  когда дочернее окно имеет  расширенный
             тип WS_EX_NOPARENTNOTIFY. Для создания окна с расширенными
             типами нужно  использовать  функцию   CreateWindowEx.   По
             умолчанию дочерние   окна   в  панели  диалога  имеют  тип
             WS_EX_NOPARENTNOTIFY, исключая  те  случаи,   когда   окно
             создается с использованием функции CreateWindowEx.
        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                      = 133 =

                                                                               
       WM_PASTE

             Это сообщение вставляет данные из системного буфера в окно
             блока  управления,  начиная  с  текущей  позиции  курсора.
             Данные заносятся только в том случае, если системный буфер
             содержит данные в формате CF_TEXT.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                WM_QUERYDRAGICON [3.0]                         

             Это сообщение  посылается  минимизированному  окну (окну в
             виде иконы) когда пользователь тащит  икону,  но  окно  не
             имеет иконы класса.

             Когда пользователь  тащит  икону  окна,  не имеющего иконы
             класса, Windows заменяет  его  икону,  курсором  иконы  по
             умолчанию. Если   пользователь   хочет,   чтобы  во  время
             перемещения отображался другой курсор,  она должна вернуть
             дескриптор монохромного     курсора,     совместимого    с
             разрешением устройтсва. Прикладная программа может вызвать
             функцию LoadCursor  для  загрузки  курсора и получения его
             дескриптора.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             В младшем  слове возвращаемое значение содержит дескриптор
             курсора, который Windows должна отображать при перемещении
             иконы. Если  возвращаемое  значение  равно  NULL,  Windows
             будет использовать  курсор  по  умолчанию.  По   умолчанию
             возвращается NULL.

        ───────────────────────────────────────────────────────────────
                                  WM_QUERYENDSESSION                           

             Это сообщение  выдается,   когда   пользователь   вызывает
             команду  "Конец  сеанса  работы".  Если  любая  прикладная

       Windows 3.0/Ref/5#7                                      = 134 =

             программа возвратит нуль,  сеанс работы не  заканчивается.
             Среда     Windows     прекращает     посылать    сообщения
             WM_QUERYENDSESSION, как только одна из прикладных программ
             возвратит  нуль,  и  посылает  сообщения  WM_ENDSESSION  с
             параметром  wParam,  установленным   в   нуль   прикладной
             программой, которая уже возвратила ненулевое значение.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Если прикладная   программа   может    завершить    работу
             возвращаемое значение не равно нулю. Иначе оно равно нулю.

        Действие по умолчанию

             Функция DefWindowProc возвращает ненулевое значение.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_QUERYNEWPALETTE [3.0]

             Это сообщение информирует окно,  что оно  получает  захват
             ввода. Если  окно  релаизовало  свою палитру при получении
             захвата ввода,  оно должно вернуть TRUE,  иначе оно должно
             вернуть FALSE.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Если окно  реализовало  логическую  палитру   возвращаемое
             значение равно TRUE, иначе оно равно FALSE.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_QUERYOPEN

             Это сообщение   посылается   иконе,   когда   пользователь
             потребовал преобразовать ее в окно.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.


       Windows 3.0/Ref/5#7                                      = 135 =

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение   равно   нулю,   если    прикладная
             программа  запрещает  преобразование.  Оно  не равно нулю,
             если преобразование разрешено.

        Действие по умолчанию

             Функция DefWindowProc возвращает ненулевое значение.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_QUIT

             Это сообщение  является  требованием  на  окончание работы
             прикладной программы.  Оно генерируется,  когда прикладная
             программа вызывает функцию PostQuitMessage. Это заставляет
             функцию GetMessage возвратить нуль.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код возврата, передаваемый в
                               вызове функции PostQuitMessage.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                   WM_RBUTTONDBLCLK                            

             Это сообщение выдается,  когда пользователь  нажимает  два
             раза правую кнопку мыши.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение, указывающее нажаты ли
                               различные виртуальные клавиши. Параметр
                               может быть любой  комбинацией следующих
                               значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               MK_CONTROL   Устанавливается, если
                                            нажата клавиша CONTROL.

                               MK_LBUTTON   Устанавливается, если
                                            нажата левая кнопка.

                               MK_MBUTTON   Устанавливается, если
                                            нажата средняя кнопка.


       Windows 3.0/Ref/5#7                                      = 136 =

                               MK_RBUTTON   Устанавливается, если
                                            нажата правая кнопка.

                               MK_SHIFT     Устанавливается, если
                                            нажата клавиша SHIFT.
                               ────────────────────────────────────────

             lParam            Содержит координаты x и y курсора мыши.
                               Координата x находится в младшем слове;
                               координата y - в старшем слове. Эти
                               координаты всегда устанавливаются
                               относительно левого верхнего угла окна.
             ──────────────────────────────────────────────────────────

        Примечание

             Сообщения о  двойном  нажатии  на  клавишу  могут получить
             только окна,  класс которых имеет  тип  CS_DBLCLKS.  Среда
             Windows  генерирует сообщение о двойном нажатии на клавишу
             каждый раз, когда пользователь нажимает, отпускает и затем
             снова  нажимает кнопку мыши за время,  отведенное системой
             на двойное нажатие.  Двойное нажатие фактически генерирует
             четыре   сообщения:   сообщение  о  нажатии,  сообщение  о
             освобождении,  сообщение о вторичном нажатии и сообщение о
             последующем освобождении.

        ───────────────────────────────────────────────────────────────
                                    WM_RBUTTONDOWN                             

             Это сообщение  выдается,   когда   пользователь   нажимает
             правую кнопку мыши.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение, указывающее нажаты ли
                               различные виртуальные клавиши. Параметр
                               может быть любой  комбинацией следующих
                               значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               MK_CONTROL   Устанавливается, если
                                            нажата клавиша CONTROL.

                               MK_LBUTTON   Устанавливается, если
                                            нажата левая кнопка.

                               MK_MBUTTON   Устанавливается, если
                                            нажата средняя кнопка.

                               MK_SHIFT     Устанавливается, если
                                            нажата клавиша SHIFT.
                               ────────────────────────────────────────

       Windows 3.0/Ref/5#7                                      = 137 =


             lParam            Содержит координаты x и y курсора мыши.
                               Координата x находится в младшем слове;
                               координата y - в старшем слове. Эти
                               координаты всегда устанавливаются
                               относительно левого верхнего угла окна.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                     WM_RBUTTONUP                              

             Это сообщение  выдается,  когда  пользователь  освобождает
             среднюю кнопку мыши.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение, указывающее нажаты ли
                               различные виртуальные клавиши. Параметр
                               может быть любой  комбинацией следующих
                               значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               MK_CONTROL   Устанавливается, если
                                            нажата клавиша CONTROL.

                               MK_LBUTTON   Устанавливается, если
                                            нажата левая кнопка.

                               MK_MBUTTON   Устанавливается, если
                                            нажата средняя кнопка.

                               MK_SHIFT     Устанавливается, если
                                            нажата клавиша SHIFT.
                               ────────────────────────────────────────

             lParam            Содержит координаты x и y курсора мыши.
                               Координата x находится в младшем слове;
                               координата y - в старшем слове. Эти
                               координаты всегда устанавливаются
                               относительно левого верхнего угла окна.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_RENDERALLFORMATS

             Это сообщение  посылается прикладной программе - владельцу
             системного буфера, когда она разрушается.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.


       Windows 3.0/Ref/5#7                                      = 138 =

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Прикладная программа     должна    воспроизвести    данные
             системного  буфера  во  всех  форматах,  которые  возможно
             сгенерировать,   и  передать  дескриптор  каждого  формата
             функции SetClipboardData.  Это дает уверенность в том, что
             данные в системном буфере могут быть воспроизведены,  даже
             если прикладная программа и была разрушена.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_RENDERFORMAT

             Это сообщение   является   запросом  владельцу  системного
             буфера на форматирование последних данных, скопированных в
             системный буфер   в   указанном   формате  и  на  передачу
             дескриптора сформатиррованных данных в системный буфер.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет формат данных. Он может быть
                               любым форматом, описанным в функции
                               SetClipboardData.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                     WM_SETCURSOR                              

             Это сообщение посылается, если ввод от мыши не захвачен, а
             системная мышь  осуществляет  перемещение  курсора  внутри
             окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор окна, в котором
                               находится курсор мыши.

             lParam            Содержит в младшем слове код проверки
                               области и номер сообщения в старшем
                               слове.
             ──────────────────────────────────────────────────────────

        Примечание

             Перед обработкой функция DefWindowProc посылает  сообщение
             WM_SETCURSOR  в родительское окно.  Если родительское окно
             возвращает  TRUE,  дальнейшая  обработка  не  выполняется.
             Передача сообщения родительскому окну дает ему возможность
             управлять установкой  курсора  в  дочернем  окне.  Функция

       Windows 3.0/Ref/5#7                                      = 139 =

             DefWindowProc использует также это сообщение для установки
             курсора  в  виде  стрелки,  если   его   нет   в   области
             пользователя,  или  в виде курсора,  зарегистрированного в
             классе,  если он имеется.  Если  младшее  слово  параметра
             lParam  равно  HTERROR  и старшее слово этого же параметра
             содержит сообщение нажатой  клавиши  мыши,  то  вызывается
             функция MessageBeep.

             Старшее слово  lParam  равно  нулю  когда окно находится в
             режиме меню.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_SETFOCUS

             Это сообщение  посылается  после  того,  как окно захватит
             ввод.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор окна, теряющего
                               захват ввода (может быть NULL).

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Если прикладная    программа     намерена     индицировать
             псевдокурсор, то   в   данной  точке  она  должна  вызвать
             соответствующие функции псевдокурсора.

        ───────────────────────────────────────────────────────────────
                                   WM_SETFONT [3.0]                            

             Это сообщение определяет шрифт,  который блок управления в
             панель диалога будет использовать для вывода текста. Лучше
             всего владельцу блока управления панели диалога определить
             шрифт при получении  сообщения  WM_INITDIALOG.  Прикладная
             программа должна вызвать функцию DeleteObject для удаления
             шрифта, когда он станет  больше  не  нужен,  например  при
             разрушении блока управления.

             При получении данного сообщения размер блока управления не
             изменяеся. Поэтому чтобы  избежать  обрезания  текста,  не
             помещающегося в   границах  блока  управления,  прикладная
             программа должна скорректировать размеры блока  управления
             перед изменением шрифта.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит дескриптор шрифта. Если этот
                               параметр равен NULL, то блок управления
                               будет использовать системный шрифт.

       Windows 3.0/Ref/5#7                                      = 140 =


             lParam            Определяет должен ли блок управления быть
                               перерисован при изменении шрифта. Если
                               lParam равен TRUE, блок управления будет
                               перерисован, иначе нет.
             ──────────────────────────────────────────────────────────

        Примечания

             Перед созданием  панели  диалога,  имеющей тип DS_SETFONT,
             Windows посылает панели диалога сообщение WM_SETFONT перед
             созданием блоков  управления.  Прикладная  программа может
             создать панель диалога с типом DS_SETFONT с помощью  одной
             из следующих функций:

             - CreateDialogIndirect

             - CreateDialogIndirectParam

             - CreateBoxIndirect

             - CreateBoxIndirectParam

             Структура данных DLGTEMPLATE, которую прикладная программа
             посылает этим  функциям  должна  иметь  установленный  тип
             DS_SETFONT и  содержать  структуру данных FONTINFO которая
             определяет шрифт,  используемый для вывода текста  блоками
             управления панели диалога.

        ───────────────────────────────────────────────────────────────
                                     WM_SETREDRAW                              

             Это сообщение посылается прикладной  программой  окну  для
             того,  чтобы  позволить  или  запретить  перерисовку окна,
             которое было изменено.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет состояние флага перерисовки.
                               Если он не равен нулю, то флаг
                               перерисовки устанавливается. Если он
                               равен нулю, то флаг сбрасывается.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение   устанавливает    или    сбрасывает    флаг
             перерисовки.  Однако,  оно  не  заставляет  панель перечня
             корректировать свое изображение.  Когда  флаг  перерисовки
             установлен,  то  блок  управления  может  перерисовываться
             непосредственно  после  каждого   изменения.   Если   флаг

       Windows 3.0/Ref/5#7                                      = 141 =

             перерисовки    сброшен,    перерисовка   не   выполняется.
             Прикладные   программы,   которым   необходимо    добавить
             несколько имен к перечню без перерисовки до тех пор,  пока
             не будет добавлено последнее имя,  должны установить  флаг
             перерисовки перед добавлением последнего имени к списку.

        ───────────────────────────────────────────────────────────────
                                      WM_SETTEXT                               

             Это сообщение  используется  для  того,  чтобы  установить
             текст    окна.   Для   редактируемых   блоков   управления
             устанавливаемый текст - это содержимое  блока  управления.
             Для  клавишных  блоков  управления  текст - это имя мягкой
             клавиши. Для других окон текст - это заголовок окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Указывает на оканчивающуюся нулем строку
                               с текстом окна.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение  равно   LB_ERRSPACE   (для   панели
             перечня) или   CB_ERRSPACE   (для  комбинированного  блока
             управления) есди для установки текста не хватает  места  в
             блоке редактирования.  Комбинированный  блок управления не
             имеющий блока редактирования возвращает значение CB_ERR.

        Примечание

             Это сообщение не изменяет текущую выборку  панели  перечня
             или комбинированного   блока   управления.   Для   выборки
             совпадающего с данной строкой элементов панели перечня или
             комбинированного блока   управления  прикладная  программа
             должна использовать сообщения CB_SELECTSTRING.

        ───────────────────────────────────────────────────────────────
                                    WM_SHOWWINDOW                              

             Это сообщение  посылается  каждый  раз,  когда окно должно
             быть  сделано  невидимым  или  видимым.  Окно   становится
             невидимым   или   видимым,   когда:   вызывается   функция
             ShowWindow, перекрывающееся окно увеличивается до размеров
             экрана    или    возвращается   к   предыдущему   размеру,
             перекрывающееся окно или  накладываемое  окно  закрывается
             (становится   иконой)  или  открывается  (отображается  на
             экране).  Когда  перекрывающееся  окно  закрывается,   все
             связанные с ним накладываемые окна делаются невидимыми.


       Windows 3.0/Ref/5#7                                      = 142 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет, должно ли окно быть видимым.
                               Он не равен нулю, если окно становится
                               видимым, и равен нулю, если окно
                               делается невидимым.

             lParam            Определяет статус окна, которое
                               становится видимым. Он равен нулю, если
                               сообщение посылается из-за вызова
                               функции ShowWindow. В противном случае
                               параметр lParam имеет одно из значений:

                               Значение         Описание
                               ────────────────────────────────────────
                               SW_PARENTCLOSING Родительское окно
                                                закрывается (становится
                                                иконой) или накладываемое
                                                окно делается невидимым.

                               SW_PARENTOPENING Родительское окно
                                                открывается (отображается
                                                на экране) или
                                                накладываемое окно
                                                индицируется.
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Функция DefWindowProc делает окно невидимым или видимым  в
             зависимости от указания в сообщении.

        ───────────────────────────────────────────────────────────────
                                       WM_SIZE                                 

             Это сообщение  выдается  после  того,  как  были  изменены
             размеры окна.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение, определяющее тип
                               требуемого изменения размера. Он может
                               быть одним из следующих значений:

                               Значение       Описание
                               ────────────────────────────────────────
                               SIZEFULLSCREEN Окно было максимизировано.

                               SIZEICONIC     Окно было преобразовано в
                                              икону.

                               SIZENORMAL     Окно изменило размер, но
                                              не было использовано ни
                                              SIZEICONIC, ни

       Windows 3.0/Ref/5#7                                      = 143 =

                                              SIZEFULLSCREEN.

                               SIZEZOOMHIDE   Сообщение посылается всем
                                              накладываемым окнам, когда
                                              некоторое другое окно
                                              увеличивается в размере до
                                              полного экрана.

                               SIZEZOOMSHOW   Сообщение посылается всем
                                              накладываемым окнам, когда
                                              некоторое другое окно было
                                              уменьшено до его прежнего
                                              размера.
                               ────────────────────────────────────────

             lParam            Содержит новые длину и высоту области
                               пользователя в окне. Ширина находится в
                               младшеем слове, высота - в старшем слове.
             ──────────────────────────────────────────────────────────

        Примечание

             Если функция  SetScrollPos  или  MoveWindow вызывается для
             дочернего окна как результат  сообщения  WM_SIZE,  то  для
             выполнения  перерисовки окна параметр bRedraw должен иметь
             ненулевое значение.

        ───────────────────────────────────────────────────────────────
                                   WM_SIZECLIPBOARD                            

             Это сообщение  посылается,  когда системный буфер содержит
             дескриптор данных  для  формата  CF_OWNERDISPLAY  (т.  е.,
             владелец   системного   буфера   должен  индицировать  его
             содержимое),  и  окно  прикладной  программы  -  владельца
             системного буфера изменило размеры.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Идентифицирует окно прикладной программы
                               - владельца системного буфера.

             lParam            Младшее слово lParam - идентифицирует
                               структуру данных RECT, определяющую
                               область, в которой должен рисовать
                               владелец системного буфера. Старшее
                               слово не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Когда окно  прикладной  программы  -  владельца системного
             буфера собираются разрушить или сделать иконой (отложить),
             сообщение    WM_SIZECLIPBOARD    посылается    с   нулевым

       Windows 3.0/Ref/5#7                                      = 144 =

             прямоугольным  блоком  (0,0,0,0)  в  качестве  его  нового
             размера.   Это   позволяет   владельцу  системного  буфера
             освободить свои ресурсы отображения.

             Прикладная программа    должна    использовать     функцию
             GlobalLock  для  блокировки  памяти,  содержащей структуру
             данных   PAINTSTRUCT,   и   функцию    GlobalUnlock    для
             разблокирования этой памяти перед завершением своей работы
             или передачей управления.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_SPOOLERSTATUS [3.0]

             Это сообщение  посылается  программой  Print  Manager  при
             добавлении и удалении задания из очереди.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Равен SP_JOBSTATUS.

             lParam            Определяет в младшем слове число заданий
                               остающихся в очереди Print Manager.
                               Старшее слово не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Это сообщение используется только в целях информации.

        ───────────────────────────────────────────────────────────────
                                      WM_SYSCHAR                               

             Это сообщение является  результатом  трансляции  сообщений
             WM_SYSKEYUP и  WM_SYSKEYDOWN.  Оно  определяет виртуальный
             код клавиши системного меню.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит значение в коде ASCII клавиши
                               системного меню.

             lParam            Содержит число повторений, код
                               сканирования, код перехода клавиши,
                               предшествующее состояние клавиши, и код
                               контекста, как показано ниже:

                               Бит     Описание
                               ────────────────────────────────────────
                               0-15    Число повторений (число нажатий
                                       на клавишу, являющееся
                                       результатом удерживания
                                       пользователем клавиши в нажатом
                                       состоянии).

       Windows 3.0/Ref/5#7                                      = 145 =


                               16-23   Код сканирования (значение,
                                       зависящее от OEM).

                               24      Расширенная клавиша, такая как
                                       функциональная или клавиши
                                       числовой клавиатуры (1 - если
                                       расширенная клавиша).

                               25-26   Не используются.

                               27-28   Используется Windows.

                               29      Код контекста (1, если клавиша
                                       Alt удерживается нажатой в то
                                       время, как нажата другая клавиша,
                                       и 0, в противном случае).

                               30      Предыдущее состояние клавиши (1,
                                       если клавиша была нажата перед
                                       тем, как было послано сообщение,
                                       и 0, если клавиша была отпущена).

                               31      Состояние перехода (1, если
                                       клавиша освобождается, и 0, если
                                       клавиша нажимается).
             ──────────────────────────────────────────────────────────

        Примечание

             Когда код контекста равен 0 сообщение должно быть передано
             функции TranslateAccelerator,  которая обработает его  как
             обычное сообщение  а  не как сообщение о нажатии системной
             клавиши. Это  позволяет  использовать  клавиши  ускорителя
             даже с активным окном, не имеющим захвата ввода.

             В расширенной клавиатуры  IBM  со  101  и  102  клавишами,
             имеются дополнительные   клавиши:  правый  ALT,  и  правый
             CONTROL на  основном  блоке  клавиатуры,  INSERT,  DELETE,
             HOME, PAGEUP, PAGEDOWN и клавиши управления курсором слева
             от числовой клавиатуры,  и клавиши деления (/) и ENTER  на
             числовой клавиатуре.    Бит   расширенных   клавиш   могут
             поддерживать также некоторые другие клавиши.

        ───────────────────────────────────────────────────────────────
                                    WM_SYSCOMMAND                              

             Это сообщение  выдается,   когда   пользователь   выбирает
             команду  из  системного  меню  или панель максимизации или
             минимизации.


       Windows 3.0/Ref/5#7                                      = 146 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Определяет тип запрашиваемой системной
                               команды. Оно может иметь одно из
                               следующих значений:

                               Значение     Описание
                               ────────────────────────────────────────
                               SC_CLOSE     Закрыть окно.

                               SC_HSCROLL   Выполнить горизонтальную
                                            прокрутку.

                               SC_KEYMENU   Получить меню через нажатие
                                            клавиши.

                               SC_MAXIMIZE  Увеличить окно до размеров
                               (или SC_ZOOM) экрана.

                               SC_MINIMIZE  Преобразовать окно в икону.
                               (или SC_ICON)

                               SC_MOUSEMENU Получить меню через нажатие
                                            клавиши мыши.

                               SC_MOVE      Переместить окно.

                               SC_NEXTWINDOW Перейти в следующее окно.

                               SC_PREVWINDOW Перейти в предыдущее окно.

                               SC_RESTORE    Контрольная точка
                                             (сохранение предыдущих
                                             координат).

                               SC_SIZE       Изменить размер окна.

                               SC_VSCROLL    Выполнить вертикальную
                                             прокрутку.
                               ────────────────────────────────────────

             lParam            Содержит координаты x и y  курсора мыши,
                               если команда системного меню выбирается
                               с помощью мыши. Младшее слово содержит
                               координату x, а старшее слово -
                               координату y. В противном случае этот
                               параметр не используется.
             ──────────────────────────────────────────────────────────

        Действие по умолчанию

             Функция DefWindowProc выполняет запрос системного меню для
             предопределенных действий, описанных выше.

        Примечания

       Windows 3.0/Ref/5#7                                      = 147 =


             В сообщениях WM_SYSCOMMAND четыре младшие  бита  параметра
             wParam  используются  для  внутренних целей среды Windows.
             Когда прикладная программа проверяет значение wParam,  она
             должна   объединить  шестнадцатиричное  значение  FFF0  со
             значением wParam,  используя поразрядную операцию AND  для
             получения правильного результата.

             Элементы системного   меню  могут  быть  модифицированы  с
             помощью функций GetSystemMenu и AppendMenu,  InsertMenu  и
             ModifyMenu.  Прикладная  программа,  которая  модифицирует
             системное    меню,    должна    обрабатывать     сообщения
             WM_SYSCOMMAND.   Любое   из  сообщений  WM_SYSCOMMAND,  не
             обрабатываемое прикладной программой, должно быть передано
             функции DefWindowProc.  Любые значения команд, добавленные
             прикладной программой, должны обрабатываться ею и не могут
             быть переданы функции DefWindowProc.

             Прикладная программа   может   выполнить  любую  системную
             команду в любое  время,  передав  сообщение  WM_SYSCOMMAND
             функции DefWindowProc.

             Нажатие клавиш  ускорения,  которые определены для выборки
             элементов из системного меню,  транслируются  в  сообщения
             WM_SYSCOMMAND;   все   другие   нажатия  клавиш  ускорения
             транслируются в сообщения WM_COMMAND.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_SYSDEADCHAR

             Это сообщение  является  результатом  трансляции сообщений
             WM_SYSKEYUP или  WM_SYSKEYDOWN.  Оно  определяет  значение
             символа "мертвой" клавиши.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит символьное значение "мертвой"
                               клавиши.

             lParam            Содержит число повторений и число
                               автоповторов. Младшее слово содержит
                               число повторений; старшее слово содержит
                               число автоповторов.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                    WM_SYSKEYDOWN                              

             Это сообщение  выдается,  когда  пользователь  при нажатой
             клавише Alt нажимает другую клавишу.  Оно также  выдается,
             когда в данный момент отсутствует окно,  захватившее ввод;
             в этом случае сообщение WM_SYSKEYDOWN посылается активному
             окну.   Получившее   это  сообщение  окно  может  выяснить

       Windows 3.0/Ref/5#7                                      = 148 =

             реальную ситуацию, проверив код контекста в lParam.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит виртуальной код нажатой клавиши.

             lParam            Содержит число повторений, код
                               сканирования, код перехода клавиши,
                               предшествующее состояние клавиши, и код
                               контекста, как показано ниже:

                               Бит     Описание
                               ────────────────────────────────────────
                               0-15    Число повторений (число нажатий
                                       на клавишу, являющееся
                                       результатом удерживания
                                       пользователем клавиши в нажатом
                                       состоянии).

                               16-23   Код сканирования (значение,
                                       зависящее от OEM).

                               24      Расширенная клавиша, такая как
                                       функциональная или клавиши
                                       числовой клавиатуры (1 - если
                                       расширенная клавиша).

                               25-26   Не используются.

                               27-28   Используется Windows.

                               29      Код контекста (1, если клавиша
                                       Alt удерживается нажатой в то
                                       время, как нажата другая клавиша,
                                       и 0, в противном случае).

                               30      Предыдущее состояние клавиши (1,
                                       если клавиша была нажата перед
                                       тем, как было послано сообщение,
                                       и 0, если клавиша была отпущена).

                               31      Состояние перехода (1, если
                                       клавиша освобождается, и 0, если
                                       клавиша нажимается).

                               Для сообщения WM_SYSKEYDOWN код перехода
                               (бит 31) равен 0. Бит кода контекста
                               (бит 29) равен 1, если нажата клавиша
                               Alt. Этот бит равен 0, если это
                               сообщение посылается активному окну,
                               поскольку нет окна, захватившего ввод.
             ──────────────────────────────────────────────────────────


       Windows 3.0/Ref/5#7                                      = 149 =

        Примечание

             Когда код контекста равен 0 сообщение должно быть передано
             функции TranslateAccelerator,  которая обработает его  как
             обычное сообщение  а  не как сообщение о нажатии системной
             клавиши. Это  позволяет  использовать  клавиши  ускорителя
             даже с активным окном, не имеющим захвата ввода.

             Из-за автоповтора  может выдаваться более одного сообщения
             WM_KEYDOWN  прежде,  чем  посылается  сообщение  WM_KEYUP.
             Предыдущее   состояние   клавиши  (30-й  бит)  может  быть
             использовано для определения того,  указывает ли сообщение
             WM_KEYDOWN   переход   в  нажатое  состояние  впервые  или
             повторно.

             В расширенной клавиатуры  IBM  со  101  и  102  клавишами,
             имеются дополнительные   клавиши:  правый  ALT,  и  правый
             CONTROL на  основном  блоке  клавиатуры,  INSERT,  DELETE,
             HOME, PAGEUP, PAGEDOWN и клавиши управления курсором слева
             от числовой клавиатуры,  и клавиши деления (/) и ENTER  на
             числовой клавиатуре.    Бит   расширенных   клавиш   могут
             поддерживать также некоторые другие клавиши.

        ───────────────────────────────────────────────────────────────
                                       WM_KEYUP                                

             Это сообщение  выдается,  когда  пользователь  освобождает
             клавишу,  которая была нажата при нажатой клавише Alt. Оно
             также  выдается,  когда  в данный момент отсутствует окно,
             захватившее ввод;  в  этом  случае  сообщение  WM_SYSKEYUP
             посылается  активному окну.  Получившее это сообщение окно
             может  определить  конкретную   ситуацию,   проверив   код
             контекста в lParam.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит виртуальной код освобождаемой
                               клавиши.

             lParam            Содержит число повторений, код
                               сканирования, код перехода клавиши,
                               предшествующее состояние клавиши, и код
                               контекста, как показано ниже:

                               Бит     Описание
                               ────────────────────────────────────────
                               0-15    Число повторений (число нажатий
                                       на клавишу, являющееся
                                       результатом удерживания
                                       пользователем клавиши в нажатом
                                       состоянии).

                               16-23   Код сканирования (значение,

       Windows 3.0/Ref/5#7                                      = 150 =

                                       зависящее от OEM).

                               24      Расширенная клавиша, такая как
                                       функциональная или клавиши
                                       числовой клавиатуры (1 - если
                                       расширенная клавиша).

                               25-26   Не используются.

                               27-28   Используется Windows.

                               29      Код контекста (1, если клавиша
                                       Alt удерживается нажатой в то
                                       время, как нажата другая клавиша,
                                       и 0, в противном случае).

                               30      Предыдущее состояние клавиши (1,
                                       если клавиша была нажата перед
                                       тем, как было послано сообщение,
                                       и 0, если клавиша была отпущена).

                               31      Состояние перехода (1, если
                                       клавиша освобождается, и 0, если
                                       клавиша нажимается).

                               Для сообщения WM_SYSKEYUP код перехода
                               (бит 31) равен 1. Бит кода контекста
                               (бит 29) равен 1, если нажата клавиша
                               Alt. Этот бит равен 0, если это
                               сообщение посылается активному окну,
                               поскольку нет окна, захватившего ввод.
             ──────────────────────────────────────────────────────────

        Примечание

             Когда код контекста равен 0 сообщение должно быть передано
             функции TranslateAccelerator,  которая обработает его  как
             обычное сообщение  а  не как сообщение о нажатии системной
             клавиши. Это  позволяет  использовать  клавиши  ускорителя
             даже с активным окном, не имеющим захвата ввода.

             В расширенной клавиатуры  IBM  со  101  и  102  клавишами,
             имеются дополнительные   клавиши:  правый  ALT,  и  правый
             CONTROL на  основном  блоке  клавиатуры,  INSERT,  DELETE,
             HOME, PAGEUP, PAGEDOWN и клавиши управления курсором слева
             от числовой клавиатуры,  и клавиши деления (/) и ENTER  на
             числовой клавиатуре.    Бит   расширенных   клавиш   могут
             поддерживать также некоторые другие клавиши.

             Для расширенной  клавиатуры  со 102 клавишами не в формате
             USA, правая клавиша Alt  обрабатывается  как  CONTROL+ALT.
             Ниже показана    последовательность    сообщений   которые
             посылаются при нажатии этой клавиши:

       Windows 3.0/Ref/5#7                                      = 151 =


             Номер    Сообщение        Код виртуальной клавиши (lParam)
             ──────────────────────────────────────────────────────────
             1        WM_KEYDOWN       VK_CONTROL

             2        WM_KEYDOWN       VK_MENU

             3        WM_KEYUP         VK_CONTROL

             4        WM_KEYUP         VK_MENU

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_TIMECHANGE

             Это сообщение выдается,  когда прикладная программа вносит
             изменение (или ряд изменений)  в  системное  время.  Любая
             прикладная  программа,  которая  изменяет системное время,
             должна послать это сообщение всем окнам верхнего уровня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Для того, чтобы послать сообщение WM_TIMECHANGE всем окнам
             верхнего  уровня,  прикладная  программа   может   вызвать
             функцию  SendMessage  с  параметром hWnd,  установленным в
             шестнадцатиричное значение 0xFFFF.

        ───────────────────────────────────────────────────────────────
                                                                               
       WM_TIMER

             Это сообщение   выдается,   когда   достигается   событие,
             установленное для данного таймера.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит ID таймера - целое значение,
                               которое идентифицирует таймер.

             lParam            Указывает на функцию, которая была
                               передана в  функцию  SetTimer, при
                               создании таймера. Если параметр lParam
                               не равен NULL, то вместо того, чтобы
                               посылать сообщение WM_TIMER функции
                               окна, вызывается непосредственно
                               указанная функция.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────

       Windows 3.0/Ref/5#7                                      = 152 =

                                                                               
       WM_UNDO

             Это сообщение   отменяет  последнюю  операцию.  Когда  оно
             посылается редактируемому блоку управления удаленный перед
             этим текст  восстанавливается  а  добавленный  перед  этим
             текст удаляется.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Не используется.
             ──────────────────────────────────────────────────────────

        ───────────────────────────────────────────────────────────────
                                    WM_VKEYTOITEM                              

             Это сообщение посылается владельцу панелью перечня с типом
             LBS_WANTKEYBOARDINPUT в ответ на сообщение WM_KEYDOWN.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит виртуальной код клавиши нажатой
                               пользователем.

             lParam            Содержит в старшем слове позицию
                               псевдокурсора и дескриптор окна панели
                               перечня в младшем слове.
             ──────────────────────────────────────────────────────────

        Возвращаемое значение

             Возвращаемое значение    определяет    действие,   которое
             прикладная программа  выполнила  в  ответ  на   сообщение.
             Значение -2    определяет,    что   прикладная   программа
             обработала все  аспекты  выбранного  элемента  и   никаких
             больше действий   для   панели   перечня   не   требуются.
             Возвращаемое значение равное -1, говорит о том, что панель
             перечня выполнила   для   данной   клавиши   действия   по
             умолчанию. Возвращаемое значение равное нулю  или  большее
             нуля определяет индекс элемента панели перечня и говорит о
             том, что  панель  перечня  должна  выполнить  для   данной
             клавиши действия по умолчанию с данным элементом.

        ───────────────────────────────────────────────────────────────
                                      WM_VSCROLL                               

             Это сообщение выдается, когда пользователь нажимает кнопку
             мыши на вертикальной строке прокрутки.


       Windows 3.0/Ref/5#7                                      = 153 =

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Содержит код строки прокрутки,
                               определяющий запрос пользователя на
                               прокрутку. Он может быть одним из
                               следующих:

                               Значение         Описание
                               ────────────────────────────────────────
                               SB_BOTTOM        Прокрутка до конца вниз.

                               SB_ENDSCROLL     Конец прокрутки.

                               SB_LINEDOWN      Прокрутка на одну строку
                                                вниз.

                               SB_LINEUP        Прокрутка на одну строку
                                                вверх.

                               SB_PAGEDOWN      Прокрутка на одну
                                                страницу вниз.

                               SB_PAGEUP        Прокрутка на одну страницу
                                                вверх.

                               SB_THUMBPOSITION Прокрутка к абсолютной
                                                позиции. Текущая позиция
                                                содержится в младшем
                                                слове lParam.

                               SB_THUMBTRACK    Бегунок перемещается на
                                                заданную позицию.
                                                Текущая позиция
                                                содержится в младшем
                                                слове lParam.

                               SB_TOP           Прокрутка до конца вверх.
                               ────────────────────────────────────────

             lParam            Если сообщение посылается строкой
                               прокрутки, то старшее слово параметра
                               идентифицирует блок управления. Если
                               сообщение посылается как результат
                               управления пользователем строкой
                               прокрутки в накладываемом окне, старшее
                               слово не используется.
             ──────────────────────────────────────────────────────────

        Примечание

             Сообщение SB_THUMBTRACK  обычно  используется  прикладными
             программами,  чтобы обеспечить некоторую обратную связь во
             время перемещения бегунка.

             Если прикладная  программа  прокручивает  документ в окне,

       Windows 3.0/Ref/5#7                                      = 154 =

             она должна также восстановить позицию  бегунка  с  помощью
             функции SetScrollPos.

        ───────────────────────────────────────────────────────────────
                                 WM_VSCROLLCLIPBOARD                           

             Это сообщение посылается,  когда системный буфер  содержит
             дескриптор  данных  для  формата  CF_OWNERDISPLAY (т.  е.,
             владелец  системного  буфера   должен   индицировать   его
             содержимое),  и  произошло  событие  в строке вертикальной
             прокрутки прикладной  программы  -  владельца   системного
             буфера.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Дескриптор окна прикладной программы
                               - владельца системного буфера.

             lParam            Содержит один из следующих кодов строки
                               прокрутки:

                               Значение         Описание
                               ────────────────────────────────────────
                               SB_BOTTOM        Прокрутка до конца вниз.

                               SB_ENDSCROLL     Конец прокрутки.

                               SB_LINEDOWN      Прокрутка на одну строку
                                                вниз.

                               SB_LINEUP        Прокрутка на одну строку
                                                вверх.

                               SB_PAGEDOWN      Прокрутка на одну
                                                страницу вниз.

                               SB_PAGEUP        Прокрутка на одну страницу
                                                вверх.

                               SB_THUMBPOSITION Прокрутка к абсолютной
                                                позиции. Текущая позиция
                                                содержится в младшем
                                                слове lParam.

                               SB_TOP           Прокрутка до конца вверх.
                               ────────────────────────────────────────

                               Старшее слово  lParam  содержит  позицию
                               бегунка,  если код  строки  прокрутки  -
                               SB_THUMBPOSITION.   В  противном  случае
                               старшее слово не используется.
             ──────────────────────────────────────────────────────────


       Windows 3.0/Ref/5#7                                      = 155 =

        Примечание

             Владелец системного  буфера  должен  использовать  функцию
             InvalidateRect   или,   при   необходимости,   осуществить
             перерисовку.   Также  должна  быть  восстановлена  позиция
             строки прокрутки.

        ───────────────────────────────────────────────────────────────
                                   WM_WININICHANGE                             

             Это сообщение    посылается,    когда    изменяется   файл
             инициализации Windows    (WIN.INI).    Любая    прикладная
             программа, которая вносит изменения в файл WIN.INI, должна
             послать это сообщение всем окнам верхнего уровня.

             Параметры         Описание
             ──────────────────────────────────────────────────────────
             wParam            Не используется.

             lParam            Указывает на строку, определяющую имя
                               секции, которая изменяется (не должна
                               включать квадратные скобки).
             ──────────────────────────────────────────────────────────

        Примечание

             Для того,  чтобы  послать  сообщение  WM_WININICHANGE всем
             окнам верхнего уровня,  прикладная программа может вызвать
             функцию  SendMessage  с  параметром hWnd,  установленным в
             шестнадцатиричное значение 0xFFFF.

             Хотя это и не корректно,  некоторые  прикладные  программы
             посылают это сообщение с lParam равным NULL. В этом случае
             прикладные программы должны  проверить  все  секции  файла
             WIN.INI, которые влияют на прикладную программу.

