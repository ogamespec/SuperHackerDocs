                          
                          П.НОРТОН                   
                          
 
                
                 
              ПРОГРАММНО-АППАРАТНАЯ ОРГАНИЗАЦИЯ   
                      КОМПЬЮТЕРА IBM PC    
                                              
                                              
                
                
                                              
              (INSIDE THE IBM PC.ACCESS TO ADVANCED
                   FEATURES AND PROGRAMMING)
              
              Prentice-Hall Publishing Comp.,1984
              
              
                
                
                
                
                
                
                
              
                      Перевод с английского
              
                            С.Е.Писарева
              
              
              
              
              
              
              
              
                
                
              
              
              
              
              
                       
                            Киев  1987
              
              
              
              
              
              
              
              
              
                   Предисловие переводчиков
                
               
              
              Текст   предлагаемой   читателю   книги   сформирован  и
         отредактирован  с  помощью  оконного   текстового   редактора
         LEXICON  (разработчик ВЦ АН СССР, Е.Веселов) сотрудниками НПО
         "Горсистемотехника" (г.Киев) тт.  Шевцовым  С.И.,  Шут  И.Б.,
         Варфоломеевой  Л.В.  Прилагаемые рисунки выполнены т.Шевцовым
         С.И. с помощью системы Grafix Partner.
              Авторы  перевода  благодарны  всем   им   за   оказанную
         поддержку и внимание.
              В  дальнейшем  перевод  будет изменяться и пополняться с
         учетом материалов  (отсутствующих  в  оригинале),  отражающих
         особенности новых версий операционной системы и аппаратуры.
              
              Тел. 221-27-94
              ______________
              

                                 ОГЛАВЛЕНИЕ
              
              
              
              ГЛАВА 1. ВВЕДЕНИЕ В СФЕРУ ПЕРСОНАЛЬНЫХ КОМПЬЮТЕРОВ
              
              1.1. Краткий обзор содержания книги
              1.2. Вспомогательные обучающие средства
              1.3  Используемые     программные     средства,    языки
         программирования и тексты программ 
              1.4. Возможные аспекты рассмотрения проблемы
              1.5. Обзор   оригинальных   источников,  используемых  в
         данной работе
              1.6. Некоторые особенности изложения материала
              
              Приложение  1.1.  Текст  программы   визуализации   всех
         символов на экране дисплея (язык Бейсик)
              
              ГЛАВА 2. АРХИТЕКТУРА ТЕХНИЧЕСКИХ СРЕДСТВ
              
              2.1. Микропроцессор  -  центральный  узел  персонального
         компьютера 
              2.2. Краткие    сведения    об   остальных   компонентах
         компьютера 
              2.3. Функциональные назначения этих компонентов
              2.4. Использование разъемов расширения
              2.5. Дополнительные сведения о технических средствах
              2.6. Три аспекта рассмотрения архитектурных решений
              2.7. Возможности комплектации IBM/PC
              
              ГЛАВА 3. ПРИНЦИПЫ ФУНКЦИОНИРОВАНИЯ IBM/PC
              
              3.1. Организация памяти персонального компьютера
              3.2. Принципы адресации
              3.3. Сверхоперативная память на регистрах
              3.5. Прерывания
              3.6. Стеки
              3.7. Порты
              
              Приложение 3.1. Текст программы поиска активного участка
         памяти ( Бейсик)
              Приложение 3.2. Текст   программы  обработки  прерываний
         (Ассемблер)
              Приложение 3.3. Текст  программы  поиска активных портов
         (Паскаль)
              Приложение 3.4. Текст  программы  считывания  данных  из
         порта (Ассемблер) 

              ГЛАВА 4. АРХИТЕКТУРА И ВОЗМОЖНОСТИ ОПЕРАЦИОННОЙ СИСТЕМЫ
              
              4.1. Для чего нужны операционные системы
              4.2. Шесть основных модулей ДОС
              4.3. Нижний  уровень  программной  поддержки  -  система
         BIOS-ПЗУ
              4.4. Процедура начальной загрузки - структура процесса
              4.5. Операции с периферийным  устройством  -  компонента
         IBMBIO.COM
              4.6. Ядро операционной системы - компоненты IBMDOS.COM
              4.7. "Внутренние"    компоненты  (команды)  операционной
         системы  -  компонента COMMAND.COM
              4.8. "Внешние"   команды    операционной    системы    -
         особенности выполнения и загрузки
              4.9. Функции  обслуживания  пользователем  операционной
         системы
              
              
              ГЛАВА 5. ОРГАНИЗАЦИЯ ВНЕШНЕЙ ПАМЯТИ
              
              5.1. Устройство гибкого магнитного диска (дискеты)
              5.2. Форматы хранения информации
              5.3. Типы дискет и проблемы защиты от копирования
              5.4. Стандартный   накопитель   информации   на   гибких
         магнитных дисках
              5.5. Принципы хранения файлов
              5.6. Организация справочников
              5.7. Структура таблицы размещения файлов
              5.8. Стратегия размещения файлов
              5.5. Файлы в текстовом формате
              5.10. Форматы записей данных
              5.11. Форматы программных (исполняемых файлов)
              
              Приложение 5.1. Текст   программы   анализа    структуры
         справочника (Паскаль)
              Приложение 5.2. Текст   программы    анализа   структуры
         таблицы размещения файлов (Паскаль)
              Приложение 5.3. Текст программы обработки справочника и
         таблицы размещения файлов (Паскаль)

              ГЛАВА 6. РАБОТА С ПЗУ

              6.1. Организация ПЗУ и его использование
              6.2. Анализ содержимого ПЗУ средствами программы DEBUG
              6.3. Анализ содержимого ПЗУ - метод деассемблирования
              6.4. Анализ    содержимого     ПЗУ    -    реконструкция
         интепретатора языка Бейсик
              6.5. Существующие версии BIOSa
              6.6. Механизм выборки информации из ПЗУ
              6.7. Описание специальных прерываний
              
              Приложение 6.1. Текст   программы  проверки метки версии
         ПЗУ (Паскаль)
              

              ГЛАВА 7. ОПЕРАЦИИ С ДИСКАМИ
              
              7.1. Три уровня дисковых операций
              7.2.  Средства  поддержки   дисковых   операций   уровня
         BIOS-ПЗУ 
              7.3. Параметры дисков и методы защиты от копирования

              
              ГЛАВА 8. ВИДЕОДОСТУП - ТЕКСТОВЫЙ РЕЖИМ
                   
              8.1. Типы видеомониторов
              8.2. Принципы отображения информации
              8.3. Метод   хранения  копии  изображения  в оперативной
         памяти
              8.4. Страничный механизм цветного графического дисплея 
              8.5. Атрибуты изображений
              8.6. Использование цвета
              8.7. Режим прямого управления видеомонитором
              8.8. Управление перемещением курсора
              8.9. Стандартный режим управления видеомонитором
              8.10. Псевдографический режим
              8.11. Средства управления видеодоступа уровня BIOS-ПЗУ
              
              Приложение 8.1. Текст      программы        демонстрации
         возможностей управления цветом (Бейсик)
              Приложение 8.2. Текст   программы  генерации изображений
         (Паскаль)
              
         
              ГЛАВА 9. ВИДЕОДОСТУП - ГРАФИЧЕСКИЙ РЕЖИМ

              9.1. Основы машинной графики
              9.2. Понятие элемента отображения (пиксель)
              9.3. Отображение пикселей на экране
              9.5. Генерация текстов в графическом режиме
              
              Приложение 9.1. Текст   программы  генерации графических
         образов (Паскаль)
              
              ГЛАВА 10. БЛОК КЛАВИАТУРЫ
              
              10.1. Принципы построения
              10.2. Механизм смены внутренних кодов
              10.3. Клавиши управления
              10.4. Программная   поддержка  операций  с   клавиатурой
         уровня BIOS-ПЗУ
              10.5. Работа с клавиатурой в рамках языковых процессоров
              
              Приложение 10.1. Текст      программы       демонстрации
         возможностей управления клавиатурой (Бейсик)
              
              ГЛАВА 11. ДОПОЛНИТЕЛЬНЫЕ ВОЗМОЖНОСТИ
              
              11.1. Асинхронный коммуникационный адаптер
              11.2. Адаптер устройства печати
              11.3. Интерфейс с накопителем  информации  на  магнитной
         кассете
              11.4. Дополнительные    процедуры   обслуживания  уровня
         BIOS-ПЗУ
              11.5. Генерация звука
              
              Приложение 11.1. Текст   программы   генерации  звука  с
         использованием таймера (Ассемблер)
              
              
              
              
           
                                              
                                              
              Глава 1. ВВЕДЕНИЕ В СФЕРУ ПЕРСОНАЛЬНЫХ КОМПЬЮТЕРОВ
                              
              
              
              Книга, предлагаемая читателю, рассказывает о чудесах - о 
         тех чудесах, которые позволяет творить Персональный Компьютер 
         фирмы "IBM" (IBM/PC). 
              Появление    персонального    компьютера   фирмы   "IBM" 
         знаменовало собой фактическое введение нового и очень высоко- 
         го   стандарта  качества  и  производительности  персональных 
         компьютеров.  Те,  кто  уже  знал   и   понимал   возможности 
         персональных  компьютеров,  увидели  в IBM/PC новое средство, 
         превосходящее все то что существовало до сих пор. Те же,  кто 
         считал персональные компьютеры не более чем игрушками, начали 
         осозновать  действительную  ценность   этих   компьютеров   в 
         качестве   полезнейшего  рабочего  инструмента  инженера  или 
         ученого. 
              Эта  книга  отличается  от  большинства  книг,знакомящих 
         чителей  с  компьютерами.  Она  рассчитана  на  тех  читатей, 
         которые  не   желают   останавливаться   на   сведениях   для 
         начинающих,   а   хотят   узнать  действительные  возможности 
         персонального компьютера фирмы "IBM". 
              Компьютер   IBM/PC   позволяет   реализовать   множество 
         интереснейших возможностей,  о  которых  будет  рассказано  в 
         данной  книге.  Эта книга адресована всем, кого действительно 
         интересует как работает  IBM/PC  и  что  можно  делать  с  ее 
         помощью,  независимо  от  того,  является ли читатель опытным 
         профессионалом или начинающим пользователем компьютеров. 
              Книга  позволяет  не  только  понять  как  функционирует 
         IBM/PC,   но  и  обьясняет  как  можно  его  использовать  на 
         практике. Она  предлагает  дополнительный  и  более  глубокий 
         материал  об IBM/PC для всех, кто в нем нуждается. Мы поможем 
         Вам понять не только принципы функционирования машины,  Но  и 
         ее   потенциальные   возможности.  Книга  содержит  множество 
         советов    и    практических     рекомендаций,     касающихся 
         программирования  для IBM/PC. Но не следует считать эту книгу 
         руководством по программированию для IBM/PC, в  основном  она 
         посвящена возможностям самого компьютера. 
              
              1.1. Краткий обзор содержания книги
              
              Эта   книга   в  основном  посвящена  программам  (  или 
         программному обеспечению),  поскольку  именно  они  реализуют 
         большинство   возможностей   компьютера.   Но   помимо  этого 
         необходимо рассмотреть и  аппаратные  средства  компьютера  - 
         этому посвящена глава 2. 
              В     главе     3    рассматривается    функционирование
         ценитального узла компьютера - собственно микропроцессора. 
              Операционная система  РС-DOS  кратко описывается в главе 
         4.  В этой главе приведены пояснения принципов работы ДОС и в 
         качестве  дополнительного   материала   описаны   программные 
         средства, обеспечивающие доступ к различным возможностям ДОС. 
              Далее,  в  главе  5, рассматривается организация внешней 
         памяти и способы хранения данных на гибких магнитных  дисках. 
         Примеры  программ  показывают  способы  расшифровки служебной 
         информации об организации хранения данных на дискете, которая 
         обычно скрыта от пользователя. 
              Глава  6  посвящена  программному  обеспечению,  которое 
         хранится в ПЗУ (постоянном запоминающем устройстве) IBM/PC. В 
         этой главе показано как можно пользоваться этими программами. 
         Этот материал подготавливает почву для изучения глав с  7  по 
         11, в которых, шаг за шагом, описываются служебные программы, 
         хранящиеся в ПЗУ. Каждая из этих глав сопровождается примером 
         программ,  позволяющих  использовать  те или иные возможности 
         компьютера. 
              Глава  7  описывает  доступ  к   процедурам   работы   с 
         дискетами.   Главы   8  и  9  описывают  работу  с  дисплеем, 
         соответственно в алфавитно-цифровом и графическом режимах. 
              Глава 10 посвящена использованию клавиатуры, а глава  11 
         подводит итоги рассмотрения всего предыдущего материала. 
              Приложения   этой   книги   включают  краткий  глоссарий 
         компьютерной терминологии,  введение  в  Паскаль  и  описание 
         интерфейса  между  программами,  написанными на ассемблере, и 
         программами на Паскале или другом языке высокого уровня. 
              
              1.2. Вспомогательные обучающие средства
              
              Если Вы просто хотите узнать побольше об IBM/PC, то  Вам 
         не  потребуется  ничего,  кроме  этой  книги.  Однако,  чтобы 
         применить  полученные  знания   на   практике   этого   будет 
         недостаточно, потребуется, как минимум, сам компьютер. 
              Чтобы  воспользоваться  программами, приведенными в этой 
         книге, потребуется  IBM/PC  с  64К  байтами  памяти  и  одним 
         дисководом.  Все  программы  могут работать как с монохромным 
         дисплеем, так и с цветным графическим адаптером.  Потребуется 
         также  операционная  система  ДОС и поставляемые вместе с нею 
         средства, такие как программа  DEBUG.  Можно  воспользоваться 
         любой  версией  ДОС:  исходной  версией 1.00, неофициальной и 
         временной версией 1.05, усовершенствованной версией 1.10  или 
         ДОС 2.00. 
              Чтобы  как  можно  полнее  использовать все возможности, 
         предоставляемые IBM/PC, Вам потребуется дополнительный  пакет 
         программ  на  гибких  магнитных  дисках,  прилагаемый  к этой 
         книге. Средства доступа  ко  всем  возможностям  IBM/PC  были 
         разработаны  специально  для  этой  книги.  Содержимое пакета 
         описывается в приложении 5. 
              Вам не нужно  будет  использовать  Макроассемблер  фирмы 
         "IBM"  для  использования  представленных  в  книге  процедур 
         доступа, написанных на ассемблере. Все эти программы включены 
         в  пакет  программ  в  виде готовых к использованию обьектных 
         модулей.  Однако,  если  Вам  захочется  внести  изменения  в 
         ассемблерную программу, чтобы адаптировать ее к своим нуждам, 
         то потребуется и ассемблер, и необходимо  будет  освоить 
         язык  ассемблера.  Один  из  разделов этой книги представляет 
         собой простое введение в использование ассемблера. 
              Чтобы использовать  приведенные  в  книге  программы  на 
         языке  Паскаль  либо  сами  по  себе,  либо  в  составе Ваших 
         собственных  программ,  Вам  потребуется   компилятор   языка 
         Паскаль для IBM/PC. 
              И,  наконец,  Вам  может  потребоваться копия "Сервисных 
         программ  Нортона"  (The  Norton  Utilities).  Она   включает 
         программу   восстановления   поврежденных  дискет  (FileFix), 
         уничтоженных  файлов  (UnErase),  модификации   секторов   на 
         дискете  (SecMod)  и  управления скрытыми файлами (FileHide и 
         BatHide);  реорганизации  справочников  файлов   (DiskOpt   и 
         FileSort)  и  управления  экранным режимом (Reverse, ScrAtr и 
         Clear), а также несколько других полезных служебных программ. 
              
              1.3.   Используемые    программные    средства,    языки
         программирования и тексты программ
         
              В этой книге будет приведено  множество  программ  и  мы 
         сразу  же  приступим  к  рассмотрению  первой  из  них, текст 
         которой приведен в приложении 1-1. Эта программа написана  на 
         языке  БЭЙСИК  и  выдает  на  экран  все  256 кодов символов, 
         отображаемых дисплеем IBM/PC. Многие пользователи, как это ни 
         удивительно, никогда не видели всего набора символов, так что 
         это  представляет  для  них  интерес.  Просмотр  сразу   всех 
         возможных  символов может оказаться полезным для выбора из их 
         числа  таких  символов,  которые  будут  использоваться   для 
         организации   специальных   эффектов.   Программа  отображает 
         символы в виде таблицы по 16 символов  в  каждом  ряду.  Если 
         необходимо  установить  порядковый  номер  любого символа, то 
         можно использовать функцию  CHR$  языка  БЕЙСИК.  Так  первая 
         строка  содержит  символы  от  CHR$(0)  до CHR$(15), а вторая 
         CHR$(16)-CHR$(81).    Шестнадцатиричные     коды     символов 
         определяются по меткам строк и столбцов. 
              В   примерах   программ,   приведенных   в  этой  книге, 
         используются три языка программирования:  БЕЙСИК,  Паскаль  и 
         язык  ассемблера.  Интерпретатор языка БЕЙСИК имеется в любом 
         варианте IBM/PC, поэтому БЕЙСИК используется во всех случаях, 
         когда  им  целесообразно  воспользоваться.  Однако  БЕЙСИК не 
         слишком хорошо  приспособлен  для  решения  серьезных  задач, 
         поэтому, в основном используется язык Паскаль. 
              Паскаль    приобрел    большую   популярность   в   мире 
         персональных  компьютеров   благодаря   своим   возможностям, 
         компактности  и надежности. У Паскаля имеются и очень сильные 
         конкуренты - в первую очередь языки Си и  Форс.  Однако,  для 
         нас  Паскаль  имеет  два  важных  преимущества. Во-первых, он 
         проще и его легче изучить, чем языки Си и Форс  и  во-вторых, 
         что  наиболее важно, фирма "IBM" поставляет Паскаль для своих 
         персональных компьютеров с самого начала. И  коль  скоро  нам 
         необходим какой-то общий язык общения, большая часть программ 
         в этой книге написана на Паскале. 
              Если вы не знакомы с языком  Паскаль,  не  отчаивайтесь, 
         наиболее простой способ немного изучить этот язык заключается 
         в чтении примеров, приведенных в книге. Они  были  специально 
         написаны как можно доступнее и подобраны таким образом, чтобы 
         постепенно  обучать  читателя.  Кроме  того,   приложение   2 
         содержит    краткое    руководство    по    языку    Паскаль, 
         демонстрирующее его  возможности  и  стиль  программирования, 
         поясняющее наиболее важные компоненты языка. 
              Я  настоятельно рекомендую язык Паскаль всем, кто еще не 
         выбрал, на каком языке программировать на IBM/PC. 
              Если Вы собираетесь использовать другой язык, то примеры 
         программ  на  Паскале,  приведенные  в  этой книге, все равно 
         будут  полезны.  Они  показывают  приемы  работы  на  IBM/PC, 
         которые можно перенести и в другие языки программирования. 
              Многие  из  наиболее  мощных  и  интересных возможностей 
         IBM/PC  можно  задействовать  только  с   помощью   программ, 
         написанных  на  языке  ассемблера. В этой книге мы рассмотрим 
         все  эти  возможности  и  способы  их  использования.   Чтобы 
         обеспечить  Вам  наиболее  благоприятные  возможности  для их 
         использования  в  книге  приведен  полный   набор   программ, 
         написанных на языке ассемблера, которые представят Вам доступ 
         ко всем возможностям IBM/PC и операционной системы ДОС. 
              В приложении 3 описываются способы подключения  модулей, 
         написанных   на   языке   ассемблера.   Потребности  описания 
         относятся к языку Паскаль, но они практически в том  же  виде 
         могут быть применены к любому языку программирования, который 
         использует стандартные механизмы вызова программ. 
              Специально для этой книги было написано небольшое  число 
         программ.Одни  -  с  чисто иллюстративным назначением - чтобы 
         продемонстрировать некоторые приемы работы. Другие  программы 
         предназначены  для  помощи  в  получении  информации  о Вашем 
         компьютере. Третью группу  составляют  программные  средства, 
         обеспечивающие  Вам  доступ ко множеству важных возможностей, 
         предоставляемых IBM/PC. По возможности листинги этих программ 
         были включены в эту книгу , и в первую очередь, это относится 
         к тем программам, изучить которые читателю наиболее  полезно. 
         Однако,   некоторые  из  вспомогательных  программ  лучше  не 
         изучать,  а  непосредственно  использовать,  книга   содержит 
         тексты  только  тех  программ, которые полезно изучить, а все 
         остальные программы включены в специальный пакет,  записанный 
         на дискете, прилагающейся к данной книге. 
              Этот  пакет  содержит  все  программы,  листинги которых 
         приведены  в  книге,  и  многие  другие  полезные  программы. 
         Содержимое пакета описывается в приложении 5. 
              Программы,  написанные  на языке ассемблера, записаны на 
         дискете как в виде исходного текста, так и в виде  готовых  к 
         использованию  обьектных  модулей.  Если Вы захотите внести в 
         эти  программы  какие-либо  изменения,  то   Вам   пригодится 
         исходный  текст.  Для  использования  готовых программ Вам не 
         нужно изучать язык ассемблера и использовать  ассемблер. 
         Программы  на  Паскале  также представлены и в виде исходного 
         текста, и в виде готовых, скомпилированных  модулей,  которые 
         готовы к использованию. 
              В   пакет   программ   включена   одна   вспомогательная 
         программа, DiskLook. Эта  программа  позволяет  просматривать 
         всю  иформацию,  хранящуюся  на  гибких магнитных дисках. Она 
         может вывести перечень файлов, упорядоченный по именам, датам 
         или  размерам  или  имена  всех файлов, которые были удалены. 
         Программа  DiskLook   позволяет   просмотреть   распределение 
         дискового  пространства, показывает расположение любого файла 
         и и позволяет считывать данные с любого места на дискете. 
             
             1.4. Три пересекающиеся области
             
              Хотя не все это замечают, но появление IBM/PC привело  к 
         возникновению  трех  пересекающихся областей интересов. Чтобы 
         это стало очевидным,  должо  пройти  определенное  время,  но 
         читатель должен знать о них и об их связи с данной книгой. 
              Появление персонального компьютера фирмы "IBM" было, как 
         ни странно это звучит,  появлением  первого  IBM/PC-подобного 
         компьютера;   первого,   но  не  единственного.  Кроме  того, 
         появилась операционная система  фирмы  "Майкрософт",  MS-DOS; 
         версия этой операционной системы для IBM/PC получила название 
         PC-DOS, хотя можно встретить и названия IBM-DOS и просто ДОС. 
              Отсюда и возникают три области интересов. Во-первых, это 
         интерес  к  самому  компьютеру  IBM/PC.  Далее, это интерес к 
         компьютерам в большей или меньшей степени имитирующим  IBM/PC 
         и, наконец, это интерес к семейству компьютеров, использующих 
         операционную систему MS-DOS. 
              Между этими областями много общего, так что любая книга, 
         посвященная  одной  из областей, содержит обширный материал и 
         по остальным. Эта книга посвящена первопричине появления всех 
         этих  областей  интереса  -  персональному  компьютеру  фирмы 
         "IBM", но  большая  часть  того  о  чем  пойдет  речь,  может 
         пригодиться   и   тем,   кто   интересуется  IBM/PC-подобными 
         компьютерами и тем, кто интересуется семейством  компьютеров, 
         работающих под управлением операционной системы MS-DOS. 
              Время  от  времени,  при изложении материала этой книги, 
         когда можно провести такое разделение, я буду указывать,  что 
         относится, а что не относится к остальным двум областям. 
             
             1.5. Источники информации
             
              В  такой  книге  нельзя  описать абсолютно все аспекты и 
         подробности работы  IBM/PC.  Ниже  приведен  список  наиболее 
         важных  и  полезных источников информации, которыми Вы можете 
         воспользоваться, если потребуются более подробные сведения. 
              Практически все  сведения,  приведеные  в  даной  книге, 
         извлечены  из  этих  источников.  В  отличие от многих других 
         персональных компьютеров IBM/PC сопровождался  очень  широким 
         кругом   открытых   источников   информации.   Это  произошло 
         благодаря позиции фирмы "IBM", состоящей в том, чтобы  машина 
         была  как  можно  более  доступна  разработчикам программного 
         обеспечения и аппаратных расширений. В качестве  автора  этой 
         книги,  я  не  имел  доступа к каким-либо особенным секретам, 
         какие были бы недоступны читателям. Мне потребовалось  только 
         переработать   общедоступную   информацию,   извлечь  из  нее 
         наиболее существенное и выделить  информацию,  представляющую 
         интерес для наиболее широкого круга читателей. 
              Если  Вам потребуется более подробная информация, чем та 
         которая содержится в  этой  книге,  Вы  можете  обратиться  к 
         следующим  источникам: наиболее богатый источник информации - 
         это  собственное  техическое  руководство  по   Персональному 
         компьютеру   фирмы   "IBM",   содержащее  помимо  технических 
         подробностей, детальное описание ROM-BIOS, т.е., хранящейся в 
         ПЗУ  базовой системы ввода-вывода. Эти программы обеспечивают 
         наиболее функциональные программные средства  для  управления 
         IBM/PC.  Приведен листинг BIOS на языке ассемблера, в котором 
         можно разобраться только в том случае, если Вы хорошо  знаете 
         язык  ассемблера  микропроцессора  8086 фирмы "Интел". Тем не 
         менее, листинг системы BIOS представляет собой настоящий клад 
         информации о служебных подпрограммах, доступных пользователю. 
         Даже  если  Вы  незнакомы  с  языком   ассемблера,   описания 
         служебных  подпрограмм  и  способ  их организации помогут Вам 
         понять  организацию  этого  компьютера.  (Приводятся   только 
         листинги   системы   BIOS,   а   листинг  записанного  в  ПЗУ 
         интерпретатора языка Бейсик (ROМ-BASIC) не  приводятся,  хотя 
         его  можно  получить  с  помощью  команды  DEBUG операционной 
         системы, правда без комментариев.) 
              Кроме того, в руководстве приведены  две  очень  удобные 
         таблицы,  содеращие  все  256  кодов  символов,  используемых 
         IBM/PC и функции специальных символов-атрибутов,  управляющих 
         цветом текста, отображаемого на экране IBM/PC. 
              Еще одинм полезным источником информации может послужить 
         руководство, поставляемое вместе с операционной системой DOC. 
         В  приложениях  к  этому  руководству  можно  найти  полезную 
         информацию  о  форматах  дискет,  соглашениях  для  служебных 
         процедур ДОС, блоках управления файлами, приставках сегментов 
         программ и так  далее.  Само  руководство  по  ДОС  несколько 
         беднее,   чем   большинство   наших   источников  информации, 
         поскольку оно не содержит подробной технической информации  о 
         ДОС.  Руководство  содержит  очень  полезную  вспомогательную 
         информацию и некоторые рекомендации. 
              Чтобы лучше понять функционирование микрокомпьютера,  на 
         основе  которого  функционирует  IBM/PC,  можно  обратиться к 
         нескольким  книгам  по   микропроцессорам   8086/8088   фирмы 
         "Интел".   Особенно   полезными  мне  показались  две  книги. 
         Наиболее   доступно    принципы    организации    и    работы 
         микропроцессора  8086  представлены  в  книге  "The 8086/8088 
         Primer", написанной Стефаном П. Морзом  (Hayden,1980).  Более 
         глубоко  микропроцессор  описывается в книге "The 8086 Book", 
         Рассела Ректора (Osborne/McGrawHill,1980). 
              В качестве  справочника  по  программированию  на  языке 
         Паскаль  можно  воспользоваться  стандартным  руководством по 
         компилятору языка Паскаль для IBM/PC. Это не слишком  удачное 
         введение  в Паскаль, но только в этом руководстве описываются 
         особенности конкретной версии языка Паскаль для IBM/PC. Чтобы 
         изучить  язык  можно  выбрать  одну  из  книг  по Паскалю для 
         начинающих, которыми переполнены книжные магазины. Если же Вы 
         обладаете    хорошей    подготовкой,   достаточно   прочитать 
         руководство   по   компилятору   языка   Паскаль   полностью. 
         Практически  все технические детали, касающиеся использования 
         версии языка Паскаль для IBM/PC либо подробно  описаны,  либо 
         поясняются примерами. На мой взгляд, авторы этого руководства 
         проделали   большую   работу,   включив    все    необходимые 
         рекомендации  для  тех случаев, которые они не могли детально 
         пояснить.  (Вы  многое  сможете  узнать  о   языке   Паскаль, 
         внимательно  изучив  примеры,  приведенные  в  этой  книге, и 
         прочитав руководство по языку Паскаль в приложении 2). 
              Как  и  в  случае  с  языком  Паскаль,  рекомендации  по 
         программированию  на  ассемблере можно найти в руководстве по 
         ассемблеру для IBM/PC. Однако, в этом руководстве Вы  не 
         найдете   набора  машинных  команд.  Он  описывается  в  двух 
         упоминавшихся   выше   книгах   по   микропроцессору    8086. 
         Руководство   по   ассемблеру  для  IBM/PC  очень  плохо 
         об'ясняет вопросы программирования и практически не  содержит 
         необходимой   вспомогательной   информации,   но   без   него 
         невозможно пользоваться  ассемблером.  (Приложение  3  к 
         настоящей   книге   описывает  методы  об'единения  программ, 
         написанных  на  языках  Паскаль  и  ассемблер,  а  также 
         содержит  ряд  полезных  советов,  которые помогут Вам начать 
         изучение языка ассемблера.) 
              
              1.6.Несколько замечаний о способе изложения материала
              
              В этой книге я старался об'яснять все как  можно  проще, 
         яснее  и по возможности без противоречий. Если Вам встретится 
         непонятный термин, загляните в  краткий  глоссарий  терминов, 
         приведенный в приложении 1. 
              Ниже приведен ряд замечаний. поясняющих способ изложения 
         материала,   использованный   в   этой   книге.   Сначала   о 
         представлении чисел. 
              Числа  всегда  будут  записываться  обычными десятичными 
         цифрами, которые все мы изучаем еще в детстве. В тех случаях, 
         когда     это    необходимо,    будут    также    приводиться 
         шестнадцитиричные      числа,       обозначаемые       словом 
         "шестнадцатиричное".     Шестнадцатиричные    числа    удобно 
         использовать  при  работе  с   компьютером,   поскольку   они 
         представляют собой удобную сокращенную запись двоичных чисел. 
         В отличие от десятичной системы, использующей десять цифр,  в 
         шестнадцатиричной системе цифр шестнадцать, обозначаемых от 0 
         до 9, далее следует А (со  значением  10),  В,  С,  D,  E,  и 
         наконец,  F  (со  значением пятнадцать). В этой книге 11 глав 
         (шестнадцатиричное   В);   Декларация   Независимости    была 
         подписана в 1776 году (шестнадцатиричное 6F0). 
              Вас  может  удивить  запись  чисел  и  в  десятичном и в 
         шестнадцатиричном виде, хотя бы потому, что  ни  Паскаль,  ни 
         Бейсик,     ни    ассемблер    не    требуют    использования 
         шестнадцатиричных чисел при программировании. Тому  есть  три 
         причины.  Одна  состоит в том, что некоторые числа, например, 
         адреса ячеек  памяти,  имеет  больше  смысла  представлять  в 
         шестнадцатиричном   виде.   Другая   связана   с   тем,   что 
         вспомогательная  программа  ДОС   DEBUG   использует   только 
         шестнадцатиричную  форму  представления.  И,  наконец,  часть 
         литературы по IBM/PC, в  частности  техническое  руководство, 
         широко  использует  шестнадцатиричную  форму, причем даже без 
         специальных  оговорок.  Чтобы  облегчить  Вам   сопоставление 
         информации этой книги с другими источниками, числа приводятся 
         как в десятичном, так и в шестнадцатиричном виде. 
              Еще один  элемент  компьютерного  жаргона,  связанный  с 
         записью   чисел,   -   это   использование   буквы  "К".  "К" 
         соответствует числу 1024, так что 64К будет сооветствовать 64 
         раза  по  1024  или  65536.  Термин  "К" широко используется, 
         поскольку он является кратким  обозначением  числа,  примерно 
         равного одной тысяче - так что легко понять, что 64К примерно 
         соответствует шестидесяти четырем тысячам. в двоичной системе 
         значение К или 1024 представляется круглым числом - это два в 
         десятой степени. 
              Иногда возникает  необходимость  обозначать  символы  их 
         кодами, значения которых находятся в диапазоне от 0 до 255. В 
         этих случаях используется способ  записи,  принятый  в  языке 
         Бейсик,  например,  CHR$(65), соответствующий заглавной букве 
         "А". На языке Паскаль это же можно записать как chr(65). 
              Рассмотрим  теперь  биты.  Очень  часто  непонимание   и 
         путаница   возникает   при   обращении   к  отдельным  битам, 
         образующим байты и слова. Различные  источники  описывают  их 
         по-разному,  что еще более осложняет изучение. Наиболее часто 
         используются три  схемы,  которые  я  сейчас  поясню.  Трудно 
         сказать  какая из них наилучшая - мы будем пользоваться самой 
         простой.  Если  Вы  собираетесь  знакомиться  с   технической 
         литературой по компьютерам, Вам необходимо знать три схемы. 
              Если  записать  все  восемь  битов  образующих байт так, 
         чтобы первым был "старший  значащий",  а  последним  "младший 
         значащий"  бит, то их можно будет пронумеровать от первого до 
         восьмого. Такую последовательность можно назвать  просто  "по 
         порядку".  Такой  способ записи мы и будем далее использовать 
         как наиболее простой. Недостаток его заключается в  том,  что 
         он  не  имеет никакого смыслового значения. Другие два метода 
         связаны с числовым "весом" каждого бита.  По  второму  методу 
         биты  нумеруются  справа  налево,  начиная с нуля. Это способ 
         записи  "по  степеням"  и  каждый  номер  бита  соответствует 
         степени  двойки. Такой способ записи наиболее распространен в 
         технической литературе.  И  последний  метод,  который  можно 
         назвать  "по  значению",  обозначает  каждый  бит  значением, 
         равным двум в степени, соответствующей этому биту. 
              Ниже приведена таблица,  показывающая  все  три  способа 
         записи: 
              
              По порядку  По степени  По значению  Бит
         ____________________________________________________________
              
                  1-ый        7          128     10000000
                  2-ой        6          64      01000000
                  3-ий        5          32      00100000
                  4-ый        4          16      00010000
                  5-ый        3          8       00001000
                  6-ой        2          4       00000100
                  7-ой        1          2       00000010
                  8-ой        0          1       00000001
              
         ____________________________________________________________
              
              Как  уже  упоминалось,  мы  будем просто нумеровать биты 
         слева направо, по порядку. Остальные  два  способа,  особенно 
         нумерацию   "по   степени",   можно   встретить  в  различной 
         литературе. Нумерация "по значению"  удобна  в  тех  случаях, 
         когда  необходимо  связать  числовые  значения  байта  с  его 
         битами. Например, в программе можно  установть  1-ый  и  8-ой 
         биты,  присвоив байту значение 128+1. Каждый из этих способов 
         нумерации битов может быть расширен от  8-битового  байта  до 
         16-битового   слова,   что  также  может  Вам  встретиться  в 
         технической литературе. 
             
              Приложение 1.1   Текст   программы   визуализации   всех 
         символов на экране дисплея (Бейсик).
         
         
         1000  REM Листинг 1.1 -- Программа для отображения всех
         1010  REM символов экрана. (С) Авторское право 1983,
         1020  REM Питер Нортон
         1030  GOSUB 2000 'ЗАГОЛОВОК
         1040  GOSUB 3000 'ОПРЕДЕЛЕНИЕ ТИПА ДИСПЛЕЯ И УСТАНОВКА АДРЕСА
         1050  GOSUB 2000 'СНОВА УСТАНОВИТЬ ЗАГОЛОВОК
         1060  GOSUB 4000 'ФОРМИРОВАНИЕ ОКРУЖАЮЩИХ КОММЕНТАРИЕВ
         1070  GOSUB 5000 'ФОРМИРОВАНИЕ МАССИВА ЭКРАНА
         1080  GOSUB 6000 'ЗАВЕРШЕНИЕ РАБОТЫ И ВОЗВРАТ В ДОС
              
         2000  REM Подпрограмма вывода заголовка
         2010  KEY OFF : CLS : WIDTH 80
         2020  REM
         2030  PRINT "   Программы для книги "Персональный компьютер"
         2040  PRINT "   фирмы "IBM".(С) Авторское право 1983"
         2050  PRINT "   Питер Нортон"
         2060  PRINT 
         2070  PRINT "Программа 1-1: Демонстрация всех символов экрана"
         2999  RETURN
         
         3000  REM Подпрограмма проверки типа дисплея
         3010  PRINT
         3020  PRINT "Прежде чем продолжить работу сообщите,"
         3025  PRINT "дисплей цветной-графический?";
         3030  GOTO 3060
         3040  PRINT
         3050  PRINT "(ответ Д или Н)";
         3060  ANSWER$ = INKEY$
         3070  IF LEN(ANSWER$) < 1 THEN 3060
         3080  IF LEN(ANSWER$) > 1 THEN 3040
         3090  SEGVAL! = 0
         3100  IF MID$(ANSWER$,1,1) = "Y" THEN SEGVAL! = &HB800 'Цветной
         3110  IF MID$(ANSWER$,1,1) = "y" THEN SEGVAL! = &HB800 'Цветной
         3120  IF MID$(ANSWER$,1,1) = "N" THEN SEGVAL! = &HB000 'Монохр.
         3130  IF MID$(ANSWER$,1,1) = "n" THEN SEGVAL! = &HB000 'Монохр.
         3140  IF SEGVAL! = 0 THEN 3040
         3150  DEF SEG = SEGVAL!
         3999  RETURN
         
         4000  REM  подпрограмма для формирования сопроводительных
         4005  REM  сообщений
         4010  FOR HEX.DIGIT% = 0 TO 15
         4020     LOCATE 6,HEX.DIGIT% * 3 + 1
         4030     PRINT HEX$(HEX.DIGIT%)
         4040     LOCATE HEX.DIGIT% + 8,8
         4050     PRINT HEX$(HEX.DIGIT%)
         4060  NEXT HEX.DIGIT%
         4070  LOCATE  ,,0
         4999  RETURN
         
         5000  REM  подпрограмма форомирования массива экрана
         5010  FOR ROW% = 0 TO 15
         5020   FOR COL% = 0 TO 15
         5030    POKE(ROW% + 7) * 160 + COL%*6 + 26, COL% + ROW% * 16
         5040   NEXT COL%
         5050  NEXT ROW%
         5999  RETURN
         
         6000  LOCATE 25,1,1
         6010  PRINT "Нажмите любую клавишу для возврата в ДОС..."
         6020  IF LEN(INKEY$) = 0 THEN 6020 'ожидание нажатия клавиши
         6030  CLS
         6999  SYSTEM

         9999  REM Конец листинга программы 1-1
         
             
              
                   
              
                
                
                       ГЛАВА 2. АРХИТЕКТУРА ТЕХНИЧЕСКИХ СРЕДСТВ
                       
                       
              
              В настоящей главе мы рассмотрим  физическую  организацию 
         персонального  компьютера фирмы IBM, его периферию и принципы 
         сопряжения  отдельных  компонентов.  Поскольку   предлагаемая 
         книга  не  является  руководством  по организации технических 
         средств,  мы  не  будем  рассматривать  эти  вопросы  слишком 
         детально.  Приведенных  сведений,  однако,  достаточно, чтобы 
         понять  принципы  работы   IBM/PC   ,состав   дополнительного 
         оборудования,  подключаемого  к  компьютеру и особенности его 
         взаимодействия с остальной системой. 
              Компьютер  во  многом  напоминает  автомобиль.  Он также 
         состоит из множества отдельных частей  и  для  того,чтобы  им 
         польэоваться  (  так  же  как  в  случае  с  автомобилем)  не 
         обязательно знать назначение каждой детали. Однако,  если  Вы 
         хотите  использовать  всю  систему,  необходимо иметь хотя бы 
         приближенное представление о том как функционируют  отдельные 
         части. Как раз этому и посвящена настоящая глава. 
              
              
                2.1.  Микропроцессор-центральный  уэел   персонального
                                     компьютера
              
              Центром вычислительной системы  является  ее  процессор. 
         Это  основное  звено, или "мозг" компьютера. Именно процессор 
         обладает   способностью   выполнять   команды,   составляющие 
         компьютерную  программу.  Персональные компьютеры строятся на 
         базе микропроцессоров, выполняемых в настоящее время на одном 
         кристалле   или   "чипе".  Микропроцессор,  использованный  в 
         IBM/PC, был разработан  и  создан  фирмой  "Интел",  начавшей 
         производство микропроцессоров много лет назад. 
              В IBM/PC используется микропроцессор 8088 фирмы "Интел", 
         который  практически полностью идентичен микропроцессору 8086 
         той же фирмы. Эти микропроцессоры (8086 и  8088  )  выполняют 
         одни и те же команды, так что с точки зрения программирования 
         они обладают функциональной эквивалентностью ( различия между 
         ними заметны только конструктору и мы остановимся на них чуть 
         позже).    Все,    что    касается    программирования    для 
         микропроцессора 8086 относится и к микропроцессору 8088. 
              Принципиальное   отличие    IBM/PC    от    персональных 
         компьютеров предыдущего поколения заключается в использовании 
         16-разрядного микропроцессора. До появления  IBM/PC  наиболее 
         популярные   персональные   компьютеры   строились   на  базе 
         8-разрядных   микропроцессоров,   таких   как   6502   (фирмы 
         "Моторолла",  который  использован  в персональном компьютере 
         "Эппл-2", 8080 (фирмы  "Интел")  или  Z80  (фирмы  "Зайлог"). 
         Различия  между  8-  и 16-разрядными микропроцессорами весьма 
         существенны,  и  их  трудно  сформулировать   одной   фразой. 
         Любопытно,что   наименее   существенное  различие  дало  этим 
         микропроцессорам их названия:  8-разрядные  процессоры  могут 
         манипулировать  данными,  состоящими из 8 бит, а 16-разрядные 
         процессоры могут работать и 16-разрядными данными.  Оба  типа 
         процессоров  позволяют  добиться  одинаковых результатов, так 
         что в этой части различие между ними не слишком  значительно. 
         Основное   преимущество  16-разрядных  процессоров  перед  их 
         8-разрядными  предшественниками  заключается  в  значительном 
         повышении  их  быстродействия,  мощности и удобства их набора 
         команд (причем операции с  16-разрядными  числами  составляют 
         лишь  часть  этого  набора). Кроме того (и это самое главное) 
         существенно   увеличивается    объем    адресуемой    памяти. 
         Большинство  8-разрядных  процессоров  может  использовать не 
         более  64К  памяти,  что  значительно  уменьшает  возможности 
         эффективного    использования    персональных    компьютеров. 
         Процессор 8088, используемый в IBM/PC,  позволяет  адресовать 
         1024К    или    свыше    одного    миллиона    байт   памяти. 
         Может,разумеется,возникнуть  потребность  в  памяти  большего 
         объема,   но,   для  большинства  практических  нужд,  одного 
         миллиона байт вполне достаточно. 
              Таким  образом,  мы  установили наиболее важное различие 
         между   процессором   8088   и   8-разрядными    процессорами 
         персональных   компьютеров   предыдущего   поколения:   объем 
         адресуемой памяти больше не является жестким ограничением для 
         задач,   которые   можно   решать   с  помощью  персонального 
         компьютера. 
              В  чем же состоит различие между микропроцессором 8088 и 
         его "старшим братом" - микропроцессором  8086?  Функционально 
         они одинаковы - выполняют одинаковые команды, используют одни 
         и те же данные, исполняют  одинаковые  программы.  Отличаются 
         они  лишь способом обмена данными с внешней средой. Процессор 
         8086 работает с  периферийным  оборудованием,  которое  может 
         параллельно  обрабатывать  16-разрядные  данные,  а процессор 
         8088 может обмениваться только  8-разрядными  словами.  Таким 
         образом,  различие  между  процессорами 8088 и 8086 состоит в 
         ширине  внешней  шины  данных  -  процессор  8086  пересылает 
         16-разрядные,  а  8088  -  восьмиразрядные  данные.  Это дает 
         основание утверждать, что микропроцессор 8088 не  является  в 
         полном   смысле   16-разрядным.   Такое  утверждение  отчасти 
         соответствует   истине,   но   только   отчасти.    Внутреняя 
         архитектура  8088 - 16-разрядная, но он не использует внешнюю 
         16-разрядную шину данных. Подробнее о шине данных будет  идти 
         речь в параграфе 2.3. 
              В   практичеcком   плане   указанное   различие    между 
         микропроцессорами  8086  и 8088 имеет два аспекта. Во-первых, 
         при передаче более чем одного байта  данных,  процессор  8086 
         работает  в  два  раза  быстрее.  Это  не  означает,  что  он 
         выполняет  всю  работу  вдвое  быстрее,  поскольку   ожидание 
         передачи данных занимает только часть времени работы и, кроме 
         того, в некоторых случаях требуется передавать только 8  бит. 
         Однако,  в  тех  случаях,  когда  процессор  ожидает передачу 
         большого  объема  данных,  8086  тратит  на  ожидание  меньше 
         времени и, следовательно, выполняет работу быстрее. 
              Второй   аспект   заключается   в  проектировании  схемы 
         соединений и выборе компонентов. Восьмиразрядные  цепи  проще 
         проектировать и в настоящее время имеется множество недорогих 
         и очень надежных восьмиразрядных компонентов. Таким  образом, 
         воспользовавшись  микропроцессором 8088, фирма "IBM" упрстила 
         свой персональный компьютер и уменьшила его  стоимость  ценой 
         незначительного уменьшения скорости вычислений. 
                
                2.2.   Краткие   сведения   об  остальных  компонентах
         компьютера 
                
              Для того чтобы микропроцессор мог  работать,  необходимы 
         некоторые вспомогательные компоненты, подобно тому как одного 
         двигателя недостаточно, чтобы заставить автомобиль двигаться. 
              Многие  части  автомобиля  могут  переноситься  с  одной 
         модели на другую - для персональных компьютеров это еще более 
         обычное дело. Лишь немногие компоненты IBM/PC были специально 
         разработаны  для  нее,  -  фактически  большая  часть системы 
         составлена   из   стандартных    компонентов,    начиная    с 
         микропроцессора 8088 фирмы "Интел". Особенность персонального 
         компьютера  фирмы  "IBM"  состоит  в   оригинальном   способе 
         организации известных  компонентов в  единую  функционирующую 
         систему.     Электронная     промышленность      представляет 
         разработчикам    компьютеров    большой   набор   необходимых 
         стандартных компонентов, задача  разработчика  заключается  в 
         том, чтобы объединить их нужным образом. 
              Такое  описание  процесса  разработки  компьютеров может 
         породить мысль, что разрабатывать компьютеры очень просто  и, 
         что  все  они очень похожи друг на друга. Но это настолько же 
         верно, как то, что работа писателя заключается в выборе  слов 
         из   словаря.   Персональные   компьютеры,  подобные  IBM/PC, 
         действительно в значительной  части  состоят  из  стандартных 
         компонентов, однако,   главное   заключается   в  способе  их 
         обьединения. 
              Составляющие IBM/PC можно рассматривать с трех различных 
         точек   зрения:   по   тому  где  они  размещаются,  как  они 
         функционируют, и  как  они  взаимодействуют  друг  с  другом. 
         Рассмотрим    вопрос    пространственного   размещения   этих 
         составляющих. 
              Физически  составляющие  IBM/PC   можно   разделить   на 
         компоненты  системного  блока  и компоненты блока расширения. 
         Все основные платы, входящие в состав  любой  модели  IBM/PC, 
         размещаются  в большом блоке, получившем название системного. 
         (Компьютеры фирмы "Эппл" используют более цветистое  название 
         для  аналогичного  блока  - материнский блок.) Системный блок 
         включает все необходимые компоненты,  позволяющие  компьютеру 
         работать   без   каких-либо   дополнений.   Здесь   находятся 
         микропроцессор, первые 64К памяти и  "встроенные"  программы, 
         такие   как   интерпретатор   языка   Бейсик,   записанный  в 
         микросхемах  ПЗУ.  Большая  часть  компонентов,  описанных  в 
         следующем  параграфе,  также  находится в системном блоке. На 
         рис.2.1 показана упрощенная схема системного блока  (показаны 
         наиболее существенные детали). 
              Системный блок расположен в основании IBM/PC и  заключен 
         в  корпус.  Он  занимает  весь  корпус в длину и примерно две 
         трети в ширину. Если открыть корпус компьютера, то внутри, на 
         дне  корпуса  можно увидеть системный блок. Если взглянуть на 
         него со стороны задней стенки корпуса,можно увидеть в  центре 
         большой элемент схемы IBM/PC - микропроцессор 8088. 
              Правая   часть  системного  блока  находится  под  левым 
         дисководом, а место слева от системного блока свободно -  оно 
         предназначено  для размещения блоков расширений. В левом углу 
         системного   блока   имеется   пять    свободных    разъемов, 
         предназначенных для подключения дополнительного оборудования, 
         которое  может  быть  введено  в  состав  компьютера.   Блоки 
         расширения   вставляются  в  эти  разъемы,  располагаясь  над 
         системным блоком. 
              Блоки  расширения  или  карты,  как их иногда называют - 
         могут использоваться для обслуживания устройств, подключаемых 
         к  IBM/PC.  Они могут использоваться для двух основных целей: 
         для увеличения объема  памяти  и  подключения  дополнительных 
         устройств. Если оборудование умещается на одной плате, то его 
         можно разместить  внутри  корпуса  IBM/PC.  Если  же  оно  не 
         помещается в корпус, например, в случае с дисплеем, то внутри 
         размещается  только   плата   управления,   соединяющаяся   с 
         оборудованием  с  помощью  кабеля,  который  можно пропустить 
         через отверстие в  задней  стенке  корпуса.  Каждому  разъему 
         расширения   соответствует  специальное  отверстие  в  задней 
         стенке корпуса, закрытое заглушкой, если оно не используется. 
              Системный  блок  разработан  фирмой   "IBM",   а   блоки 
         расширения  могут разрабатывать все желающие, при условии что 
         они будут соблюдать основные  правила,  касающиеся  размеров, 
         электрических  параметров  соединений, теплового режима и так 
         далее. 
              
                2.3. Функциональное назначение 
         
                
              Может Вам эти сведения  и  не  пригодятся,  но,  видимо, 
         будет  интересно  узнать как работают основные элементы схемы 
         IBM/PC. Если какой-либо  элемент  будет  иметь  значение  для 
         понимания  материала  последующих  разделов книги, я буду это 
         специально отмечать, чтобы  Вы  не  подумали,  что  сведения, 
         полученные в этом разделе можно просто забыть. 
              Сигналы  синхронизации  работы  системы   обеспечиваются 
         генератором 8284А. Эти сигналы используются всеми  элементами 
         компьютера   и   задают  длительность  операций.  С  тактовым 
         генератором  связан  таймер   8255А-5,   использующийся   для 
         поддержки  интерфейса накопителя на кассетной магнитной ленте 
         и встроенного динамика. В главе 11 будет  описано  управление 
         динамиком  и  мы  увидим  как  "программировать"  таймер  для 
         извлечения звуков. 
              Функционирование  компьютерной   системы   основано   на 
         использовании  прерываний,  работа с которыми будет описана в 
         следующей главе. Для организации  работы  системы  прерываний 
         используется  микросхема 8259А.
              Когда данные передаются внутри компьютерной системы, они 
         проходят по  общему  каналу,  к  которому  имеют  доступ  все 
         компоненты  системы.  Этот путь получил название шины данных. 
         Концепция  шины   представляет   собой   один   из   наиболее 
         совершенных  методов  унификации  при разработке компьютеров. 
         Вместо   того   чтобы   пытаться   соединять   все   элементы 
         компьютерной  системы  между собой специальными соединениями, 
         разработчики компьютеров ограничили  пересылку  данных  одной 
         общей  шиной.  Данные  пересылаются  по  шине в сопровождении 
         специальных сигналов, обозначающих их  назначение.  Эта  идея 
         чрезвычайно  упрстила  конструкцию  компьютеров и существенно 
         увеличила ее гибкость. Чтобы  добавить  новый  компонент,  не 
         требуется    выполнять    множество   различных   соединений, 
         достаточно  присоединить  его  к  шине.   Чтобы   упорядочить 
         передачу  информации  по  шине  используется  контроллер шины 
         8288. 
              Все упоминавшиеся до  сих  пор  элементы  размещаются  в 
         системном блоке. Если взглянуть на основные блоки расширения, 
         можно  обнаружить  еще  несколько   интересных   компонентов. 
         Имеется  два  типа адаптеров дисплеев для IBM/PC. Один из них 
         предназначен для управления монохромным дисплеем фирмы  "IBM" 
         -  для  управления цветным графическим дисплеем ( или простым 
         монохромным дисплеем,  который  также  может  подключаться  к 
         цветному/графическому адаптеру). Хотя дисплеи этих двух типов 
         работают по-разному и  имеют  различные  характеристики,  для 
         управления  ими  используется  одна  и  та  же  микросхема  - 
         контроллер дисплея 6845 (фирмы "Моторола"). 
              Для   управления   дисководами  используется  микросхема 
         контроллера  гибких  дисков  -  PD765  фирмы  "NEC"  или   ее 
         эквивалент  (расположена  на  плате  адаптера гибких дисков). 
         Изучая листинги BIOS, приведенные в  техническом  руководстве 
         по IBM/PC, можно встретить таинственную ссылку на "NEC". Речь 
         идет как раз о контроллере гибких дисков. Хотя  мы  не  будем 
         рассматривать   такие   подробности,   можно  упомянуть,  что 
         возможно непосредственное управление работой  гибких  дисков, 
         путем  выдачи  команд  контроллера.  Эти  команды  описаны  в 
         техническом руководстве. 
                
                2.4. Использование разъемов расширения
                
              Любые дополнительные устройства подключаются к IBM/PC  с 
         помощью  одного  из  разъемов  расширения,  каждый из которых 
         имеет 62  соединительных  провода.  Эти  62  линии  позволяют 
         передавать  все  сигналы,  необходимые  для  управления любым 
         оборудованием, которое может быть подключено  к  IBM/PC.  Все 
         линии   работают   параллельно,   так  что  устройства  можно 
         подключать  к  любому  из  пяти   разъемов.   Любой   сигнал, 
         посылаемый  одному  из  блоков расширения,  передается и всем 
         остальным, поскольку они подключены  к  параллельным  линиям. 
         Здесь  имеет  место  расширение  идеи  общей шины данных: все 
         блоки расширения  используют общее  62-проводное  соединение. 
         называемое каналом ввода/вывода. 
              По  характеру использования все линии можно разделить на 
         четыре категории. Во-первых, восемь  линий  используются  для 
         подвода  питания  к блокам расширения с различными номиналами 
         напряжений. 
              Далее, еще восемь линий используется для передачи восьми 
         бит  данных  на/с  шины  данных.  Все данные проходят по этой 
         шине, независимо от направления передачи. 
              Еще  двадцать  линий  предназначены для адресации. Когда 
         данные передаются  в  память  или  считываются  из  нее,  или 
         данными   обмениваются   с  внешним  устройством,  необходимо 
         указать адрес, который может быть либо адресом ячейки памяти, 
         либо  номером  устройства.  При работе с памятью используются 
         все 20 линий, это позволяет передать  адрес  одной  из  1024К 
         ячеек  памяти. Для устройств ввода/вывода используется только 
         девять  линий,  что  позволяет   адресовать   512   различных 
         устройств. 
              Остальные   линии   канала   используются  для  передачи 
         различных сигналов управления. Примерами таких сигналов могут 
         служить команды чтения из памяти, записи в память или команды 
         чтения/записи для периферийных устройств. 
              Каждое   внешнее   устройство,  подключенное  к  разъему 
         расширения постоянно ожидает  сигналов  канала  ввода/вывода. 
         Предположим,    например,    что    выдана   команда   ввода, 
         идентифицируемая сигналом на линии  чтения  по  вводу/выводу. 
         Когда  это  произойдет,  все  устройства  будут  читать  шину 
         адреса, который не относится к памяти  компьютера  (поскольку 
         не  была  выдана  команда  работы  с  памятью).Если же выдана 
         команда работы с  памятью,  то  все  устройтсва  ввода/вывода 
         будут   игнорировать   содержимое   шины   адреса.  Поскольку 
         запрашивалась  операция  ввода/вывода,  каждое   периферийное 
         устройство  проверит  содержимое  шины  адреса. Если адрес на 
         шине  совпадает  с  адресом  устройтсва,  то   оно   начинает 
         выполнять  операцию.  В  противном случае никаких действий не 
         производится.Таков принцип работы блоков расширения. 
                
                2.5. Что еще необходимо знать об аппаратных средствах
                
              Есть  еще  несколько  интересных  подробностей,  которые 
         полезно знать о системном блоке IBM/PC. 
              Во-первых, внутри корпуса  IBM/PC  спрятаны  два  набора 
         переключателей.   Их  называют  переключателями  конфигурации 
         системы (они выполнены в виде корпуса с двумя рядами выводов, 
         т.е.   корпуса   типа  DIR).  Установка  этих  переключателей 
         указывает какое оборудование подключено к  IBM/PC,  например, 
         количество  дисководов,  объем  доступной  памяти  и т.д. Эти 
         переключатели ничем реально не управляют -  они  используются 
         только для удобства. После включения IBM/PC программы запуска 
         считывают положение этих переключателей и затем устанавливают 
         содержимоке  определенных  ячеек  памяти  в соответствии с их 
         положением.  Затем,  если  какой-либо  программе   необходимо 
         узнать   ,   какой   объем   памяти  установлен,  проверяется 
         содержимое  этих  ячеек.  (Хранение  информации  о  положении 
         переключателей  в  памяти  очень удобно, поскольку появляется 
         возможность, в  случае  необходимости,  ее  изменения.  Таким 
         образом, программа может изменить положение переключателей и, 
         следовательно,   как   бы   изменить   список    подключаемых 
         устройств.) 
              Как  видите,  использование  переключателей конфигурации 
         системы  "логическое"  скорее  чем  "физическое".   Изменение 
         положений переключателей не отключает и не подключает никакие 
         устройства,  оно  просто  изменяет  ту  информацию,   которую 
         программы могут получить о конфигурации системы. 
              Далее,  рассмотрим  сопроцессор.  Когда   разрабатывался 
         микропроцессор  8088, для него была предусмотрена способность 
         выполнения обычных, целочисленных арифметических операций, но 
         он  не способен оперировать с числами с плавающей запятой или 
         вещественными  числами  (  в  языке  Бейсик  это   называется 
         арифметикой   обычной  и  двойной  точности).  Арифметические 
         операции над числами с плавающей  запятой  могут  выполняться 
         одним  из  двух  способов. Первый и наиболее распространенный 
         способ - программная реализация с помощью логических операций 
         и    целочисленных    арифметических   операций   подрограмм, 
         выполняющих  вычисления  и  дающих  результаты  в   форме   с 
         плавающей  запятой.  Второй  способ  основан на использовании 
         специализированного сопроцессора. 
              Микропроцессор 8088 сконструирован так, что он позволяет 
         использовать  арифметический  сопроцессор 8087 фирмы "Интел". 
         Специализация процессора 8087  состоит  в  быстрой  обработке 
         чисел  с  плавающей  запятой.  Он может выполнять как обычные 
         операции сложения, вычитания,  умножения  и  деления,  так  и 
         более     сложные     операции,    такие    как    вычисление 
         тригонометрических  функцмй.   Конструктивно   заложенные   в 
         микропроцессор  8088  сигналы позволяют ему передавать работу 
         сопроцессору 8087, а затем получать результаты работы.  Чтобы 
         использовать арифметический сопроцессор, необходимо иметь его 
         в составе компьютера,  а  кроме  того  необходимы  программы, 
         которые  могут  выдавать  специальные  коды,  необходимые для 
         запуска сопроцессора 8087. Хотя в первой версии PC фирма  IBM 
         не   включала   в   систему   сопроцессор,  гнездо  для  него 
         предусмотрено  в  системном  блоке.  На  рис.2.1.  его  можно 
         увидеть    в   правом   верхнем   углу,   рядом   с   гнездом 
         микропроцессора 8088. 
              Конструкция микропроцессоров  8086/8088  предусматривает 
         два   основных  способа  повышения  вычислительной  мощности. 
         Первый заключается в  использовании  сопроцессора  8087,  для 
         которого   в   IBM/PC   предусмотрено  специальное  гнездо  в 
         системном блоке.  Второй  способ  заключается  в  организации 
         мультипроцессорного  режима,  при  котором  несколько обычных 
         микропроцессоров совместно выполняют вычисления,  распределяя 
         нагрузку  между  собой.  Фирма  "IBM"  не предусмотрела такой 
         режим работы в конструкции своего  персонального  компьютера. 
         Еще  один вспомогательный "чип" - процессор ввода/вывода 8089 
         позволяет повысить общую производительность системы  на  базе 
         процессора  8086/8088,  однако  его  использование  также  не 
         предусмотрено в IBM/PC. 
              Рассмотрим теперь еще одно  пустое  гнездо  в  системном 
         блоке  IBM/PC.  "Встроенное"  программное  обеспечение IBM/PC 
         записано в микросхемах постоянного  запоминающего  устройтсва 
         (ПЗУ), расположенных почти в центре системного блока, ближе к 
         левой стороне. Как видно из  рис.2.1  таких  микросхем  пять. 
         Рядом  с  ними,  с  левой  стороны  имеется свободное гнездо, 
         которое оставлено специально с  целью  добавления  каких-либо 
         программ. Назначение этого гнезда вызывает различные домыслы. 
         Лично  я  вижу   три   возможных   разумных   предназначения. 
         Во-первых,   оно   могло   быть   оставлено  по  соображениям 
         надежности - если в какой-нибудь из записанных в ПЗУ процедур 
         обнаружатся ошибки, исправление которых приведет к увеличению 
         объема процедуры, то в  это  гнездо  можно  будет  установить 
         микросхему  с  записью  этих изменений. Во-вторых, если "IBM" 
         расширит  номенклатуру  поддерживаемых  системой   устройств, 
         таких  как  жесткие диски большой емкости, тогда в это гнездо 
         можно  будет  установить   микросхему   ПЗУ   с   записанными 
         программами  управления.  Правда,  блок расширения для любого 
         нового  устройтсва  также  может  содержать  все  необходимые 
         программы,    так    что   действительной   необходимости   в 
         дополнительном гнезде для этих целей нет. Третья, и  наиболее 
         вероятная,  возможность  связана  с  поддержкой  сопроцессора 
         8087.  В  это  гнездо  можно  установть  ПЗУ  с   программами 
         сопроцессора.   Такие   программы  позволили  бы  работать  с 
         арифметическим     сопроцессором      8087      "встроенному" 
         интерпретатору  Бейсика,  а  также  программам, написанным на 
         других языках, например, на Паскале, Фортране или Бейсике  (с 
         помощью компилятора). 
                
                2.6. Три аспекта рассмотрения архитектурных решений
                
              Все  о чем мы говорили до сих пор в этой главе относится 
         только к оригинальной модели IBM/PC, т.е. к первому  аспекту. 
         На  совместимые  с  IBM/PC  компьютеры  распространяется лишь 
         часть информации, а вся  остальная  применяется  для  каждого 
         конкретного  компьютера.  Совпадает  обычно  лишь одна деталь 
         всех совместимых с РС компонентов  -  это  вид  разьемов  для 
         подключения блоков расширения. В этой части все РС - подобные 
         компьютеры практически полностью повторяют IBM/PC. 
              В   сфере  больших  компьютеров  уже  давно  образовался 
         определенный круг так  называемых  элементов  совместимых  по 
         способу  соединения.  Такие  элементы  могут  заменить  части 
         системы путем отключения исходного элемента  и  включения  на 
         его место заменителя. Такая замена может производиться как со 
         стороны периферийных устройтсв компьютера, так и  со  стороны 
         процессора. 
              То же самое  происходит  и  с  IBM/PC.  В  месте  любого 
         соединения  можно  обнаружить  конкуренцию  между  различными 
         вариантами  элементов  замены  по  обе  стороны   соединения. 
         Постоянным  остается  только  формат  разъема  - его изменить 
         нельзя.  Таким   образом,   общим   для   всех   компьютеров, 
         совместимых  с  IBM/PC,  будет формат разъема для подключения 
         блоков расширения. 
              Материал,  рассматривавшийся  в  начале  этой  главы,  к 
         третьей  области  интересов   -   компьютером,   использующих 
         различные    версии    операционной    системы    MS-DOS,   - 
         непосредственного отношения не имеет. Однако,  в  той  части, 
         где  речь  пойдет  о  значении  дополнительного оборудования, 
         подключаемого к IBM/PC, все  сказанное  об  IBM/PC  в  равной 
         степени относится и к другим персональным компьютерам. 
               
               2.7. Возможности комплдектации  IBM/PC
               
              В этом параграфе речь пойдет  о  различных  возможностях 
         комплектации     IBM/PC     дополнительными     периферийными 
         устройствами  и  о  том,  как  это  сказывается  на   рабочих 
         характеристиках.   Не  все  понимают  значение  периферийного 
         оборудования. Дескать, IBM/PC и есть  IBM/PC,  независимо  от 
         того,  что  к  нему  подключено.  Однако,  для  практического 
         использования  решающее  значение  имеет   то   оборудование, 
         которое подключено к компьютеру. 
              По моему мнению существует  три  или  четыре  достаточно 
         сильно различающихся персональных компьютера фирмы "IBM". 
              Речь  идет  об  одной  модели  компьютера  с  различными 
         комплектами  периферийных   устройтсв,   которые   определяют 
         область применения компьютера. 
              ИГРУШКА.  Это IBM/PC без дисковой памяти, так называемая 
         "кассетная система". Такая  конфигурация,  по  моему  мнению, 
         никогда  и  никем  не  воспринималась всерьез и, вероятно, не 
         имела права на существование. Я  убежден,  что  ее  появление 
         связано  только с желанием снизить цену базовой модели, чтобы 
         не отпугнуть потенциальных покупателей. Такой  комплект  вряд 
         ли  можно  использовать  для решения сколько-нибудь серьезных 
         задач, так что усеченный  вариант  мощной  машины  становится 
         похож   на   игровую   машину  типа  "Атари"  или  "Маттель". 
         Доказательством бесполезности такого варианта  может  служить 
         отсутствие  программ  на  кассетах.  Единственная возможность 
         использования этой системы состоит, вероятно, в подготовке  и 
         обучении  пользователей  перед  переходом  к  работе  с более 
         серьезным оборудованием. 
              Следующие  два  варианта  комплектации  IBM/PC  являлись 
         основными  вариантами   компоновки   IBM/PC   в   начале   ее 
         применения.  На  их примере хорошо иллюстрируется положение о 
         том, что в некотором  смысле  существует  не  один  компьютер 
         IBM/PC  с  различным  периферийным оборудованием, а несколько 
         существенно отличающихся друг от друга компьютеров IBM/PC. 
              ДЕЛОВОЙ КОМПЬЮТЕР. Это IBM/PC  с  монохромным  дисплеем, 
         желательно  фирмы "IBM". Естественно, эта машина должна иметь 
         два дисковода, устройство печати и,  возможно,  еще  какое-то 
         оборудование.  Но  отличает  этот  компьютер,  прежде  всего, 
         дисплей. Графика здесь не требуется,  вся  работа  ведется  в 
         алфавитно-цифровом (текстовом) режиме. Использолвание дисплея 
         фирмы "IBM" очень облегчает чтение текста  на  экране.  Сфера 
         применения  этого  компьютера  - в основном учреждения. Экран 
         монохромного дисплея фирмы "IBM" не утомляет глаза, даже если 
         смотреть на него целый день. С помощью этого компьютера можно 
         выполнять деловые расчеты,  формировать  планы  (например,  с 
         помощью   программы  "VisiCalk")  или  готовить  документы  с 
         помощью текстовых процессоров. 
              ГРАФИЧЕСКАЯ МАШИНА.  Это  IBM/PC  оборудованный  цветным 
         графическим дисплеем и остальными периферийными устройствами, 
         включая  дискеты.  Этот  компьютер   позволяет   работать   с 
         графическими    изображениями,    правда   ценой   пониженной 
         различимости  символов.  Использование  этой  машины  труднее 
         описать  простыми  категориями, но они могут использоваться в 
         инженерном и архитектурном черчении, деловой графике, играх и 
         мультипликации. 
              Я утверждаю,  что  "деловой  компьютер"  и  "графическая 
         машина"   являются  различными  компьютерами,  поскольку  они 
         предназначены для совершенно разных целей. И, что  еще  более 
         важно,  пограммные продукты для них тоже совершенно различны. 
         Ясно, что деловые программы, выдающие  текстовые  результаты, 
         смогут  работать  и  на  компьютерах  с цветными графическими 
         дисплеями, однако, это  будет  более  утомительно  для  глаз. 
         Программы,  написанные  для графического дисплея, определенно 
         не будут работать на деловом компьютере. 
              Такое   частичное   разделение   между   предполагаемыми 
         вариантами использования  деловых  систем  IBM/PC  делает  их 
         практически  разными  машинами,  со  своими  рынками и своими 
         кругом пользователей. Но все же,  все  системы  IBM/PC  имеют 
         очень  много  общего  в оборудовании, программных средствах и 
         интересах  пользователей.  Я  так  подробно  остановился   на 
         разделении  деловых  и  графических  систем,  чтобы  Вы лучше 
         представляли себе сам факт существования такого различия. 
              МАШИНА С ВИНЧЕСТЕРОМ. Это IBM/PC,  к  которой  подключен 
         диск  большой емкости с высокой скоростью доступа. Такой диск 
         часто называют "жестким"  (чтобы  отличать  его  от  "гибких" 
         дисков) или "винчестером" (по кодовому наименованию одного из 
         ранних   проектов   фирмы   "IBM",    в    рамках    которого 
         разрабатывалась     технология,    реализованная    в    этих 
         накопителях). Отличительной чертой такого компьютера является 
         наличие  внешней  памяти  большого объема, позволяющей решать 
         множество задач: хранить  всю  деловую  информацию  небольшой 
         компании,  хранить регистрационные записи пациентов врача или 
         хранить  базу  данных  научного  работника.  Короче   говоря, 
         IBM/PC,  оборудованный  винчестером,  обладает  возможностями 
         оперативной работы с большими массивами данных. 
              Не  требуется  большого  опыта  работы  с  IBM/PC, чтобы 
         установить,    что     основным     сдерживающим     фактором 
         быстродействия,  возможностей  и  полезности этого компьютера 
         является   хранение   данных   на    диске.    Быстродействие 
         микропроцессора   8088,   использующегося   в   IBM/PC,   для 
         большинства  задач  достаточно   велико.   (Если   какие-либо 
         программы  на Ваш взгляд работают недостаточно быстро, то это 
         скорее всего связано с недостаточно эффективной  реализацией. 
         Наиболее общий пример - это программы на Бейсике, выполняемые 
         в режиме интерпретации.) 
              Объем памяти IBM/PC также вполне достаточен и, во всяком 
         случае,  значительно  превышает  характеристики   песональных 
         компьютеров   предыдущего   поколения.   Большинство   первых 
         персональных компьютеров имело всего 64 К памяти, в то  время 
         как  объем  памяти IBM/PC может превышать 256К. (Часть памяти 
         используется   в   качестве   экранной    памяти,    хранения 
         интерпретатора Бейсика и управляющих программ системы BIOS). 
              Скорость и  емкость  внешней  памяти  на  гибких  дисках 
         ограничивают  возможности   IBM/PC.   Снять  эти  ограничения 
         позволяют жесткие диски винчестерского типа.  Обычно  емкость 
         винчестера  лежит  в  пределах от 2 до 25 миллионов байт, что 
         эквивалентно емкости 12  -  150 односторонних  дискет.  Кроме 
         того,  скорость  доступа  у  винчестера  намного  выше, чем у 
         дисководов с гибкими магнитными дисками. 
              Таким   образом,   с  подключением  винчестера  появился 
         четвертый и, вероятно, наиболее интересный вариант IBM/PC. Мы 
         имеем  все  основания  считать  оснащенный винчестером IBM/PC 
         отдельной версией компьютера, поскольку  его  возможности  на 
         порядок  выше,  чем  у остальных систем. Винчестеры позволяют 
         хранить базу данных  значительного  объема  или  всю  деловую 
         документацию  компании.  Винчестеры  превращают  персональные 
         компьтеры либо в законченные деловые машины,  либо  в  мощные 
         средства   доступа   к   данным.  Таким  образом,  винчестеры 
         существенно увеличивают возможности IBM/PC. 
              Когда появился первый вариант  IBM/PC,  фирма  "IBM"  не 
         поставляла  и  не  предусматривала  подключение винчестеров к 
         IBM/PC, но изготовители дисков быстро разработали контроллеры 
         и  программы  для  подключения  винчестера  к IBM/PC. Однако, 
         можно ожидать, что для полной  реализации  потенциала  IBM/PC 
         винчестеры   (или   другие  эквивалентные  устройства  памяти 
         большой емкости с быстрым доступом)  должны  стать  составной 
         частью большинства компьютеров IBM/PC. 
              Прежде  чем завершить рассмотрение важности комплектации 
         IBM/PC  периферийным  оборудованием,   необходимо   упомянуть 
         адаптер   последовательной  связи.  Адаптер  связи  настолько 
         обычный элемент оборудования, что  о  нем  редко  вспоминают. 
         Однако,    наиболее    перспективный    путь    использования 
         персональных   компьютеров    заключается    в    организации 
         вычислительных  сетей,  которые  без  адаптера  связи создать 
         невозможно. Таким  образом,  адаптер  связи  может  оказаться 
         наиболее важным дополнительным элементом оборудования. 

